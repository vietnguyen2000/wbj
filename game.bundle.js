(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[757],{556:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var i=atob(this.toDataURL(e,n).split(",")[1]),a=i.length,s=a>>2,r=new Uint8Array(a),o=new Uint32Array(r.buffer,0,s),c=0,h=0;c<s;c++)o[c]=i.charCodeAt(h++)|i.charCodeAt(h++)<<8|i.charCodeAt(h++)<<16|i.charCodeAt(h++)<<24;for(var l=3&a;l--;)r[h]=i.charCodeAt(h++);t(new Blob([r],{type:e||"image/png"}))}})},444:function(t,e,n){"use strict";n.r(e),n.d(e,{FacebookTournament:function(){return u}});var i=n(8),a=n(144),s=n.n(a),r=n(6),o=n.n(r),c=n(47),h=n(254),l=n(111),u=function(){function t(){}var e=t.prototype;return e.createAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.createAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.shareAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.shareAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.joinAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.joinAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postScoreAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.postScoreAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getTournamentsAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}(),d=function(){function t(t){var e=this;this.facebook=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.requestTournamentAsync=function(){var t=(0,i.default)(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.facebook.getTournamentAsync();case 3:return t.next=5,e.facebook.tournament.shareAsync({score:n});case 5:t.next=12;break;case 7:return t.prev=7,t.t0=t.catch(0),i=GameSDK.player.getName(),t.next=12,e.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),this.facebook=t}var e=t.prototype;return e.switchAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return t.next=4,GameSDK.context.switchAsync(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.chooseAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return t.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return t.abrupt("return",GameSDK.context.getID());case 8:if(t.prev=8,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=16;break}t.t1=t.t0.code,t.next="USER_INPUT"===t.t1?14:"SAME_CONTEXT"===t.t1?15:16;break;case 14:return t.abrupt("return",!1);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),e.createAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return t.next=5,GameSDK.context.createAsync(""+e);case 5:case 15:return t.abrupt("return",GameSDK.context.getID());case 8:if(t.prev=8,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=16;break}t.t1=t.t0.code,t.next="USER_INPUT"===t.t1?14:"SAME_CONTEXT"===t.t1?15:16;break;case 14:return t.abrupt("return",!1);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.getPlayerToken=function(){var t=(0,i.default)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return e=t.sent,t.abrupt("return",e.getSignature());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getContextPlayers=function(){var t=(0,i.default)(o().mark((function t(e){var n,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameSDK.context.getPlayersAsync();case 3:return n=t.sent,i=[],n.forEach((function(t){var n=t.getID();if(n!==e){var a=t.getName();if(a){var s=t.getPhoto();i.push(new h.default(n,a,s).toObject())}}})),t.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return t.prev=9,t.t0=t.catch(0),console.warn("getPlayersAsync",{error:t.t0}),t.abrupt("return",[]);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e.shareAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.shareAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.sendMessage=function(){var t=(0,i.default)(o().mark((function t(e){var n,i,a,s,r,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,i=e.image,a=e.template,s=e.cta,r=e.text,c={data:n,image:i,action:"CUSTOM",template:a,cta:s,text:r,strategy:"IMMEDIATE",notification:"PUSH"},t.next=4,GameSDK.updateAsync(c);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.inviteAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.inviteAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postSessionScoreAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.postSessionScoreAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getRewardedVideoAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getRewardedVideoAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getInterstitialAdAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getInterstitialAdAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getContextID=function(){return GameSDK.context.getID()},e.attemptToAddShortcut=function(){var t=(0,i.default)(o().mark((function t(){var e,n,i,a,r,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCalledCreateShortcut){t.next=2;break}return t.abrupt("return",!1);case 2:if(t.prev=2,"ANDROID"!==GameSDK.getPlatform()){t.next=6;break}return t.abrupt("return",!1);case 6:return t.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(n=t.sent,!(i=n.lastCallCreateShortcut)||!(0,l.checkIsToday)(+i)){t.next=12;break}return t.abrupt("return",!1);case 12:if(a=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:a}),s()(e=GameSDK.getSupportedAPIs()).call(e,"canCreateShortcutAsync")){t.next=17;break}return t.abrupt("return",!1);case 17:return t.next=19,GameSDK.canCreateShortcutAsync();case 19:if(!t.sent){t.next=37;break}return r=c.AnalyticsEvents.SHORTCUT_CREATE,h=c.AnalyticsEvents.SHORTCUT_CREATE_POPUP,this.isCalledCreateShortcut=!0,window.game.analytics.event(h),t.prev=24,t.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return t.next=29,GameSDK.createShortcutAsync();case 29:return window.game.analytics.event(r,{success:!0}),t.abrupt("return",!0);case 33:return t.prev=33,t.t0=t.catch(24),window.game.analytics.event(r,{success:!1}),t.abrupt("return",!1);case 37:return t.abrupt("return",!1);case 40:return t.prev=40,t.t1=t.catch(2),t.abrupt("return",!1);case 43:case"end":return t.stop()}}),t,this,[[2,40],[24,33]])})));return function(){return t.apply(this,arguments)}}(),e.attemptToSubscribeBot=function(){var t=(0,i.default)(o().mark((function t(){var e,n,i,a,r,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCalledSubscribeBot){t.next=2;break}return t.abrupt("return",!1);case 2:if(t.prev=2,s()(e=GameSDK.getSupportedAPIs()).call(e,"player.canSubscribeBotAsync")){t.next=6;break}return t.abrupt("return",!1);case 6:return t.next=8,GameSDK.player.canSubscribeBotAsync();case 8:if(!t.sent){t.next=34;break}return t.next=12,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 12:if(n=t.sent,!(i=n.lastCallSubscribeBot)||!(0,l.checkIsToday)(+i)){t.next=16;break}return t.abrupt("return",!1);case 16:return a=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:a}),r=c.AnalyticsEvents.BOT_SUBSCRIBE,h=c.AnalyticsEvents.BOT_SUBSCRIBE_POPUP,this.isCalledSubscribeBot=!0,window.game.analytics.event(h),t.prev=21,t.next=24,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 24:return t.next=26,GameSDK.player.subscribeBotAsync();case 26:return window.game.analytics.event(r,{success:!0}),t.abrupt("return",!0);case 30:return t.prev=30,t.t0=t.catch(21),window.game.analytics.event(r,{success:!1}),t.abrupt("return",!1);case 34:return t.abrupt("return",!1);case 37:return t.prev=37,t.t1=t.catch(2),t.abrupt("return",!1);case 40:case"end":return t.stop()}}),t,this,[[2,37],[21,30]])})));return function(){return t.apply(this,arguments)}}(),e.matchPlayerAsync=function(){var t=(0,i.default)(o().mark((function t(e,n,i){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s()(a=GameSDK.getSupportedAPIs()).call(a,"checkCanPlayerMatchAsync")){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(t.sent){t.next=9;break}return t.abrupt("return",!1);case 9:return t.next=11,GameSDK.matchPlayerAsync(e,n,i);case 11:return t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n,i){return t.apply(this,arguments)}}(),e.setLoadingProgress=function(t){GameSDK.setLoadingProgress(t)},e.getLocale=function(){return GameSDK.getLocale()||"en"},e.injectTournament=function(){var t=(0,i.default)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!GameCore.Configs.Tournament.UseMock){t.next=8;break}return t.next=4,n.e(357).then(n.bind(n,569));case 4:e=t.sent.default,this.facebook.tournament=new e,t.next=9;break;case 8:this.facebook.tournament=new u;case 9:this.facebook.getTournamentAsync=this.getTournamentAsync,this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getTournamentAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getTournamentAsync();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}();e.default=d},47:function(t,e,n){"use strict";n.r(e),n.d(e,{AnalyticsEvents:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",DAILY_CHALLENGE_BEGIN:"daily_challenge_begin",DAILY_CHALLENGE_FAIL:"daily_challenge_fail",DAILY_CHALLENGE_END:"daily_challenge_end",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score"}},62:function(t,e,n){"use strict";n.r(e);var i=n(121),a=function(){function t(t,e){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(e.targets.length<1)){this.buildConfig(t,e);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var e=t.prototype;return e.buildConfig=function(t,e){this.config=(0,i.merge)(t,e)},e.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},e.restart=function(){var t;null==(t=this.tween)||t.restart()},e.stop=function(){var t;null==(t=this.tween)||t.stop()},e.remove=function(){var t;null==(t=this.tween)||t.remove()},e.next=function(t){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,t),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,t),this.tween):null},t}();e.default=a},464:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),s=n(62),r={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(t){function e(e){var n,a,s;return(s=t.call(this,r,e)||this).posX=void 0,s.handleSwitchPosition=function(){var t;s.posX=-s.posX,null==(t=s.tween)||t.updateTo("x",-s.posX)},null!=(n=s.config)&&n.props?(s.posX=s.config.props.x,null==(a=s.tween)||a.on(Phaser.Tweens.Events.TWEEN_REPEAT,s.handleSwitchPosition),s):(0,i.default)(s)}return(0,a.default)(e,t),e}(s.default);e.default=o},458:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(62),s={targets:[],duration:400,ease:n(255).default,props:{scale:"-=0.1"}},r=function(t){function e(e){return t.call(this,s,e)||this}return(0,i.default)(e,t),e}(a.default);e.default=r},482:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(62),s={targets:[],duration:400,ease:n(255).default,props:{scale:"+=0.1"}},r=function(t){function e(e){return t.call(this,s,e)||this}return(0,i.default)(e,t),e}(a.default);e.default=r},255:function(t,e,n){"use strict";n.r(e);var i=n(328),a=n.n(i)()(.48,1.57,.6,.83);e.default=a},10:function(t,e,n){"use strict";n.r(e);var i=n(112),a=n(4),s=n(0),r=n(47),o=n(458),c=n(36),h=n(24),l=n(28),u=function(t){function e(e,n,i,s,r,l){var u;return void 0===l&&(l=!1),(u=t.call(this,e)||this).useSound=!0,u.isClicked=!1,u.scaleUp=-1,u.scaleDown=-1,u.button=void 0,u.upAnimation=void 0,u.downAnimation=void 0,u.isUsePixelPerfect=!1,u.hitArea=void 0,u.hitZone=void 0,u.scaleDownPress=void 0,u.parentName=void 0,u.handelObjectDestroy=function(){u.scene&&u.scene.events.off(Phaser.Scenes.Events.SLEEP,u.handleSceneSleep)},u.handleSceneSleep=function(){u.scene&&u.scene.tweens.killTweensOf((0,a.default)(u))},u.handlePointerDown=function(){var t,e;u.isClicked||null!=(t=u.upAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(u.isClicked=!0,u.runDownAnimation())},u.handleOnClick=function(t){return function(){var e,n,i,a;u.isClicked&&(null!=(e=u.upAnimation)&&null!=(n=e.tween)&&n.isPlaying()||(u.isClicked=!1,u.runUpAnimation(),null==(i=u.upAnimation)||null==(a=i.tween)||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){u.logButtonEvent(),u.addDebugData(),u.processCallback(t)}))))}},u.handlePointerOut=function(){var t,e;u.isClicked&&(null!=(t=u.upAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(u.isClicked=!1,u.runUpAnimation()))},u.runDownAnimation=function(){var t;-1===u.scaleDown&&(u.scaleUp=u.scale,u.scaleDown=u.scaleDownPress),u.useSound&&u.scene.audio.playSound(h.default.BUTTON_CLICK),null==(t=u.downAnimation)||t.remove(),u.downAnimation=new o.default({targets:[(0,a.default)(u)],duration:150,props:{scale:u.scaleDown},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.downAnimation.play()},u.runUpAnimation=function(){var t;-1!==u.scaleUp&&(null==(t=u.upAnimation)||t.remove(),u.upAnimation=new o.default({targets:[(0,a.default)(u)],duration:150,props:{scale:u.scaleUp},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.upAnimation.play())},u.isUsePixelPerfect=l,u.setDepth(c.default.BUTTON),u.createButton(n,i,s,r),u.updateSize(),u.listenEvents(),u.scene.add.existing((0,a.default)(u)),u}(0,s.default)(e,t);var n=e.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(t){var e,n,i;null==(e=this.upAnimation)||e.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),t()},n.setDisabled=function(t){var e,n;t?(this.setAlpha(.5),null==(e=this.hitArea)||e.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(t,e,n,i){this.button=this.scene.add.image(0,0,t,e),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,s=a.displayWidth,r=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:s,displayHeight:r}),this.add([this.button,this.hitZone])},n.updateSize=function(){var t=this.button,e=t.width,n=t.height,i=e/100*10,a=n/100*10,s=i<10?i:10,r=a<10?a:10;this.setSize(e+s,n+r),this.hitZone.setSize(e+s,n+r)},n.addDebugData=function(){var t=this.getParentName(),e=this.name;(0,l.addBreadcrumbSentry)("ui-click",t+":"+e)},n.logButtonEvent=function(){var t=this.getParentName(),e=this.name;this.scene.analytics.event(r.AnalyticsEvents.BUTTON_CLICK,{button_name:e,screen_name:t})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var t=this.parentContainer;t;){if(t instanceof GameCore.Screen){var e=t;return this.parentName=e.getScreenName(),this.parentName}t=t.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.default)(e,[{key:"onClick",set:function(t){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(t)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),e}(Phaser.GameObjects.Container);e.default=u},465:function(t,e,n){"use strict";n.r(e);var i=n(11),a=n(112),s=n(4),r=n(0),o=n(43),c=n.n(o),h=n(246),l=n.n(h),u=n(85),d=n.n(u),p=n(30),f=n.n(p),g=n(38),m=n.n(g),v=n(110),y=n.n(v),S=n(97),A=n.n(S),x=n(146),E=n.n(x),b=n(36),w=n(441);function T(t,e){var n="undefined"!==typeof A()&&E()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return C(t,e);var i=m()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return y()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return C(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var M=function(t){function e(e,n){var a,r;(r=t.call(this,e)||this).config=void 0,r.isEnable=void 0,r.maxHeight=void 0,r.isScrolling=void 0,r.boundTop=void 0,r.boundBottom=void 0,r.maskGraphics=void 0,r.objects=void 0,r._value=0,r.velocity=0,r.isScrollingSmooth=void 0,r.lastScrollY=void 0,r.isScrollingBack=void 0,r.scrollingBackTo=void 0,r.lastScrollYCount=0,r.hitArea=void 0,r.onScrollEvents=[],r.update=function(t,e){r.isScrollingSmooth&&r.velocity&&r.scrollingSmooth(e),r.isScrollingBack&&r.scrollingBack(e)},r.checkReachBound=function(){return r.isReachTop()||r.isReachBottom()},r.onMouseScroll=(0,w.debounce)((function(t,e,n){if(r.isEnable){var i;if(r.isScrolling=!0,r.checkReachBound())return r.lastScrollY=c()(i=r.lastScrollY).call(i,(function(){return 0})),void(r.isScrolling=!1);r.stopScrollingBack(),r.startScrollSmooth(-n*r.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),r.onTouchScroll=function(t){if(r.isEnable){r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack(),r.isScrolling=!0;var e=r.scene.game.world.getZoomRatio(),n=t.position,i=t.prevPosition,a=(n.y-i.y)/e,s=r.height*r.maxScrollOver,o=1;if(r.lastScrollY[++r.lastScrollYCount%r.lastScrollY.length]=a,r.isReachTop()&&a>=0){var c=(s-(r.value-r.marginTop))/s;o=Math.min(o,c)}if(r.isReachBottom()&&a<=0){var h=(s-(-r.maxHeight-r.value))/s;o=Math.min(o,h)}var l=a*o,u=r.maxScrollOver*r.height;r.value+l>r.marginTop+u?r.value=r.marginTop+u:r.value+l<-r.maxHeight-u?r.value=-r.maxHeight-u:r.value+=l,r.callOnScrollEvents(r.value,l)}},r.onTouchDown=function(){r.isEnable&&(r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack())},r.onTouchEnd=function(){var t,e;if(r.isReachTop()&&(r.startScrollingBack(r.marginTop),r.stopScrollSmooth()),r.isReachBottom()&&(r.startScrollingBack(-r.maxHeight),r.stopScrollSmooth()),r.isScrolling){var n=l()(t=r.lastScrollY).call(t,(function(t,e){return t+e}))/r.lastScrollY.length;r.startScrollSmooth(n*r.scrollSmooth),r.lastScrollY=c()(e=r.lastScrollY).call(e,(function(){return 0}))}},r.config=(0,i.default)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5,useMask:!0},n);var o=n.width,h=n.height;return r.isEnable=!1,r.maxHeight=0,r.lastScrollY=d()(a=new Array(3)).call(a,0),r.setSize(o,h),r.createGroup(),r.createInput(),r.createEvents(),r.scene.add.existing((0,s.default)(r)),r}(0,r.default)(e,t);var n=e.prototype;return n.onScroll=function(t){this.onScrollEvents.push(t)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){var t=this.drawDebugBox(16711680,.8);console.log(null==t?void 0:t.x,null==t?void 0:t.y,null==t?void 0:t.displayWidth,null==t?void 0:t.displayHeight)},n.setEnable=function(t){this.isEnable=t,t?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(t){this.addAt(t),this.objects.add(t);var e=t.y+t.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,e,0),this.updateObjectVisible()},n.addItems=function(t){var e=this;this.addAt(t),this.objects.addMultiple(t);var n=c()(t).call(t,(function(t){return t.y+t.height+e.marginBottom-e.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var t;return f()(t=this.objects.getChildren()).call(t,(function(t){return t.active}))},n.createBound=function(t,e,n,i){this.boundTop=this.scene.make.image({key:t,frame:e}),this.boundBottom=this.scene.make.image({key:t,frame:e}),i&&(this.boundTop.setTint(i),this.boundBottom.setTint(i)),this.boundTop.setAlpha(0,0,0,0),this.boundBottom.setAlpha(0,0,0,0),this.boundTop.setDepth(b.default.PRIORITY),this.boundBottom.setDepth(b.default.PRIORITY);var a=this.width,s=n,r=this.getWorldPosition(),o=r.x,c=r.y;this.boundTop.setDisplaySize(a,s),this.boundBottom.setDisplaySize(a,s),this.boundTop.setY(-this.displayHeight/2+s/2+c-this.y-1),this.boundBottom.setY(this.displayHeight/2-s/2+c-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var t;null==(t=this.maskGraphics)||t.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var e=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-e/2,0-n/2,e,n,0),this.config.useMask&&this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var t=this.getWorldPosition(),e=t.x,n=t.y;this.maskGraphics.setPosition(e,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(t){this.objects.incY(t),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var t=this.objects.getChildren(),e=0;e<t.length;e++){var n=t[e];n.y+n.height<-this.height/2||n.y-n.height>this.height/2?n.setVisible(!1):n.setVisible(!0)}},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(t,e){for(var n,i=T(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,t,e)}},n.scrollingBack=function(t){var e=(this.scrollingBackTo-this.value)*t*this.scrollingBackRate/1e3;this.value+=e,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,e)},n.startScrollingBack=function(t){this.isScrollingBack=!0,this.scrollingBackTo=t},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(t){var e=this.velocity*t/1e3;this.value+=e;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*t/1e3,Math.abs(this.velocity)<this.acceleration*t/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,e)},n.startScrollSmooth=function(t){this.isScrollingSmooth=!0,t&&(t*this.velocity>0?this.velocity+=t:this.velocity=t)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,a.default)(e,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(t){var e=t-this._value;this._value=t,this.updateObject(e)}}]),e}(Phaser.GameObjects.Container);e.default=M},71:function(t,e,n){"use strict";n.r(e);var i=n(1).default.EFFECTS,a=i.KEY,s=i.FRAME,r={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:a,PREFIX:s.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:a,PREFIX:s.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:a,PREFIX:s.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}};e.default=r},36:function(t,e,n){"use strict";n.r(e);e.default={BACKGROUND:1,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,POPUP:999,PRIORITY:80,DEBUG:90,DICE:99,PIECE:99,ON_TOP:1e4}},247:function(t,e,n){"use strict";n.r(e);e.default={min:18,max:60}},13:function(t,e,n){"use strict";n.r(e);e.default={PRIMARY:{KEY:"font-main",TEXTURE:"./assets/fonts/primary.png",DATA:"./assets/fonts/primary.xml"},PRIMARY_LIGHT:{KEY:"font-main-light",TEXTURE:"./assets/fonts/primary-light.png",DATA:"./assets/fonts/primary-light.xml"},NUMBER_LIGHT:{KEY:"number-light",TEXTURE:"./assets/fonts/number-light.png",DATA:"./assets/fonts/number-light.xml"},NUMBER_DARK:{KEY:"number-dark",TEXTURE:"./assets/fonts/number-dark.png",DATA:"./assets/fonts/number-dark.xml"},FONT_FAMILY:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',FONT_FAMILY_ARIAL:"Arial"}},122:function(t,e,n){"use strict";n.r(e);var i={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+(0,n(445).getImageScale)()+"x/bg.jpg",CONFIG:{}}};e.default=i},1:function(t,e,n){"use strict";n.r(e);var i=n(11),a=(0,n(445).getImageScale)(),s={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+a+"x/tutorial-resources.png",JSON:"./assets/textures/"+a+"x/tutorial-resources.json",FRAME:{HAND:"hand",BLANK:"blank",BUTTON_BROWN:"brown"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+a+"x/default-resources.png",JSON:"./assets/textures/"+a+"x/default-resources.json",URL:"./assets/textures/"+a+"x/",FRAME:{BLANK:"blank",LOGO:"logo",TEXT_LOADING:"loading",BORDER_BOTTOM_PANEL:"border-bottom-panel",BOTTOM_PANEL:"bottom-panel",BOTTOM_LINE:"bottom-line",GLARE:"glare",TITLE_YOUR_SCORE:"title-your-score",BG_YOUR_SCORE:"bg-your-score",LEAF:"leaf",BEST_SCORE_FRAME:"best-score-frame",BEST_SCORE_FRAME_LONG:"best-score-frame-long",FOOTER:"footer",SCORE_PANEL:"score-panel",SCORE_PANEL_DARK:"score-panel-dark",BG_PROGRESS_CIRCLE:"bg-progress-circle",BG_TEXT_TARGET_PANEL:"text-target-panel",WOOD_PANEL:"wood-panel",BORDER_DAILY:"border-daily",BG_STREAK:"bg-streak",BG_COMBO:"bg-combo",LEVEL_PLAYED:"bg/level-played",LEVEL_PLAYING:"bg/level-playing",LEVEL_LOCKED:"bg/level-locked",BG_DARK:"bg/bg-dark",BG_TOP:"bg/bg-top",BG_MIDDLE:"bg/bg-middle",BG_BOTTOM:"bg/bg-bottom",PRELOADER:"preloader/dual-ring",LEADERBOARD_TAB_ON:"leaderboards/tab-on",LEADERBOARD_TAB_OFF:"leaderboards/tab-off",LEADERBOARD_BG_TOP:"leaderboards/bg-top",LEADERBOARD_BG_MIDDLE:"leaderboards/bg-middle",LEADERBOARD_BG_BOTTOM:"leaderboards/bg-bottom",LEADERBOARD_BG_ITEM:"leaderboards/bg-item",LEADERBOARD_BORDER_LEFT:"leaderboards/border-left",LEADERBOARD_BORDER_RIGHT:"leaderboards/border-right",PREFIX_LEADERBOARD_BG_ITEM:"leaderboards/bg-item-",PREFIX_LEADERBOARD_BG_ITEM_0:"leaderboards/bg-item-0",AVATAR_BORDER:"avatar/border",AVATAR_BORDER_BIG:"avatar/border-big",AVATAR_BORDER_CHALLENGE:"avatar/border-challenge",AVATAR_BACKGROUND:"avatar/background",POPUP_TOP:"popup/top",POPUP_TOP_DARK:"popup/top-dark",POPUP_MID:"popup/middle",POPUP_BOTTOM:"popup/bottom",POPUP_CONTENT_BACKGROUND:"popup/background",POPUP_SCORE_PANEL:"popup/score-panel",ICON_ADS:"icons/flat-ad",ICON_CUP_GOLD:"icons/cup-gold",ICON_CUP_SILVER:"icons/cup-silver",ICON_CUP_COPPER:"icons/cup-bronze",ICON_SOUND:"icons/sound",ICON_VIBRATE:"icons/vibrate",ICON_MUSIC:"icons/music",ICON_RANK:"icons/rank",ICON_PLAY:"icons/play",ICON_I_PLAY:"icons/i-play",ICON_PLAY_GREEN:"icons/play-green",ICON_SHARE:"icons/share",ICON_INVITE:"icons/invite",ICON_FLAG:"icons/milestone",ICON_BROWN_JOURNEY:"icons/brown-journey",ICON_WHITE_JOURNEY:"icons/white-journey",ICON_SWORD:"icons/sword",ICON_SWORD_BLUE:"icons/sword-blue",ICON_SETTING:"icons/setting",ICON_REPLAY:"icons/replay",ICON_RETRY:"icons/retry",ICON_HOME:"icons/home",ICON_BACK:"icons/back",ICON_BATTLE:"icons/battle",ICON_CUP:"icons/cup",ICON_SHARE_BLUE:"icons/share-blue",ICON_CROWN:"icons/crown",ICON_CROWN_BIG:"icons/crown-big",ICON_CLOCK:"icons/clock",ICON_DAILY:"icons/icon-daily",ICON_JOURNEY:"icons/icon-journey",ICON_JOURNEY_2:"icon-journey",ICON_DOT_RED:"icons/dot",ICON_STAR:"icons/star",ICON_PLUS:"icons/plus",ICON_CHECK:"icons/check",BUTTON_CLOSE:"buttons/close",BUTTON_RED:"buttons/red",BUTTON_BLUE:"buttons/blue",BUTTON_BLUE_SMALL:"buttons/blue-small",BUTTON_BLUE_MEDIUM:"buttons/blue-medium",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_BIG:"buttons/green-big",BUTTON_DARK_BLUE:"buttons/dark-blue",BUTTON_DARK_BLUE_BIG:"buttons/dark-blue-big",BUTTON_BROWN:"buttons/brown",BUTTON_GREEN_LARGE:"buttons/green-large",BUTTON_PLAY:"buttons/play",BUTTON_RANDOM:"buttons/random",BUTTON_CHALLENGE_LIGHT:"buttons/challenge_light",BUTTON_SHARE_DARK:"buttons/share",BUTTON_MINOR:"buttons/minor",BUTTON_CIRCLE:"buttons/circle-button",BUTTON_TOGGLE_OFF:"buttons/toggle-off",BUTTON_TOGGLE_ON:"buttons/toggle-on",BUTTON_DARK_BLUE_SMALL:"buttons/dark-blue-small",BUTTON_DOT_BLUE:"buttons/dot-blue",BUTTON_DOT_GREEN:"buttons/dot-green",DAILY_BORDER:"daily-challenge/border",DAILY_BACKGROUND:"daily-challenge/bg",DAILY_TITLE_PANEL:"daily-challenge/title-panel",DAILY_BORDER_TOP:"daily-challenge/top-panel",DAILY_BORDER_MIDDLE:"daily-challenge/middle-panel",DAILY_BORDER_BOTTOM:"daily-challenge/bottom-panel",DAILY_BG_ITEM_LIGHT:"daily-challenge/bg-item-light",DAILY_BG_ITEM_DARK:"daily-challenge/bg-item-dark",DAILY_BG_TIME:"daily-challenge/time-panel",NO_THANK_TEXT:"texts/no-thank",TEXT_SECOND_CHANGE:"texts/second-chance",TEXT_VS:"texts/vs",TEXT_LOSE:"texts/lose",TEXT_WIN:"texts/win",TEXT_DRAW:"texts/draw",TEXT_CONTINUE:"texts/continue",TEXT_LEADER_BOARD:"texts/leader-board",TEXT_WORLD:"texts/world",TEXT_WORLD_DISABLE:"texts/world-disable",TEXT_FRIENDS:"texts/friends",TEXT_FRIENDS_DISABLE:"texts/friends-disable",TEXT_PLAY_WITH:"texts/play-with",TEXT_PLAY_WITH_BLUE:"texts/play-with-blue",TEXT_JOURNEY:"texts/text-journey",TEXT_SETTING:"texts/setting",TEXT_OFF:"texts/off",TEXT_ON:"texts/on",TEXT_REPLAY:"texts/replay",TEXT_YOUR_SCORE:"texts/your-score",TEXT_WAITING_OPPONENT:"texts/waiting-for-opponent",TEXT_SINGLE:"texts/play-single",TEXT_RETRY:"texts/text-retry",TEXT_LEVEL_FAIL:"texts/level-failed",TEXT_CONGRATULATION:"texts/congratulations",TEXT_NEXT_LEVEL:"texts/text-next-level",TEXT_SHARE_BLUE:"texts/text-share",TEXT_CLOSE_BLUE:"texts/text-close",TEXT_PLAY:"texts/play",TEXT_MISSION:"texts/mission",TEXT_NEXT_MILESTONE:"texts/next-milestone",TEXT_FIRST_MILESTONE:"texts/first-milestone",TEXT_COLLECT:"texts/collect",TEXT_YES:"texts/yes",TEXT_NO:"texts/no",TEXT_TUTORIAL:"texts/text-tutorial",TEXT_DAILY_CHALLENGE:"texts/daily-challenge",TEXT_RESULT:"texts/result",TEXT_RANKING:"texts/text-ranking",TEXT_NEW_BEST:"texts/new-best",TEXT_INVITE_FRIENDS:"texts/invite-friends",TEXT_KEEP_PLAYING:"texts/keep-playing",TEXT_OUT_OF_LIVE:"texts/out-of-live",TEXT_REFILL_LIVES:"texts/refill-lives",LIVES_HEART:"lives/heart",LIVES_TIME_BLOCK:"lives/time-block",LIVES_TIME_BLOCK_2:"lives/time-block-2"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/effects-resources.png",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",GLOW_CIRCLE:"glow-circle",GLARE_CROSS:"glare-cross",DUST:"dust",DUST_YELLOW:"dust-yellow",FX_STAR:"star",FX_STAR_YELLOW:"star-yellow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_CONFETTI_RIBBON:"ribbon",TEXT_COOL:"text/text_cool",TEXT_EXCELLENT:"text/text_excellent",TEXT_GOOD:"text/text_good",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",BG_SCORE:"bg-score",BG_MAIN_SCORE:"bg-main-score",BOARD:"board",VIOLET_GLOW:"violet-glow",MASK:"mask",FLAG:"flag",DUST:"dust",CUP_GLARE:"cup-glare",HAND:"hand",AVATAR_BORDER:"avatars/border",AVATAR_BACKGROUND:"avatars/background",ICON_SETTING:"icons/setting",ICON_CUP:"icons/cup",ICON_CHECK:"icons/check",ICON_STAR:"icons/star",ICON_STAR_1:"icons/star-1",ICON_HOME:"icons/home",ICON_ADD_FRIEND:"icons/add-friends",ICON_BATTLE:"icons/battle",TEXT_NEXT_LEVEL:"text/next-level",BUTTON_WOOD_SMALL:"buttons/wood-small",BUTTON_SKIP:"buttons/button-skip",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",PROGRESS_BAR_RIGHT_WHITE:"progress/bar-right-white"}},GAMEPLAY_32:{KEY:"gameplay-32-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-32-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-32-resources.json",FRAME:{GEM:"gem/gem",GEM_LIGHT:"gem/gem_light",GEM_SILVER:"gem/gem_silver",GEM_TRANSPARENT:"gem/gem_transparent",GEM_WHITE:"gem/gem_white",GEM_GLARE:"gem/gem_glare",GEM_HIGHT_LIGHT:"gem/gem_highlight",GEM_DIAMOND_10:"gem/diamond/diamond-10",GEM_DIAMOND_11:"gem/diamond/diamond-11",GEM_DIAMOND_12:"gem/diamond/diamond-12",GEM_DIAMOND_13:"gem/diamond/diamond-13",GEM_DIAMOND_14:"gem/diamond/diamond-14",GEM_DIAMOND_15:"gem/diamond/diamond-15",GEM_DIAMOND_10_LIGHT:"gem/diamond/diamond-10_light",GEM_DIAMOND_11_LIGHT:"gem/diamond/diamond-11_light",GEM_DIAMOND_12_LIGHT:"gem/diamond/diamond-12_light",GEM_DIAMOND_13_LIGHT:"gem/diamond/diamond-13_light",GEM_DIAMOND_14_LIGHT:"gem/diamond/diamond-14_light",GEM_DIAMOND_15_LIGHT:"gem/diamond/diamond-15_light",GEM_RUBY_20:"gem/ruby/ruby-20",GEM_SAPPHIRE_30:"gem/sapphire/sapphire-30",BLOCK_GRADIENT_PREFIX:"gem/block_gradient/block_color"}},DEMO_SPINE:{KEY:"demo-spine",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"}};GameCore.Utils.Valid.isDebugger()&&(s.EFFECTS.FRAME=(0,i.default)({},s.ANIMATION_SCENE.FRAME,s.EFFECTS.FRAME)),e.default=s},35:function(t,e,n){"use strict";n.r(e),n.d(e,{SceneKeys:function(){return r},SceneEvents:function(){return o},SceneDepth:function(){return i}});var i,a=n(97),s=n.n(a),r={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",JOURNEY_SCENE:"JOURNEY_SCENE",LEVEL_SCENE:"LEVEL_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},o={SWITCH:s()("SWITCH"),LAUNCH:s()("LAUNCH"),RUN:s()("RUN")};!function(t){t[t.SCENE=0]="SCENE",t[t.POPUP=1]="POPUP"}(i||(i={}))},24:function(t,e,n){"use strict";n.r(e);e.default={BUTTON_CLICK:"button_click",CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",GAME_OVER_SCENE:"game_over_scene",GAME_OVER:"game_over",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNT:"score_count",PIECE_PICK:"piece_pick",PIECE_DROP:"piece_drop",PIECE_INVALID_MOVE:"piece_invalid_move",BOARD_GAME_OVER:"board_end",RESCUE_TIME:"rescue_timer",EAT_BLOCK:"eat_block",GOOD:"good",COOL:"cool",EXCELLENT:"excellent",SCORE_REACHED:"reach_score",TARGET_REACHED:"reach_goal",WAIT_OPPONENT:"wait_opponent",WIN:"win",LOSE:"lose",DRAW:"draw",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small"}},471:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),s=n(1),r=n(121),o=s.default.EFFECTS,c=o.KEY,h=o.FRAME,l=function(t){function e(e,n){var a;return(a=t.call(this,e,c,h.BLANK)||this).config=void 0,a.emitter=void 0,a.config=n||{},a.scene.add.existing((0,i.default)(a)),a}(0,a.default)(e,t);var n=e.prototype;return n.createEmitters=function(){var t=h.FX_CONFETTI_SMALL_1,e=h.FX_CONFETTI_SMALL_2,n=h.FX_CONFETTI_SMALL_3,i=h.FX_CONFETTI_SMALL_4,a=1/this.scene.world.getPixelRatio(),s={on:!1,particleBringToTop:!0,frame:[t,e,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:300,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:.8},rotate:{start:0,end:1080},scale:{min:.8*a,max:2*a},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},o=(0,r.merge)(s,this.config);this.emitter=this.createEmitter(o)},n.run=function(t,e,n){this.stop(),this.emitter.setQuantity(t),this.emitter.setPosition(e,n),this.emitter.start()},n.explode=function(t,e,n){this.emitter||this.createEmitters(),this.emitter.explode(t,e,n)},n.stop=function(){var t,e,n;null==(t=this.emitter)||t.killAll(),null==(e=this.emitter)||e.stop(),null==(n=this.emitter)||n.remove(),this.createEmitters()},e}(Phaser.GameObjects.Particles.ParticleEmitterManager);e.default=l},469:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ut}});var i=n(11),a=n(4),s=n(0),r=n(1),o=n(71),c=o.default.RIBBON_A,h=c.KEY,l=c.TEXTURE,u=c.FRAME_RATE,d=c.END,p=c.PREFIX,f=c.ZERO_PAD,g=function(t){function e(e){var n={repeat:-1,frameRate:u,frames:e.generateFrameNames(l,{prefix:p,end:d,zeroPad:f,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,h,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),m=o.default.RIBBON_B,v=m.KEY,y=m.TEXTURE,S=m.FRAME_RATE,A=m.END,x=m.PREFIX,E=m.ZERO_PAD,b=function(t){function e(e){var n={repeat:-1,frameRate:S,frames:e.generateFrameNames(y,{prefix:x,end:A,zeroPad:E,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,v,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),w=o.default.RIBBON_C,T=w.KEY,C=w.TEXTURE,M=w.FRAME_RATE,I=w.END,P=w.PREFIX,k=w.ZERO_PAD,R=function(t){function e(e){var n={repeat:-1,frameRate:M,frames:e.generateFrameNames(C,{prefix:P,end:I,zeroPad:k,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,T,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),_=o.default.RIBBON_D,O=_.KEY,D=_.TEXTURE,B=_.FRAME_RATE,L=_.END,F=_.PREFIX,N=_.ZERO_PAD,G=function(t){function e(e){var n={repeat:-1,frameRate:B,frames:e.generateFrameNames(D,{prefix:F,end:L,zeroPad:N,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,O,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),U=o.default.CONFETTI_STAR_X,V=U.KEY,Y=U.TEXTURE,z=U.FRAME_RATE,W=U.END,H=U.PREFIX,X=U.ZERO_PAD,K=function(t){function e(e){var n={repeat:-1,frameRate:z,frames:e.generateFrameNames(Y,{prefix:H,end:W,zeroPad:X,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,V,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),j=o.default.CONFETTI_STAR_Y,q=j.KEY,Z=j.TEXTURE,J=j.FRAME_RATE,Q=j.END,$=j.PREFIX,tt=j.ZERO_PAD,et=function(t){function e(e){var n={repeat:-1,frameRate:J,frames:e.generateFrameNames(Z,{prefix:$,end:Q,zeroPad:tt,start:1}),showOnStart:!0};return t.call(this,e,q,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),nt=n(43),it=n.n(nt),at=n(85),st=n.n(at),rt=function(t){function e(e){var n,i,a;(a=t.call(this,e)||this).scene=void 0,a.ribbon=void 0,a.graphics=void 0,a.colorUse=void 0,a.lastChange=void 0,a.currentFrame=void 0,a.isYoyo=void 0,a.isGravityChanged=void 0,a.points=void 0,a.scene=e.manager.scene;var s=a.emitter.manager,r=s.x,o=s.y;return a.points=it()(n=st()(i=new Array(10)).call(i,null)).call(n,(function(){return{x:a.x+r,y:a.y+o}})),a.isYoyo=!1,a.isGravityChanged=!1,a.lastChange=0,a.currentFrame=-1,a.createGraphics(),a.randomRibbonUsedWhenFall(),a}(0,s.default)(e,t);var n=e.prototype;return n.randomRibbonUsedWhenFall=function(){switch(Phaser.Math.Between(0,3)){default:this.ribbon=this.scene.anims.get(o.default.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(o.default.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(o.default.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(o.default.RIBBON_D.KEY)}},n.setRibbonPosition=function(t,e){var n;it()(n=this.points).call(n,(function(n){n.x=t,n.y=e}))},n.createGraphics=function(){var t=[8443204,2928867,12013036,16376097,15285798];this.colorUse=t[Phaser.Math.Between(0,t.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});var e=this.emitter.manager,n=e.x,i=e.y,a=e.depth;this.graphics.setDepth(a),this.graphics.setPosition(n,i)},n.update=function(e,n,i){var a=t.prototype.update.call(this,e,n,i);return this.updateFrames(e),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),a},n.updateFrames=function(t){this.lastChange+=t,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)},n.updatePoints=function(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))},n.updateGraphics=function(){this.graphics.visible&&(this.graphics.clear(),this.graphics.strokePoints(this.points))},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setGravityY(45))},n.updateVelocity=function(){this.graphics.visible&&(this.lifeCurrent>this.life-1800?this.velocityX+=Phaser.Math.Between(-12,12):this.velocityX>0?this.velocityX+=Phaser.Math.Between(-10,6):this.velocityX+=Phaser.Math.Between(-6,10))},n.updateColor=function(){this.graphics.visible||(this.tint=this.colorUse)},e}(Phaser.GameObjects.Particles.Particle),ot=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.isYoyo=void 0,n.isGravityChanged=void 0,n.lastChange=void 0,n.currentFrame=void 0,n.star=void 0,n.starX=void 0,n.starY=void 0,n.isYoyo=!1,n.isGravityChanged=!1,n.lastChange=0,n.currentFrame=-1,n.scene=e.manager.scene,n.starX=n.scene.anims.get(o.default.CONFETTI_STAR_X.KEY),n.starY=n.scene.anims.get(o.default.CONFETTI_STAR_Y.KEY),n.star=n.starX,n}(0,s.default)(e,t);var n=e.prototype;return n.update=function(e,n,i){var a=t.prototype.update.call(this,e,n,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(e),a},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setGravityY(15),this.emitter.setSpeedX(0))},n.updateVelocity=function(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=Phaser.Math.Between(-6,3):this.velocityX+=Phaser.Math.Between(-3,6))},n.updateFrames=function(t){if(this.lastChange+=t,this.lastChange>=this.star.msPerFrame){var e=Phaser.Math.RND.between(0,1);this.star=e>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}},n.updateFrameRate=function(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=Phaser.Math.RND.between(300,600)},e}(Phaser.GameObjects.Particles.Particle),ct=r.default.EFFECTS,ht=ct.KEY,lt=ct.FRAME,ut=function(t){function e(e){var n;return(n=t.call(this,e,ht,lt.BLANK)||this).emitterConfetti=void 0,n.emitterRibbons=void 0,n.ribbonConfig=void 0,n.confettiConfig=void 0,n.width=void 0,n.height=void 0,n.emitterRibbons=[],n.emitterConfetti=[],n.createConfigs(),n.createAnimations(),n.scene.add.existing((0,a.default)(n)),n}(0,s.default)(e,t);var n=e.prototype;return n.createConfigs=function(){var t=1/this.scene.world.getPixelRatio();this.ribbonConfig={on:!1,visible:!1,timeScale:1.5,frame:lt.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:1800,random:!0},scale:{min:.6*t,max:t},particleClass:rt},this.confettiConfig={on:!1,delay:200,timeScale:2,tint:[8443204,2928867,12013036,16376097,15285798],particleBringToTop:!0,frame:lt.PREFIX_ANIMATION_RIBBON_CONFETTI_A+"1",speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:1080},scale:{min:.6*t,max:t},particleClass:ot}},n.createAnimations=function(){if(!this.scene.anims.get(o.default.CONFETTI_STAR_X.KEY)){var t=new K(this.scene.anims);this.scene.anims.add(o.default.CONFETTI_STAR_X.KEY,t)}if(!this.scene.anims.get(o.default.CONFETTI_STAR_Y.KEY)){var e=new et(this.scene.anims);this.scene.anims.add(o.default.CONFETTI_STAR_Y.KEY,e)}if(!this.scene.anims.get(o.default.RIBBON_A.KEY)){var n=new g(this.scene.anims);this.scene.anims.add(o.default.RIBBON_A.KEY,n)}if(!this.scene.anims.get(o.default.RIBBON_B.KEY)){var i=new b(this.scene.anims);this.scene.anims.add(o.default.RIBBON_B.KEY,i)}if(!this.scene.anims.get(o.default.RIBBON_C.KEY)){var a=new R(this.scene.anims);this.scene.anims.add(o.default.RIBBON_C.KEY,a)}if(!this.scene.anims.get(o.default.RIBBON_D.KEY)){var s=new G(this.scene.anims);this.scene.anims.add(o.default.RIBBON_D.KEY,s)}},n.run=function(t,e,n,i){this.setPosition(t,e),this.width=n,this.height=i,this.createEmitters(),this.emitterConfetti.forEach((function(t){t.emitParticle(25)})),this.emitterRibbons.forEach((function(t){t.emitParticle(20)}))},n.stop=function(){this.emitterConfetti.forEach((function(t){t.killAll()})),this.emitterRibbons.forEach((function(t){t.killAll()})),this.kill()},n.createEmitters=function(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()},n.createConfettiLeftEmitter=function(){var t=(0,i.default)({},this.confettiConfig,{speedX:{min:5,max:90}}),e=this.createEmitter(t);this.emitterConfetti.push(e)},n.createConfettiRightEmitter=function(){var t=this.width,e=(0,i.default)({},this.confettiConfig,{x:t,speedX:{min:-5,max:-90}}),n=this.createEmitter(e);this.emitterConfetti.push(n)},n.createRibbonLeftEmitter=function(){var t=(0,i.default)({},this.ribbonConfig,{speedX:{min:20,max:80},emitCallback:function(t){t.setRibbonPosition(0,0)}}),e=this.createEmitter(t);this.emitterRibbons.push(e)},n.createRibbonRightEmitter=function(){var t=this.width,e=(0,i.default)({},this.ribbonConfig,{x:t,speedX:{min:-20,max:-80},emitCallback:function(e){e.setRibbonPosition(t,0)}}),n=this.createEmitter(e);this.emitterRibbons.push(n)},e}(Phaser.GameObjects.Particles.ParticleEmitterManager)},470:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),s=n(1).default.EFFECTS,r=s.KEY,o=s.FRAME,c=function(t){function e(e){var n;return(n=t.call(this,e,r,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.default)(n)),n}(0,a.default)(e,t);var n=e.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var t=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:500,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*t,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:800,max:1500}})},n.run=function(t,e,n,i,a){this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(e-i/2,n-a/2),this.emitter.setQuantity(t),this.emitter.start()},n.stop=function(){var t,e;null==(t=this.emitter)||t.killAll(),null==(e=this.emitter)||e.stop()},n.reset=function(){this.createEmitters()},e}(Phaser.GameObjects.Particles.ParticleEmitterManager);e.default=c},147:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var i=n(0),a=n(30),s=n.n(a),r=n(47),o=function(t){function e(e,n,i){var a;return(a=t.call(this,e,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.default)(e,t),e}(Phaser.GameObjects.Zone),c=n(247),h=n(35),l=function(t){function e(){var e;return(e=t.call(this,{visible:!1})||this).unsubscribeList=void 0,e.gameZone=void 0,e.background=void 0,e.handleOpenScene=function(){e.logPageviewOnOpen(),e.logEventOpen(),e.scaleGame()},e.removeStateChange=function(){e.unsubscribeList.forEach((function(t){return t()}))},e}(0,i.default)(e,t);var n=e.prototype;return n.create=function(){var t=this;this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.createGameZone();var e=GameCore.Configs.Game;this.events.on(Phaser.Scenes.Events.UPDATE,(function(){e.AutoDropFps&&t.autoUpdateFPS()}))},n.scaleGame=function(){var t=this.getCamera("main"),e=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;t.setZoom(e),t.centerOn(i/2,a/2)},n.createGameZone=function(){var t=this.world.getWorldSize(),e=t.width,n=t.height;this.gameZone=new o(this,e,n)},n.autoUpdateFPS=function(){this.allowUpdateFPS()&&(this.tweenPlaying()||this.particlePlaying()?this.game.updateFps(c.default.max):this.game.updateFps(c.default.min))},n.allowUpdateFPS=function(){return this.scene.key===h.SceneKeys.GAME_SCENE||this.scene.key===h.SceneKeys.JOURNEY_SCENE},n.tweenPlaying=function(){for(var t=this.tweens.getAllTweens(),e=0;e<t.length;e++)if(t[e].isPlaying())return!0;return!1},n.particlePlaying=function(){var t=this.getAllParticles();if(!t)return!0;var e=!1;return t.forEach((function(t){t.emitters.list.forEach((function(t){t.alive&&t.alive.length>0&&(e=!0)}))})),e},n.getAllParticles=function(){if(this.input.enabled&&this.scene.isActive()&&!this.scene.isPaused()){var t=this.children.list;return!t||t.length<=0?[]:s()(t).call(t,(function(t){return"ParticleEmitterManager"===t.type}))}},n.getCamera=function(t){return"main"===t?this.cameras.main:this.cameras.getCamera(t)},n.createMask=function(t){void 0===t&&(t=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+t+")")},n.fontSize=function(t){return t/2.4},n.createBackground=function(t,e,n,i){try{this.background?(this.background.setTexture(t),e&&this.background.setFrame(e)):this.background=this.make.image({key:t,frame:e}),this.background.setName(t);var a=this.gameZone,s=a.displayWidth,r=a.displayHeight;this.background.setDisplaySize(s,r),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)}catch(o){console.log("Ex === ",o)}},n.handleStateChange=function(t){var e=this;this.unsubscribeList=[],t.forEach((function(t){var n=t.selector,i=t.callback,a=e.storage.watch(n,i);e.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(r.AnalyticsEvents.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},e}(Phaser.Scene)},531:function(t,e,n){"use strict";n.r(e);n(301);var i=n(110),a=n.n(i),s=n(38),r=n.n(s),o=function(t,e){return void 0===e&&(e=1),a()({length:Math.ceil(t.length/e)},(function(n,i){return r()(t).call(t,i*e,i*e+e)}))},c=n(30),h=n.n(c),l=n(144),u=n.n(l),d=function(t,e){return h()(t).call(t,(function(t){return!u()(e).call(e,t)}))},p=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}},f=n(32),g=n.n(f),m=function(t,e,n){return g()(n).call(n,t)===e&&null!==t&&void 0!==t},v=function(t){return h()(t).call(t,m)},y={chunk:o,difference:d,shuffle:p,unique:v},S=n(85),A=n.n(S),x=n(253),E=n.n(x),b=E()((function(t,e){if("string"===typeof t){var n=e[t.toLowerCase()];if("string"===typeof n)return n}return"?"})),w=E()((function(t){for(var e=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(e=i.exec(t));)n.push(e[1]);return n})),T=E()((function(t){for(var e=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(e=i.exec(t));){var a=e[0];if(a.length>=2){var s,o=a.length,c=r()(a).call(a,0,o-1),h=a[o-1],l=A()(s=new Array(+c)).call(s,h);n.push.apply(n,l)}else n.push(a)}return n})),C=function(t,e){var n=t,i=GameCore.Utils.Object.invert(e),a={},s=0,r=0;return w(n).forEach((function(t){s=0,r++,a[r]||(a[r]={}),T(t).forEach((function(t){s++,a[r][s]=b(t,i)}))})),a},M=E()((function(t,e){var n=e[t];return"string"===typeof n?""+n.toUpperCase():"?"})),I=function t(e,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(e))return a;var s="",o=1;for(var c in e)if(GameCore.Utils.Object.hasOwn(e,c)){var h=e[c];if(GameCore.Utils.Valid.isObject(h))a+=":"+t(h,n,!0);else if(GameCore.Utils.Valid.isString(h)){var l=M(h,n);l===s?(o++,a=r()(a).call(a,0,-2)):o=1,a+=""+o+l,s=l}}return a=a.replace(/1([A-Z])/g,"$1")},P=function(t){try{return atob(t)}catch(e){return""}},k={decodeMap:C,encodeMap:I,hashToString:P,stringToHash:function(t){try{return btoa(t)}catch(e){return""}}},R=function(t){try{return JSON.parse(t)}catch(e){return null}},_=n(96),O=n.n(_),D=function(t){try{return O()(t,null,0)}catch(e){return""}},B=function(t){return R(D(t))},L={clone:B,decode:R,encode:D},F=function(t){var e="object"===typeof t||"function"===typeof t,n=Array.isArray(t);return null!==t&&e&&!n},N=function(t){return void 0===t||null===t},G=function t(e){if(!F(e))return e;for(var n in e){N(e[n])&&delete e[n];var i=e[n];F(i)&&(e[n]=t(i))}return e},U=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},V=n(29),Y=n.n(V),z=function(t){var e={};return Y()(t).forEach((function(n){if(U(t,n)){var i=t[n];"string"===typeof i&&(e[i]=n)}})),e},W=function(t,e){if(!Array.isArray(t))return{};var n={};return t.forEach((function(t){if(U(t,e)){var i=t[e];"string"===typeof i&&(n[i]=t)}})),n},H={clear:G,hasOwn:U,invert:z,keyBy:W},X=function(t){return t?t[0].toUpperCase()+r()(t).call(t,1):t},K=function(t){var e=0;if(0==t.length)return e;for(var n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e},j=n(246),q=n.n(j),Z=function(t){var e;return q()(e=Y()(t)).call(e,(function(e,n){var i=t[n];return void 0!==i&&e.push(n+"="+i),e}),[]).join("&")},J=function(t){void 0===t&&(t="0x");for(var e=t,n=0;n<6;n++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},Q=function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=t;void 0!=e&&(a-=e.length,i+=e);for(var s=0;s<a;s++){var r=Math.floor(Math.random()*n.length);i+=n.charAt(r)}return i},$=function(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(t){return"\u0111"===t?"d":"D"}))},tt=n(26),et=n.n(tt),nt=n(324),it=n.n(nt),at=function(t,e){var n,i=t.split(" "),a=(i.length<=1?et()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),s=it()(a).call(a," ")||0,r=s>=0?s:e;return(a.length>e?a.substring(0,r):a).substring(0,e)},st=n(343),rt=n.n(st),ot=function(t){void 0===t&&(t=16);var e=function(e){return Math.floor(e).toString(t)};return e(Date.now()/1e3)+rt()(" ").call(" ",t).replace(/./g,(function(){return e(Math.random()*t)}))},ct={capitalize:X,hashCode:K,params:Z,toCamelCase:function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}));return e.substr(0,1).toLowerCase()+e.substr(1)},toUpperCamelCase:function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}));return e.substr(0,1).toUpperCase()+e.substr(1)},randomColor:J,random:Q,removeDiacritics:$,getShortName:at,generateObjectId:ot},ht=function(t){return"boolean"===typeof t},lt=function(){return true},ut=function(t){return"function"===typeof t},dt=function(t){return"number"===typeof t},pt=function(t){var e;return g()(e=["string","number","symbol"]).call(e,typeof t)>-1},ft=function(t){return"string"===typeof t},gt=n(46),mt=n.n(gt),vt=function(t,e,n){var i=n||{},a=i.timeout,s=void 0===a?1e3:a,r=i.checkInterval,o=void 0===r?100:r;return new(mt())((function(n){var i=setInterval((function(){("function"===typeof t?t():t)===("function"===typeof e?e():e)&&(clearInterval(i),n(!0))}),o);s>0&&setTimeout((function(){clearInterval(i),n(!1)}),s)}))},yt=function(t){var e=t.scene,n=t.key,i=t.newKey,a=e.textures.get(n).getSourceImage();if(!a)return!1;var s=Math.min(a.width,a.height);i||e.textures.removeKey(n);var r=e.textures.createCanvas(i||n,s,s),o=r.context;return o.beginPath(),o.arc(s/2,s/2,s/2,0,2*Math.PI,!1),o.clip(),r.draw((a.width-s)/2,(a.height-s)/2,a),!0},St=function(t){var e=t.scene,n=t.key,i=t.newKey,a=t.radius,s=t.width,r=t.height,o=e.textures.get(n).getSourceImage();if(!o)return!1;s||(s=o.width),r||(r=o.height),i||e.textures.removeKey(n);var c=e.textures.createCanvas(i||n,s,r),h=c.context,l=Math.min(s,r)/100*a/2;return h.beginPath(),h.moveTo(0+l,0),h.lineTo(0+s-l,0),h.quadraticCurveTo(0+s,0,0+s,0+l),h.lineTo(0+s,0+r-l),h.quadraticCurveTo(0+s,0+r,0+s-l,0+r),h.lineTo(0+l,0+r),h.quadraticCurveTo(0,0+r,0,0+r-l),h.lineTo(0,0+l),h.quadraticCurveTo(0,0,0+l,0),h.closePath(),h.clip(),c.draw(0,0,o),!0},At=function(t){if(g()(t).call(t,".")<0)return t;for(var e=t.length-1;e>=0;e--){if("."==t[e])return t.substring(0,e);if("0"!=t[e])return t.substring(0,e+1)}return t},xt=function(t,e){var n=e||{},i=n.fractionalDigits,a=void 0===i?0:i,s=n.startAbbreviate,r=void 0===s?1e3:s,o=n.abbreviateStep,c=void 0===o?3:o,h=n.maxLength,l=void 0===h?-1:h,u=n.removeLastZero,d=void 0===u||u,p=n.suffixes,f=void 0===p?["","k","m","b","t","q"]:p,g=-1===l?99999999:l;if(t>=r){var m=Math.floor(t/Math.pow(10,c)),v=Math.floor((m.toString().length-1)/c)+1,y=(t/Math.pow(Math.pow(10,c),v)).toFixed(a),S=g-f[v].length,A=y.substring(0,S);return(d?At(A):A)+f[v]}var x=t.toFixed(a),E=g-f[0].length,b=x.substring(0,E);return d?At(b):b+f[0]},Et=function(t,e,n){void 0===n&&(n="0");for(var i=t.toString(),a=0;a<e-i.length;a++)i=n+i;return i},bt=function(t,e,n){void 0===n&&(n="0");for(var i=t.toString(),a=0;a<e-i.length;a++)i+=n;return i},wt={Array:y,Hash:k,Json:L,Object:H,String:ct,Valid:{isBoolean:ht,isDebugger:lt,isFunction:ut,isNumber:dt,isObject:F,isPropertyKey:pt,isString:ft,isValueChangeAsync:vt},Image:{drawCircle:yt,drawBorder:St},Number:{toAbbreviatedString:xt,padStart:Et,padEnd:bt},Device:{isDesktop:function(){var t=navigator.userAgent;return/Windows|Mac OS/i.test(t)},isMobile:function(){var t=navigator.userAgent;return/Android|iP[ao]d|iPhone/i.test(t)},isAndroid:function(){return"ANDROID"===FBInstant.getPlatform()},isIOS:function(){return"IOS"===FBInstant.getPlatform()},isMobileWeb:function(){return"MOBILE_WEB"===FBInstant.getPlatform()},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}}},Tt=n(11),Ct=n(121),Mt={AppId:"1012305065987428",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",PlayerDataStoreUsingApi:!1,LeadersBoard:{LeaderboardId:"61a0bde67c386b3ef39de708",UseMock:!1,Limit:10},Ads:{Enabled:!0,Mockup:{Enable:!1},InterstitialAdOptions:{showWhenStartGame:!1,secondsFirstTime:0,secondsBetweenAds:60},BannerAdOptions:[]},Match:{MaxRescueCount:0},Debugger:{ShowConsole:!0}},It={ENV:"production",LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1}},Pt={ENV:"development",AppId:"405221927720733",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",PlayerDataStoreUsingApi:!0,PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,DefaultDiamondsForNewUser:300,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:500,EnableVibrate:!0,VibrateValue:[0,0,119,199,279,359,439],Progress:{BonusScore:5e3,Milestone:3},MaxGemInPiece:2,RatePieceContainGem:10},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{ForcePixelRatio:0,AutoDropFps:!1},Debugger:{ShowInspector:!0,ShowMonitoring:!0,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},Match:{MaxRescueCount:1,RescueGamePopupTimeout:10,DelayNoThank:1e3,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",JourneyMatchStore:"journeyMatch",LivesStore:"lives",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}},Levels:[100,500,1e3,1500,2e3,3e3,4e3,5e3,6e3,7500,9e3,11500,13e3,15e3,17e3,19e3,21e3,23e3,25e3,1e5],PieceRandoms:{maxPiece:200,measureError:.5}},DailyRewards:{MaxDays:6,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[]},LeadersBoard:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"61811128f28777ad0ed05787",Limit:50},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,InterstitialPlacementId:"",VideoRewardsPlacementId:"",BannerPlacementId:"",BannerReloadPeriod:60,Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{showWhenStartGame:!1,secondsFirstTime:90,secondsBetweenAds:180},BannerAdOptions:[]},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GameAnalytics:{key:"",secret:"",consoleLog:!1},GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},MagnetItem:{key:"magnet-item",scoreForOnePercent:4,maxMagnetPerMatch:5},Board:{cols:9,rows:9},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed"]}},DailyChallenge:{Prefix:"leaderboards",LeaderBoardId:"61e00146f28777ad0e328f2c"},Lives:{bonusDurationMins:5,bonusLife:1,livesCapacity:10},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0}};Pt=(0,Ct.merge)((0,Tt.default)({},Pt),It);var kt=Pt=(0,Ct.merge)((0,Tt.default)({},Pt),Mt),Rt=function(t){return function(e){try{var n=window.game,i=e.module;if(n.scene.getScenes(!0)[0].scene.key!==t)return;var a=i.default;n.scene.remove(t),n.scene.add(t,a,!0),n.scene.bringToTop(n.globalScene),console.log("%c HotScene: ","font-size:12px;background-color: #465975;color:#fff;",t)}catch(r){var s;null==(s=void 0)||s.invalidate()}}},_t=n(537),Ot=n.n(_t),Dt=n(539),Bt=n.n(Dt),Lt=n(541),Ft=n.n(Lt),Nt=n(441),Gt=!1,Ut=function t(e,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):e.children.getByName(n.name),Gt&&console.log("%c Checking object: ","font-size:12px;background-color: #465975;color:#fff;",n.name,n.type),a){if("Container"===n.type){var s=a,r=n.getAll();if(t(e,r,s),!s.hotContainer)return;console.log("%c Update container: ","font-size:12px;background-color: #33A5FF;color:#fff;",s.name)}var o=Ot()(n),c=["_events","_sysEvents","input","localTransform","list","displayList"],l=h()(o).call(o,(function(t){if("string"!==typeof t)return!1;if(g()(c).call(c,t)>=0)return!1;if(!a)return!1;var e=Bt()(n,t);return!(e instanceof Function)&&(!(e instanceof Phaser.Scene)&&(!(e instanceof Phaser.GameObjects.Group)&&(!(e instanceof Phaser.GameObjects.GameObject)&&e===Bt()(a,t))))}));l.length<1||(Gt&&console.log("%c HotObject: ","font-size:12px;background-color: #2EAFB0;color:#fff;",n.name,l),l.forEach((function(t){if(a){var e=Bt()(n,t),i=Bt()(a,t),s=Ft()(a,t,e);Gt&&console.log("%c Update property: ","font-size:12px;background-color: #B03734;color:#fff;",s,t,{oldValue:i,newValue:e})}})))}}}))},Vt=function(t,e){return void 0===e&&(e=Gt),function(n){try{var i=window.game,a=n.module,s=i.scene.getScenes(!0)[0];if(s.scene.key!==t)return;Gt=e;var r=a.default,o=t+"-draft";i.scene.remove(o);var c=i.scene.add(o,r);console.log("%c HotSceneObjects: ","font-size:12px;background-color: #465975;color:#fff;",t),s=i.scene.getScene(t),c.events.once(Phaser.Scenes.Events.RENDER,(0,Nt.debounce)((function(){var t=c.children.getAll();Ut(s,t),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(s),i.scene.bringToTop(i.globalScene)}catch(h){console.warn(h)}}},Yt={Configs:kt,Utils:wt,LiveUpdate:{Scene:Rt,SceneObjects:Vt}};window.GameCore=Yt;console.warn("production",{Configs:kt,isDebugger:wt.Valid.isDebugger()});var zt=Yt,Wt=n(28),Ht=n(325),Xt=n(8),Kt=n(0),jt=n(6),qt=n.n(jt),Zt=n(444),Jt=function(){function t(t){this.game=void 0,this.game=t}var e=t.prototype;return e.addKillRevive=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Group,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(e){e.prototype.kill=t.kill,e.prototype.revive=t.revive}))},e.addSetWorldSize=function(){var t=this;[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setWorldSize=t.setWorldSize}))},e.addSetWorldSizeForContainer=function(){var t=this;[Phaser.GameObjects.Container].forEach((function(e){e.prototype.setWorldSize=t.setWorldSizeForContainer}))},e.addGetWorldPosition=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(e){e.prototype.getWorldPosition=t.getWorldPosition}))},e.addDrawDebugBox=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(e){e.prototype.drawDebugBox=t.drawDebugBox}))},e.addHighQuality=function(){var t=this;[Phaser.GameObjects.Text].forEach((function(e){e.prototype.setHighQuality=t.setHighQuality}))},e.kill=function(){this.setActive(!1),this.setVisible(!1)},e.revive=function(){this.setActive(!0),this.setVisible(!0)},e.setWorldSize=function(t,e){this.setSize(t,e),this.setDisplaySize(t,e)},e.setWorldSizeForContainer=function(t,e,n){void 0===n&&(n=2),this.setSize(t*n,e*n),this.setDisplaySize(t,e)},e.getWorldPosition=function(){var t=this.getWorldTransformMatrix().decomposeMatrix();return{x:t.translateX,y:t.translateY}},e.drawDebugBox=function(t,e){var n=this.x,i=this.y,a=this.width,s=this.height,r=this.depth,o=this.originX,c=this.originY,h=this.scene.add.rectangle(n,i,a,s,t,e);h.setName("Debug Box"),h.setDepth(r);var l=GameCore.Utils.Valid.isNumber;return l(o)&&l(c)&&h.setOrigin(o,c),h},e.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},t}(),Qt=Jt,$t=GameCore.Configs.Ads.Mockup.GiphyApiKey,te=function(){function t(){}return t.loadBannerAdAsync=function(t,e){var n=this;return new(mt())((function(i,a){window.yaContextCb=window.yaContextCb||[];var s=document.getElementById("yandexAdContextScript");s||((s=document.createElement("script")).src="https://yandex.ru/ads/system/context.js",s.async=!0,document.head.appendChild(s));var r="yandex_rtb_wrapper_"+t,o="yandex_rtb_"+t,c=document.getElementById(r);if(!c){(c=document.createElement("div")).id=r,document.body.appendChild(c),c.style.display="block",c.style.position="fixed",c.style.zIndex="10000";var h=document.createElement("div");h.id=o,h.classList.add("yandex-adaptive"),h.style.display="block",c.appendChild(h)}n.setBannerAdSize(t,e||{}),n.getAdContentAsync().then((function(t){var e=document.getElementById("mock-banner-ads");e||((e=document.createElement("img")).id="mock-banner-ads",e.style.cssText="height: 100%; width: 100%; background-color: white; position: absolute;",c.childNodes[0].appendChild(e)),e.src=t,i()})).catch(a)}))},t.setBannerAdSize=function(t,e){var n=e||{},i=n.bannerHeight,a=void 0===i?50:i,s=n.bannerWidth,r=void 0===s?320:s,o="yandex_rtb_wrapper_"+t,c="yandex_rtb_"+t,h=document.getElementById(o),l=document.getElementById(c);if(h&&l){var u=document.body,d=(u.clientHeight,u.clientWidth);h.style.top="",h.style.bottom="0px",h.style.left=(d-r)/2+"px",h.style.margin="auto",h.style.height=a+"px",h.style.width=r+"px",l.style.height=a+"px",l.style.width=r+"px"}},t.hideBannerAdAsync=function(){return new(mt())((function(t){document.querySelectorAll('div[id^="yandex_rtb_wrapper_"]').forEach((function(t){var e=t;e.style.bottom="",e.style.top="-"+e.style.height})),t()}))},t.getAdContentAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://api.giphy.com/v1/gifs/random?api_key="+$t+"&rate=pg",t.next=3,fetch(n,{method:"GET"});case 3:return i=t.sent,t.next=6,i.json();case 6:if(a=t.sent,GameCore.Utils.Valid.isObject(a)){t.next=9;break}return t.abrupt("return","");case 9:return t.abrupt("return",null===(e=a.data)||void 0===e?void 0:e.images.downsized.url);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}();te.bannerAdOptions={};var ee,ne={LOADED:"loaded",DISPLAYED:"displayed"};!function(t){t.IDLE="idle",t.LOADING="loading",t.FILLED="filled",t.SHOWING="showing"}(ee||(ee={}));var ie,ae=ee;!function(t){t.REWARDED="rewarded",t.INTERSTITIAL="interstitial"}(ie||(ie={}));var se=ie,re=n(42),oe=function(t){function e(e,n){var i;return(i=t.call(this,n)||this).code=void 0,i.code=e,i.message=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),ce=oe,he=function(t){this.type=void 0,this.status=void 0,this.type=t,this.status=ae.IDLE};GameCore.Ads={Types:se,Status:ae,Events:ne,AdError:ce,AdInstance:he};var le=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastAdShownTime=void 0,n.intervalBannerAd=void 0,n.interstitial=void 0,n.rewardedVideo=void 0,n.reloadBannerAdIntervals=void 0,n.bannerAdSizeOptions=void 0,n.showingBannerAd={},n.updateSizeBannerAd=function(){try{var t=n.config.bannerAdOptions,e=n.getCorrectBannerAdSizeOption(n.bannerAdSizeOptions);t.forEach((function(t){n.showingBannerAd[t.placementId]&&(GameCore.Configs.Ads.Mockup.Enable?te.setBannerAdSize(t.placementId,e):GameSDK.setBannerAdSize(t.placementId,e))}))}catch(i){console.log(i)}},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.lastAdShownTime=0,this.addEventUpdateSizeBannerAd()},n.configure=function(t,e){this.enabled=e.enabled,this.config=e,this.setAdInstance(t)},n.setAdInstance=function(t){var e=this.config,n=e.interstitialPID,i=e.rewardedVideoPID;this.interstitial=new t(se.INTERSTITIAL,n),this.rewardedVideo=new t(se.REWARDED,i)},n.preloadInterstitialAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.preloadAdAsync(se.INTERSTITIAL);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.showInterstitialAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.canbeShowInterstitialAd()){t.next=2;break}throw new ce("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return t.next=4,this.showAdAsync(se.INTERSTITIAL);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.preloadAdAsync(se.REWARDED);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showAdAsync(se.REWARDED);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.preloadAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.enabled){t.next=2;break}throw new ce("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(e))){t.next=5;break}throw new ce("AD_INSTANCE_NOT_INITIALTED","The instance ads not yet initiated");case 5:return t.next=7,n.loadAsync();case 7:this.events.emit(ne.LOADED,e);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.showAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.enabled){t.next=2;break}throw new ce("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(e))){t.next=5;break}throw new ce("AD_INSTANCE_NOT_INITIALTED","The instance ads not yet initiated");case 5:return this.lastAdShownTime=window.performance.now()/1e3,t.next=8,n.showAsync();case 8:this.events.emit(ne.DISPLAYED,e);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getAdStatus=function(t){var e=this.getAdInstanceByType(t);return e?e.getStatus():null},n.getAdInstanceByType=function(t){switch(t){case se.INTERSTITIAL:return this.interstitial;case se.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var t=window.performance.now()/1e3,e=this.config.interstitialAdOptions,n=e.secondsFirstTime,i=e.secondsBetweenAds,a=t-this.lastAdShownTime;return this.lastAdShownTime>0?a>i:a>n},n.showBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.reloadBannerAdIntervals=this.reloadBannerAdIntervals||{},n=this.config.bannerAdOptions,i=GameSDK.getPlatform(),a="WEB"==i,window.addEventListener,n.forEach((function(t){var n=t.platform;if("ALL"==n||"DESKTOP"==n&&a||"MOBILE"==n&&!a){s.bannerAdSizeOptions=e||{};var i=t.placementId,r=t.secondsReload;if(i&&""!=i){if(r>0){if(s.reloadBannerAdIntervals[i])return;return s.loadBannerAdAsync(i),void(s.reloadBannerAdIntervals[i]=setInterval((function(){s.loadBannerAdAsync(i)}),1e3*r))}s.loadBannerAdAsync(i)}}})),t.abrupt("return");case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getCorrectBannerAdSizeOption=function(t){var e=this.game.canvas.offsetWidth,n=t||{},i=n.bannerWidth,a=void 0===i?0:i,s=n.bannerHeight,r=void 0===s?0:s;if(this.game.world){var o=this.game.world,c=o.getZoomRatio(),h=o.getPixelRatio();a=a?o.getPhysicPixels(a,c/h):e,r=r?o.getPhysicPixels(r,c/h):50}return{bannerWidth:a,bannerHeight:r}},n.loadBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=GameCore.Configs.Ads,i=this.getCorrectBannerAdSizeOption(this.bannerAdSizeOptions),!n.Mockup.Enable){t.next=8;break}return t.next=6,te.loadBannerAdAsync(e,i);case 6:t.next=10;break;case 8:return t.next=10,GameSDK.loadBannerAdAsync(e,i);case 10:this.showingBannerAd[e]=!0,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));return function(e){return t.apply(this,arguments)}}(),n.addEventUpdateSizeBannerAd=function(){window.addEventListener("resize",this.updateSizeBannerAd)},n.hideBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.config.bannerAdOptions.forEach((function(t){var n=t.placementId,i=e.reloadBannerAdIntervals[n];i&&(clearInterval(i),e.reloadBannerAdIntervals[n]=null),e.showingBannerAd[n]=!1})),t.prev=2,!GameCore.Configs.Ads.Mockup.Enable){t.next=9;break}return t.next=7,te.hideBannerAdAsync();case 7:t.next=11;break;case 9:return t.next=11,GameSDK.hideBannerAdAsync();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.log(t.t0);case 16:case"end":return t.stop()}}),t,this,[[2,13]])})));return function(){return t.apply(this,arguments)}}(),n.getBannerHeight=function(){var t=this.getCorrectBannerAdSizeOption(this.bannerAdSizeOptions);if(this.game.world){var e=this.game.world,n=e.getZoomRatio(),i=e.getPixelRatio();return this.game.world.getPhysicPixels(t.bannerHeight,i/n)}return 50},e}(Phaser.Plugins.BasePlugin),ue=le,de=function(){function t(t,e,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=t,this.color=n||"#FFF",this.options=e,this.selfLog=!0,console.info("%c"+this.name+": init","color: "+this.color,this.options)}var e=t.prototype;return e.event=function(t,e,n){this.processEvent(t,e,n),this.selfLog&&console.info("%c"+this.name+": event","color: "+this.color,{name:t,value:n,payload:e})},e.pageview=function(t){var e=this.getPageByKey(t);this.processPageView(e),this.selfLog&&console.info("%c"+this.name+": pageview","color: "+this.color,{page:e})},e.setTrafficSource=function(t){this.processTrafficSource(t),this.selfLog&&console.info("%c"+this.name+": set traffic source","color: "+this.color,{source:t})},e.levelStart=function(t,e,n){this.processLevelStart(t,e,n),this.selfLog&&console.info("%c"+this.name+": level start","color: "+this.color,{level:t,score:e,levelName:n})},e.levelFail=function(t,e,n){this.processLevelFail(t,e,n),this.selfLog&&console.info("%c"+this.name+": level fail","color: "+this.color,{level:t,score:e,levelName:n})},e.levelRescue=function(t,e,n){this.processLevelRescue(t,e,n),this.selfLog&&console.info("%c"+this.name+": level rescue","color: "+this.color,{level:t,score:e,levelName:n})},e.levelComplete=function(t,e,n){this.processLevelComplete(t,e,n),this.selfLog&&console.info("%c"+this.name+": level complete","color: "+this.color,{level:t,score:e,levelName:n})},e.showInterstitialAd=function(t){this.processShowInterstitialAd(t),this.selfLog&&console.info("%c"+this.name+": show interstitial ad","color: "+this.color,{placement:t})},e.showRewardedVideoAd=function(t){this.processShowRewardedVideoAd(t),this.selfLog&&console.info("%c"+this.name+": show rewarded video ad","color: "+this.color,{placement:t})},e.receiveReward=function(t){this.processReceiveReward(t),this.selfLog&&console.info("%c"+this.name+": receive reward","color: "+this.color,{placement:t})},e.showAdFail=function(t,e,n){this.processShowAdFail(t,e,n),this.selfLog&&console.info("%c"+this.name+": show ad fail","color: "+this.color,{type:t,placement:e,reason:n})},e.getPageByKey=function(t){var e=t.replace(/_/g,"-");return e=e.toLowerCase()},e.processLevelStart=function(t,e,n){},e.processLevelFail=function(t,e,n){},e.processLevelRescue=function(t,e,n){},e.processLevelComplete=function(t,e,n){},e.processShowInterstitialAd=function(t){},e.processShowRewardedVideoAd=function(t){},e.processReceiveReward=function(t){},e.processShowAdFail=function(t,e,n){},t}();GameCore.Analytics={BaseAnalytics:de};var pe=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).analytics=void 0,n.pageview=function(t){n.isActive()&&n.analytics.forEach((function(e){e.pageview(t)}))},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.analytics=[]},n.add=function(t){this.analytics.push(t)},n.setTrafficSource=function(t){this.isActive()&&this.analytics.forEach((function(e){e.setTrafficSource(t)}))},n.event=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.event(t,e,n)}))},n.levelStart=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(t,e,n)}))},n.levelRescue=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(t,e,n)}))},n.levelFail=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(t,e,n)}))},n.levelComplete=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(t,e,n)}))},n.showInterstitialAd=function(t){this.isActive()&&this.analytics.forEach((function(e){e.showInterstitialAd(t)}))},n.showRewardedVideoAd=function(t){this.isActive()&&this.analytics.forEach((function(e){e.showRewardedVideoAd(t)}))},n.receiveReward=function(t){this.isActive()&&this.analytics.forEach((function(e){e.receiveReward(t)}))},n.showAdFail=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(t,e,n)}))},n.isActive=function(){return this.analytics.length>=1},e}(Phaser.Plugins.BasePlugin),fe=pe,ge=function(){function t(t,e,n){var i=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!i.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!i.game.player.getPlayerSetting("sound")},this.name=e,this.game=t,this.markers={},this.isSprite=n,this.isSprite||(this.audio=this.game.sound.add(this.name))}var e=t.prototype;return e.play=function(t,e){var n,i,a,s=(0,Tt.default)({volume:this.volume},e||{});if(s.volume!==this.volume&&(s.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(a=this.audio)||a.play(t,s));this.createMaker(t),null==(n=this.markers[t])||n.play(t,s)},e.pause=function(t){var e,n;this.isSprite?null==(e=this.markers[t])||e.pause():null==(n=this.audio)||n.pause()},e.stop=function(t){var e,n;this.isSprite?null==(e=this.markers[t])||e.stop():null==(n=this.audio)||n.stop()},e.setVolume=function(t){this.volume=t},e.createMaker=function(t){if(!this.markers[t])try{this.markers[t]=this.game.sound.addAudioSprite(this.name)}catch(e){console.warn("createMaker",e)}},t}(),me=ge,ve=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(t){n.musicManager=new me(n.game,t,!1),n.setMusicVolume(n.isMuteAll?0:1)},n.initSound=function(t){n.soundManager=new me(n.game,t,!0),n.setSoundVolume(n.isMuteAll?0:1)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.playSound=function(t,e){try{if(!this.soundManager||this.isMuteAll)return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(t,e)}catch(n){}},n.stopSound=function(t){try{this.soundManager.stop(t)}catch(e){}},n.playMusic=function(t){void 0===t&&(t={});try{if(!this.musicManager||this.isMuteAll)return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,Tt.default)({loop:!0,volume:.2},t))}catch(e){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(t){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(t){}},n.setSoundVolume=function(t){try{if(!this.soundManager)return;this.soundManager.setVolume(t)}catch(e){console.warn("setSoundVolume",e)}},n.setMusicVolume=function(t){try{if(!this.musicManager)return;this.musicManager.setVolume(t)}catch(e){console.warn("setMusicVolume",e)}},n.muteAll=function(){this.isMuteAll=!0,this.setMusicVolume(0),this.setSoundVolume(0)},n.unmuteAll=function(t){void 0===t&&(t=1),this.isMuteAll=!1,this.setMusicVolume(t),this.setSoundVolume(t)},e}(Phaser.Plugins.BasePlugin),ye=ve,Se=n(112),Ae="AUTH_TOKEN_REQUEST",xe="AUTH_TOKEN_RECEIVED",Ee=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.name="RequestTokenFail",i.message=e||"Request token fail",i.payload=n||{},i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),be=n(60),we=(0,be.createSelector)([function(t){return t.auth.token}],(function(t){return t})),Te=(0,be.createSelector)([function(t){return t.auth.isRequesting}],(function(t){return t})),Ce=function(t){return{type:xe,payload:{token:t}}},Me=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.requestToken=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game.facebook,a=n(),s=we(a),!Te(a)&&""===s){t.next=7;break}return t.abrupt("return");case 7:return e({type:Ae,payload:{}}),t.next=10,i.getPlayerToken();case 10:r=t.sent,e(Ce(r)),t.next=25;break;case 14:if(t.prev=14,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=19;break}if("PENDING_REQUEST"!==t.t0.code){t.next=19;break}return t.abrupt("return");case 19:if(e(Ce("")),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"message"))){t.next=24;break}if("string"!==typeof t.t0.message){t.next=24;break}return(0,Wt.sendException)(new Error(t.t0.message)),t.abrupt("return");case 24:(0,Wt.sendException)(new Ee);case 25:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.getToken=function(){return we(this.state)},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),Ie=Me,Pe=function(t,e){void 0===e&&(e=1);var n=new Image;n.onload=function(){var n,i,a=(n=this.width*e,i=this.height*e,{string:"+",style:"font-size: 1px; padding: "+Math.floor(i/2)+"px "+Math.floor(n/2)+"px;"});console.info("%c "+a.string,a.style+" background: transparent url("+t+") no-repeat center center; background-size: "+this.width*e+"px "+this.height*e+"px;")},n.src=t},ke=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(t){var e=this,n=Y()(t);n.length<1||(n.forEach((function(n){e.scene.load.image(n,t[n])})),this.scene.load.start())},n.capture=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.width,i=e.height,a=e.renderOptions,this.width=n,this.height=i,this.renderOptions=a,console.log(e),this.createCanvas(),t.next=8,this.loadImages();case 8:return this.drawObjects(),t.abrupt("return",this.snapshotFrame());case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var t=this;return new(mt())((function(e,n){for(var i in t.renderOptions){var a=t.renderOptions[i],s=a.name,r=a.image;if(r)t.scene.textures.get(s).key!==s&&t.scene.load.image(s,r)}t.scene.load.on(Phaser.Loader.Events.COMPLETE,e),t.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(){var t=new Error("Load image failed");n(t)})),t.scene.load.start()}))},n.drawObjects=function(){for(var t in this.renderOptions){var e=this.renderOptions[t];switch(e.type){case"text":this.drawText(e);break;case"image":this.drawImage(e)}}},n.drawText=function(t){var e=this.canvas.context,n=t.x,i=t.y,a=t.font,s=t.text,r=t.fillStyle,o=t.lineWidth,c=t.textAlign;e.font=a+' nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',e.fillStyle=r||"#ffffff",o&&(e.lineWidth=o),c&&(e.textAlign=c),e.fillText(s,n,i)},n.drawImage=function(t){var e=this.canvas.context,n=t.x,i=t.y,a=t.name,s=t.frame,r=t.width,o=t.height,c=t.fallbackWithImage,h=this.scene.textures.get(a),l=h.getSourceImage(s);"__MISSING"===h.key&&c&&(l=(h=this.scene.textures.get(c)).getSourceImage()),e.drawImage(l,n,i,r,o)},n.snapshotFrame=function(){var t=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&Pe(t),t},e}(Phaser.Plugins.ScenePlugin),Re=ke,_e={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme},Oe=n(43),De=n.n(Oe),Be=function(t){try{var e=localStorage.getItem(t);return null===e?null:GameCore.Utils.Json.decode(e)}catch(n){return null}},Le=function(t,e){try{var n=Be(t),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var a=GameCore.Utils.Json.clone(e);if(!GameCore.Utils.Valid.isObject(a))return!1;var s=GameCore.Utils.Object.clear(a),r=(0,Ct.merge)(i,s),o=GameCore.Utils.Json.encode(r);return localStorage.setItem(t,o),!0}catch(c){return!1}},Fe=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="BadRequest",i.message=e||"This request is bad",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ne=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="RequestTimeout",i.message=e||"This request is timeout",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ge=n(111),Ue=GameCore.Configs,Ve=Ue.AppId,Ye=Ue.Network,ze=function(t){if(!t.ok)throw new Fe(null,{response:t})},We=function(){var t=window.game.auth.getToken();return{token:t,timeout:Ye.Timeout,headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}}},He=function(t,e,n,i){return(0,Xt.default)(qt().mark((function a(){var s,r,o,c,h;return qt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s=t+"/apps/"+Ve+"/"+e,r=new AbortController,n.signal=r.signal,o=setTimeout((function(){r.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=O()(i)),a.next=8,fetch(s,n);case 8:return c=a.sent,clearTimeout(o),ze(c),a.next=13,c.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return h=a.t0,a.abrupt("return",h);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof Fe)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new Ne(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},Xe=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",e());case 4:if(t.prev=4,t.t0=t.catch(0),!(t.t0 instanceof Ne&&n>0)){t.next=18;break}return t.prev=7,t.next=10,(0,Ge.sleepAsync)(600);case 10:return t.next=12,Xe(e,n-1);case 12:return t.abrupt("return",t.sent);case 15:return t.prev=15,t.t1=t.catch(7),t.abrupt("return",{});case 18:if(!(t.t0 instanceof Ne)){t.next=20;break}return t.abrupt("return",{});case 20:return console.warn(t.t0),t.abrupt("return",{});case 22:case"end":return t.stop()}}),t,null,[[0,4],[7,15]])})));return function(e,n){return t.apply(this,arguments)}}(),Ke=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),void 0===a&&(a=Ye.Retries),t.prev=2,s=(0,Tt.default)({},We(),n,{method:"GET"}),r=He(i,e,s),t.next=7,Xe(r,a);case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(2),console.warn(t.t0),t.abrupt("return",{});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,i,a){return t.apply(this,arguments)}}(),je=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a,s){var r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===i&&(i={}),void 0===s&&(s=Ye.Retries),t.prev=2,r=(0,Tt.default)({},We(),i,{method:"POST"}),o=He(a,e,r,n),t.next=7,Xe(o,s);case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(2),console.warn(t.t0),t.abrupt("return",{});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,i,a,s){return t.apply(this,arguments)}}(),qe={score:0,settings:(0,Tt.default)({},_e),userGuideDisplays:0,customFields:{diamond:300,lastReceiveGift:0}},Ze=GameCore.Configs,Je=Ze.ApiHost,Qe=Ze.PlayerDataStoreUsingApi,$e=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe){t.next=2;break}return t.abrupt("return",tn(e));case 2:return t.abrupt("return",en(e));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tn=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=GameCore.Utils.String.params(e),t.next=3,Ke("players?"+n,{},Je);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),en=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.setDataAsync(e);case 2:return i=et()(n=Y()(qe)).call(n,Y()(e)),a=h()(i).call(i,(function(t,e){return g()(i).call(i,t)===e})),t.next=6,GameSDK.player.getDataAsync(a);case 6:return s=t.sent,t.next=9,GameSDK.player.getStatsAsync();case 9:return r=t.sent,t.abrupt("return",(0,Tt.default)({},s,r));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),nn=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe){t.next=2;break}return t.abrupt("return",an(e));case 2:return t.abrupt("return",sn());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),an=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("players/"+e+"/user-guide-displays/inc",{},{},Je);case 2:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),sn=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.incrementStatsAsync({userGuideDisplays:1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),rn="PLAYER_RECEIVED",on="PLAYER_DATA_UPDATE",cn="PLAYER_SCORE_UPDATE",hn="PLAYER_SETTING_UPDATE",ln="PLAYER_CONNECTED_PLAYERS_UPDATE",un=n(254),dn=_e.sound,pn=_e.music,fn=_e.vibrate,gn=_e.language,mn=_e.theme,vn=function(){function t(t){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0;var e=t||{},n=e.sound,i=e.music,a=e.vibrate,s=e.language,r=e.theme;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:dn,this.music=GameCore.Utils.Valid.isBoolean(i)?i:pn,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:fn,this.language=GameCore.Utils.Valid.isString(s)?s:gn,this.theme=GameCore.Utils.Valid.isString(r)?r:mn}return t.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme}},t}(),yn=vn,Sn=qe.userGuideDisplays,An=qe.customFields,xn=qe.settings,En=function(){function t(t){this.data=void 0;var e=t.settings,n=t.score,i=t.customFields,a=t.userGuideDisplays,s=GameCore.Utils.Valid.isNumber(n)&&n>0?n:0,r=GameCore.Utils.Valid.isNumber(a)?a:Sn,o=GameCore.Utils.Valid.isObject(i)?i:An,c=xn;GameCore.Utils.Valid.isObject(e)&&(c=new yn(e).toObject()),this.data={score:s,userGuideDisplays:r,settings:c,customFields:o}}return t.prototype.toObject=function(){return this.data},t}(),bn=En,wn=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=e||"The name of player data is not supported",i.payload=n||{},i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Tn=(0,be.createSelector)([function(t){return t.player}],(function(t){return t})),Cn=(0,be.createSelector)([Tn],(function(t){return t.playerId})),Mn=(0,be.createSelector)([function(t){return t.player.data}],(function(t){return t})),In=(0,be.createSelector)([Mn],(function(t){return t.settings})),Pn=(0,be.createSelector)([function(t){return t.player.connectedPlayers}],(function(t){return t})),kn=(0,be.createSelector)([Pn,function(t,e){return e.limit},function(t,e){return e.offset}],(function(t,e,n){if("number"!==typeof e)return[];if("number"!==typeof n)return[];var i=Y()(t);return r()(i).call(i,n,e+n)||[]})),Rn=(0,be.createSelector)([Mn],(function(t){return t.score})),_n=(0,be.createSelector)([Mn],(function(t){return t.customFields})),On=((0,be.createSelector)([_n],(function(t){return null==t?void 0:t.diamond})),GameCore.Configs),Dn=On.AppId,Bn=On.LanguageSupport,Ln=On.ThemeSupport,Fn=On.PlayerDataStore,Nn=function(t){return{type:ln,payload:{connectedPlayers:t}}},Gn=function(t,e){return function(n,i){try{var a,s=i(),r=In(s);n({type:hn,payload:{name:t,value:e}});var o={settings:(0,Tt.default)({},r,(a={},a[t]=e,a))};Le(Fn,o),$e(o)}catch(c){(0,Wt.sendException)(c)}}},Un=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r={customFields:(s={},s[t]=e,s)},n.next=4,i(Yn(r));case 4:o=a(),c=Mn(o),$e(c),n.next=14;break;case 9:if(n.prev=9,n.t0=n.catch(0),!(n.t0 instanceof wn)){n.next=13;break}return n.abrupt("return");case 13:(0,Wt.sendException)(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(t,e){return n.apply(this,arguments)}}()},Vn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={customFields:t},e.next=4,n(Yn(a));case 4:s=i(),r=Mn(s),$e(r),e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(0),!(e.t0 instanceof wn)){e.next=13;break}return e.abrupt("return");case 13:(0,Wt.sendException)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},Yn=function(t){return function(e){try{e({type:on,payload:{data:t}}),Le(Fn,t)}catch(n){(0,Wt.sendException)(n)}}},zn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({type:cn,payload:{score:t}});case 3:$e({score:t}),a=i(),s=Mn(a),Le(Fn,s),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,Wt.sendException)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},Wn=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.incUserGuideDisplays=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,e(Yn({userGuideDisplays:1})),a=n(),s=Cn(a),t.next=7,nn(s);case 7:i.data.set("userGuideDisplays",1),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.receiveData=function(t,e){this.game.storage.dispatch(function(t,e){return function(n){var i=t.playerId,a=t.name,s=t.photo,r=t.locale;n({type:rn,payload:{playerId:i,name:a,photo:s,locale:r,data:e||{}}})}}(t,e))},n.updateData=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A,x,E,b,w;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=n(),a=Tn(i),s=a.playerId,r=a.name,o=a.photo,c=a.locale,t.next=6,$e({appId:Dn,playerId:s,name:r,photo:o,locale:c});case 6:if(h=t.sent,GameCore.Utils.Valid.isObject(h)){t.next=9;break}return t.abrupt("return");case 9:if(h.playerId===s){t.next=11;break}return t.abrupt("return");case 11:l=In(i),u=l.theme,d=l.sound,p=l.music,f=l.vibrate,g=l.language,m=new bn(h).toObject(),v=m.settings,y=v.theme,S=v.music,A=v.sound,x=v.vibrate,E=v.language,b=g in Bn,w=u in Ln,g===E&&b||(m.settings.language=E),!0===S&&p!==S&&(m.settings.music=S),!0===A&&d!==A&&(m.settings.sound=A),!0===x&&f!==x&&(m.settings.vibrate=x),u===y&&w||(m.settings.theme=y),e(Yn(m)),!0===m.settings.music&&window.game.audio.playMusic(),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 29:case"end":return t.stop()}}),t,null,[[0,26]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setScore=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(zn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.setSetting=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.game.storage,t.next=3,i.dispatch(Gn(e,n));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.setCustomData=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.game.storage,t.next=3,i.dispatch(Un(e,n));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.updateCustomFields=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Vn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,t.next=4,new(mt())((function(t,e){i.once("players",(function(e){t(e)})),i.once("playersfail",(function(){return e([])})),i.getPlayers()}));case 4:if(a=t.sent,s=function(t){return!!t},r=h()(n=De()(a).call(a,(function(t){var e=t.getID(),n=t.getName(),i=t.getPhoto();return e&&n&&i?new un.default(e,n,i).toObject():null}))).call(n,s),!(r.length<1)){t.next=9;break}return t.abrupt("return");case 9:e(Nn(r)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Nn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getPlayer=function(){return Tn(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(t){var e=this.getPlayerSettings();return"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:GameCore.Utils.Object.hasOwn(_e,t)?_e[t]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getCoins=function(){var t=this.getCustomData("coin");return GameCore.Utils.Valid.isNumber(t)?t:0},n.getDiamond=function(){var t=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(t)?t:0},n.getBestScore=function(){return Rn(this.state)},n.getCustomData=function(t){var e=_n(this.state);return GameCore.Utils.Valid.isObject(e)&&GameCore.Utils.Object.hasOwn(e,t)?e[t]:null},n.getConnectedPlayers=function(){return Pn(this.state)},n.getConnectedPlayerIds=function(t,e){return kn(this.state,{limit:t,offset:e})},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),Hn=Wn,Xn=GameCore.Configs.ApiHost,Kn=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=GameCore.Utils.String.params(e),t.next=3,Ke("players?"+n,{},Xn);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jn="PROFILES_DATA_UPDATE",qn=(0,be.createSelector)([function(t){return t.profile.data}],(function(t){return t})),Zn=(0,be.createSelector)([function(t){return t.profile.profileIds}],(function(t){return t})),Jn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r,o;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=i(),s=Zn(a),!((r=GameCore.Utils.Array.difference(t,s)).length<1)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Kn({playerIds:r});case 8:o=e.sent,n({type:jn,payload:{data:o}}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,Wt.sendException)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}()},Qn=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.requestProfiles=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Jn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getProfiles=function(){return qn(this.state)},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),$n=Qn,ti=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(Phaser.Events.EventEmitter),ei=ti,ni=n(47),ii=function(t){function e(e,n,i,a){var s;(s=t.call(this,e)||this).zone=void 0,s.background=void 0,s.setName(n),s.setVisible(!1);var r=s.scene.world.getWorldSize(),o=r.width,c=r.height;return s.setSize(i||o,a||c),s.addZone(),s.addBackground(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(t){GameCore.Utils.Valid.isObject(t)&&(this.setDataEnabled(),this.setData(t)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen())},n.close=function(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.setBlockInputOutsideEnabled=function(t){this.scene.input.setTopOnly(t)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var t="screen-background";if(!this.scene.textures.exists(t)){var e=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(0,1),i.fillRect(0,0,e,n),i.generateTexture(t,e,n),i.destroy()}this.background=this.scene.add.image(0,0,t),this.background.setInteractive(),this.add(this.background)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(ni.AnalyticsEvents.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},e}(Phaser.GameObjects.Container),ai=ii,si={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=ai,GameCore.Screens={Events:si};var ri=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).events=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.boot=function(){this.events=new ei,this.registryScreenFactory()},n.get=function(t){var e=this.scene.children.getByName(t);return null===e?null:e},n.add=function(t,e,n,i){var a=this.get(t);return a||(a=this.scene.add.screen(t,e,n,i),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(t,e){var n=this.get(t);return!!n&&(n.open(e),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),console.log("Screen open",t,e),!0)},n.close=function(t){var e=this.get(t);return!!e&&(e.close(),e.emit(GameCore.Screens.Events.CLOSE,e),this.events.emit(GameCore.Screens.Events.CLOSE,e),console.log("Screen close",t),!0)},n.bringToTop=function(t){var e=this.scene.children.getByName(t);e&&this.scene.children.bringToTop(e)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(t,e,n,i){var a=new e(this.scene,t,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},e}(Phaser.Plugins.ScenePlugin),oi=ri,ci=n(448),hi=n.n(ci),li=n(326),ui=n(545),di="CONTEXT_RECEIVED",pi="CONTEXT_PROCESSED",fi="CONTEXT_GAME_MODE_DETECTED",gi="MESSAGES_SENT_UPDATE",mi="MESSAGES_SENT_REMOVE",vi="SCENE_KEY_UPDATE",yi=n(50),Si={currentSceneKey:"",prevSceneKey:""};(0,yi.enableES5)();var Ai,xi,Ei,bi,wi,Ti,Ci,Mi,Ii,Pi,ki,Ri={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},_i=Ri,Oi={data:{}},Di={token:"",isRequesting:!1},Bi=(Ai={},Ai.auth=function(t,e){return void 0===t&&(t=Di),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.token;switch(e.type){case Ae:t.isRequesting=!0;break;case xe:t.token=i,t.isRequesting=!1}}}))},Ai),Li={playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:_e,userGuideDisplays:0,customFields:{}},isUserNew:!0},Fi=(xi={},xi.player=function(t,e){return void 0===t&&(t=Li),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.name,s=i.value,r=i.data,o=void 0===r?{}:r,c=i.score,h=i.connectedPlayers,l=void 0===h?[]:h;switch(e.type){case rn:var u=i.playerId,d=i.name,p=i.photo,f=i.locale,g=i.data;if(n.playerId=u,n.name=d,n.photo=p,n.locale=f,GameCore.Utils.Valid.isObject(g)){var m=g;n.data=(0,Ct.merge)(t.data,m)}g.userGuideDisplays>0&&(n.isUserNew=!1);break;case cn:n.data.score=c;break;case hn:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=s;break;case on:n.data=(0,Ct.merge)(t.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case ln:if(l.length<=0)break;var v=GameCore.Utils.Object.keyBy(l,"playerId");n.connectedPlayers=(0,Ct.merge)(t.connectedPlayers,v)}}}))},xi),Ni=n(546),Gi=n.n(Ni),Ui={data:{},profileIds:[]},Vi=(Ei={},Ei.profile=function(t,e){return void 0===t&&(t=Ui),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.data,s=void 0===a?[]:a;if(e.type===jn){var r,o,c=GameCore.Utils.Object.keyBy(s,"playerId"),h=Y()(c);n.data=(0,Ct.merge)((0,Tt.default)({},t.data),c),n.profileIds=et()(r=[]).call(r,new(Gi())(et()(o=[]).call(o,t.profileIds,h)))}}}))},Ei),Yi="MATCH_GAMEPLAY_INITIALIZE",zi="MATCH_GAMEPLAY_START",Wi="MATCH_GAMEPLAY_FINISH",Hi="MATCH_GAMEPLAY_UPDATE",Xi="MATCH_GAMEPLAY_RESCUE",Ki="MATCH_GAMEPLAY_RESET_RESCUE",ji="MATCH_GAMEPLAY_SHOW_MINI_JOURNEY",qi="MATCH_STATS_DATA_CLEAR",Zi="MATCH_STATS_DATA_UPDATE",Ji="MATCH_STATS_CURRENT_UPDATE",Qi="MATCH_SINGLE_CREATE_REQUEST",$i="MATCH_SINGLE_DETAIL_REQUEST",ta="MATCH_SINGLE_MOVE_UPDATED",ea="MATCH_SINGLE_DATA_RECEIVED",na="MATCH_SINGLE_DATA_CLEAR",ia="MATCH_JOURNEY_CREATE_REQUEST",aa="MATCH_JOURNEY_DATA_CLEAR",sa="MATCH_JOURNEY_MOVE_UPDATED",ra="MATCH_JOURNEY_DATA_RECEIVED",oa="MATCH_JOURNEY_DAILY_CHALLENGE_START",ca="MATCH_JOURNEY_DAILY_CHALLENGE_COMPLETED",ha="MATCH_JOURNEY_SCORE_RECEIVED",la="MATCH_CHALLENGE_JOIN_REQUEST",ua="MATCH_CHALLENGE_CREATE_REQUEST",da="MATCH_CHALLENGE_FINISH_REQUEST",pa="MATCH_CHALLENGE_CONTINUE_REQUEST",fa="MATCH_CHALLENGE_DATA_RECEIVED",ga="MATCH_CHALLENGE_DATA_CLEAR",ma="MATCH_GROUP_CREATE_REQUEST",va="MATCH_GROUP_FINISH_REQUEST",ya="MATCH_ONLINE_CREATE_REQUEST",Sa="MATCH_ONLINE_DATA_RECEIVED",Aa="MATCH_ONLINE_STATS_UPDATE",xa="MATCH_ONLINE_FINISH_REQUEST",Ea="MATCH_ONLINE_DATA_CLEAR",ba="open",wa="active",Ta="finished",Ca={mode:"",status:ba,rescued:0,startAt:0,finishAt:0,showMiniJourney:null},Ma={single:{_id:"",data:{fen:""},playerId:"",status:ba},group:{status:ba,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:ba,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:ba,players:{}},journey:{_id:"",data:{fen:""},playerId:"",status:ba,challengeMode:!1},updateAt:0,isRequesting:!1},Ia={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Pa=(bi={},bi.match=(0,li.combineReducers)({gameplay:function(t,e){return void 0===t&&(t=Ca),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.mode,s=i.status,r=i.stateShowMiniJourney,o=i.rescued;switch(e.type){case Yi:n.status=ba,n.mode=Ca.mode,n.rescued=Ca.rescued,n.startAt=Ca.startAt,n.finishAt=Ca.finishAt,n.opponentInfo=Ca.opponentInfo;break;case zi:n.mode=a,n.status=wa,n.rescued=o,n.startAt=Date.now();break;case Hi:n.mode="string"===typeof a?a:t.mode,n.status=s||t.status;break;case Wi:n.status=Ta,n.finishAt=Date.now();break;case Xi:n.rescued+=1;break;case ji:n.showMiniJourney=r;break;case Ki:n.rescued=0}}}))},match:function(t,e){return void 0===t&&(t=Ma),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.match,s=i.opponentInfo,r=i.players,o=i.score;switch(e.type){case Qi:case $i:case la:case da:case ya:case ia:n.isRequesting=!0;break;case ta:n.single=(0,Tt.default)({},t.single,a),n.updateAt=Date.now();break;case sa:n.journey=(0,Tt.default)({},t.journey,a),n.updateAt=Date.now();break;case oa:n.journey.challengeMode=!0;break;case ca:n.journey.challengeMode=!1;break;case ea:n.isRequesting=!1,n.single=a||Ma.single;break;case ra:n.isRequesting=!1,n.journey=a||Ma.journey;break;case ha:n.journey.score=o;break;case na:n.isRequesting=!1,n.single=Ma.single;break;case aa:n.isRequesting=!1,n.journey=Ma.journey;break;case ua:case pa:n.isRequesting=!0,n.challenge.opponentInfo=s;break;case fa:n.isRequesting=!1,n.challenge=(0,Tt.default)({},a||Ma.challenge),n.challenge.opponentInfo=t.challenge.opponentInfo;break;case ga:n.isRequesting=!1,n.challenge=Ma.challenge;break;case ma:n.group.status=wa,s&&(n.group.opponentInfo=s);break;case va:n.group.status=Ta;break;case Ea:n.online.status=Ma.online.status,n.online.players=Ma.online.players;break;case Sa:n.online.status=wa,n.online.players=r;break;case xa:n.online.status=Ta}}}))},stats:function(t,e){return void 0===t&&(t=Ia),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.playerId,s=i.stats,r=i.match,o=i.current,c=i.players,h=i.leaders;switch(e.type){case qi:delete n.data[a],n.current=Ia.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=Ia.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=s,n.isRequesting=!1;break;case Zi:n.data[a]=s;break;case Ji:n.current=(0,Ct.merge)((0,Tt.default)({},t.current),s);break;case Sa:Y()(c).forEach((function(t){n.data[t]={score:0}}));break;case Aa:h.forEach((function(t){var e=t.playerId,i=t.score,a=t.rank;n.data[e]={score:i,rank:a}}));break;case fa:var l=r||{},u=l.blackPlayerId,d=l.blackPlayerScore,p=l.whitePlayerId,f=l.whitePlayerScore,g=l.whitePlayerLevel,m=l.blackPlayerLevel;if(!u||!p)break;o&&(n.current=o),n.data[u]={score:d,level:m},n.data[p]={score:f,level:g}}}}))}}),bi),ka="TOURNAMENT_ACTIVE",Ra="TOURNAMENT_REQUEST",_a="TOURNAMENT_RECEIVED",Oa={active:!1,tournamentId:null,bestSessionScore:0,isRequesting:!1},Da=(wi={},wi.tournament=function(t,e){return void 0===t&&(t=Oa),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.score,s=void 0===a?0:a,r=i.tournamentId;switch(e.type){case ka:n.active=!0,n.tournamentId=r;break;case Ra:n.isRequesting=!0;break;case _a:n.isRequesting=!1,s>t.bestSessionScore&&(n.bestSessionScore=s)}}}))},wi),Ba=n(327),La=n.n(Ba),Fa=n(143),Na=n.n(Fa),Ga="LEADERBOARD_DATA_REQUEST",Ua="LEADERBOARD_DATA_UPDATE",Va="LEADERBOARD_DATA_CLEAR",Ya={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},za=(Ti={},Ti.leaderboards=function(t,e){return void 0===t&&(t=Ya),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.leaderboardId,s=i.type,r=i.limit,o=i.offset,c=i.leaders;switch(e.type){case Ga:t.type!==s&&0===o&&(n.leaders=Ya.leaders),n.isRequesting=!0,n.leaderboardId=a,n.type=s,n.limit=r,n.offset=o;break;case Ua:if(n.isRequesting=!1,t.type!==s)break;var h=GameCore.Utils.Json.clone((0,Tt.default)({},t.leaders,c)),l=La()(h),u=De()(l).call(l,(function(t){return t.name&&t.photo||(t.name="Unknown",t.photo=""),t}));Na()(u).call(u,(function(t,e){return+e.score-+t.score})),u.forEach((function(e,i){e.rank=i+1,t.leaders[e.playerId]||(n.leaders[e.playerId]=e)}));break;case Va:n.isRequesting=!1,n.type=Ya.type,n.limit=Ya.limit,n.offset=Ya.offset,n.leaders=Ya.leaders,n.leaderboardId=Ya.leaderboardId}}}))},Ti),Wa="MISSIONS_DATA_REQUEST",Ha="MISSIONS_DATA_RECEIVE",Xa="MISSION_START",Ka="MISSION_UPDATE",ja="MISSION_COMPLETED",qa={mission:null,missions:null,isRequesting:!1},Za=(Ci={},Ci.missions=function(t,e){return void 0===t&&(t=qa),(0,yi.default)(t,(function(n){var i,a,s=e.payload;if(s){var r=s.name,o=s.type,c=s.value,h=s.missions;switch(e.type){case Wa:n.isRequesting=!0;break;case Ha:if(n.isRequesting=!1,h.length<1)return;n.missions={},h.forEach((function(t){n.missions[t.name]=t}));break;case Xa:if(null===t.missions)break;var l=t.missions[r];n.mission={name:r,process:{},require:l.require,reward:l.reward},Y()(l.require).forEach((function(t){n.mission.process[t]=0}));break;case Ka:if((null==(i=t.mission)?void 0:i.name)!==r)break;n.mission.process[o]+=c;break;case ja:if((null==(a=t.mission)?void 0:a.name)!==r)break;n.mission=null}}}))},Ci),Ja="DAILY_TASKS_DATA_REQUEST",Qa="DAILY_TASKS_DATA_RECEIVE",$a="DAILY_TASKS_PROCESS_UPDATE",ts="DAILY_TASK_VALUE_ADD",es="DAILY_TASK_REWARDED",ns="DAILY_TASKS_SEEN",is="DAILY_TASK_FINISHED",as={tasks:[],process:[],isRequesting:!1,isNotice:!1},ss=(Mi={},Mi.dailyTasks=function(t,e){return void 0===t&&(t=as),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.id,s=i.type,r=i.value,o=i.tasks,c=i.process;switch(e.type){case Ja:n.isRequesting=!0;break;case Qa:n.isRequesting=!1,n.tasks=o;break;case $a:n.process=c;break;case ts:if(!t.process[a])break;n.process[a][s]+=r;break;case es:if(!t.process[a])break;n.process[a].rewarded=!0;break;case ns:n.isNotice=!1;break;case is:n.isNotice=!0}}}))},Mi),rs={rewards:[],isRequesting:!1},os=(Ii={},Ii.dailyRewards=function(t,e){return void 0===t&&(t=rs),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.rewards;switch(e.type){case"DAILY_REWARDS_REQUEST":t.isRequesting=!0;break;case"DAILY_REWARDS_RECEIVE":t.isRequesting=!1,t.rewards=i}}}))},Ii),cs="DAILY_CHALLENGE_REQUEST",hs="DAILY_CHALLENGE_UPDATE",ls="DAILY_CHALLENGE_TIME_PLAY_UPDATE",us={leaders:{},isRequesting:!1,time:0},ds=(Pi={},Pi.dailyChallenge=function(t,e){return void 0===t&&(t=us),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.leaders,a=n.time;switch(e.type){case cs:t.isRequesting=!0;break;case hs:t.isRequesting=!1,t.leaders=i;break;case ls:t.time=a}}}))},Pi),ps="LIVES_REQUEST",fs="LIVES_UPDATED",gs="LIVES_RESET",ms="LIVES_COUNT_DOWN_START",vs={isRequesting:!1,lives:0,lastBonusLifeTime:0,countDownStartAt:0},ys=(ki={},ki.lives=function(t,e){return void 0===t&&(t=vs),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.data;switch(e.type){case ps:t.isRequesting=!0;break;case fs:t.isRequesting=!1,t.lives=i.lives,t.lastBonusLifeTime=i.lastBonusLifeTime;break;case gs:t.isRequesting=!1,t.lives=vs.lives,t.lastBonusLifeTime=vs.lastBonusLifeTime,t.countDownStartAt=0;break;case ms:t.countDownStartAt=(new Date).getTime()}}}))},ki),Ss=(0,li.combineReducers)((0,Tt.default)({scene:function(t,e){return void 0===t&&(t=Si),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.sceneKey;if(e.type===vi)n.currentSceneKey=a,n.prevSceneKey=t.currentSceneKey}}))},context:function(t,e){return void 0===t&&(t=Ri),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.gameMode,a=n.contextId,s=n.contextType,r=n.entryPointData;switch(e.type){case di:t.contextId=a,t.contextType=s,t.entryPointData=r;break;case pi:t.contextId=a,t.contextType=s,t.processed=!0;break;case fi:t.currentGameMode=i}}}))},messages:function(t,e){return void 0===t&&(t=Oi),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(e.type){case gi:t.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case mi:t.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},Bi,Fi,Vi,Pa,Da,za,Za,ss,os,ds,ys)),As=Ss,xs=window,Es=xs.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,bs=li.compose,ws=function(t){Es&&(bs=Es({trace:!0,traceLimit:25})||li.compose);var e=bs((0,li.applyMiddleware)(ui.default));return(0,li.createStore)(As,t,e)},Ts=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(t){return n.store.dispatch(t)},n.getState=function(){return n.store.getState()},n.subscribe=function(t){return n.store.subscribe(t)},n.watch=function(t,e){var i=hi()((function(){var e=n.getState();return t(e)}));return n.subscribe(i((function(t){e(t)})))},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.store=ws({})},n.setInitiator=function(t){this.initiator=t},n.syncStore=function(){this.initiator.initContext(),this.initiator.initPlayer()},e}(Phaser.Plugins.BasePlugin),Cs=Ts,Ms=n(549),Is=n.n(Ms),Ps=function(t){function e(e,n){var i;return(i=t.call(this,e,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,Kt.default)(e,t);var n=e.prototype;return n.load=function(){var t;switch(this.payload.type){case"google":t=this.getGoogleFontConfig(this.payload);break;case"local":t=this.getLocalFontConfig(this.payload)}Is().load(t)},n.getGoogleFontConfig=function(t){var e=this,n=t.character,i=t.fontName,a=t.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){e.loader.nextFile(e,!0)},timeout:15e3}},n.getLocalFontConfig=function(t){var e=this,n=t.fontName,i=t.fontType,a=document.createElement("style");document.head.appendChild(a);var s=a.sheet;if(s){var r='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+("opentype"===i?".otf":".ttf")+'") format("'+i+'"); }';s.insertRule(r,0)}return{custom:{families:[n]},active:function(){e.loader.nextFile(e,!0)},timeout:15e3}},e}(Phaser.Loader.File),ks=Ps,Rs=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.addFont=function(t){var e=new ks(this.scene.load,t);this.scene.load.addFile(e)},e}(Phaser.Plugins.ScenePlugin),_s=Rs,Os=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).ratio=void 0,n.width=void 0,n.height=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.forcePixelRatio=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){var e=t.width,n=t.height,i=t.ratio;this.ratio=i,this.width=e,this.height=n,this.initWorldSize(),this.addEventResize()},n.resize=function(t){var e=this;t&&t>0&&(this.forcePixelRatio=t);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(t){var n=t.cameras.main;if(n){var i=e.getZoomRatio(),a=e.getWorldSize(),s=a.width,r=a.height;n.setZoom(i),n.centerOn(s/2,r/2)}}))},n.resizeCanvas=function(t,e){this.game.canvas.width=t,this.game.canvas.height=e,this.game.scale.resize(t,e)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){this.worldWidth=this.width,this.worldHeight=this.height,this.isScreenSmallerRatio(this.ratio)&&(this.worldHeight=this.width/this.getScreenRatio()),this.worldRatio=this.worldWidth/this.worldHeight},n.getZoomRatio=function(){var t=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/t},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var t=GameCore.Utils.Device.pixelRatio();return t>2&&(t=2),t},n.getPhysicPixels=function(t,e){return t*e},n.getCanvasSizeFixedRatio=function(t){var e=this.getPixelRatio(),n=this.getScreenWidth()*e,i=this.getScreenHeight()*e;return this.isScreenSmallerRatio(t)?i=n/t:n=i*t,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var t=document,e=t.body,n=t.documentElement,i=e.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var t=document,e=t.body,n=t.documentElement,i=e.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(t){return this.getScreenWidth()/this.getScreenHeight()<=t},n.addEventResize=function(){var t=this;window.addEventListener("resize",(function(){t.resize()}))},e}(Phaser.Plugins.BasePlugin),Ds=Os,Bs=function(){function t(t,e,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=t||_i.contextId,this.contextType=e||_i.contextType,this.entryPointData=n||_i.entryPointData}return t.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},t}(),Ls=Bs,Fs=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidPlayerId",i.message=e||"The playerId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ns=Fs,Gs="share_invite",Us="journey_invite",Vs="tournament",Ys="challenge_friend_match",zs="matching_group_match",Ws=n(122),Hs=new un.default("10","Your Friend",Ws.default.AVATAR.FILE).toObject(),Xs="single",Ks="challenge-friends",js="matching-group",qs="tournaments",Zs="online",Js="journey",Qs=(0,be.createSelector)([function(t){return t.context}],(function(t){return t})),$s=((0,be.createSelector)([function(t){return t.context.contextId}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.contextType}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.processed}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.currentGameMode}],(function(t){return t}))),tr=function(t,e){return{type:pi,payload:{contextId:t,contextType:e}}},er=function(t){return function(e){e({type:fi,payload:{gameMode:t}}),(0,Wt.addBreadcrumbSentry)("game-mode",t)}},nr=GameCore.Configs.PlayerDataStore,ir=function(t){var e=this;this.game=void 0,this.initContext=function(){var t=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),a=new Ls(t,n,i).toObject(),s=a.contextId,r=a.contextType,o=a.entryPointData;e.game.storage.dispatch(function(t,e,n){return{type:di,payload:{contextId:t,contextType:e,entryPointData:n}}}(s,r,o))},this.initPlayer=function(){var t=e.getPlayerInfo(),n=e.getPlayerDataLocal();e.game.player.receiveData(t,n)},this.getPlayerInfo=function(){try{var t=window.GameSDK.player.getID(),e=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(t))throw new Ns(null,{playerId:t});return GameCore.Utils.Valid.isString(e)||(e="You"),new un.default(t,e,n,i).toObject()}catch(a){return new un.default("123","You").toObject()}},this.getPlayerDataLocal=function(){try{var t=Be(nr);return GameCore.Utils.Valid.isObject(t)?new bn(t).toObject():null}catch(e){return console.warn(e),null}},this.game=t},ar=n(35),sr=[ni.AnalyticsEvents.BUTTON_CLICK,ni.AnalyticsEvents.SCREEN_OPEN],rr=function(t){function e(e,n){var i;(i=t.call(this,"FacebookAnalytics",{prefix:n},"#0F52BA")||this).game=void 0,i.game=e;var a=(GameCore.Configs.Analytics.FacebookAnalytics||{}).consoleLog;return i.selfLog=!!a,i}(0,Kt.default)(e,t);var n=e.prototype;return n.processTrafficSource=function(t){},n.processEvent=function(t,e,n){if(!(g()(sr).call(sr,t)>=0)){var i=this.getEventName(t);this.game.facebook.log(i,n,e)}},n.processPageView=function(t){},n.processLevelStart=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_START,{level:t,score:e,level_name:n})},n.processLevelRescue=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_RESCUE,{level:t,score:e,level_name:n})},n.processLevelFail=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!1})},n.processLevelComplete=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!0})},n.processShowInterstitialAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"interstitial",screen_name:""+t})},n.processShowRewardedVideoAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+t})},n.processShowAdFail=function(t,e){var n=t===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(ni.AnalyticsEvents.AD_SHOW_FAILED,{ad_type:n,screen_name:""+e})},n.getEventName=function(t){return this.options.prefix+"_"+t},e}(GameCore.Analytics.BaseAnalytics),or=rr,cr=[ni.AnalyticsEvents.SCREEN_OPEN],hr=function(t){function e(e,n){var i;(i=t.call(this,"GoogleAnalytics",(0,Tt.default)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var a=n.trackingId;i.game=e;var s=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!s,i.trackingId=a,i}(0,Kt.default)(e,t);var n=e.prototype;return n.processTrafficSource=function(t){},n.processEvent=function(t,e,n){if(!(g()(cr).call(cr,t)>=0)){var i=this.formatEventName(t),a=e?(0,Tt.default)({},e):{};a=n?(0,Tt.default)({},a,{value:n}):a,a=(0,Tt.default)({},a,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,a)}},n.processLevelStart=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_START,{level:t,score:e,level_name:n})},n.processLevelRescue=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_RESCUE,{level:t,score:e,level_name:n})},n.processLevelFail=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!1})},n.processLevelComplete=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!0})},n.processShowInterstitialAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"interstitial",screen_name:""+t}),this.processEvent(ni.AnalyticsEvents.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processShowRewardedVideoAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+t}),this.processEvent(ni.AnalyticsEvents.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowAdFail=function(t,e){var n=t===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(ni.AnalyticsEvents.AD_SHOW_FAILED,{ad_type:n,screen_name:""+e})},n.processPageView=function(t){var e=this.getGameplayMode(),n="/"+e+"/"+t;this.currentPath=n,document.title=this.formatPageTitle(e,t),gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var t=this.game.storage.getState();return $s(t)},n.formatEventName=function(t){return t.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(t,e){return this.toUpperCamelCaseWithSpace(t)+"::"+this.toUpperCamelCaseWithSpace(e)},n.toUpperCamelCaseWithSpace=function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?" "+e.toUpperCase():""}));return e.substr(0,1).toUpperCase()+e.substr(1)},e}(GameCore.Analytics.BaseAnalytics),lr=hr,ur="G-G0S5WJQE7V",dr="UA-227866957-1",pr=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).startGame=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.auth.requestToken();case 3:n.storage.syncStore(),n.configureSentry(),n.detectGameMode(),n.initAnalytics(),n.analytics.event(ni.AnalyticsEvents.LOAD_START),n.setTrafficSourceAnalytics(),n.scene.launch(ar.SceneKeys.GLOBAL_SCENE),n.scene.start(ar.SceneKeys.LOAD_SCENE),n.analytics.pageview(ar.SceneKeys.LOAD_SCENE),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 17:return t.prev=17,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(ar.SceneKeys.BOOT_SCENE),t.finish(17);case 21:case"end":return t.stop()}}),t,null,[[0,14,17,21]])}))),n}(0,Kt.default)(e,t);var n=e.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var t=this.player.getPlayer();(0,Wt.setSentryUser)({id:t.playerId,username:t.name})},n.detectGameMode=function(){this.storage.dispatch((function(t,e){var n,i=e(),a=Qs(i),s=window.game.player.getPlayerId(),r=a.contextId,o=a.entryPointData||{},c=o.type,h=o.matchId,l=o.playerId,d=o.opponentId,p=void 0===d?Hs.playerId:d,f=o.tournamentContextId,g=s===l,m=p===Hs.playerId||u()(n=[p,l]).call(n,s),v=Xs;!r||void 0!==c&&c!==Vs||(v=qs),c===Vs&&f&&(v=qs),r&&c===Gs&&!g&&(v=Ks),h&&r&&m&&c===Ys&&(v=Ks),r&&c===zs&&(v=js),t(er(v))}))},n.initAnalytics=function(){var t=GameCore.Configs.Analytics,e=this.player.getPlayerId();if(this.analytics.add(new lr(this.game,{userId:e,trackingId:dr,measuringId:ur,version:"2"})),GameCore.Utils.Valid.isObject(t.FacebookAnalytics)){var n=t.FacebookAnalytics.prefix;this.analytics.add(new or(this.game,n))}},n.setTrafficSourceAnalytics=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getPlayerFirstVisitEntryPoint();case 3:e=t.sent,this.analytics.setTrafficSource(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),n.getPlayerFirstVisitEntryPoint=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.getDataAsync(["entry_point"]);case 2:if(e=t.sent,n=e.entry_point?e.entry_point:null){t.next=9;break}return t.next=7,GameSDK.getEntryPointAsync();case 7:n=t.sent,GameSDK.player.setDataAsync({entry_point:n}).catch();case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e}(Phaser.Scene),fr=pr,gr=n(4),mr=n(109),vr=n.n(mr),yr=n(145),Sr=n.n(yr),Ar=n(1),xr="ALERT_SCREEN",Er="NOTIFY_SCREEN",br="RESCUE_SCREEN",wr="SETTINGS_SCREEN",Tr="BEST_SCORE_SCREEN",Cr="RESULT_SCREEN",Mr="GAME_OVER_SCREEN",Ir="TUTORIAL_PLAY_SCREEN",Pr="LEADER_BOARD_SCREEN",kr="MINI_JOURNEY_SCREEN",Rr="DAILY_CHALLENGE_SCREEN",_r="YOUR_SCORE_SCREEN",Or="LEVEL_SCREEN",Dr="MISSION_SCORE_COMPLETE_SCREEN",Br="MISSION_COLLECTION_COMPLETE_SCREEN",Lr="MISSION_FAIL_SCREEN",Fr="COLLISION_COMPLETED_SCREEN",Nr="NO_SPACE_LEFT_SCREEN",Gr="SCORE_REACHED_SCREEN",Ur="NEXT_TARGET_SCORE_SCREEN",Vr="COLLECTION_ITEMS_SCREEN",Yr="TARGET_SCORE_SCREEN",zr="CLAIM_HEART_SCREEN",Wr=300,Hr=999,Xr=n(24),Kr=n(10),jr=n(36),qr=n(13),Zr={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Jr={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Qr=Jr.STATUS,$r=function(){function t(t){this.state=void 0,this.scene=void 0,this.scene=t}var e=t.prototype;return e.init=function(){this.setState(Qr.READY)},e.start=function(){this.isRunning()||this.setState(Qr.RUNNING)},e.stop=function(){this.isRunning()&&this.setState(Qr.STOPPED)},e.setState=function(t){this.state=t},e.isReady=function(){return this.state===Qr.READY},e.isRunning=function(){return this.state===Qr.RUNNING},e.isStopped=function(){return this.state===Qr.STOPPED},t}(),to=$r,eo=n(62),no={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},io=function(t){function e(e){return t.call(this,no,e)||this}return(0,Kt.default)(e,t),e}(eo.default),ao=io,so=n(255),ro={targets:[],duration:300,ease:so.default,props:{scale:{from:1.2,to:1}}},oo=function(t){function e(e){return t.call(this,ro,e)||this}return(0,Kt.default)(e,t),e}(eo.default),co=oo,ho={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},lo=function(t){function e(e){return t.call(this,ho,e)||this}return(0,Kt.default)(e,t),e}(eo.default),uo=lo,po=Ar.default.DEFAULT,fo=po.KEY,go=po.FRAME,mo=function(t){function e(e,n,i,a,s,r){var o;return(o=t.call(this,e,n,i)||this).top=void 0,o.mid=void 0,o.bottom=void 0,o.payload=void 0,o.payload=r,o.setSize(a,s),o.setDepth(jr.default.POPUP),o.createPopup(),o.scene.add.existing((0,gr.default)(o)),o}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.top=this.scene.add.image(0,0,fo,go.POPUP_TOP),this.mid=this.scene.add.image(0,0,fo,go.POPUP_MID),this.bottom=this.scene.add.image(0,0,fo,go.POPUP_BOTTOM),this.add([this.top,this.mid,this.bottom])},n.updatePopupSize=function(){var t,e=(null==(t=this.payload)?void 0:t.forceHeightTop)||this.width*this.top.height/this.top.width;this.top.setWorldSize(this.width,e),this.bottom.setWorldSize(this.width,this.width*this.bottom.height/this.bottom.width),this.mid.setWorldSize(this.width,this.height-this.top.displayHeight-this.bottom.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.top,this,0,-this.mid.displayHeight/2-this.top.displayHeight/2),Phaser.Display.Align.In.Center(this.mid,this),Phaser.Display.Align.In.Center(this.bottom,this,0,this.mid.displayHeight/2+this.bottom.displayHeight/2)},n.setFrameTop=function(t,e,n){e||(e=this.top.displayWidth),n||(n=this.top.displayHeight),this.top.setFrame(t),this.top.setWorldSize(e,n)},(0,Se.default)(e,[{key:"onClose",set:function(t){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,t)}}]),e}(Phaser.GameObjects.Container),vo=mo,yo=Ar.default.DEFAULT,So=yo.KEY,Ao=yo.FRAME,xo=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.contents=void 0,s.buttonPlay=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onPlay=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.setVisible(!0);var n=s.getData(["onPlay"])[0];s.onPlay=n,s.runOpenAnimation()},s.handlePlay=function(){s.onPlay&&s.onPlay(),s.close()},s.setVisible(!1),s.setDepth(Wr),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createMessage(),this.createButtonPlay(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonPlay])},n.createButtonPlay=function(){this.buttonPlay=new Kr.default(this.scene,So,Ao.BUTTON_GREEN_LARGE,170,55),this.buttonPlay.setName("Play");var t=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(60),text:"\u0418\u0413\u0420\u0410\u0422\u042c",origin:{x:.5,y:.5}});this.buttonPlay.add(t),Phaser.Display.Align.In.Center(t,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,50),this.buttonPlay.onClick=this.handlePlay},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5},text:"The game will end when there s no\nmore space for your given blocks."}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-45),this.messageText.setScale(0).setAlpha(0)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{y:250,scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=n.y,a=n.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},e}(GameCore.Screen),Eo=xo,bo=[{minCol:0,minRow:0,cols:4,rows:4},{minCol:4,minRow:0,cols:4,rows:4},{minCol:0,minRow:4,cols:4,rows:4},{minCol:4,minRow:4,cols:4,rows:4}],wo=[{minCol:0,minRow:0,cols:5,rows:5},{minCol:3,minRow:0,cols:5,rows:5},{minCol:0,minRow:3,cols:5,rows:5},{minCol:3,minRow:3,cols:5,rows:5}],To=[{minCol:0,minRow:0,cols:6,rows:6},{minCol:3,minRow:0,cols:6,rows:6},{minCol:0,minRow:3,cols:6,rows:6},{minCol:3,minRow:3,cols:6,rows:6}],Co="vertical",Mo="horizontal",Io="left",Po="right",ko="top",Ro="bottom",_o="vertical_left",Oo="vertical_right",Do="horizontal_left",Bo="horizontal_right",Lo="gem/gem",Fo="gem/gem",No="gem/gem",Go="gem/gem",Uo="gem/gem",Vo="gem/gem",Yo="gem/gem",zo="gem/gem",Wo="gem/gem",Ho=[{level:1,frames:[],width:480,height:189},{level:2,frames:[Ar.default.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[Ar.default.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],Xo=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],Ko="l",jo="l_1",qo="l_3",Zo="line_2",Jo="line_3",Qo="line_4",$o="line_5",tc="square_1",ec="square_2",nc="square_3",ic="trapezoid",ac="triangle",sc="t_piece",rc="plus_piece",oc="cross_piece_2",cc="cross_piece_3",hc="cross_piece_4",lc="cross_piece_5",uc="u_piece",dc=[Ko,jo,qo,Zo,Jo,Qo,$o,tc,ec,nc,ac,ic,sc,rc,oc,cc,hc,uc],pc=[{type:Ko,rate:2},{type:jo,rate:8},{type:qo,rate:6},{type:Zo,rate:9},{type:Jo,rate:9},{type:Qo,rate:8},{type:$o,rate:8},{type:tc,rate:9},{type:ec,rate:8},{type:ac,rate:2},{type:ic,rate:2},{type:sc,rate:1},{type:rc,rate:1},{type:oc,rate:2},{type:cc,rate:1},{type:hc,rate:1},{type:uc,rate:1}],fc=[[1,0],[1,0],[1,1]],gc=[[0,1],[0,1],[1,1]],mc=[[1,0],[1,1]],vc=[[1,0,0],[1,0,0],[1,1,1]],yc=[[1,1,1],[1,0,0]],Sc=[[1,1,1],[0,0,1]],Ac=[[1,1],[1,0]],xc=[[1,1,1],[1,0,0],[1,0,0]],Ec=[[1,1],[0,1],[0,1]],bc=[[1,1],[1,0],[1,0]],wc=[[1,1],[0,1]],Tc=[[1,1,1],[0,0,1],[0,0,1]],Cc=[[0,0,1],[1,1,1]],Mc=[[1,0,0],[1,1,1]],Ic=[[0,1],[1,1]],Pc=[[0,0,1],[0,0,1],[1,1,1]],kc=[[1],[1]],Rc=[[1,1]],_c=[[1],[1],[1]],Oc=[[1,1,1]],Dc=[[1],[1],[1],[1]],Bc=[[1,1,1,1]],Lc=[[1],[1],[1],[1],[1]],Fc=[[1,1,1,1,1]],Nc=[[1]],Gc=[[1,1],[1,1]],Uc=[[1,1,1],[1,1,1],[1,1,1]],Vc=[[1,0],[1,1],[0,1]],Yc=[[0,1],[1,1],[1,0]],zc=[[1,1,0],[0,1,1]],Wc=[[0,1,1],[1,1,0]],Hc=[[0,1],[1,1],[0,1]],Xc=[[1,0],[1,1],[1,0]],Kc=[[0,1,0],[1,1,1]],jc=[[1,1,1],[0,1,0]],qc=[[0,0,1],[1,1,1],[0,0,1]],Zc=[[1,0,0],[1,1,1],[1,0,0]],Jc=[[0,1,0],[0,1,0],[1,1,1]],Qc=[[1,1,1],[0,1,0],[0,1,0]],$c=[[0,1,0],[1,1,1],[0,1,0]],th=[[1,0],[0,1]],eh=[[0,1],[1,0]],nh=[[1,0,0],[0,1,0],[0,0,1]],ih=[[0,0,1],[0,1,0],[1,0,0]],ah=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],sh=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],rh=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],oh=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],ch=[[1,1],[0,1],[1,1]],hh=[[1,0],[1,1],[1,0]],lh=[[1,0,1],[1,1,1]],uh=[[1,1,1],[1,0,1]],dh=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"4bb3/4bb3/4bb3/3bb4/bbbb2bbb/bbbb1bbbb/4bb3/4bb3/4bb3 l tz-vr,b",piece:tc,position:{x:4,y:3}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2+30},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=[{x:5,y:3},{x:5,y:4},{x:4,y:4},{x:4,y:5}],e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y;this.scene.main.board.dataBoard[a][i].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()}},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),ph=dh,fh=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/x/bbbb1ryry/x/x/x/x l s1,b",piece:tc,position:{x:4,y:4}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=n/2+176+30,a=i+(n-85-i)/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2+15},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<1;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),gh=fh,mh=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/4bb3/4bb3/5b3/x/x/x l l-dt,b",piece:tc,position:{x:3,y:3}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2-20},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking();this.scene.main.board.dataBoard[5][4].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),vh=mh,yh=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"2r/2r/2r/2r/x/x/x/2r/2r l e3-v,r",piece:Jo,position:{x:2,y:4}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2-60},y:{from:a,to:n/2+30},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),Sh=yh,Ah=Zr.STATUS,xh=Ar.default.GAMEPLAY,Eh=xh.KEY,bh=xh.FRAME,wh=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.currentLevel=1,n.tutorialId=void 0,n.inputType=void 0,n.handFrame=void 0,n.background=void 0,n.headerContainer=void 0,n.maskGraphics=void 0,n.textTutorial=void 0,n.skipButton=void 0,n.stepOne=void 0,n.stepTwo=void 0,n.stepThree=void 0,n.stepFour=void 0,n.showTutorialWhenStart=function(){switch(n.scene.analytics.event(ni.AnalyticsEvents.TUTORIAL_STEP,{tutorial_step:n.currentLevel}),n.currentLevel){case 1:n.stepOne.start(),n.setTextTutorial("\u0420\u0430\u0437\u043c\u0435\u0441\u0442\u0438\u0442\u0435 \u0431\u043b\u043e\u043a\u0438 \u0432 \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u0443\u044e\n\u043b\u0438\u043d\u0438\u044e \u0438 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435, \u0447\u0442\u043e \u043f\u0440\u043e\u0438\u0437\u043e\u0439\u0434\u0435\u0442!");break;case 2:n.stepTwo.start(),n.setTextTutorial("\u0422\u0435\u043f\u0435\u0440\u044c \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435, \u0447\u0442\u043e \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442,\n\u043a\u043e\u0433\u0434\u0430 \u0432\u044b \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u0435 \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u043b\u0438\u043d\u0438\u044e.");break;case 3:n.stepThree.start(),n.setTextTutorial("\u0422\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043a\u0432\u0430\u0434\u0440\u0430\u0442 3\xd73.\n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435!");break;case 4:n.stepFour.start(),n.setTextTutorial("\u0421\u0442\u0440\u043e\u0439\u0442\u0435 \u043b\u0438\u043d\u0438\u0438 \u0438 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u044b,\n\u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043a\u043e\u043c\u0431\u043e-\u043e\u0447\u043a\u0438!");break;default:n.handleCompleteTutorial()}},n.nextTutorial=function(){switch(n.currentLevel){case 1:n.stepOne.nextLevel();break;case 2:n.stepTwo.nextLevel();break;case 3:n.stepThree.nextLevel();break;case 4:n.stepFour.nextLevel()}n.currentLevel++,n.showTutorialWhenStart()},n.validTargetPosition=function(t){var e={x:0,y:0};switch(n.currentLevel){case 1:e=n.stepOne.dataInit.position;break;case 2:e=n.stepTwo.dataInit.position;break;case 3:e=n.stepThree.dataInit.position;break;case 4:e=n.stepFour.dataInit.position}return e.x===t.x&&e.y===t.y},n.scene=e,n.createHand(),n.createTutorialPlayScreen(),n.createHeader(),n.createSkipButton(),n.initTutorialStep(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createTutorialPlayScreen=function(){this.scene.screen.add(Ir,Eo)},n.createHeader=function(){this.headerContainer=this.scene.add.container(),this.headerContainer.setVisible(!1);var t=this.scene.gameZone.width,e=this.scene.make.image({key:Eh,frame:bh.BLANK});e.setTint(0),e.setAlpha(.5),e.setWorldSize(t,100),this.headerContainer.add(e),Phaser.Display.Align.In.Center(e,this.headerContainer),this.textTutorial=this.scene.make.text({style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700",align:"center"}}),this.textTutorial.setHighQuality(),this.textTutorial.setTint(16442297),this.headerContainer.add(this.textTutorial),Phaser.Display.Align.In.TopCenter(this.headerContainer,this.scene.gameZone,0,-50)},n.createSkipButton=function(){this.skipButton=new Kr.default(this.scene,Eh,bh.BUTTON_SKIP,60,35.5),this.headerContainer.add(this.skipButton),this.skipButton.onClick=this.handleSkip.bind(this),Phaser.Display.Align.In.BottomRight(this.skipButton,this.headerContainer,-5,-5)},n.handleSkip=function(){this.scene.game.globalScene.screen.open(xr,{message:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435\n\u043f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435?",onHandleYes:this.handleCompleteTutorial.bind(this)})},n.initTutorialStep=function(){this.stepOne=new gh(this),this.stepTwo=new Sh(this),this.stepThree=new vh(this),this.stepFour=new ph(this)},n.start=function(){this.isRunning()||(this.scene.analytics.pageview("tutorial-screen"),this.setState(Ah.RUNNING),this.headerContainer.setVisible(!0),this.showTutorialWhenStart())},n.setTextTutorial=function(t){var e=this,n=t.split(""),i="";this.scene.time.addEvent({repeat:n.length,delay:10,callback:function(){var t=n.shift()||"";i+=t,e.textTutorial.setText(i),Phaser.Display.Align.In.Center(e.textTutorial,e.headerContainer,-e.scene.gameZone.width/2,-60)}})},n.stop=function(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.background]),this.background.setVisible(!1),this.maskGraphics.setVisible(!1),this.setState(Ah.STOPPED))},n.handleCompleteTutorial=function(){this.scene.analytics.pageview("game-scene"),this.scene.analytics.event(ni.AnalyticsEvents.TUTORIAL_COMPLETE),this.setState(Ah.STOPPED),this.scene.main.praise.tweenShowScoreText.stop().remove(),this.scene.startGame(),this.handFrame.setVisible(!1),this.headerContainer.setVisible(!1)},n.createHand=function(){this.handFrame=this.scene.make.image({key:Eh,frame:bh.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(jr.default.ON_TOP),this.handFrame.setWorldSize(64,55)},n.isValidForTutorial=function(){return this.scene.game.player.getPlayerIsNew()},n.dragStart=function(){switch(this.currentLevel){case 1:this.stepOne.dragStart();break;case 2:this.stepTwo.dragStart();break;case 3:this.stepThree.dragStart();break;case 4:this.stepFour.dragStart()}},n.skipTutorial=function(){this.isRunning()&&(this.handFrame.setVisible(!1),this.setState(Ah.STOPPED))},n.invalidMove=function(){switch(this.currentLevel){case 1:this.stepOne.invalidMove();break;case 2:this.stepTwo.invalidMove();break;case 3:this.stepThree.invalidMove();break;case 4:this.stepFour.invalidMove()}},n.handleGuidePlayStep=function(t){try{this.scene.main.board.clearBoard(),this.scene.footer.pieces.clearPieces();var e=null,n=null;if(t){var i=this.scene.main.board.getBoardByFen(t);e=this.scene.handleDynamicFenSize(i),n=this.scene.footer.pieces.getPiecesByFen(t)}this.scene.main.board.startGame(e),this.scene.footer.pieces.showAvailablePieces(n)}catch(a){console.log(a)}},e}(to),Th=wh,Ch={START_GAME:"start-game",REPLAY:"replay",RESCUE:"rescue",RECEIVE_DIAMONDS:"receive-diamonds",GAME_OVER:"game-over"},Mh={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},Ih=function(t){function e(e){return t.call(this,Mh,e)||this}return(0,Kt.default)(e,t),e}(eo.default),Ph=Ih,kh=n(97),Rh=n.n(kh),_h=n(146),Oh=n.n(_h),Dh=function(t){return t.leaderboards},Bh=((0,be.createSelector)([function(t){return Dh(t).leaderboardId}],(function(t){return t})),(0,be.createSelector)([function(t){return Dh(t).limit}],(function(t){return t})),(0,be.createSelector)([function(t){return Dh(t).offset}],(function(t){return t})),(0,be.createSelector)([function(t){return Dh(t).leaders}],(function(t){return t}))),Lh=((0,be.createSelector)([function(t){return Dh(t).type}],(function(t){return t})),(0,be.createSelector)([function(t){return Dh(t).isRequesting}],(function(t){return t}))),Fh="global",Nh="friend",Gh=GameCore.Configs,Uh=Gh.ApiHost,Vh=Gh.OtherHost,Yh=Gh.LeadersBoard,zh=Yh.LeaderboardId,Wh=Yh.Prefix+"/"+zh+"/leaders",Hh=Yh.Prefix+"/"+zh+"/players",Xh=Yh.Name,Kh=function(t){var e="";return Yh.LeaderboardId?(t===Fh?e=Wh:t===Nh&&(e=Hh),e):e},jh=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=De()(e).call(e,(function(t){return t.playerId})),a=GameCore.Utils.Object.keyBy(e,"playerId"),s=GameCore.Utils.String.params({playerIds:i}),t.next=5,Ke("players?"+s,{},Uh);case 5:return r=t.sent,o=De()(n=r.data).call(n,(function(t){var e=a[t.playerId];return(0,Tt.default)({},t,{score:e.score,rank:e.rank,getScore:function(){return e.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return e.rank},getExtraData:function(){return e.extraData},getPlayer:function(){return{getName:function(){return t.name},getPhoto:function(){return t.photo},getID:function(){return t.playerId}}}})})),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),qh=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),null==zh){t.next=3;break}return t.abrupt("return",Zh(e));case 3:return t.abrupt("return",Jh(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Zh=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),n=[],i=Kh(Fh)){t.next=5;break}return t.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(e),t.next=8,Ke(i+"?"+a,{},Vh);case 8:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=12;break}return t.abrupt("return",n);case 12:return n=r,t.abrupt("return",jh(n));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Jh=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),i=(n=e).limit,a=n.offset,t.next=4,window.GameSDK.getLeaderboardAsync(Xh);case 4:return s=t.sent,t.next=7,s.getEntriesAsync(i,a);case 7:return r=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Qh=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),null==zh){t.next=3;break}return t.abrupt("return",$h(e));case 3:return t.abrupt("return",tl(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$h=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),n=[],i=Kh(Nh)){t.next=5;break}return t.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(e),t.next=8,Ke(i+"?"+a,{},Vh);case 8:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=12;break}return t.abrupt("return",n);case 12:return n=r,t.abrupt("return",jh(n));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tl=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),i=(n=e).limit,a=n.offset,t.next=4,window.GameSDK.getLeaderboardAsync(Xh);case 4:return s=t.sent,t.next=7,s.getConnectedPlayerEntriesAsync(i,a);case 7:return r=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),el=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==zh){t.next=2;break}return t.abrupt("return",nl(e));case 2:return t.abrupt("return",il());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),nl=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,e){t.next=3;break}return t.abrupt("return",n);case 3:if(i=Kh(Nh)){t.next=6;break}return t.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:e}),t.next=9,Ke(i+"?"+a,{},Vh);case 9:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=13;break}return t.abrupt("return",n);case 13:return n=jh(r)[0],t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),il=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.GameSDK.getLeaderboardAsync(Xh);case 2:return e=t.sent,t.next=5,e.getPlayerEntryAsync();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),al=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==zh){t.next=2;break}return t.abrupt("return",sl(e,n));case 2:return t.abrupt("return",rl(n));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),sl=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("players/"+e+"/leaderboard",{score:n},{},Uh);case 2:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),rl=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.GameSDK.getLeaderboardAsync(Xh);case 2:return n=t.sent,t.next=5,n.setScoreAsync(e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function ol(t,e){var n="undefined"!==typeof Rh()&&Oh()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return cl(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return cl(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var hl=GameCore.Configs.LeadersBoard,ll=function(t,e,n,i){return void 0===n&&(n=hl.LeaderBoardLimit),void 0===i&&(i=0),function(){var a=(0,Xt.default)(qt().mark((function a(s,r){var o,c,l,u,d,p,f,g,m,v,y,S,x,E,b,w,T,C,M;return qt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,o=window.game,c=o.player,o.profile,r(),l=c.getPlayerId(),s({type:Ga,payload:{leaderboardId:t,type:e,limit:n,offset:i}}),!hl.UseMock){a.next=11;break}return a.next=8,(0,Ge.sleepAsync)(1e3);case 8:return p=De()(u=A()(d=new Array(n)).call(d,null)).call(u,(function(t,e){var n=(e+1)*(i+1);return{playerId:"0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)}})),s(ul(p,e)),a.abrupt("return");case 11:if(f=[],e!==Fh){a.next=18;break}return a.next=15,qh({limit:n,offset:i});case 15:f=a.sent,a.next=26;break;case 18:if(e!==Nh){a.next=26;break}return(g=c.getConnectedPlayerIds(n,i)).push(l),m=GameCore.Utils.Array.unique(g),a.next=24,Qh({playerIds:m,limit:m.length});case 24:f=a.sent,m.forEach((function(t){var e=h()(f).call(f,(function(e){return e.playerId===t}));e&&0!==e.length||f.push({playerId:t,score:0})}));case 26:for(v={},y=ol(f);!(S=y()).done;)x=S.value,E=x.playerId,b=x.score,w=x.rank,T=x.getPlayer(),C=T.getPhoto(),M=T.getName(),v[E]={playerId:E,name:M,photo:C,score:b,rank:w};s(ul(v,e)),a.next=35;break;case 31:a.prev=31,a.t0=a.catch(0),s(ul([],e)),(0,Wt.sendException)(a.t0);case 35:case"end":return a.stop()}}),a,null,[[0,31]])})));return function(t,e){return a.apply(this,arguments)}}()},ul=function(t,e){return{type:Ua,payload:{leaders:t,type:e}}},dl=function(){return{type:Va,payload:{}}},pl={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},fl=function(t){function e(e){return t.call(this,pl,e)||this}return(0,Kt.default)(e,t),e}(eo.default),gl=fl,ml={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},vl=function(t){function e(e){return t.call(this,ml,e)||this}return(0,Kt.default)(e,t),e}(eo.default),yl=vl,Sl={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},Al=function(t){function e(e){return t.call(this,Sl,e)||this}return(0,Kt.default)(e,t),e}(eo.default),xl=Al,El=Ar.default.DEFAULT,bl=El.KEY,wl=El.FRAME,Tl=function(t){function e(e){var n;return(n=t.call(this,e,0,0,bl,wl.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(80,80),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnimation=function(){var t;null==(t=this.anim)||t.remove(),this.anim=new xl({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(e){return t.prototype.setVisible.call(this,e),e?this.runAnimation():this.anim.stop(),this},e}(Phaser.GameObjects.Image),Cl=Tl,Ml=function(t){function e(e,n){var i;(i=t.call(this,e)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(t,e){return function(){var n=i.scene.textures.get(t);n&&n.key===t?i.handleLoadComplete(t):(i.scene.load.once("filecomplete-image-"+t,i.handleLoadComplete),i.scene.load.image(t,e),i.scene.load.start())}},i.handleLoadComplete=function(t){if(i.scene){var e=i.payload,n=e.id,a=e.radius,s=void 0===a?0:a;if(n&&n===t){var r=n+"_bordered_"+s,o=s>0?r:n,c=i.scene.textures.get(o);if(c&&c.key===o)i.setPhoto(c.key);else if(0!=s&&s<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:r,radius:s}))return void i.showLoading(!1);i.setPhoto(r)}else if(100==s){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:r}))return void i.showLoading(!1);i.setPhoto(r)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(t){t.key===i.payload.id&&i.setDefaultAvatar(t.key)},i.scene.add.existing((0,gr.default)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,s=a.id,r=a.url,o=a.radius;return s&&r&&i.loadPhoto(s,r,o),i.addDefaultListeners(),i}(0,Kt.default)(e,t);var n=e.prototype;return n.setFrame=function(t){this.avtFrame.setFrame(t),this.avtFrame.setVisible(!0)},n.setBackground=function(t){this.background.setFrame(t)},n.loadPhoto=function(t,e,n){var i;if(void 0===n&&(n=0),this.payload.id=t,this.payload.url=e,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),t&&e){var a=this.scene.textures.get(t);if(a&&a.key===t)this.handleLoadComplete(t);else{this.showLoading(!0);var s=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(s,this.handleLoadPhotoAfterDelay(t,e))}}else this.setPhoto(Ws.default.AVATAR.KEY)},n.addDefaultListeners=function(){var t=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var e;null==(e=t.loadPhotoTimer)||e.remove(),t.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,t.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(t){this.loadPhoto(t,Ws.default.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var t=this.payload,e=t.key,n=t.background,i=t.borderWidth,a=void 0===i?0:i;this.background=this.scene.make.image({key:e,frame:n}),this.background.setWorldSize(this.width-a,this.height-a),this.add(this.background)},n.createLoading=function(){this.loading=new Cl(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var t=this.payload,e=t.key,n=t.frame,i=t.width,a=t.height;n?(this.avtFrame=this.scene.make.image({key:e,frame:n}),this.avtFrame.setWorldSize(i,a)):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(t){this.photo.setVisible(!t),this.loading.setVisible(t)},n.setPhoto=function(t){this.showLoading(!1),this.photo.setTexture(t),this.photo.setFrame(0);var e=this.payload,n=e.width,i=e.height,a=Math.min(n,i)-(this.payload.borderWidth||8);this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},e}(Phaser.GameObjects.Container),Il=Ml,Pl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidContextId",i.message=e||"This contextId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),kl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="NewScoreIsBad",i.message=e||"The new score is bad",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Rl=function(t){return t.match},_l=(0,be.createSelector)([function(t){return Rl(t).gameplay.mode}],(function(t){return t})),Ol=((0,be.createSelector)([function(t){return Rl(t).gameplay.status}],(function(t){return t})),(0,be.createSelector)([function(t){return Rl(t).gameplay.rescued}],(function(t){return t}))),Dl=(0,be.createSelector)([function(t){return Rl(t).gameplay.startAt}],(function(t){return t})),Bl=(0,be.createSelector)([function(t){return Rl(t).gameplay.finishAt}],(function(t){return t})),Ll=(0,be.createSelector)([function(t){return Rl(t).gameplay.showMiniJourney}],(function(t){return t})),Fl=GameCore.Configs,Nl=Fl.AppId,Gl=Fl.OtherHost,Ul=Fl.LeadersBoard,Vl=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={appId:Nl,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!Ul.UseMock){t.next=5;break}return t.next=4,(0,Ge.sleepAsync)(1e3);case 4:return t.abrupt("return",(0,Tt.default)({},n,e,{_id:Ul.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",t.next=8,je("leaderboards",(0,Tt.default)({},n,e),{},Gl);case 8:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yl=(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d,p,f;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n={}),i=[],!Ul.UseMock){t.next=7;break}return t.next=5,(0,Ge.sleepAsync)(1e3);case 5:return o=(r=n).limit,c=void 0===o?10:o,h=r.offset,l=void 0===h?0:h,t.abrupt("return",De()(a=A()(s=new Array(c)).call(s,null)).call(a,(function(t,e){var n=(e+1)*(l+1);return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random())}})));case 7:return u=GameCore.Utils.String.params(n),d="leaderboards/"+e+"/leaders",t.next=11,Ke(d+"?"+u,{},Gl);case 11:if((p=t.sent)&&(null==p||!p.error)){t.next=14;break}throw new Error((null==p?void 0:p.error)||"Leaderboard not found");case 14:if(!((f=(null==p?void 0:p.data)||[]).length<1)){t.next=17;break}return t.abrupt("return",i);case 17:return i=f,t.abrupt("return",i);case 19:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i){var a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("leaderboards/"+e+"/players/"+n,{score:i},{},Gl);case 2:return a=t.sent,t.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}()),zl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="CurrentTournamentScoreIsNotBest",i.message=e||"The new score is not best",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Wl=GameCore.Configs.Tournament.UseLeaderboard,Hl=function(t){return{type:ka,payload:{tournamentId:t}}},Xl=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,c,h,l,u;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.facebook,a=t.playerId,s=t.playerName,r=t.score,o=t.autoStartGame,c=s+"'s Tournament",h=GameCore.Utils.String.generateObjectId(),e.next=7,i.tournament.createAsync({initialScore:r,config:{title:c,tournamentTitle:c},data:{playerId:a,playerName:s,leaderboardId:h}});case 7:return l=e.sent,u=l.getID(),o&&(n(Hl(u)),n(qd())),e.next=12,Vl({_id:h,createdBy:a,name:u,description:c,expireTime:6048e5});case 12:if(e.sent._id!==h){e.next=16;break}return e.next=16,Yl(h,a,r);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,Wt.sendException)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}()},Kl=function(t){return(0,Xt.default)(qt().mark((function e(){var n,i,a,s,r;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game.facebook,i=t.playerId,a=t.playerName,s=t.leaderboardId,r=t.score,s&&Yl(s,i,r),e.next=5,n.tournament.shareAsync({score:r,data:{type:Vs,playerId:i,playerName:a}});case 5:Yl(s,i,r);case 6:case"end":return e.stop()}}),e)})))},jl=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.game.facebook,t.next=4,e.getTournamentAsync();case 4:return n=t.sent,i=JSON.parse(n.getPayload()||"{}"),t.abrupt("return",i.leaderboardId);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),ql=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.game.facebook,t.next=4,e.getTournamentAsync();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(0),console.warn("getCurrentTournament ~ error",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),Zl=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r,o,c,h,l,d,p,f,g,m,v,y;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,s=window.game,r=s.player,o=s.facebook,c=s.analytics,e.prev=2,l=i(),d=_l(l),u()(h=[Xs,qs]).call(h,d)){e.next=7;break}return e.abrupt("return");case 7:return n({type:Ra,payload:{}}),p=r.getPlayer(),f=p.playerId,g=p.name,e.next=11,ql();case 11:if(!e.sent){e.next=23;break}if(a=ni.AnalyticsEvents.TOURNAMENT_SHARE,!Wl){e.next=21;break}return e.next=17,jl();case 17:return m=e.sent,v={playerId:f,playerName:g,score:t,leaderboardId:m},e.next=21,n(Kl(v));case 21:e.next=28;break;case 23:if(a=ni.AnalyticsEvents.TOURNAMENT_CREATE,!Wl){e.next=28;break}return y={playerId:f,playerName:g,score:t,autoStartGame:!1},e.next=28,n(Xl(y));case 28:if(c.event(a,{success:!0}),!1!==Wl){e.next=32;break}return e.next=32,o.requestTournamentAsync(t);case 32:n(Jl(t)),e.next=40;break;case 35:if(e.prev=35,e.t0=e.catch(2),!(e.t0 instanceof zl)){e.next=39;break}return e.abrupt("return");case 39:a&&c.event(a,{success:!1});case 40:case"end":return e.stop()}}),e,null,[[2,35]])})));return function(t,n){return e.apply(this,arguments)}}()},Jl=function(t){return{type:_a,payload:{score:t}}},Ql=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidOpponentId",i.message=e||"This opponentId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),$l=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="WideFrameRenderFail",i.message=e||"Wide frame render fail",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),tu={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},eu=function(t,e){return e.playerId},nu=((0,be.createSelector)([function(t){return Rl(t).match.isRequesting}],(function(t){return t})),(0,be.createSelector)([function(t){return Rl(t).match.single}],(function(t){return t}))),iu=(0,be.createSelector)([function(t){return Rl(t).match.single._id}],(function(t){return t})),au=(0,be.createSelector)([function(t){return Rl(t).match.single.score}],(function(t){return t||0})),su=((0,be.createSelector)([function(t){return Rl(t).match.single.level}],(function(t){return t||0})),(0,be.createSelector)([function(t){var e;return null==(e=Rl(t).match.single.data)?void 0:e.diamond}],(function(t){return t||0})),(0,be.createSelector)([function(t){var e;return null==(e=Rl(t).match.single.data)?void 0:e.fen}],(function(t){return t||null})),(0,be.createSelector)([function(t){return Rl(t).match.single.status}],(function(t){return t})),(0,be.createSelector)([function(t){return Rl(t).match.single.playerId}],(function(t){return t})),(0,be.createSelector)([function(t){return Rl(t).match.challenge}],(function(t){return t}))),ru=(0,be.createSelector)([function(t){return Rl(t).match.challenge._id}],(function(t){return t})),ou=(0,be.createSelector)([function(t){return Rl(t).match.challenge.status}],(function(t){return t})),cu=(0,be.createSelector)([function(t){return Rl(t).match.challenge.opponentInfo}],(function(t){return t})),hu=((0,be.createSelector)([function(t){return Rl(t).match.challenge.whitePlayerId}],(function(t){return t})),(0,be.createSelector)([function(t){return Rl(t).match.challenge.blackPlayerId}],(function(t){return t})),(0,be.createSelector)([su,eu],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId;return n!==e&&i===e?n:i!==e&&n===e?i:""})),(0,be.createSelector)([su,eu],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId;return n===e?n:i===e?i:Hs.playerId}))),lu=(0,be.createSelector)([su,eu],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId,a=t.whitePlayerFinish,s=t.blackPlayerFinish;return e&&n===e?a:!(!e||i!==e)&&s})),uu=(0,be.createSelector)([su,function(t,e){return e.opponentId}],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId,a=t.whitePlayerFinish,s=t.blackPlayerFinish;return e&&n===e?a:!(!e||i!==e)&&s})),du=(0,be.createSelector)([function(t){return Rl(t).match.group.opponentInfo}],(function(t){return t})),pu=((0,be.createSelector)([function(t){return Rl(t).match.online.players}],(function(t){return t})),(0,be.createSelector)([function(t){return Rl(t).match.journey}],(function(t){return t}))),fu=(0,be.createSelector)([function(t){return Rl(t).match.journey._id}],(function(t){return t})),gu=(0,be.createSelector)([function(t){return Rl(t).match.journey.level}],(function(t){return t})),mu=(0,be.createSelector)([function(t){return Rl(t).match.journey.challengeMode}],(function(t){return t})),vu=(0,be.createSelector)([function(t){return Rl(t).match.journey.score}],(function(t){return t})),yu=(0,be.createSelector)([function(t){return Rl(t).stats.data}],(function(t){return t})),Su=(0,be.createSelector)([function(t){return Rl(t).stats.current}],(function(t){return t})),Au=((0,be.createSelector)([function(t){return Rl(t).stats.isRequesting}],(function(t){return t})),(0,be.createSelector)([function(t){return t.messages.data}],(function(t){return t}))),xu=(0,be.createSelector)([Au,function(t,e){return e.opponentId}],(function(t,e){return!!GameCore.Utils.Valid.isString(e)&&(!!GameCore.Utils.Object.hasOwn(t,e)&&t[e].sent)})),Eu=n(463),bu=new(n.n(Eu)()),wu=n(356),Tu=n.n(wu),Cu=function(t){if("string"!==typeof t||!t)throw new $l(null,{imageShare:t})},Mu=function(){return(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,c,h,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.analytics,a=e.facebook,s=e.globalScene,r=e.lang,t.prev=1,s.screen.open(Er,{message:r.Text.LOADING,loading:!0}),t.next=5,Iu();case 5:return o=t.sent,Cu(o),c=n.getPlayer(),h=c.playerId,l=c.name,u=c.photo,t.next=10,a.shareAsync({text:r.Text.SHARE_BEST_SCORE,intent:"SHARE",image:o||"",data:{playerId:h,playerName:l,playerPhoto:u,type:Gs}});case 10:i.event(ni.AnalyticsEvents.SHARE,{share_content_type:"BestScore",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.SHARE,{share_content_type:"BestScore",success:!1}),(0,Wt.sendException)(t.t0);case 17:return t.prev=17,s.screen.close(Er),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})))},Iu=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,c,h,l;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.game,n=e.player,i=e.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=a.data,c=(o||{}).score,h=ku({playerId:s,playerPhoto:r,playerScore:c})){t.next=7;break}return console.warn("getRenderOptionsBestScore"),t.abrupt("return");case 7:return l={name:"share-best-score",width:952,height:492,renderOptions:h},t.next=10,i.frameCapture.capture(l);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Pu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u,d,p;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=Su(e),r=yu(e),o=i.getPlayer(),c=o.playerId,h=o.photo,l=r[c]||{},u=l.score,s.bestScore>u&&(u=s.bestScore),d=ku({playerId:c,playerPhoto:h,playerScore:u})){t.next=10;break}return console.warn("getRenderOptionsCurrentScore"),t.abrupt("return");case 10:return p={name:"share-current-score",width:952,height:492,renderOptions:d},t.next=13,a.frameCapture.capture(p);case 13:return t.abrupt("return",t.sent);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ku=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:635,y:122,image:a,width:210,height:210,fallbackWithImage:Ws.default.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},Ru=(function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.profile,a=e.globalScene,s=n.getPlayer(),r=s.playerId,o=s.name,c=s.photo,(h=n.getConnectedPlayerIds(99,0)).push(r),l=[],t.next=7,Qh({playerIds:GameCore.Utils.Array.unique(h),limit:h.length});case 7:u=t.sent,d=GameCore.Utils.Object.keyBy(u,"playerId"),p={playerId:r,name:o,photo:c,score:0},GameCore.Utils.Object.hasOwn(d,r)&&(p=d[r]),l.push(p),t.t0=Tu()(qt()).call(qt(),d);case 14:if((t.t1=t.t0()).done){t.next=27;break}if(f=t.t1.value,!GameCore.Utils.Object.hasOwn(d,f)){t.next=25;break}if(g=d[f],3!==l.length){t.next=20;break}return t.abrupt("break",27);case 20:if(g.playerId!==r){t.next=22;break}return t.abrupt("continue",14);case 22:if(!(Number(g.score)>Number(p.score))){t.next=24;break}return t.abrupt("continue",14);case 24:l.push(g);case 25:t.next=14;break;case 27:return m=GameCore.Utils.Array.unique(h),t.next=30,i.requestProfiles(m);case 30:if(v=i.getProfiles(),l.forEach((function(t,e){var n=t.playerId;if(GameCore.Utils.Object.hasOwn(v,n)){var i=v[n],a=i.name,s=i.photo;l[e].name=a,l[e].photo=s}})),l.length<3)for(y=0;y<=3-l.length;)l.push({playerId:"bot"+y,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),y++;if(S=Ru({playerId:r,playerName:o,playerPhoto:c,listLeaders:l})){t.next=37;break}return console.warn("getRenderOptionsLeaderboard"),t.abrupt("return");case 37:return A={name:"share-leaderboard",width:1500,height:2e3,renderOptions:S},t.next=40,a.frameCapture.capture(A);case 40:return t.abrupt("return",t.sent);case 41:case"end":return t.stop()}}),t)})))}(),function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.listLeaders,r=void 0===s?[]:s;if(!Array.isArray(r))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var o={avatar:{name:""+n,type:"image",x:490,y:250,image:a,width:525,height:525,fallbackWithImage:Ws.default.AVATAR.KEY}};return r.forEach((function(t,e){var n=t.playerId,i=t.photo;o["photo_"+n]={name:""+n,type:"image",x:475,y:1215+385*e,image:i,width:150,height:150,fallbackWithImage:Ws.default.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},r.forEach((function(t,e){var n=t.playerId,i=t.name,a=t.score;o["name_"+n]={type:"text",x:690,y:1312+193*e,font:"600 60px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1070,y:1312+193*e,font:"600 55px",text:a,fillStyle:"#b18151"}})),o}),_u=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u,d,p,f,g,m,v,y,S;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=yu(e),r=i.getPlayer(),o=r.photo,c=r.playerId,h=cu(e),l=h.playerId,u=h.photo,d=lu(e,{playerId:c}),p=uu(e,{opponentId:l}),f=s[c]||{},g=f.score,m=s[l]||{},v=m.score,y=Du({playerId:c,playerPhoto:o,playerScore:g,opponentId:l,opponentPhoto:u,opponentScore:v,isPlayerFinished:d,isOpponentFinished:p})){t.next=12;break}return console.warn("getRenderOptionsLeaderboard"),t.abrupt("return");case 12:return S={name:"share-game-result",width:952,height:492,renderOptions:y},t.next=15,a.frameCapture.capture(S);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ou=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u,d,p,f,g,m;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=yu(e),r=i.getPlayer(),o=r.photo,c=r.playerId,h=du(e),l=h.playerId,u=h.photo,d=h.score,p=s[c]||{},f=p.score,g=Du({playerId:c,playerPhoto:o,playerScore:f,opponentId:l,opponentPhoto:u,opponentScore:d})){t.next=9;break}return console.warn("getRenderOptionsGroupResult"),t.abrupt("return");case 9:return m={name:"share-group-match-result",width:952,height:492,renderOptions:g},t.next=12,a.frameCapture.capture(m);case 12:return t.abrupt("return",t.sent);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Du=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.playerScore,r=void 0===s?0:s,o=t.opponentId,c=void 0===o?"20":o,h=t.opponentPhoto,l=void 0===h?"":h,u=t.opponentScore,d=void 0===u?0:u,p=t.isPlayerFinished,f=t.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof r)return null;if("string"!==typeof c)return null;if("string"!==typeof l)return null;if("number"!==typeof d)return null;if("boolean"!==typeof p)return null;if("boolean"!==typeof f)return null;var g=r===d,m=r>d,v=p||f,y=p&&f,S={leftPhoto:{name:""+n,type:"image",x:55,y:162,image:a,width:200,height:200,fallbackWithImage:Ws.default.AVATAR.KEY},rightPhoto:{name:""+c,type:"image",x:702,y:162,image:l,width:200,height:200,fallbackWithImage:Ws.default.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(S.leftScoreShadow={type:"text",x:148,y:443,font:"600 70px",fillStyle:"#c4683f",text:p?""+r:"???",textAlign:"center"},S.leftScore={type:"text",x:148,y:443,font:"600 70px",fillStyle:"#f2a62e",text:p?""+r:"???",textAlign:"center"},S.rightScoreShadow={type:"text",x:795,y:443,font:"600 70px",fillStyle:"#c4683f",text:f?""+d:"???",textAlign:"center"},S.rightScore={type:"text",x:795,y:443,font:"600 70px",fillStyle:"#f2a62e",text:f?""+d:"???",textAlign:"center"}),!g&&y&&(m?S.leftCrown={name:"crown-icon",type:"image",x:12,y:122,image:"./assets/images/others/crown-icon.png",width:106,height:78}:S.rightCrown={name:"crown-icon",type:"image",x:665,y:122,image:"./assets/images/others/crown-icon.png",width:106,height:78}),S},Bu=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game,i=n.player,a=n.analytics,s=n.facebook,r=n.globalScene,t.prev=1,r.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),t.next=5,Lu();case 5:return o=t.sent,Cu(o),c=i.getPlayer(),h=c.playerId,l=c.name,u=c.photo,t.next=10,s.shareAsync({text:"Great! I have a score!",intent:"SHARE",image:o||"",data:{playerId:h,playerName:l,playerPhoto:u,type:Gs}});case 10:a.event(ni.AnalyticsEvents.SHARE,{share_content_type:"Score",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),a.event(ni.AnalyticsEvents.SHARE,{share_content_type:"Score",success:!1}),(0,Wt.sendException)(t.t0);case 17:return t.prev=17,r.screen.close(Er),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})));return function(e){return t.apply(this,arguments)}}()},Lu=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.game,n=e.player,i=e.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=n.getBestScore(),c=Fu({playerId:s,playerPhoto:r,playerScore:o})){t.next=7;break}return console.warn("getRenderOptionsBestScore"),t.abrupt("return");case 7:return h={name:"share-score",width:952,height:492,renderOptions:c},t.next=10,i.frameCapture.capture(h);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Fu=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:635,y:122,image:a,width:210,height:210,fallbackWithImage:Ws.default.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},Nu=function(t){var e=t.contextId;if(""===e||"string"!==typeof e)throw new Pl(null,{contextId:e})},Gu=function(t){var e=t.opponentId,n=t.contextId;if(""===e||"string"!==typeof e)throw new Ql(null,{opponentId:e});if(""===n||"string"!==typeof n)throw new Pl(null,{contextId:n})},Uu=function(t){if(null===t.imageShare)throw new $l},Vu=function(t,e){return void 0===e&&(e=!0),function(n,i){var a,s=i(),r=Au(s);if(e){var o;if(null!=(o=r[t])&&o.sent)return;n(Yu(t))}null!=(a=r[t])&&a.sent&&n(zu(t))}},Yu=function(t){return{type:gi,payload:{opponentId:t}}},zu=function(t){return{type:mi,payload:{opponentId:t}}},Wu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game.facebook,Gu({opponentId:e,contextId:n}),(a=window.game.facebook.getContextID())!==n||""===n){t.next=6;break}return t.abrupt("return",a);case 6:if("10"!==e||""===n){t.next=8;break}return t.abrupt("return",n);case 8:if(!n){t.next=12;break}return t.next=11,i.switchAsync(n);case 11:return t.abrupt("return",window.game.facebook.getContextID());case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 17:return t.abrupt("return","");case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}(),Hu=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,u,d,p,f,g,m,v;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,c=s.facebook,n.prev=1,h=e.matchId,l=e.contextId,n.next=5,Wu(t,l);case 5:return u=n.sent,Nu({contextId:u}),d=a(),n.next=10,_u(d);case 10:return p=n.sent,Uu({imageShare:p}),f=r.getPlayer(),g=f.name,m=f.playerId,v=window.game.lang.getText({key:"MESSAGE_INVITE",variables:[g]}),n.next=16,c.sendMessage({cta:"Play",text:v,image:p||"",template:"challenge",data:{type:Ys,matchId:h,playerId:m,opponentId:t,status:wa}});case 16:i(Vu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"Invite",success:!0}),bu.emit(tu.INVITE_FRIENDS.EVENTS.INVITED_FRIEND,{type:"friend",value:1,opponentId:t}),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"Invite",success:!1}),(0,Wt.sendException)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,21]])})));return function(t,e){return n.apply(this,arguments)}}()},Xu=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,u,d,p,f,g,m,v;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,c=s.facebook,n.prev=1,h=e.matchId,l=e.contextId,n.next=5,Wu(t,l);case 5:return u=n.sent,Nu({contextId:u}),d=a(),n.next=10,_u(d);case 10:return p=n.sent,Uu({imageShare:p}),f=r.getPlayer(),g=f.name,m=f.playerId,v=window.game.lang.getText({key:"MESSAGE_FINISH_MATCH",variables:[g]}),n.next=16,c.sendMessage({cta:"See result",text:v,image:p||"",template:"finished",data:{type:Ys,matchId:h,playerId:m,opponentId:t,status:Ta}});case 16:i(Vu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishMatch",success:!0}),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishMatch",success:!1}),(0,Wt.sendException)(n.t0);case 24:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(t,e){return n.apply(this,arguments)}}()},Ku=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A,x;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,c=s.facebook,n.prev=1,h=e.matchId,l=e.contextId,n.next=5,Wu(t,l);case 5:return u=n.sent,Nu({contextId:u}),d=a(),n.next=10,_u(d);case 10:return p=n.sent,Uu({imageShare:p}),f=r.getPlayer(),g=f.name,m=f.playerId,v=yu(d),y=v[m]||{},S=y.score,A=void 0===S?0:S,x=window.game.lang.getText({key:"MESSAGE_BEST_SCORE",variables:[g,A]}),n.next=18,c.sendMessage({cta:"See result",text:x,image:p||"",template:"pass_score",data:{type:Ys,matchId:h,playerId:m,opponentId:t,status:Ta}});case 18:i(Vu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"BestScore",success:!0}),n.next=26;break;case 22:n.prev=22,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"BestScore",success:!1}),(0,Wt.sendException)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,22]])})));return function(t,e){return n.apply(this,arguments)}}()},ju=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,u,d,p,f,g,m,v,y;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,c=s.facebook,n.prev=1,h=e.matchId,l=e.contextId,u=e.score,n.next=5,Wu(t,l);case 5:return d=n.sent,Nu({contextId:d}),p=a(),n.next=10,_u(p);case 10:return f=n.sent,Uu({imageShare:f}),g=r.getPlayer(),m=g.name,v=g.playerId,y=window.game.lang.getText({key:"MESSAGE_FINISH_TURN",variables:[m,u]}),n.next=16,c.sendMessage({cta:"Play",text:y,image:f||"",template:"play_turn",data:{type:Ys,matchId:h,playerId:v,opponentId:t,status:wa}});case 16:i(Vu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishTurn",success:!0}),n.next=26;break;case 20:if(n.prev=20,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishTurn",success:!1}),!(n.t0 instanceof Pl)){n.next=25;break}return n.abrupt("return");case 25:(0,Wt.sendException)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(t,e){return n.apply(this,arguments)}}()},qu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.player,s=i.facebook,r=a.getPlayer(),o=r.playerId,c=r.name,h=r.photo,l=Su(n),u=l.score,d={type:zs,playerId:o,playerName:c,playerPhoto:h,playerScore:u},t.next=7,s.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i"}},text:{default:c+" beats your high score. Their score: "+u+".",localizations:{en_US:c+" beats your high score. Their score: "+u+".",vi_VN:c+" v\u1eeba v\u01b0\u1ee3t \u0111i\u1ec3m s\u1ed1 cao nh\u1ea5t c\u1ee7a b\u1ea1n! Ch\u01a1i l\u1ea7n n\u1eefa ch\u1ee9?"}},image:e||"",template:"play_turn",data:d});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}(),Zu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,s=i.facebook,t.prev=1,r=a.getPlayer(),o=r.playerId,c=r.name,h=r.photo,l=Su(n),u=l.score,d={type:zs,playerId:o,playerName:c,playerPhoto:h,playerScore:u},t.next=7,s.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:c+" got "+u+" scores. So easy! Can you?",localizations:{en_US:c+" got "+u+" scores. So easy! Can you?",vi_VN:c+" \u0111\xe3 \u0111\u1ea1t "+u+" \u0111i\u1ec3m! Qu\xe1 d\u1ec5 lu\xf4n. Ch\u01a1i l\u1ea1i n\xe0o!"}},image:e||"",template:"play_turn",data:d});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),(0,Wt.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}(),Ju=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidMatchId",i.message=e||"Invalid match id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Qu=GameCore.Utils.Valid.isDebugger();console.log("WWWWWWWWWWWWWWWW ",Qu);for(var $u=[{key:"level-0",mapJson:"./assets/json/levels/level-0.json"}],td=1;td<=100;td++)$u.push({key:"level-"+td,mapJson:"./assets/json/levels/level-"+td+".json"});var ed=$u,nd=GameCore.Configs.ApiHost,id=(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single-matches",t.next=3,je("single-matches",e,{},nd);case 3:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single-matches/active",t.next=3,Ke("single-matches/active",{},nd);case 3:return e=t.sent,t.abrupt("return",(null==e?void 0:e.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="single-matches/"+e+"/move",t.next=3,je(i,n,{},nd);case 3:return a=t.sent,t.abrupt("return",(null==a?void 0:a.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="single-matches/"+e+"/finish",t.next=3,je(n,{},{},nd);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"matches",t.next=3,je("matches",{opponentPlayerId:e},{},nd);case 3:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),ad=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="matches/"+e+"/join",t.next=3,je(n,{},{},nd);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),sd=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="matches/"+e,t.next=3,Ke(n,{},nd);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),rd=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s="matches/"+e+"/finish",t.next=3,je(s,{matchId:e,score:n,level:i,extraData:a},{},nd);case 3:return r=t.sent,t.abrupt("return",(null==r?void 0:r.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),od=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidMatchStatus",i.message=e||"The match status is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),cd=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidOpponentId",i.message=e||"Invalid opponent id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),hd=cd,ld=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidBlackPlayerId",i.message=e||"Invalid black player id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),ud=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidRequestedMatchId",i.message=e||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),dd=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidScore",i.message=e||"The score is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),pd=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidWhitePlayerId",i.message=e||"Invalid white player id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),fd=function(t){var e=t.matchId,n=t.score;if(""===e||"string"!==typeof e)throw new Ju(null,{matchId:e});if("number"!==typeof n)throw new dd(null,{score:n})},gd=function(t){var e=t.matchId,n=t.currentMatchId;if(""===e||"string"!==typeof e)throw new Ju(null,{matchId:e});if(""===n||"string"!==typeof n)throw new Ju(null,{currentMatchId:n});if(e!==n)throw new ud(null,{matchId:e,currentMatchId:n})},md=function(t){var e=t.matchId,n=t.currentMatchId;if(""===e||"string"!==typeof e)throw new Ju(null,{matchId:e});if(""===n||"string"!==typeof n)throw new Ju(null,{currentMatchId:n});if(e!==n)throw new ud(null,{matchId:e,currentMatchId:n})},vd=function(t){var e=t.playerId,n=t.match,i=n._id,a=n.playerId,s=n.status;if(""===i||"string"!==typeof i)throw new Ju(null,{matchId:i});if("finished"===s||"string"!==typeof s)throw new od("This match is finished",{status:s});if(a!==e)throw new Ns(null,{playerId:a,currentPlayerId:e})},yd=function(t){var e=t.opponentId;if(""===e||"string"!==typeof e)throw new hd(null,{opponentId:e})},Sd=function(t){var e=t.matchId;if(""===e||"string"!==typeof e)throw new Ju(null,{matchId:e})},Ad=function(t){var e=t.match,n=e._id,i=e.whitePlayerId,a=e.blackPlayerId;if(""===n||"string"!==typeof n)throw new Ju(null,{matchId:n});if(""===i||"string"!==typeof i)throw new pd(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new ld(null,{blackPlayerId:a})},xd=GameCore.Configs.Match,Ed=function(t){try{return GameCore.Utils.Hash.stringToHash(O()(t))}catch(e){return""}},bd=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},wd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=window.game,i=n.player,a=n.globalScene,s=n.lang,a.screen.open(Er,{message:s.Text.LOADING,loading:!0}),e({type:Qi,payload:{}}),r=i.getPlayerId(),o=(0,Tt.default)({},xd.LocalSingleMatchDefault,{status:"active",playerId:r,startedAt:Date.now(),rescued:0}),vd({playerId:r,match:o}),e(Md(o)),Le(xd.SingleMatchStore,o),t.next=19;break;case 11:if(t.prev=11,t.t0=t.catch(0),e(Md(null)),!(t.t0 instanceof Ju)){t.next=16;break}return t.abrupt("return");case 16:if(!(t.t0 instanceof od)){t.next=18;break}return t.abrupt("return");case 18:(0,Wt.sendException)(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},Td=function(t,e){return function(n,i){try{fd((0,Tt.default)({matchId:t},e));var a=i(),s=fu(a);gd({matchId:t,currentMatchId:s}),n({type:sa,payload:{match:e}});var r=e.data;e.data=Ed(r),e.challengeMode=!1;var o=window.game.player;Le(xd.JourneyMatchStore+"-"+o.getPlayerId(),e)}catch(c){if(c instanceof Ju)return;(0,Wt.sendException)(c)}}},Cd=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r,o,c,h,l,u;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=window.game.player,Sd({matchId:t}),s=i(),r=iu(s),o=a.getPlayerId(),md({matchId:t,currentMatchId:r}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:t}}),c=nu(s),vd({playerId:o,match:c}),h=(0,Tt.default)({},xd.LocalSingleMatchDefault,c,{_id:t,status:"finished",playerId:o,finishAt:Date.now()}),n(Md(h)),l=h.data,(u=(0,Tt.default)({},h)).data=Ed(l),Le(xd.SingleMatchStore,u),e.next=26;break;case 18:if(e.prev=18,e.t0=e.catch(0),n(Md(null)),!(e.t0 instanceof Ju)){e.next=23;break}return e.abrupt("return");case 23:if(!(e.t0 instanceof od)){e.next=25;break}return e.abrupt("return");case 25:(0,Wt.sendException)(e.t0);case 26:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()},Md=function(t){return{type:ea,payload:{match:t}}},Id=function(t){return{type:ra,payload:{match:t}}},Pd=function(){return{type:na,payload:{}}},kd=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,c;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.profile,s=i.globalScene,r=i.lang,s.screen.open(Er,{message:r.Text.LOADING,loading:!0}),o=t.playerId,yd({opponentId:o}),n({type:ua,payload:{opponentInfo:t}}),e.next=8,id(o);case 8:return c=e.sent,Ad({match:c}),e.next=12,a.requestProfiles([o]);case 12:n(Dd(c)),e.next=23;break;case 15:if(e.prev=15,e.t0=e.catch(0),n(Dd(null)),!(e.t0 instanceof Ju)){e.next=20;break}return e.abrupt("return");case 20:if(!(e.t0 instanceof hd)){e.next=22;break}return e.abrupt("return");case 22:(0,Wt.sendException)(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},Rd=function(t,e){return void 0===e&&(e=!0),function(){var n=(0,Xt.default)(qt().mark((function n(i){var a,s,r,o,c,h,l,u,d,p;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,s=a.player,r=a.profile,o=a.globalScene,e&&o.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),Sd({matchId:t}),i({type:la,payload:{matchId:t}}),n.next=7,ad(t);case 7:if(c=n.sent,Ad({match:c}),h=c.status,l=c.whitePlayerId,u=c.blackPlayerId,h!==wa){n.next=16;break}return d=s.getPlayerId(),p=d===l?u:l,n.next=16,r.requestProfiles([p]);case 16:i(Dd(c)),n.next=25;break;case 19:if(n.prev=19,n.t0=n.catch(0),i(Dd(null)),!(n.t0 instanceof Ju)){n.next=24;break}return n.abrupt("return");case 24:(0,Wt.sendException)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[0,19]])})));return function(t){return n.apply(this,arguments)}}()},_d=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i){var a,s,r,o,c,h,l,u,d;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,s=a.player,a.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),Sd({matchId:t}),i({type:pa,payload:{matchId:t,opponentInfo:e}}),n.next=7,sd(t);case 7:r=n.sent,Ad({match:r}),o=r.whitePlayerId,c=r.whitePlayerScore,h=r.blackPlayerScore,l=s.getPlayerId(),u=s.getPlayerData(),d=u.score,i(Dd(r,{score:l===o?c:h,bestScore:d})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),i(Dd(null)),!(n.t0 instanceof Ju)){n.next=22;break}return n.abrupt("return");case 22:(0,Wt.sendException)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(t){return n.apply(this,arguments)}}()},Od=function(t,e,n){return function(){var i=(0,Xt.default)(qt().mark((function i(a){var s,r,o,c,h;return qt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,s=window.game,r=s.globalScene,o=s.lang,r.screen.open(Er,{message:o.Text.LOADING,loading:!0}),Sd({matchId:t}),a({type:da,payload:{matchId:t,score:e,extraData:n}}),c=n.level,i.next=8,rd(t,e,c,n);case 8:return h=i.sent,Ad({match:h}),i.next=12,a(Dd(h));case 12:i.next=20;break;case 14:if(i.prev=14,i.t0=i.catch(0),a(Dd(null)),!(i.t0 instanceof Ju)){i.next=19;break}return i.abrupt("return");case 19:(0,Wt.sendException)(i.t0);case 20:case"end":return i.stop()}}),i,null,[[0,14]])})));return function(t){return i.apply(this,arguments)}}()},Dd=function(t,e,n){return void 0===n&&(n=null),{type:fa,payload:{match:t,opponentInfo:e,current:n}}},Bd=function(t){return{type:ma,payload:{opponentInfo:t}}},Ld=function(t,e){return{type:Sa,payload:{matchId:t,players:e}}},Fd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,t.prev=2,e({type:$i,payload:{}}),t.next=6,window.FBInstant.player.getDataAsync(["level"]);case 6:s=t.sent,r=s.level,o=Be(xd.JourneyMatchStore+"-"+a)||{},c=o.data,h=o.level,o.data=bd(c),r!==h&&(o.data={}),(l=r||1)>ed.length-1&&(l=ed.length-1),u=(0,Tt.default)({},o,{level:l,playerId:a}),e({type:sa,payload:{match:u}}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(2),console.log("Erorrrrr = ",t.t0);case 21:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e){return t.apply(this,arguments)}}()},Nd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e({type:ca,payload:{}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Gd=function(t){return{type:qi,payload:{playerId:t}}},Ud=function(t,e){return{type:Zi,payload:{playerId:t,stats:e}}},Vd=function(t){return{type:Ji,payload:{stats:t}}},Yd=GameCore.Configs.Match,zd=[],Wd=function(t){var e=t.contextId;if(""===e||"string"!==typeof e)throw new Pl(null,{contextId:e})},Hd=null,Xd=function(t){clearTimeout(Hd),Hd=setTimeout((function(){window.game.globalScene.screen.close(Er)}),t)},Kd=function(){return{type:Yi,payload:{}}},jd=function(t){return{type:ji,payload:{stateShowMiniJourney:t}}},qd=function(){return function(t){try{t(Pd()),t(sp(qs))}catch(e){(0,Wt.sendException)(e)}}},Zd=function(){return function(t){try{t(Pd()),t(sp(Xs))}catch(e){(0,Wt.sendException)(e)}}},Jd=function(){return function(t){try{t(rp())}catch(e){(0,Wt.sendException)(e)}}},Qd=function(t,e){return void 0===t&&(t="10"),void 0===e&&(e=!1),function(n){try{n($d("reset",t,e))}catch(i){(0,Wt.sendException)(i)}}},$d=function(t,e,n){return void 0===e&&(e="10"),void 0===n&&(n=!1),function(){var i=(0,Xt.default)(qt().mark((function i(a){var s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A,x;return qt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,s=window.game,r=s.player,o=s.facebook,c=s.globalScene,s.lang,c.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),h=t,l=o.contextType,e||(u=GameCore.Configs.PlayerIdMock,d=GameCore.Configs.PlayerIdMock2,e=r.getPlayerId()===u?d:u),t){i.next=15;break}return i.next=9,o.chooseAsync();case 9:if(!1!==(h=i.sent)){i.next=13;break}return n&&c.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.DASHBOARD_SCENE),i.abrupt("return");case 13:i.next=25;break;case 15:if(!e||e===Hs.playerId){i.next=23;break}return i.next=18,o.createAsync(e);case 18:if(!1!==(h=i.sent)){i.next=22;break}return n&&c.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.DASHBOARD_SCENE),i.abrupt("return");case 22:h||"reset"===t||(h=t);case 23:l=o.contextType,a(tr(h,l));case 25:return Wd({contextId:h}),p=r.getPlayerId(),f=r.getConnectedPlayers(),i.next=30,o.getContextPlayers(p);case 30:return g=i.sent,e!==(m=Hs).playerId&&f[e]?m=f[e]:1===g.length&&(m=g[0]),a(Gd()),y=(v=m).playerId,S=v.name,A=v.photo,x={playerId:y,name:S,photo:A},i.next=38,a(sp(Ks,x));case 38:a(tr(h,l)),bu.emit(Ch.START_GAME),i.next=51;break;case 42:if(i.prev=42,i.t0=i.catch(0),!(i.t0 instanceof Pl)){i.next=46;break}return i.abrupt("return");case 46:if("USER_INPUT"!==(null==i.t0?void 0:i.t0.code)){i.next=48;break}return i.abrupt("return");case 48:if("INVALID_OPERATION"!==(null==i.t0?void 0:i.t0.code)){i.next=50;break}return i.abrupt("return");case 50:(0,Wt.sendException)(i.t0);case 51:return i.prev=51,Xd(1e3),i.finish(51);case 54:case"end":return i.stop()}}),i,null,[[0,42,51,54]])})));return function(t){return i.apply(this,arguments)}}()},tp=function(t){var e=window.game.player.getConnectedPlayerIds(20,0);if(!t||0===t.length)return e;for(var n=[],i=0;i<e.length;i++)u()(t).call(t,e[i])||n.push(e[i]);return n},ep=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u,d,p,f,g,m,v,y;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=window.game,i=n.player,a=n.facebook,s=n.globalScene,r=n.lang,s.screen.open(Er,{message:r.Text.LOADING,loading:!0}),o=tp(zd),c="",h="",l=a.contextType,console.log("listPlayerIds === ",zd,o),o.length>0&&(u=Phaser.Math.RND.between(0,o.length-1),c=o[u],zd.push(c),console.log("listPlayerIds === ",zd)),!c||"string"!==typeof c){t.next=13;break}return t.next=12,a.createAsync(c);case 12:h=t.sent;case 13:return Wd({contextId:h}),d=i.getPlayerId(),t.next=17,a.getContextPlayers(d);case 17:return p=t.sent,f=Hs,c||1!==p.length||(f=p[0]||Hs),e(Gd()),m=(g=f).name,v=g.photo,y={playerId:c,name:m,photo:v},t.next=25,e(sp(Ks,y));case 25:e(tr(h,l)),t.next=35;break;case 28:if(t.prev=28,t.t0=t.catch(0),!(t.t0 instanceof Pl)){t.next=34;break}return e(cp({mode:Xs,status:ba})),e(Zd()),t.abrupt("return");case 34:(0,Wt.sendException)(t.t0);case 35:return t.prev=35,Xd(1e3),t.finish(35);case 38:case"end":return t.stop()}}),t,null,[[0,28,35,38]])})));return function(e){return t.apply(this,arguments)}}()},np=function(t){return void 0===t&&(t=null),function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,c;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.facebook,s=i.globalScene,r=i.analytics,o=i.lang,s.screen.open(Er,{message:o.Text.LOADING,loading:!0}),c=a.getContextID(),Wd({contextId:c}),r.event(ni.AnalyticsEvents.JOIN_GROUP,{group_id:c}),e.next=8,n(sp(js,t));case 8:e.next=17;break;case 10:if(e.prev=10,e.t0=e.catch(0),!(e.t0 instanceof Pl)){e.next=14;break}return e.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==e.t0?void 0:e.t0.code)){e.next=16;break}return e.abrupt("return");case 16:(0,Wt.sendException)(e.t0);case 17:return e.prev=17,Xd(1e3),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,10,17,20]])})));return function(t){return e.apply(this,arguments)}}()},ip=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,u,d,p,f,g,m,v,y,S;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=window.game,r=s.player,o=s.profile,c=s.facebook,(h=s.globalScene).screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),l=a(),u=r.getPlayerId(l),!((d=r.getConnectedPlayers(l)).length>0)||d[e]){n.next=9;break}return h.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.DASHBOARD_SCENE),n.abrupt("return");case 9:return p=Hs,n.next=12,c.getContextPlayers(u);case 12:if(f=n.sent,e===u||e===p.playerId||!d[e]){n.next=17;break}p=d[e],n.next=25;break;case 17:if(1!==f.length){n.next=21;break}p=f[0],n.next=25;break;case 21:return n.next=23,o.requestProfiles([e]);case 23:(g=o.getProfiles())[e]&&(p=g[e]);case 25:return n.next=27,i(_d(t,p));case 27:if(l=a(),hu(l,{playerId:u})!==Hs.playerId){n.next=32;break}return n.next=32,i(Rd(t));case 32:if(l=a(),hu(l,{playerId:u})===u||!d[e]){n.next=37;break}return i(Qd(e,!0)),n.abrupt("return");case 37:if(ru(l)===t){n.next=41;break}return h.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.DASHBOARD_SCENE),n.abrupt("return");case 41:if(m=ou(l),v=lu(l,{playerId:u}),i(cp({mode:Ks,status:m})),y=c.getContextID(),S=c.contextType,i(tr(y,S)),!v){n.next=52;break}return n.next=50,r.requestConnectedPlayers();case 50:return h.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.GAME_OVER_SCENE),n.abrupt("return");case 52:h.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.GAME_SCENE),n.next=58;break;case 55:n.prev=55,n.t0=n.catch(0),(0,Wt.sendException)(n.t0);case 58:return n.prev=58,Xd(1e3),n.finish(58);case 61:case"end":return n.stop()}}),n,null,[[0,55,58,61]])})));return function(t,e){return n.apply(this,arguments)}}()},ap=function(t){return function(e){try{var n=window.game.player,i=n.getPlayerId();al(i,t).catch((function(t){(0,Wt.sendException)(new Error(t))}));var a=n.getPlayerData(),s=a.score,r=void 0===s?0:s,o=a.level;r<t&&n.setScore(t);var c={score:t,level:o};e(Ud(i,c)),e(Vd(c))}catch(h){if(h instanceof kl)return;(0,Wt.sendException)(h)}}},sp=function(t,e){return void 0===e&&(e=null),function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,d,p,f,g,m,v,y,S,x,E,b,w,T,C,M,I;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,r=window.game,o=r.player,c=r.analytics,h=r.facebook,l=r.globalScene,d=h.getContextID(),p=0,f=a(),c.event(ni.AnalyticsEvents.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(t),level:1,level_name:"level_1"}),i(Kd()),!u()(s=[Xs,qs]).call(s,t)){n.next=16;break}return n.next=10,i((function(t){try{var e=window.game.player;t({type:$i,payload:{}});var n=e.getPlayerId(),i=Be(xd.SingleMatchStore)||{},a=i.data;i.data=bd(a),vd({playerId:n,match:i}),t(Md(i))}catch(s){if(t(Md(null)),s instanceof Ju)return;if(s instanceof Ns)return;if(s instanceof od)return;(0,Wt.sendException)(s)}}));case 10:if(f=a(),iu(f)){n.next=15;break}return n.next=15,i(wd());case 15:p=au(f);case 16:if(t===js&&i(Bd(e)),t!==Ks){n.next=26;break}return n.next=20,i(kd(e));case 20:f=a(),g=ru(f),m=cu(f),v=m.playerId,d||(d=window.game.facebook.getContextID()),y=xu(f,{opponentId:v}),d&&v&&!y&&i(Hu(v,{contextId:d,matchId:g}));case 26:t===Zs&&i(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=window.game.player,s=a.getPlayer(),r=s.playerId,o=s.name,c=s.photo,e({type:ya,payload:{playerId:r}}),h={},De()(n=A()(i=new Array(20)).call(i,null)).call(n,(function(t,e){var n="0"+(e+1);h[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),h[r]={playerId:r,name:o,photo:c},e(Ld("mock",h));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),f=a(),S=o.getPlayerData(f),x=S.score,E=void 0===x?0:x,b=nu(f),w=b.rescued,T=void 0===w?0:w,i(Vd({score:p,bestScore:E})),i({type:zi,payload:{mode:t,contextId:d,rescued:T}}),i(er(t)),l.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.GAME_SCENE),n.next=44;break;case 37:if(n.prev=37,n.t0=n.catch(0),!(n.t0 instanceof Ju)){n.next=43;break}return C=window.game,M=C.globalScene,I=C.lang,M.screen.open(Er,{message:I.Text.NO_REWARDS+"\n"+I.Text.CANCELLED_AD,duration:2500,loading:!1}),n.abrupt("return");case 43:(0,Wt.sendException)(n.t0);case 44:return n.prev=44,Xd(0),n.finish(44);case 47:case"end":return n.stop()}}),n,null,[[0,37,44,47]])})));return function(t,e){return n.apply(this,arguments)}}()},rp=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game,a=i.analytics,s=i.facebook,r=i.globalScene,o=s.getContextID(),c=n(),h=gu(c)||1,a.event(ni.AnalyticsEvents.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(Js),level:h}),e(Kd()),c=n(),fu(c)){t.next=12;break}return t.next=12,e(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=window.game,a=i.player,i.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),e({type:ia,payload:{}}),s=n(),r=gu(s)||1,o=mu(s),c=a.getPlayerId(),h=(0,Tt.default)({},xd.LocalSingleMatchDefault,{level:r,status:"active",playerId:c,challengeMode:o,startedAt:Date.now(),updateAt:Date.now()}),vd({playerId:c,match:h}),e(Id(h)),Le(xd.JourneyMatchStore+"-"+c,h),t.next=22;break;case 14:if(t.prev=14,t.t0=t.catch(0),e(Id(null)),!(t.t0 instanceof Ju)){t.next=19;break}return t.abrupt("return");case 19:if(!(t.t0 instanceof od)){t.next=21;break}return t.abrupt("return");case 21:(0,Wt.sendException)(t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}());case 12:e({type:zi,payload:{mode:Js,contextId:o}}),r.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.JOURNEY_SCENE),t.next=23;break;case 16:if(t.prev=16,t.t0=t.catch(0),!(t.t0 instanceof Ju)){t.next=22;break}return window.game.globalScene.screen.open(Er,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),t.abrupt("return");case 22:(0,Wt.sendException)(t.t0);case 23:return t.prev=23,Xd(0),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[0,16,23,26]])})));return function(e,n){return t.apply(this,arguments)}}()},op=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,c,h,l,d,p,f,g;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=window.game.player,o=e.score,c=void 0===o?0:o,h=e.level,l=void 0===h?0:h,d=a(),!u()(s=[Xs,qs]).call(s,t)){n.next=7;break}return p=iu(d),n.next=7,i(Cd(p));case 7:if(t===js&&(i({type:va,payload:{}}),f=r.getPlayerId(),i(Ud(f,e))),t!==Ks){n.next=12;break}return g=ru(d),n.next=12,i(Od(g,c,{level:l}));case 12:i({type:Wi,payload:{mode:t}}),bu.emit(Ch.GAME_OVER);case 14:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()},cp=function(t){return function(e){var n=t.mode,i=t.status;e({type:Hi,payload:{mode:n,status:i}}),(0,Wt.addBreadcrumbSentry)("game-mode",n)}},hp=function(){return function(t,e){var n=e(),i=Su(n).level,a=void 0===i?0:i,s=_l(n);window.game.analytics.event(ni.AnalyticsEvents.MATCH_RESCUE,{game_mode:GameCore.Utils.String.toUpperCamelCase(s),level:a,level_name:"level_"+a}),t({type:Xi,payload:{}})}},lp=Ar.default.DEFAULT,up=lp.KEY,dp=lp.FRAME,pp=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).buttonPlay=void 0,i.buttonShare=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var t=i.payload.playerId;i.scene.storage.dispatch(Qd(t))},i.handleShare=function(){i.scene.storage.dispatch(Bu())},i.createBackground(),i.updateSize(),i.createAvatar(),i.createRank(),i.createUsername(),i.createScore(),i.createButtonShare(),i.createButtonPlay(),n&&i.updateInfo(n),i.scene.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(t){this.payload=(0,Tt.default)({scoreRight:!0,isHighlight:!1,useChallenge:!1,backgroundFrame:"",rank:-1},t),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore(),this.updateButton(),this.alignScoreAndButton()},n.createBackground=function(){this.background=this.scene.make.image({key:up,frame:dp.LEADERBOARD_BG_ITEM}),this.background.setWorldSize(312,60),this.background.setVisible(!1),this.add(this.background)},n.updateBackground=function(){this.payload.backgroundFrame?(this.background.setVisible(!0),this.background.setFrame(this.payload.backgroundFrame||dp.LEADERBOARD_BG_ITEM),this.background.setWorldSize(312,60)):this.background.setVisible(!1)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.createAvatar=function(){this.avatar=new Il(this.scene,{key:up,frame:dp.AVATAR_BORDER,background:dp.AVATAR_BACKGROUND,width:40,height:40,radius:30,borderWidth:5}),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-40)},n.updateAvatar=function(){var t=this.payload,e=t.playerId,n=t.photo;this.avatar.loadPhoto(e,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var t=this.payload.rank;if(t<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(t),this.updateRankText(t)},n.getRankIconFrame=function(t){var e=dp.ICON_CUP_GOLD;switch(t){case 1:e=dp.ICON_CUP_GOLD;break;case 2:e=dp.ICON_CUP_SILVER;break;case 3:e=dp.ICON_CUP_COPPER}return e},n.createRankIcon=function(t){var e=this.getRankIconFrame(t);this.rankIcon=this.scene.make.image({key:up,frame:e}),this.rankIcon.setWorldSize(28,24),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-6)},n.updateRankIcon=function(t){if(t>3)this.rankIcon.setVisible(!1);else{this.rankIcon.setVisible(!0);var e=this.getRankIconFrame(t);this.rankIcon.setWorldSize(28,24),this.rankIcon.setFrame(e)}},n.createRankText=function(t){this.rankText=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(32),text:""+t,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(t){t<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(""+t),this.rankText.setFont(qr.default.NUMBER_DARK.KEY))},n.updateRankUndefined=function(){this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),this.rankText.setText("?"),this.payload.isHighlight?this.rankText.setFont(qr.default.NUMBER_LIGHT.KEY):this.rankText.setFont(qr.default.NUMBER_DARK.KEY)},n.getShortName=function(t){var e=t.substring(0,7);return e.split(" ")[0]||e},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("FRIEND NAME"),style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"}}),this.username.setTint(7485207),this.username.setHighQuality(),Phaser.Display.Align.In.Center(this.username,this.avatar,65,.5),this.add(this.username)},n.updateUsername=function(){var t=this.payload.name;this.username.setText(this.getShortName(t)),this.username.setTint(7551258)},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.text({text:"132500",style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(36)+"px",fontStyle:"500"}}),this.scoreText.setOrigin(.5),this.score.add([this.scoreText]),this.add(this.score),Phaser.Display.Align.In.Center(this.score,this.avatar,160,0)},n.updateScore=function(){var t=this.payload.score;this.scoreText.setText(t),this.scoreText.setTint(7551258)},n.createButtonPlay=function(){this.buttonPlay=new Kr.default(this.scene,up,dp.BUTTON_CHALLENGE_LIGHT,54,36),this.buttonPlay.setName("ChallengeFriend"),Phaser.Display.Align.In.RightCenter(this.buttonPlay,this,-18,2),this.buttonPlay.onClick=this.handleChallengeFriend,this.add(this.buttonPlay)},n.createButtonShare=function(){this.buttonShare=new Kr.default(this.scene,up,dp.BUTTON_SHARE_DARK,54,36),this.buttonShare.setName("Share"),Phaser.Display.Align.In.RightCenter(this.buttonShare,this,-18,2),this.buttonShare.onClick=this.handleShare,this.add(this.buttonShare)},n.updateButton=function(){var t=this.payload,e=t.isHighlight;if(!t.useChallenge)return this.buttonShare.setVisible(!1),void this.buttonPlay.setVisible(!1);e?(this.buttonShare.setVisible(!0),this.buttonPlay.setVisible(!1)):(this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!0))},n.alignScoreAndButton=function(){this.payload.useChallenge?Phaser.Display.Align.In.Center(this.score,this.avatar,150,0):Phaser.Display.Align.In.Center(this.score,this.avatar,200,0)},n.runShowPopUpAnimation=function(t,e){this.scene.tweens.killTweensOf(this),this.showPopUp=new yl({targets:[this],delay:t,duration:e,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(t,e){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new gl({targets:n,duration:e,delay:this.scene.tweens.stagger(50,{start:t+50}),props:{scale:{duration:1e3,getStart:function(t){return.8*t.scale},getEnd:function(t){return t.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(t,e){void 0===t&&(t=0),void 0===e&&(e=300);var n=100*t;this.runShowPopUpAnimation(n,e),this.runShowItemAnimation(n,e)},n.setFrameBackground=function(t){this.background.setFrame(t)},n.setUserNameLight=function(){this.username.setTint(16640200)},n.setRankLight=function(){this.rankText.setFont(qr.default.NUMBER_LIGHT.KEY)},n.setScoreLight=function(){this.scoreText.setTint(16640200)},e}(Phaser.GameObjects.Container),fp=pp,gp=Ar.default.DEFAULT.FRAME,mp=function(t){function e(e){var n;return(n=t.call(this,e)||this).myScoreBlock=void 0,n.scene=e,n.setName("FooterBar"),n.createMyScoreBlock(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createMyScoreBlock=function(){this.myScoreBlock=new fp(this.scene),this.myScoreBlock.setFrameBackground(gp.LEADERBOARD_BG_ITEM),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this)},n.updateMyScoreBlock=function(t){this.myScoreBlock.setVisible(!0),this.myScoreBlock.updateInfo(t),this.myScoreBlock.setRankLight(),this.myScoreBlock.setScoreLight(),this.myScoreBlock.setUserNameLight(),this.myScoreBlock.runShowUpAnimation(0,1e3)},e}(Phaser.GameObjects.Container),vp=mp,yp=n(464),Sp=n(465),Ap=(function(t){function e(e){var n;return(n=t.call(this,e,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,Kt.default)(e,t)}(Phaser.GameObjects.GameObject),function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,Kt.default)(e,t);var n=e.prototype;return n.reset=function(){t.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var t;return h()(t=this.listObjects).call(t,(function(t){return void 0!=t&&t.active}))},n.updateConfig=function(t){var e;this.reset(),this.listConfigs=t,this.listObjects=A()(e=new Array(t.length)).call(e,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var t,e=this;this.listObjects instanceof Array&&De()(t=this.listObjects).call(t,(function(t){void 0!==t&&e.objects.killAndHide(t)}))},n.setItemPosition=function(t,e){var n=t.height;t.setPosition(0,n/2+(n+this.padding)*e-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(t){this.objects.incY(t);var e=this.getStartObjectIndex(),n=this.getEndObjectIndex();e!=this.startObjectIndex&&(e>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,e-1):this.addObjectIndex(e,this.startObjectIndex-1),this.startObjectIndex=e),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(t,e){for(var n=t;n<=e;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(t,e){for(var n=t;n<=e;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var s=this.objects.getFirstDead(!0),r=s.height,o=r/2+(r+i)*n+this.value-this.height/2;s.updateInfo(a[n]),s.setPosition(0,o),s.setActive(!0),s.setVisible(!0),this.addAt(s),this.listObjects[n]=s}},n.getStartObjectIndex=function(){var t=this.objHeight,e=this.padding;return Math.max(Math.floor((0-this.value)/(t+e)),0)},n.getEndObjectIndex=function(){var t=this.objHeight,e=this.padding,n=this.listConfigs,i=t+e;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,Se.default)(e,[{key:"objHeight",get:function(){var t=this.objects.getChildren();return 0==t.length?this.maxHeight=0:t[0].height}}]),e}(Sp.default));function xp(t,e){var n="undefined"!==typeof Rh()&&Oh()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return Ep(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ep(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ep(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}for(var bp=Ar.default.DEFAULT.FRAME,wp=function(t){function e(e,n,i){var a;(a=t.call(this,e)||this).currentPlayerId=void 0,a.scroller=void 0;var s=a.scene.player;return a.currentPlayerId=s.getPlayerId(),a.createReuseScroller(n,i),a.scene.add.existing((0,gr.default)(a)),a}(0,Kt.default)(e,t);var n=e.prototype;return n.createReuseScroller=function(t,e){this.scroller=new Ap(this.scene,{classType:fp,listConfigs:[],width:t,height:e,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(Ar.default.DEFAULT.KEY,Ar.default.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.updateData=function(t,e){var n=La()(t)||[];if(!(n.length<1)){for(var i,a=[],s=0,r=xp(Na()(n).call(n,(function(t,e){return+e.score-+t.score})));!(i=r()).done;){var o=i.value,c=o.playerId,h=o.photo,l=o.score,u=o.name,d=o.rank;if(c){this.currentPlayerId;var p={playerId:c,photo:h,name:u,rank:d,score:l,scoreRight:e===Fh,useChallenge:e===Nh,isHighlight:!1,backgroundFrame:""+bp.PREFIX_LEADERBOARD_BG_ITEM+s};a.push(p),++s>=2&&(s=0)}}this.scroller.updateConfig(a),this.showLeaders()}},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this,e=this.getLeaders();if(!(e.length<1)){for(var n=Math.min(e.length,6),i=0;i<n;i++){var a=e[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var s=300+100*n+250;this.scene.time.delayedCall(s,(function(){t.scroller.setEnable(!0)}))}},e}(Phaser.GameObjects.Container),Tp=wp,Cp=Ar.default.DEFAULT,Mp=Cp.KEY,Ip=Cp.FRAME,Pp=function(t){function e(e){var n;return(n=t.call(this,e)||this).leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.setSize(310,430),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.showLoading=function(t){this.loading.setVisible(t),this.showMessage(!1)},n.showMessage=function(t,e){this.message.setVisible(t),e&&(this.message.setText(e),this.messageAnimation.play())},n.createLoading=function(){this.loading=new Cl(this.scene),this.loading.setVisible(!1),this.add(this.loading)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.message.setTint(10317116),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this)},n.createContents=function(){this.createLeaders(),this.createContentBackground()},n.createLeaders=function(){this.leaders=new Tp(this.scene,310,337),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this,0,-11)},n.createContentBackground=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:Mp,frame:Ip.LEADERBOARD_BG_BOTTOM});e.setFlipY(!0),e.setWorldSize(315,22);var n=this.scene.make.image({key:Mp,frame:Ip.LEADERBOARD_BG_MIDDLE});n.setWorldSize(315,300);var i=this.scene.make.image({key:Mp,frame:Ip.LEADERBOARD_BG_BOTTOM});i.setWorldSize(315,22),t.add(e),t.add(n),t.add(i),Phaser.Display.Align.In.Center(n,t),Phaser.Display.Align.In.Center(e,n,0,-n.displayHeight/2-e.displayHeight/2),Phaser.Display.Align.In.Center(i,n,0,n.displayHeight/2+i.displayHeight/2),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-10)},n.createAnimation=function(){this.messageAnimation=new yp.default({targets:[this.message],duration:60,repeat:2})},e}(Phaser.GameObjects.Container),kp=Pp,Rp=GameCore.Configs.LeadersBoard,_p=Ar.default.DEFAULT,Op=_p.KEY,Dp=_p.FRAME,Bp=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.board=void 0,s.footerBar=void 0,s.isRequesting=void 0,s.isSwitchable=void 0,s.tabId=void 0,s.offset=void 0,s.isStateChanged=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.setVisible(!0),s.selectWorldTab(),s.runOpenAnimation(),s.board.showLoading(!0);var n=[{selector:Lh,callback:function(t){if(s.isRequesting=t,s.board.showLoading(t),!1===t){if(!s.scene)return;if(!s.visible||!s.scene.scene.isActive)return;var e=s.scene.game.storage.getState(),n=Bh(e);s.isSwitchable=!0,n&&0!==Y()(n).length?s.board.leaders.updateData(n,s.tabId):s.board.showMessage(!0,"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0440\u0435\u043a\u043e\u0440\u0434\u043e\u0432 \u043f\u0443\u0441\u0442\u0430!"),s.updatePlayerEntryAsync().catch(Wt.sendException)}}}];s.handleStateChange(n)},s.handleSelectFriendTab=function(){s.isRequesting||s.isSwitchable&&s.selectFriendTab()},s.handleSelectWorldTab=function(){s.isRequesting||s.isSwitchable&&s.selectWorldTab()},s.clickClose=function(){s.runCloseAnimation()},s.setVisible(!1),s.createPopup(),s.createTitle(),s.createBoard(),s.createFooterBar(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleStateChange=function(t){var e=this;this.isStateChanged||(t.forEach((function(t){var n=t.selector,i=t.callback;e.scene.storage.watch(n,i)})),this.isStateChanged=!0)},n.createPopup=function(){this.popup=new vo(this.scene,0,-5,340,510,{forceHeightTop:60}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-2)},n.createTitle=function(){var t=this.scene.add.container(),e=this.scene.make.image({key:Op,frame:Dp.TEXT_LEADER_BOARD});e.setWorldSize(260,25);var n=new Kr.default(this.scene,Op,Dp.BUTTON_CLOSE,35,35);n.setName("Close"),n.onClick=this.clickClose,t.add([e,n]),Phaser.Display.Align.In.Center(e,t,0,9),Phaser.Display.Align.In.Center(n,t,160,-15),this.popup.add(t),Phaser.Display.Align.In.TopCenter(t,this.popup)},n.createBoard=function(){this.board=new kp(this.scene),this.popup.add(this.board),Phaser.Display.Align.In.Center(this.board,this.popup,0,-25)},n.createFooterBar=function(){this.footerBar=new vp(this.scene),this.popup.add(this.footerBar),Phaser.Display.Align.In.Center(this.footerBar,this.popup,0,178)},n.selectFriendTab=function(){this.tabId=Nh,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.scene.storage.dispatch(dl()),this.scene.storage.dispatch(ll(Rp.LeaderboardId,Nh,Rp.Limit,this.offset))},n.selectWorldTab=function(){this.tabId=Fh,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.footerBar.myScoreBlock.setVisible(!1),this.scene.storage.dispatch(dl()),this.scene.storage.dispatch(ll(Rp.LeaderboardId,Fh,Rp.Limit,this.offset))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0),i.board.showLoading(!1),i.close()}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.updatePlayerEntryAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.scene.player.getPlayerId(),n=this.scene.player.getPlayer(),i=null,t.prev=3,t.next=6,el(e);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),i=null;case 12:a={playerId:e,name:n.name,photo:n.photo,score:""+n.data.score,rank:-1},i&&(a={playerId:e,name:n.name,photo:n.photo,score:""+i.getScore(),rank:i.getRank()}),this.footerBar.updateMyScoreBlock({playerId:a.playerId,rank:a.rank,photo:a.photo,name:a.name,score:a.score,backgroundFrame:Dp.LEADERBOARD_BG_ITEM,isHighlight:!0});case 15:case"end":return t.stop()}}),t,this,[[3,9]])})));return function(){return t.apply(this,arguments)}}(),n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),Lp=Bp,Fp=n(147),Np={LOGO:{KEY:"spine-logo",JSON:"./assets/spine/logo/logo.json",ATLAS:"./assets/spine/logo/logo.atlas",ANIMATIONS:{START_GROW:"start_grow",IDLE_GROW:"idle_grow"}},BEST_SCORE:{KEY:"best-score",JSON:"./assets/spine/best-score/newbest-trim.json",ATLAS:"./assets/spine/best-score/newbest-trim.atlas",ANIMATIONS:{ANIM:"anim5"}}},Gp=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.bestScoreSpine=void 0,n.scene=e,e.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createSpineEffect=function(){var t=this,e=this.scene.world.getPixelRatio(),n=this.scene.gameZone,i=n.width,a=n.height/2;this.bestScoreSpine=this.scene.add.spine(-i/2,a,Np.BEST_SCORE.KEY,Np.BEST_SCORE.ANIMATIONS.ANIM),this.bestScoreSpine.preMultipliedAlpha=!0,this.bestScoreSpine.scale=1/e,this.add(this.bestScoreSpine),this.bestScoreSpine.on("complete",(function(){t.bestScoreSpine.setVisible(!1)}))},n.playEffect=function(){this.bestScoreSpine?(this.bestScoreSpine.setVisible(!0),this.bestScoreSpine.play(Np.BEST_SCORE.ANIMATIONS.ANIM)):this.createSpineEffect()},e}(Phaser.GameObjects.Container),Up=n(551),Vp=n.n(Up),Yp=GameCore.Configs,zp=Yp.Gameplay,Wp=Yp.Match.Levels,Hp=function(){function t(){this.levelIndex=0,this.levels=Wp,this.recentLevel=void 0}var e=t.prototype;return e.increaseLevel=function(){this.levelIndex++},e.getCurrentTargetScore=function(){return this.levels[this.levelIndex]},e.getNextTargetScoreLevel=function(){return this.levels[this.levelIndex+1]},e.getCurrentIndex=function(){return this.levelIndex},e.updateCurrentLevelByScore=function(t){var e,n=Vp()(e=this.levels).call(e,(function(e){return e>t}));if(-1===n)return this.handleAutoGrantNewLevel(t);this.levelIndex=n;var i=this.levels[n-1];return i&&(this.recentLevel=i),this.levels[n]},e.restart=function(){this.levelIndex=0,this.recentLevel=0},e.handleAutoGrantNewLevel=function(t){var e=zp.Progress.BonusScore,n=this.levels[this.levels.length-1]+e;return this.levels.push(n),n<=t?this.handleAutoGrantNewLevel(t):(this.levelIndex=this.levels.length-1,this.recentLevel=this.levels[this.levelIndex],n)},t}(),Xp=n(247),Kp=function(){var t,e=window.game.facebook;return e?(null==(t=e.platform)?void 0:t.toLowerCase())||"":null},jp=function(){return"web"==Kp()},qp=Math.sin,Zp=Math.cos,Jp=function(t,e,n){return t*Zp(e)*n},Qp=function(t,e,n,i){return void 0===i&&(i=10),t*qp(e)*n-.5*i*Math.pow(n,2)},$p=Ar.default.GAMEPLAY_32,tf=$p.KEY,ef=$p.FRAME,nf=function(t){function e(e,n){var i;return(i=t.call(this,e,n.x+(n.padding||0),n.y+(n.padding||0),tf,ef.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenStartMission=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.scene=e,i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),e.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:tf,frame:ef.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:tf,frame:ef.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:tf,frame:ef.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:tf,frame:ef.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var t=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:t,to:0,start:t},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(t){this.rateShaking=t},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var t=this.alpha0<90?1:-1;this.t0+=3e3/1900;var e=.016*this.t0,n=Jp(this.v0,this.alpha0,e),i=Qp(this.v0,this.alpha0,e);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,console.log("this.imageBreak.y === ",e,this.t0,this.imageBreak.y),this.imageBreak.rotation+=.04*t,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},e}(Phaser.GameObjects.Image),af=nf,sf=n(86),rf=n.n(sf),of=GameCore.Configs.Board,cf=(of.cols,of.rows),hf=void 0===cf?8:cf,lf=0,uf=function(){return lf},df=function(t,e){lf=0;for(var n=[],i=t.length,a=t[0].length,s=[],r=[],o=function(e){for(var i=!0,r=0;r<a;r++)0===t[e][r].value&&(i=!1);if(i){s.push(e);for(var o=function(t){n.some((function(n){return n.x===t&&n.y===e}))||n.push({x:t,y:e})},c=0;c<a;c++)o(c)}},c=0;c<i;c++)o(c);for(var h=function(e){for(var a=!0,s=0;s<i;s++)0===t[s][e].value&&(a=!1);if(a){r.push(e);for(var o=function(t){n.some((function(n){return n.x===e&&n.y===t}))||n.push({x:e,y:t})},c=0;c<i;c++)o(c)}},l=0;l<a;l++)h(l);var u=gf(t,e);if(u&&u.length>0)for(var d=function(t){var e=u[t],i=e.x,a=e.y;n.some((function(t){return t.x===i&&t.y===a}))||n.push({x:i,y:a})},p=0;p<u.length;p++)d(p);return lf+=s.length,lf+=r.length,lf+=Math.floor(u.length/9),n},pf=function(t,e){if(0===t.length)return!1;var n=h()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||n.length<=0)},ff=function(t,e){for(var n=e.x,i=e.y,a=[],s=n;s<n+3;s++)for(var r=i;r<i+3;r++){if(0===t[r][s].value)return[];a.push({x:s,y:r})}return a},gf=function(t,e){for(var n=[],i=function(t){for(var e,n=[],i=0;i<t.length;i++){var a=(e=t[i],{x:3*Math.floor(e.x/3),y:3*Math.floor(e.y/3)});pf(n,a)||n.push(a)}return n}(e),a=0;a<i.length;a++){var s=i[a],r=ff(t,s);n.push.apply(n,r)}return n},mf=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<e;a++){for(var s=!0,r=0;r<n;r++)0===t[a][r].value&&(s=!1);s&&i.push(a)}return i},vf=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<e;r++)0===t[r][a].value&&(s=!1);s&&i.push(a)}return i},yf=function(t,e){var n=t.length,i=t[0].length;if(0===e.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<e.length;r++)if(Sf(t,s,a,e[r]))return!1;return!0},Sf=function(t,e,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(t[n+s]&&t[n+s][e+r]&&0===t[n+s][e+r].value||(a=!1));return a},Af=function(t,e){for(var n=t.length,i=t[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(Sf(t,s,a,e))return!0;return!1},xf=0,Ef=function(){return xf++,18+10*(bf()-1)},bf=function(){return xf+1},wf=function(t){var e=t;switch(t){case Lo:e="b";break;case Fo:e="c";break;case No:e="d";break;case Go:e="g";break;case Uo:e="o";break;case Vo:e="p";break;case Yo:e="q";break;case zo:e="r";break;case Wo:e="y";break;case Ko:e="l";break;case jo:e="l1";break;case qo:e="l3";break;case Zo:e="e2";break;case Jo:e="e3";break;case Qo:e="e4";break;case $o:e="e5";break;case tc:e="s1";break;case ec:e="s2";break;case nc:e="s3";break;case ic:e="tz";break;case ac:e="ta";break;case ko:e="dt";break;case Io:e="dl";break;case Po:e="dr";break;case Ro:e="db";break;case Co:e="v";break;case Mo:e="h";break;case _o:e="vl";break;case Oo:e="vr";break;case Do:e="hl";break;case Bo:e="hr"}return e},Tf=function(t){var e=t;switch(t){case"b":e=Lo;break;case"c":e=Fo;break;case"d":e=No;break;case"g":e=Go;break;case"o":e=Uo;break;case"p":e=Vo;break;case"q":e=Yo;break;case"r":e=zo;break;case"y":e=Wo;break;case"l":e=Ko;break;case"l1":e=jo;break;case"l3":e=qo;break;case"e2":e=Zo;break;case"e3":e=Jo;break;case"e4":e=Qo;break;case"e5":e=$o;break;case"s1":e=tc;break;case"s2":e=ec;break;case"s3":e=nc;break;case"tz":e=ic;break;case"ta":e=ac;break;case"dt":e=ko;break;case"dl":e=Io;break;case"dr":e=Po;break;case"db":e=Ro;break;case"v":e=Co;break;case"h":e=Mo;break;case"vl":e=_o;break;case"vr":e=Oo;break;case"hl":e=Do;break;case"hr":e=Bo}return e},Cf=function(t){for(var e=[],n="12345678x",i=t.split(""),a=0;a<i.length;a++)if(g()(n).call(n,i[a])>=0)for(var s="x"===i[a]?hf:Number(i[a]),r=0;r<s;r++)e.push({value:0,frame:"gem/gem_transparent"});else e.push({value:1,frame:Tf(i[a])});return e},Mf=function(t){var e=t.split(","),n=e[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:Tf(n[0]),direction:Tf(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,frame:Tf(e[1])}},If=Ar.default.GAMEPLAY_32,Pf=If.KEY,kf=If.FRAME,Rf=GameCore.Configs.Board,_f=Rf.cols,Of=Rf.rows,Df=function(t){function e(n,i,a){var s;return(s=t.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.cellItems=[],s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=e.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,gr.default)(s)),s.createWrapPiece(),s.listenEvents(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createWrapPiece=function(){var t=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:Pf,frame:kf.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(t,t)},n.updatePosition=function(t,e){var n=this.getContainerSize(),i=n.width,a=n.height,s=this.parent.cellSize,r=this.scene.gameZone.width;this.setPosition(t+r/6-i/2+s/2,e-a/2+s/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(t,e){this.wrapPiece.setPosition(t+this.wrapPiece.displayWidth/2,e-20)},n.listenEvents=function(){var t=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(e){t.handleDragStart(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(e){t.handleDrag(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){t.handleDragEnd(),t.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(t){this.index=t},n.setInteractiveContainer=function(){var t=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,t/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(t){var e,n,i=this;if(!this.scene.isGameOver&&this.isCanMove){null==(e=this.animScaleUp)||e.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(jr.default.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.dragStart(),this.scene.audio.playSound(Xr.default.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,s=this.getContainerSize(),r=s.width,o=s.height,c=t.worldX+this.parent.cellSize*a/2-r*a/2,h=0;if(jp())h=t.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,h=t.worldY-u}this.distancePY=t.worldY-h;var d=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(d),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:c,y:h,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(c,h);var t=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(t,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(t){if(!this.scene.isGameOver&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var e=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(e)}this.resetCellItems(),this.scene.game.updateFps(Xp.default.max);var n=this.getContainerSize().width,i=t.worldX+this.parent.cellSize*this.scale/2-n/2,a=t.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var s=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(s,this.highlightCellCanCapture.bind(this))}catch(r){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(t,e,n,i){for(var a=this,s=_f,r=Of,o=[],c=0;c<i.length;c++){var l=i[c],u=l.x,d=l.y;s>u&&(s=u),r>d&&(r=d)}for(var p=function(e){var n=t[e],s=h()(i).call(i,(function(t){return t.y===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var c=s[r];a.checkItemInArray(o,c)||o.push(c)}},f=0;f<t.length;f++)p(f);for(var g=function(t){var n=e[t],s=h()(i).call(i,(function(t){return t.x===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var c=s[r];a.checkItemInArray(o,c)||o.push(c)}},m=0;m<e.length;m++)g(m);for(var v=function(t){var e=n[t],s=h()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!s||0===s.length)return"continue";var r=s[0];a.checkItemInArray(o,r)||o.push(r)},y=0;y<n.length;y++)v(y);for(var S=function(t){var e,n=o[t],i=n.x,c=n.y,l=h()(e=a.cellItems).call(e,(function(t){return t.x===i-s&&t.y===c-r}));if(!l||0===l.length)return"continue";l[0].cell.setFrame(kf.GEM_LIGHT)},A=0;A<o.length;A++)S(A)},n.resetCellItems=function(){for(var t=0;t<this.cellItems.length;t++)this.cellItems[t].cell.setFrame(kf.GEM)},n.checkItemInArray=function(t,e){var n=h()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove){this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(jr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(Xr.default.PIECE_DROP),this.handleBoardMoveCompleted(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(jr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(t,e){return 15==t?this.parent.cellSize*e*-2:30==t?0:45==t?this.parent.cellSize*e*2:60==t?this.parent.cellSize*e*4:75==t?this.parent.cellSize*e*6:t},n.handleBoardMoveCompleted=function(){var t=this,e=this.getPositionTopLeftInBoard();if(e){var n=this.calcScore();this.scene.tutorialManager.isRunning()||(this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0));var i=e.x,a=e.y,s=this.scene.main.board.dataBoard[a][i],r=s.x+this.scene.main.board.cellPadding,o=s.y+this.scene.main.board.cellPadding,c=this.getCellsHighlight();this.scene.add.tween({targets:this,x:r,y:o,duration:50,onComplete:function(){t.updateCellsWithPadding(.5),t.scene.main.board.handleRemoveHighlight(),t.hide(),t.setScale(1),t.parent.removeActivePiece(t.index),t.scene.main.board.handleMove(c,t.onBoardHandleMoveCompleted.bind(t))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var t;if(!this.matrixData)return 0;var e=this.matrixData.length||0;if(0===e)return 0;for(var n=(null==(t=this.matrixData[0])?void 0:t.length)||0,i=0,a=0;a<e;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.scene.tutorialManager.isRunning()||(this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces())},n.drawSuggestCells=function(){var t=function(t,e){for(var n=t.length,i=t[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var c=0;c<i;c++)if(Sf(t,c,o,e)&&(s=c,r=o,++a>1))return null;if(0===a)return null;for(var h=[],l=0;l<e.data.length;l++)for(var u=0;u<e.data[l].length;u++)e.data[l][u].texture&&h.push({x:s+u,y:r+l});return h&&h.length>0?h:null}(this.scene.main.board.dataBoard,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.getPositionFirstCellHighlight=function(){var t=this.scene.main.board.dataBoard,e=this.getPositionTopLeftInBoard();if(!e)return{x:0,y:0};var n=e.x,i=e.y;return e?{x:t[i][n].x,y:-(this.scene.scale.height-this.parentHeight-t[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var t=this;this.scene.audio.playSound(Xr.default.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.invalidMove(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){t.updateCellsWithPadding(.5)}})},n.canMove=function(){var t=this.scene.main.board.dataBoard,e=this.getCellsHighlight();if(0===e.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<e.length;i++){var a=e[i],s=a.x,r=a.y;if(!t[r]||!t[r][s]||0!==t[r][s].value){n=!1;break}}if(!n||0===e.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var t=this.scene.main.board.dataBoard,e=[],n=this.getPositionTopLeftInBoard();if(null===n)return e;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return e;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=t[r]&&t[r][s]?t[r][s].x:0,c=t[r]&&t[r][s]?t[r][s].y:0;if(r>=Of||s>=_f||!t[r][s]||1===t[r][s].value)return[];e.push({x:s,y:r,pX:o,pY:c})}return e},n.getPositionTopLeftInBoard=function(){for(var t=this.scene.main.board.dataBoard,e=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,s=-1,r=0;r<Of;r++)for(var o=0;o<_f;o++)if(t[r][o].x-i/2<=e&&t[r][o].x+t[r][o].width+i/2>=e&&t[r][o].y-i/2<=n&&t[r][o].y+t[r][o].height+i/2>=n){a=o,s=r;break}return a<0||a>_f-1||s<0||s>Of-1?null:{x:a,y:s}},e.buildData=function(t){for(var e=[],n=0;n<t.length;n++){e[n]=[];for(var i=0;i<t[n].length;i++){var a=1===t[n][i]?kf.GEM:null;e[n][i]={x:i,y:n,texture:a}}}return e},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell||this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var t=this,e=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:e,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Sine.Out})},n.createCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture){var a={x:0+i*e+t,y:0+n*e+t,width:e-2*t,height:e-2*t},s=new af(this.scene,a);s.setVisible(!0),this.cells[n][i]=s,this.cellItems.push({x:i,y:n,cell:s}),this.add(s)}}this.isCreateCell=!0},n.updateCellsWithPadding=function(t){for(var e=this.parent.cellSize,n=e-2*t,i=e-2*t,a=0;a<this.data.length;a++)for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r=this.cells[a][s],o=s*e+t,c=a*e+t;r.setWorldSize(n,i),r.setPosition(o,c)}},n.getContainerSize=function(){for(var t=0,e=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>t&&(t=this.data[n].length);var i=this.parent.cellSize;return{width:t*i*this.scale,height:e*i*this.scale}},n.resetPropsCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++)for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture)Math.floor(0+i*e+t),Math.floor(e-2*t),Math.floor(e-2*t),this.texture,this.frame,jr.default.PIECE,Math.floor(0+i*e+t),Math.floor(e-2*t),Math.floor(e-2*t),this.texture,this.frame,this.type,this.direction,this.isReverse},n.setCanMove=function(t){this.isCanMove=t,this.correctAlpha=t?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive()},e}(Phaser.GameObjects.Container),Bf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e,n){void 0===n&&(n=!1);var i=[];switch(e){case Io:n?i=Mc:(i=Cc,t===jo&&(i=Ic),t===qo&&(i=Pc));break;case Po:n?i=Sc:(i=yc,t===jo&&(i=Ac),t===qo&&(i=xc));break;case ko:if(n){i=gc;break}i=fc,t===jo&&(i=mc),t===qo&&(i=vc);break;case Ro:n?i=bc:(i=Ec,t===jo&&(i=wc),t===qo&&(i=Tc))}return i},e.getData=function(t,n,i){return void 0===i&&(i=!1),e.buildData(e.getMatrixData(t,n,i))},e}(Df),Lf=Bf,Ff=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e){var n=[];switch(t){case $o:n=e===Co?Lc:Fc;break;case Qo:n=e===Co?Dc:Bc;break;case Zo:n=e===Co?kc:Rc;break;case Jo:n=e===Co?_c:Oc}return n},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(Df),Nf=Ff,Gf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){case tc:e=Nc;break;case ec:e=Gc;break;case nc:e=Uc}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(Df),Uf=Gf,Vf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Hc;break;case"right":e=Xc;break;case"top":e=Kc;break;case"bottom":e=jc}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(Df),Yf=Vf,zf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Vc;break;case"vertical_right":e=Yc;break;case"horizontal_right":e=Wc;break;case"horizontal_left":e=zc}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(Df),Wf=zf,Hf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=qc;break;case"right":e=Zc;break;case"top":e=Jc;break;case"bottom":e=Qc}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(Df),Xf=Hf,Kf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData()}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(){return $c},e.getData=function(){return e.buildData(e.getMatrixData())},e}(Df),jf=Kf,qf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getDataByDirectionCross2=function(t){var e=[];if("right"===t)e=eh;else e=th;return e},e.getDataByDirectionCross3=function(t){var e=[];if("right"===t)e=ih;else e=nh;return e},e.getDataByDirectionCross4=function(t){var e=[];if("right"===t)e=sh;else e=ah;return e},e.getDataByDirectionCross5=function(t){var e=[];if("right"===t)e=oh;else e=rh;return e},e.getMatrixData=function(t,n){var i=[];switch(t){case oc:i=e.getDataByDirectionCross2(n);break;case cc:i=e.getDataByDirectionCross3(n);break;case hc:i=e.getDataByDirectionCross4(n);break;case lc:i=e.getDataByDirectionCross5(n)}return i},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(Df),Zf=qf,Jf=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=ch;break;case"right":e=hh;break;case"top":e=lh;break;case"bottom":e=uh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(Df),Qf=Jf,$f=Ar.default.DEFAULT,tg=$f.KEY,eg=$f.FRAME,ng=function(){function t(t){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createBackground(),this.createText(),this.createTween()},e.createBackground=function(){this.background=this.scene.make.image({key:tg,frame:eg.BG_STREAK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},e.createText=function(){this.text=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X \u041f\u041e\u041b\u041e\u0421\u0410!"}),this.text.setVisible(!1)},e.createTween=function(){var t=this,e=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:e}},paused:!0,onComplete:function(){t.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){t.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:e-.3}},paused:!0,onComplete:function(){t.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){t.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y-n),t.background.setPosition(t.x,t.y-n)},onComplete:function(){t.y=t.y-20,t.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y+n),t.background.setPosition(t.x,t.y+n)},onComplete:function(){t.y=t.y+5,t.tweenStep5.play(),t.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e-.3,to:e}},paused:!0,onComplete:function(){t.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){t.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.background.setVisible(!1),t.text.setScale(0),t.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.text.setScale(0)}})},e.playAnim=function(t,e){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=t,this.y=e,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(t,e),this.background.setPosition(t,e),this.text.setVisible(!0),this.tweenTextStep1.play()},e.setTextCombo=function(t){this.text.setText(t+"X \u041a\u041e\u041c\u0411\u041e!")},e.setTextStreak=function(t){this.text.setText(t+"X \u041f\u041e\u041b\u041e\u0421\u0410!")},e.setBgFrame=function(t){this.background.setFrame(t)},t}(),ig=function(){function t(t){this.scene=void 0,this.streakBreak=void 0,this.scene=t,this.init()}return t.prototype.init=function(){this.streakBreak=new ng(this.scene)},t}(),ag=function(){function t(){}return t.create=function(t,e,n){var i;switch(n.type){case Ko:case jo:case qo:i=new Lf(t,e,n);break;case Zo:case Jo:case Qo:case $o:i=new Nf(t,e,n);break;default:i=new Uf(t,e,n);break;case ac:i=new Yf(t,e,n);break;case sc:i=new Xf(t,e,n);break;case uc:i=new Qf(t,e,n);break;case rc:i=new jf(t,e,n);break;case oc:case cc:case hc:case lc:i=new Zf(t,e,n);break;case ic:i=new Wf(t,e,n)}return i},t}(),sg=ag,rg=Ar.default.GAMEPLAY_32,og=rg.KEY,cg=rg.FRAME,hg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],e.add.existing((0,gr.default)(n)),n.scene=e,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(t,e){this.setPosition(t,e)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(t){if([tc,ec,nc].some((function(e){return e===t})))return[];var e=[];switch(t){case Ko:case jo:case qo:case ac:case sc:case uc:e=[ko,Io,Po,Ro];break;case Zo:case Jo:case Qo:case $o:e=[Co,Mo];break;case ic:e=[_o,Oo,Do,Bo];break;case rc:e=[];break;case oc:case cc:case hc:case lc:e=[Io,Po]}return e},n.createAllPieces=function(){for(var t=this.cellSize,e=[],n=0;n<dc.length;n++){var i=this.getDirectionsByType(dc[n]);if(i.length<=0)e.push({type:dc[n]});else{for(var a=0;a<i.length;a++)e.push({type:dc[n],direction:i[a]});if(Ko===dc[n])for(var s=0;s<i.length;s++)e.push({type:dc[n],direction:i[s],isReverse:!0})}}for(var r=0;r<e.length;r++){var o=(0,Tt.default)({},e[r],{texture:og,frame:cg.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2),cellLength:Math.floor(t/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2)}}),c=sg.create(this.scene,this,o);c.hide(),this.allPieces.push(c)}},n.createAllPiecesGroup=function(){for(var t=0;t<this.allPieces.length;t++){var e=this.allPieces[t];this.allPiecesGroup[e.type]||(this.allPiecesGroup[e.type]=[]),this.allPiecesGroup[e.type].push(t)}},n.randomPieces=function(){var t=this;this.scene.game.updateFps(Xp.default.max);for(var e=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*e.length),a=e[i];if(!t.allPiecesGroup[a])return"continue";var s=Math.floor(Math.random()*t.allPiecesGroup[a].length),r=t.allPiecesGroup[a][s],o=[Qo,$o].some((function(t){return t===a}));if(t.canCaptureLines.isCapture&&o){for(var c=0;c<t.allPiecesGroup[a].length;c++){var h=t.allPiecesGroup[a][c];if(t.allPieces[h]&&t.allPieces[h].direction===t.canCaptureLines.direction){r=h;break}}e=t.buildPieceRates(!1)}n.some((function(t){return t.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r];a.push({position:r,texture:og,frame:cg.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(t){void 0===t&&(t=!0);for(var e=[],n=0;n<pc.length;n++)e.push((0,Tt.default)({},pc[n]));if(t){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var s=0;s<e.length;s++)e[s].type===$o&&(e[s].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<e.length;r++)e[r].type===Qo&&(e[r].rate=8)}for(var o=[],c=0;c<e.length;c++)for(var h=e[c],l=h.type,u=h.rate,d=0;d<u;d++)o.push(l);return o},n.drawPieces=function(){for(var t=this.scene.gameZone,e=t.width,n=t.height,i=[20,e/3,2*e/3-20],a=n/2+176-13,s=a+(n-85-a)/2,r=0;r<this.piecesActive.length;r++){var o=this.allPieces[this.piecesActive[r].position],c=i[r];o.updatePosition(c,s),o.updatePositionWrapPiece(c+20*(r-1),s),o.setIndex(r),o.drawPiece(),this.allPieces[this.piecesActive[r].position]=o}},n.removeActivePiece=function(t){this.piecesActive[t].used=!0},n.existPiecesActive=function(){var t,e=h()(t=this.piecesActive).call(t,(function(t){return!t.used}));return e&&e.length>0},n.showNewPieces=function(){for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].reset();this.randomPieces(),this.setActivePieces(),this.drawPieces()},n.calculatePieceInfo=function(){for(var t=0,e=0,n=this.cellSize,i=0;i<this.piecesActive.length;i++){var a=this.allPieces[this.piecesActive[i].position].data;t+=a[0].length,a.length>e&&(e=a.length)}return{cellLength:n/2,cols:t}},n.setActivePieces=function(){for(var t=this.scene.main.board.dataBoard,e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e].position,i=Af(t,this.allPieces[n]);this.allPieces[n].setCanMove(i)}},n.getPiecesByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=vr()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==rf()(s=i[a]).call(s)){var o=Mf(rf()(r=i[a]).call(r));e.push(o)}}return e},n.getFenByPieces=function(){for(var t="l",e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e],i=n.type,a=n.direction,s=n.isReverse,r=n.frame;if(!n.used){var o=wf(i);a&&""!==a&&(o+="-"+wf(a)),s&&(o+="-r"),t+=" "+o+","+wf(r)}}return t},n.clearPieces=function(){for(var t=0;t<this.piecesActive.length;t++){var e=this.piecesActive[t].position;this.allPieces[e].hide()}this.piecesActive=[]},n.showAvailablePieces=function(t){if(t&&!(t.length<=0)){for(var e=[],n=0;n<t.length;n++)for(var i=t[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,c=0;c<this.allPieces.length;c++){var h=this.allPieces[c];if(a===h.type&&s===h.direction&&r===h.isReverse){e.push({position:c,texture:og,frame:o,type:h.type,direction:h.direction,isReverse:h.isReverse});break}}this.piecesActive=e,this.setActivePieces(),this.drawPieces()}},n.debuggerNextPieces=function(){for(var t=0;t<this.piecesActive.length;t++)this.removeActivePiece(t);for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].wrapPiece.setVisible(!1);this.showNewPieces()},e}(Phaser.GameObjects.Container),lg=Ar.default.DEFAULT,ug=lg.KEY,dg=lg.FRAME,pg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,76),e.add.existing((0,gr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createDebugButton()},n.createBackground=function(){var t=this.scene.make.image({key:ug,frame:dg.FOOTER}),e=this.scene.gameZone.width;t.setWorldSize(e,this.height),this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPieces=function(){this.pieces=new hg(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new Kr.default(this.scene,ug,dg.BUTTON_DARK_BLUE,100,30),this.debugButton.setName("Debug");var t=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([t]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},e}(Phaser.GameObjects.Container),fg=pg,gg=Ar.default.DEFAULT,mg=gg.KEY,vg=gg.FRAME,yg=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.iconCrown=void 0,n.bestScoreText=void 0,n.setPosition(0,48.5),n.createBackground(),n.createScoreText(),n.createIconCrown(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:mg,frame:vg.BEST_SCORE_FRAME}),this.background.setWorldSize(55,77),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(26),origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,25)},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:mg,frame:vg.ICON_CROWN}),this.iconCrown.setWorldSize(20,18),this.add(this.iconCrown),Phaser.Display.Align.In.Center(this.iconCrown,this.background,0,5)},n.setScoreText=function(t){this.bestScoreText.setText(String(t))},n.updateBestScoreText=function(t){var e=this.scene.storage.getState();t>Su(e).bestScore&&this.setScoreText(t)},e}(Phaser.GameObjects.Container),Sg=yg,Ag=Ar.default.DEFAULT,xg=Ag.KEY,Eg=Ag.FRAME,bg=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,xg,Eg.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),wg=bg,Tg=Ar.default.GAMEPLAY,Cg=Tg.KEY,Mg=Tg.FRAME,Ig=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=void 0,n.currentScore=0,n.scene=e,n.scene.add.existing((0,gr.default)(n)),n.createBackground(),n.createScoreText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Cg,frame:Mg.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.background,0,3)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.scoreText.setText(String(t))},n.animAddScore=function(t){var e=this,n=this.score+t;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-t,to:this.score,duration:100,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(t){var n=Math.floor(t.getValue());e.setScoreText(n),e.scene.header.bestScoreBlock.updateBestScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){e.setScoreText(e.score),e.scene.header.bestScoreBlock.updateBestScoreText(e.score),e.scene.tutorialManager.isRunning()?e.scene.tutorialManager.nextTutorial():(e.scene.handleNextTargetScore(),e.scene.bestScoreReached())}})},e}(Phaser.GameObjects.Container),Pg=Ig,kg=Ar.default.GAMEPLAY,Rg=kg.KEY,_g=kg.FRAME,Og=function(t){function e(e){var n;return(n=t.call(this,e)||this).titleSprite=void 0,n.background=void 0,n.textScore=void 0,n.avatar=void 0,n.score=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.initScoreBlockAvatar=function(){this.createAvatar(),this.createBackgroundScore(),this.createScoreText(),this.setScore(0),this.setScoreText(0)},n.createAvatar=function(){this.avatar=new Il(this.scene,{key:Rg,frame:_g.AVATAR_BORDER,background:_g.AVATAR_BACKGROUND,width:32,height:32,radius:32,borderWidth:5}),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this,0,-10)},n.createBackgroundScore=function(){this.background=this.scene.make.image({key:Rg,frame:_g.BG_SCORE}),this.background.setWorldSize(92,27),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,25)},n.createScoreText=function(){this.textScore=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(35),text:"0",origin:{x:.5,y:.5}}),this.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.background)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.textScore.setText(String(t))},e}(Phaser.GameObjects.Container),Dg=Og,Bg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.addScore=void 0,n.currentScore=0,n.scene=e,n.initScoreBlockAvatar(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(){var t=this.scene.player.getPlayer(),e=t.playerId,n=t.photo;if(this.avatar.loadPhoto(e,n),this.scene.gamePlayMode===Ks){var i=this.scene.storage.getState(),a=(Su(i)[e]||{}).score,s=void 0===a?0:a;this.textScore.setText(String(s))}},n.animAddScore=function(t){var e=this,n=this.score+t;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-t,to:this.score,duration:100,onUpdate:function(t){var n=Math.floor(t.getValue());e.setScoreText(n),e.scene.header.bestScoreBlock.updateBestScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){e.setScore(e.score),e.scene.header.bestScoreBlock.updateBestScoreText(e.score),e.setScoreText(n),e.scene.handleNextTargetScore(),e.scene.bestScoreReached()}})},e}(Dg),Lg=Bg,Fg=function(t){function e(e){var n;return(n=t.call(this,e)||this).initScoreBlockAvatar(),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.updateInfo=function(){var t=this.scene.storage.getState(),e=yu(t),n=cu(t),i=n.playerId,a=n.photo,s=(e[i]||{}).score,r=void 0===s?0:s;this.textScore.setText(String(r)),this.avatar.loadPhoto(i,a)},e}(Dg),Ng=Fg,Gg=Ar.default.EFFECTS,Ug=Gg.KEY,Vg=Gg.FRAME,Yg=function(t){function e(e){var n;return(n=t.call(this,e,Ug,Vg.FX_STAR_WHITE)||this).emitZone=void 0,n.emitter=void 0,n._isPlaying=!1,n.frequency=void 0,n.count=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var t=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({frame:Vg.DUST_YELLOW,tint:16710522,emitZone:{source:this.emitZone,type:"random"},frequency:16,speedX:{min:-25,max:-10},speedY:{min:-7,max:7},lifespan:{min:500,max:1500},alpha:{start:.7,end:.3},scale:{min:1*t,max:1.5*t},delay:300})},n.run=function(t,e,n,i,a,s){console.log(n+"-"+i+"-"+a+"-"+s),this.emitZone.setSize(a,s),this.emitZone.setPosition(n-a/2,i-s/2),e!=this.frequency&&(this.emitter.setFrequency(e),this.frequency=e),t!=this.count&&(this.emitter.setQuantity(t),this.count=t),this._isPlaying||(this.emitter.start(),this._isPlaying=!0)},n.stop=function(){var t;null==(t=this.emitter)||t.stop(),this._isPlaying=!1},n.isPlaying=function(){return this._isPlaying},e}(Phaser.GameObjects.Particles.ParticleEmitterManager),zg=Yg,Wg=Ar.default.GAMEPLAY,Hg=Wg.KEY,Xg=Wg.FRAME,Kg=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.rightWhiteProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.sparkling=void 0,a.setSize(n,i),a.scene=e,a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup(),this.createSparkling()},n.initBg=function(){this.leftBg=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BG_RIGHT});var t=this.leftBg,e=t.width,n=t.height,i=e*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var c=this.width-(i+o);this.midBg.setWorldSize(c,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BAR_RIGHT}),this.rightWhiteProgress=this.scene.make.image({key:Hg,frame:Xg.PROGRESS_BAR_RIGHT_WHITE});var t=this.leftProgress,e=t.width,n=t.height,i=e*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var c=this.rightWhiteProgress,h=c.width,l=c.height,u=h*this.height/l;this.rightWhiteProgress.setWorldSize(u,this.height);var d=this.width-(i+o)+2;this.midProgress.setWorldSize(d,this.height),this.add(this.rightWhiteProgress),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:Hg,frame:Xg.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:Hg,frame:Xg.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new xl({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(Hg),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:Xg.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createSparkling=function(){this.sparkling=new zg(this.scene),this.add(this.sparkling)},n.createMilestoneFrame=function(){var t=this.scene.make.image({key:Hg,frame:Xg.FLAG});return t.setWorldSize(16,22),t},n.getMilestoneFrame=function(){var t,e=h()(t=this.listPoolMilestoneFrame).call(t,(function(t){return!t.visible}));if(!e||0===e.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return e[0]},n.handleSetAlphaListMilestone=function(t){this.listMilestoneFrame.forEach((function(e){e.score<=t?e.frame.setAlpha(1):e.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(t){t>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(t){t.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(t){this.targetScore=t},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(t){var e=t*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth,s=this.leftBg.width+this.midBg.width+this.rightBg.width;if(this.sparkling.setPosition(),0===t)return this.rightWhiteProgress.setVisible(!1),this.sparkling.stop(),this.stopAnimGlare(),void this.stopEmitter();var r=s*(t>1?1:t),o=this.leftBg.x+r-this.leftBg.width/2+this.rightWhiteProgress.width/2-1;if(this.scene.isNextTarget?(this.runSparklingEmitZone(o-2),this.scene.isNextTarget=!1):this.sparkling.run(2,50,o,this.leftBg.y-.5,4,4),this.rightWhiteProgress.setVisible(!0),this.rightWhiteProgress.x=e-s/2+this.rightWhiteProgress.width/2-3,t>=1){this.rightWhiteProgress.x=s-this.rightProgress.x-a;var c=s-this.rightProgress.x-a;if(this.sparkling.run(2,50,c,this.leftBg.y-.5,4,4),this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}if(this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,e<n)return this.leftProgress.setVisible(!0),t<=.01?(this.leftProgress.setCrop(0,0,5,2*this.height),void(this.rightWhiteProgress.x+=2)):void this.leftProgress.setCrop(0,0,e/this.leftProgress.scaleX,2*this.height);if(e>n+i){this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),this.rightProgress.setCrop(0,0,(e-(n+i-2))/this.rightProgress.scaleX,2*this.height),this.rightWhiteProgress.x=this.rightProgress.x-2;var h=this.rightProgress.x-2;this.sparkling.run(2,50,h,this.leftBg.y-.5,4,4)}else this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,(e-n)/this.midProgress.scaleX,2*this.height)},n.runSparklingEmitZone=function(t){this.scene.tweens.add({targets:this.sparkling.emitZone,x:t,duration:400})},e}(Phaser.GameObjects.Container),jg=Ar.default.GAMEPLAY,qg=jg.KEY,Zg=jg.FRAME,Jg=function(t){function e(e){var n;return(n=t.call(this,e,qg,Zg.BUTTON_WOOD_SMALL)||this).button.setWorldSize(55,48),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:qg,frame:Zg.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,1,-1.5)},e}(Kr.default),Qg=Jg,$g=Ar.default.GAMEPLAY,tm=$g.KEY,em=$g.FRAME,nm=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.myScoreBlock=void 0,n.opponentScoreBlock=void 0,n.iconBattle=void 0,n.progressBar=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,0),e.add.existing((0,gr.default)(n)),n.createLeaf(),n.creatIconBattle(),n.createBestScoreBlock(),n.createSettingButton(),n.createMainScoreBlock(),n.createMyScoreBlock(),n.createOpponentScoreBlock(),n.createProgressBar(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLeaf=function(){var t=new wg(this.scene);this.add(t),Phaser.Display.Align.In.Center(t,this,0,t.displayHeight/2)},n.createBestScoreBlock=function(){this.bestScoreBlock=new Sg(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this,-132,-12.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new Pg(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createMyScoreBlock=function(){this.myScoreBlock=new Lg(this.scene),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this,-52,35)},n.createOpponentScoreBlock=function(){this.opponentScoreBlock=new Ng(this.scene),this.opponentScoreBlock.setVisible(!1),this.add(this.opponentScoreBlock),Phaser.Display.Align.In.Center(this.opponentScoreBlock,this,52,35)},n.createSettingButton=function(){this.buttonSetting=new Qg(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,132,51)},n.createProgressBar=function(){this.progressBar=new Kg(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92)},n.creatIconBattle=function(){this.iconBattle=this.scene.make.image({key:tm,frame:em.ICON_BATTLE}),this.iconBattle.setWorldSize(30,27),this.iconBattle.setVisible(!1),this.add(this.iconBattle),Phaser.Display.Align.In.Center(this.iconBattle,this,0,24)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!1),this.iconBattle.setVisible(!1)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!0),this.iconBattle.setVisible(!0)},e}(Phaser.GameObjects.Container),im=nm,am=Ar.default.GAMEPLAY_32.FRAME,sm=[""+am.BLOCK_GRADIENT_PREFIX+10,""+am.BLOCK_GRADIENT_PREFIX+9],rm=[],om=1;om<=10;om++)rm.push(""+am.BLOCK_GRADIENT_PREFIX+om);var cm=function(){var t=GameCore.Utils.Device,e=window.navigator.vibrate;return t.isAndroid()&&"function"===typeof e||t.isMobileWeb()&&"function"===typeof e||t.isIOS()},hm=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Math.round(e/80),i=0,a=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,FBInstant.performHapticFeedbackAsync();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log("can not haptic");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}();case 3:if(!(i<n)){t.next=11;break}return s=a(),r=(0,Ge.sleepAsync)(80),i+=1,t.next=9,mt().all([s,r]);case 9:t.next=3;break;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),lm=function(t){window.navigator.vibrate(0),window.navigator.vibrate(t)},um=function(t){try{if(!cm())return!1;var e=GameCore.Utils.Device;e.isAndroid()||e.isMobileWeb()?lm(t):e.isIOS()&&hm(t).catch((function(t){return console.log(t)}))}catch(n){}},dm=function(){function t(t){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createTweenBreaking()},e.handleShowEffect=function(t){var e=this;t&&0!==t.length&&(this.removeCaptureCell(),this.captureCells=t,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){e.breakingTween.isPlaying()||e.removeCaptureCell()}}))},e.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var t=this.scene.main.board.dataBoard,e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.removeCaptureCell=function(){var t=this.scene.main.board.dataBoard;if(this.captureCells)for(var e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.setValueCaptureCell=function(){for(var t=this.scene.main.board.dataBoard,e=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,e),a=Phaser.Math.Between(82,98)*Math.PI/180,s=Phaser.Math.Between(3,10)/1e3,r=this.captureCells[n],o=r.x,c=t[r.y][o].cell;c.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,c.imageBreak.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM),c.imageBreak.setVisible(!0),c.v0=i,c.alpha0=a,c.scaleRate0=s}},e.createTweenBreaking=function(){var t=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(e){if(t.captureCells)for(var n=t.scene.main.board.dataBoard,i=0;i<t.captureCells.length;i++){t.angle=Phaser.Math.Between(-15,15);var a=t.captureCells[i],s=a.x,r=n[a.y][s].cell,o=r.imageBreak,c=r.maxScale0,h=r.alpha0<1.57?1:-1,l=.016*e.getValue(),u=Jp(r.v0,r.alpha0,l),d=Qp(r.v0,r.alpha0,l);o.setVisible(!0),o.x=r.x0+u,o.y=r.y0+-d,o.rotation+=.04*h,o.scale>c?o.scale-=r.scaleRate0:o.scale=c}},onComplete:function(){t.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},t}(),pm=dm,fm=Ar.default.GAMEPLAY,gm=fm.KEY,mm=fm.FRAME,vm=Ar.default.GAMEPLAY_32,ym=vm.KEY,Sm=vm.FRAME,Am=Ar.default.DEFAULT.FRAME,xm=GameCore.Configs.Board,Em=xm.cols,bm=xm.rows,wm=GameCore.Configs.Gameplay.VibrateValue,Tm=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=4.5,a.borderTopSize=3,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.canCaptureLines=function(t,e){void 0===e&&(e=5);for(var n=t.length,i=t[0].length,a=[],s=[],r=[],o=0;o<n;o++){for(var c=0,h={x:-1,y:-1},l=0;l<i;l++)0===o&&(r[l]={count:0,x:-1,y:-1}),1===t[o][l].value?(r[l].count++,c++):(h.x=l,h.y=o,r[l].x=l,r[l].y=o);if(c===i-1&&s.push((0,Tt.default)({row:o},h)),o===n-1)for(var u=0;u<i;u++)r[u].count===n-1&&a.push((0,Tt.default)({col:u},r[u]))}if(s.length>=e)for(var d=0,p={x:-1,y:-1},f=0;f<s.length;f++)if(0!==f){if(s[f].x===p.x&&s[f].y===p.y+1?(p.x=s[f].x,p.y=s[f].y,d++):d=1,d>=e)return{isCapture:!0,direction:"vertical",minLine:e}}else p.x=s[f].x,p.y=s[f].y,d++;if(a.length>=e)for(var g=0,m={x:-1,y:-1},v=0;v<a.length;v++)if(0!==v){if(a[v].x===m.x+1&&a[v].y===m.y?(m.x=a[v].x,m.y=a[v].y,g++):g=1,g>=e)return{isCapture:!0,direction:"horizontal",minLine:e}}else m.x=a[v].x,m.y=a[v].y,g++;return{isCapture:!1,direction:"",minLine:e}},a.scene=e,a.setSize(n,i),a.woodenEffect=new pm(a.scene),a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var t=this.scene.gameZone,e=t.width/2,n=t.height/2-27;this.boardFrame=this.scene.make.image({x:e,y:n,key:gm,frame:mm.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=1.8,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(Em+1))/Em},n.initDataBoard=function(){for(var t=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,e=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<bm;n++){this.dataBoard[n]=[];for(var i=0;i<Em;i++){var a=t+i*this.cellSize+this.cellPadding*i,s=e+n*this.cellSize+this.cellPadding*n,r={x:a,y:s,width:this.cellSize,height:this.cellSize,texture:ym,frame:Sm.GEM_TRANSPARENT,depth:jr.default.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new af(this.scene,r);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:s,width:this.cellSize,height:this.cellSize,frame:Sm.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleTweenStartMission=function(){for(var t=this,e=100,n=0;n<bm;n++)for(var i=function(i){var a=t.dataBoard[n][i].cell,s=0;s=4==n&&4==i?e:n>=3&&n<=5&&i>=3&&i<=5?200:n>=2&&n<=6&&i>=2&&i<=6?300:n>=1&&n<=7&&i>=1&&i<=7?400:500,t.scene.time.delayedCall(s,(function(){a.playTweenStartMission()}))},a=0;a<Em;a++)i(a)},n.handleHighlight=function(t,e){this.cellsHighlight=t;for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y;if(this.dataBoard[s]&&this.dataBoard[s][a]&&0===this.dataBoard[s][a].value){var r=this.dataBoard[s][a].cell;this.dataBoard[s][a].frame=Sm.GEM,r.setVisible(!0),r.setFrame(Sm.GEM),r.setAlpha(.3)}}this.canCaptureCells(t,e)},n.handleCapturePiece=function(t){var e=this;try{!function(){if(!t||t.length<=0)throw xf=0,new Error("Invalid Capture");for(var n=300,i=0,a=mf(e.dataBoard),s=vf(e.dataBoard),r=uf(),o=function(o){var c=t[o],h=c.x,l=c.y,u=e.dataBoard[l][h].cell,d=0,p=0,f=0;if(a.length>0&&s.length>0){var m=0,v=0;i=n/Em,-1!==g()(a).call(a,l)&&-1===g()(s).call(s,h)&&(m=i*h,v=0,p=g()(a).call(a,l)),-1===g()(a).call(a,l)&&-1!==g()(s).call(s,h)&&(m=0,v=i*l,p=g()(s).call(s,h)),-1!==g()(a).call(a,l)&&-1!==g()(s).call(s,h)&&(m=i*h,v=i*l,p=Math.max(g()(s).call(s,h),g()(a).call(a,l),0)),-1===g()(a).call(a,l)&&-1===g()(s).call(s,h)&&(m=i*h,v=i*l),d=Math.max(m,v,0)}else if(s.length>0)d=(i=n/Em)*l,p=g()(s).call(s,h),f=l;else if(a.length>0)d=(i=n/bm)*h,p=g()(a).call(a,l),f=h;else{i=100;var y=t[0].x;d=i*(h-y),p=0}u.hideImageHighlight(),e.scene.time.delayedCall(d,(function(){var t="";r>2&&(s.length>=3||a.length>=3)?(t=rm[f]||rm[0],u.imageBreak.setFrame(t)):(t=sm[p]||sm[0],u.imageBreak.setFrame(t)),u.playTweenScaleDown(),0==e.dataBoard[l][h].value&&u.setVisible(!1)})),e.dataBoard[l][h].frame=Sm.GEM_TRANSPARENT,e.dataBoard[l][h].value=0},c=0;c<t.length;c++)o(c)}()}catch(n){}},n.checkPositionCellOnCaptureCell=function(t,e){var n=h()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return n&&n.length>0},n.handlePraise=function(t,e){if(e&&0!==e.length){var n=Ef(),i=uf();i>1&&(n=18*lf+10*(bf()-1));for(var a=[],s=0;s<t.length;s++){var r=t[s];this.checkPositionCellOnCaptureCell(r,e)&&a.push(r)}if(0!==a.length){for(var o=a[0].pX,c=0,h=a[0].pY,l=0,u=0;u<a.length;u++){var d=a[u];d.pX<o&&(o=d.pX),d.pX>c&&(c=d.pX),d.pY<h&&(h=d.pY),d.pY>l&&(l=d.pY)}var p=o+(c-o)/2,f=h+(l-h)/2;this.scene.main.praise.handlePraise(p,f,n,i),this.handleStreakBreak(p,f),this.playEatSound(i)}}},n.handleStreakBreak=function(t,e){if(!this.scene.tutorialManager.isRunning()){var n=uf(),i=bf()-1;if(t-75<0&&(t=75),t+75>375&&(t=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&um(s),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(Am.BG_STREAK),this.scene.effectManager.streakBreak.playAnim(t,e-20)}}},n.getVibrateByLevel=function(t){return wm[t]||0},n.playEatSound=function(t){switch(this.scene.audio.playSound(Xr.default.EAT_BLOCK,{volume:1}),t){default:break;case 2:this.scene.audio.playSound(Xr.default.GOOD);break;case 3:this.scene.audio.playSound(Xr.default.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(Xr.default.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var t=0;t<this.cellsHighlight.length;t++){var e=this.cellsHighlight[t],n=e.x,i=e.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=Sm.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(Sm.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){console.log(s)}},n.canCaptureCells=function(t,e){for(var n=this,i=this.dataBoard,a=[],s=0;s<i.length;s++){a[s]=[];for(var r=0;r<i[s].length;r++)a[s][r]=(0,Tt.default)({},i[s][r])}for(var o=0;o<t.length;o++){var c=t[o],h=c.x;a[c.y][h].value=1}this.removeAnimCanCaptureCells(a,t);var l=df(a,t);if(!l||l.length<=0)return!1;for(var u=function(e){var i=l[e],a=i.x,s=i.y;t.some((function(t){return t.x===a&&t.y===s}))||n.cellSharking.push((0,Tt.default)({},l[e]))},d=0;d<l.length;d++)u(d);for(var p=0;p<this.cellSharking.length;p++){var f=this.cellSharking[p],g=f.x,m=f.y,v=this.dataBoard[m][g].cell;v.isHighlight()||v.showImageHighlight()}e(mf(a),vf(a),gf(a,t),t)},n.removeAnimCanCaptureCells=function(t,e){var n=this;if(0!==this.cellSharking.length){for(var i=mf(t),a=vf(t),s=gf(t,e),r=function(t){var e=n.cellSharking[t],r=e.x,o=e.y,c=n.dataBoard[o][r].cell;if(-1!==g()(i).call(i,o)||-1!==g()(a).call(a,r)||s.some((function(t){return t.x===r&&t.y===o})))return"continue";c.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)r(o);this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var t=0;t<this.cellSharking.length;t++){var e=this.cellSharking[t],n=e.x,i=e.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(t){try{this.suggestCells=t;for(var e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(Sm.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){console.log(r)}},n.handleRemoveSuggestMove=function(){try{for(var t=0;t<this.suggestCells.length;t++){var e=this.suggestCells[t],n=e.x,i=e.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(Sm.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){console.log(s)}},n.handleMove=function(t,e){try{for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y;if(this.dataBoard[s]&&this.dataBoard[s][a]){this.dataBoard[s][a].frame=Sm.GEM,this.dataBoard[s][a].value=1;var r=this.dataBoard[s][a].cell;r.setVisible(!0),r.setFrame(Sm.GEM),r.setAlpha(1)}}var o=df(this.dataBoard,t);this.handleCapturePiece(o),this.checkIsGameOver()&&this.scene.setIsGameOver(!0),this.handlePraise(t,o),e&&e(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(c){console.log(c)}},n.handleResetFrameBoard=function(){for(var t=0;t<bm;t++)for(var e=0;e<Em;e++)if(this.dataBoard[t]&&this.dataBoard[t][e]&&1===this.dataBoard[t][e].value){var n=this.dataBoard[t][e],i=n.frame,a=n.cell;a.visible||(0,Wt.sendException)(new Error("Cell is invisible")),a.frame.name!==i&&(0,Wt.sendException)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.checkIsGameOver=function(){for(var t=[],e=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<e.length;i++){var a=e[i],s=a.position;if(!a.used){var r=n[s];t.push({data:r.data,type:r.type,direction:r.direction,isReverse:r.isReverse,frame:r.frame})}}return!!yf(this.dataBoard,t)},n.handleGameOver=function(){this.checkIsGameOver()&&(this.scene.disableInput(),this.runAnimationGameOver())},n.runAnimationGameOver=function(){var t=this;try{this.scene.audio.playSound(Xr.default.BOARD_GAME_OVER);for(var e=[],n=function(n){for(var i=function(i){if(t.dataBoard[n]&&t.dataBoard[n][i]&&1===t.dataBoard[n][i].value){var a=Math.floor(100*(n+1));e.push({delay:a,x:i,y:n}),t.scene.time.delayedCall(a,(function(){t.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<Em;a++)i(a)},i=0;i<bm;i++)n(i);this.scene.time.addEvent({delay:e[e.length-1].delay+300,callback:function(){t.scene.handleRequestFinishGame()}})}catch(a){console.log(a)}},n.rescue=function(){for(var t=0;t<this.dataBoard.length;t++)for(var e=0;e<this.dataBoard[t].length;e++)if(this.dataBoard[t]){var n=this.dataBoard[t][e];n&&1===n.value&&(this.dataBoard[t][e].cell.setFrame(Sm.GEM),this.dataBoard[t][e].cell.resetImageGameOver())}this.handleUseBomb()},n.hasPieceL5=function(){var t=this.scene.footer.pieces.piecesActive;return h()(t).call(t,(function(t){return t.type===$o})).length>0},n.hasPieceCross5=function(){var t=this.scene.footer.pieces.piecesActive;return h()(t).call(t,(function(t){return t.type===lc})).length>0},n.handleUseBomb=function(){try{var t=this.hasPieceL5(),e=this.hasPieceCross5(),n=Math.floor(Math.random()*bo.length),i=bo[n];t&&(i=wo[n]),e&&(i=To[n]);for(var a=[],s=i.minRow;s<i.minRow+i.rows;s++)for(var r=i.minCol;r<i.minCol+i.cols;r++)this.dataBoard[s][r].frame!==Sm.GEM_TRANSPARENT&&a.push({x:r,y:s});for(var o=0;o<a.length;o++){var c=a[o],h=c.x,l=c.y,u=this.dataBoard[l][h];u.frame=Sm.GEM_TRANSPARENT,u.value=0,u.cell.setFrame(Sm.GEM_TRANSPARENT),u.cell.setVisible(!1)}this.woodenEffect.handleShowEffect(a),this.scene.footer.pieces.setActivePieces(),this.scene.updateMatchData()}catch(d){console.log(d)}},n.getBoardByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){e[s]=[];for(var r=Cf(i[s]),o=0;o<r.length;o++)e[s][o]=r[o]}return e},n.getFenByBoard=function(){for(var t="",e=0;e<bm;e++){for(var n=0,i="",a=0;a<Em;a++){if(0===this.dataBoard[e][a].value&&n++,1===this.dataBoard[e][a].value)n>0&&(i+=n>=bm?"x":""+n,n=0),i+=""+wf(this.dataBoard[e][a].frame);a===this.dataBoard[e].length-1&&n>0&&(i+=n>=bm?"x":""+n)}t+=e===this.dataBoard.length-1?""+i:i+"/"}return t},n.startGame=function(t){if(t)for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++){var i=t[e][n],a=i.value,s=i.frame,r=this.dataBoard[e][n];1===a&&(r.value=1,r.frame=s,r.cell.setFrame(Sm.GEM),r.cell.setVisible(!0))}},n.clearBoard=function(){for(var t=0;t<bm;t++)for(var e=0;e<Em;e++){var n=this.dataBoard[t][e];n.value=0,n.frame=Sm.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(Sm.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(t){var e,n=h()(e=this.cellsHighlight).call(e,(function(e){return e.x===t.x&&e.y&&t.y}));return!!(n&&n.length>0)},e}(Phaser.GameObjects.Container),Cm=GameCore.Configs.Gameplay,Mm=Cm.VibrateValue,Im=Ar.default.EFFECTS,Pm=Im.KEY,km=Im.FRAME,Rm=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=e,e.add.existing((0,gr.default)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(Pm),this.particle.setDepth(jr.default.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:km.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(jr.default.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var t,e=this,n=this.scene.storage.getState(),i=_l(n),a=this.scene.gameZone.width/2;g()(t=[js,Ks,qs]).call(t,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:600,duration:210,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){var t;this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var e=this.scene.storage.getState(),n=_l(e),i=0;n===Xs?(i=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(i+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(i+(this.score||0))):g()(t=[js,Ks,qs]).call(t,n)>=0&&(i=this.scene.header.myScoreBlock.score,this.scene.header.myScoreBlock.setScore(i+(this.score||0)),this.scene.header.myScoreBlock.setScoreText(i+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:Pm}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(jr.default.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var t=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var e=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:e},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){t.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:e,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){t.praiseFrame.setScale(0),t.praiseFrame.setAlpha(0),t.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(jr.default.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(t,e,n,i){this.startX=t,this.startY=e+15,this.listScore.push(n);var a=t-10;this.scoreText.setPosition(a,e+15),this.scoreText.setText("+"+n),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,e+15)),this.playAnimShowScoreText(),this.handlePraiseFrameText(t,e,i);var s=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&um(s),i<=1||this.changeExplode(a,e,i)},n.getVibrateByLevel=function(t){return Mm[t]||0},n.changeExplode=function(t,e,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,t,e)},n.handlePraiseFrameText=function(t,e,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0;switch(i){case km.TEXT_COOL:a=112,s=31.5;break;case km.TEXT_GOOD:a=163.5,s=31.5;break;case km.TEXT_EXCELLENT:a=149.5,s=31}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s),this.praiseFrame.setPosition(t-a/2<0?a/2:t,e-40),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(t){return Xo[t-1]||Xo[0]||null},n.getMainFrameByLevel=function(t){if(t>6)return Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT;var e=Ho[t-1]||Ho[0];return Phaser.Utils.Array.GetRandom(e.frames)},n.reset=function(){this.createTweenScoreText()},e}(Phaser.GameObjects.Container),_m=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=e,e.add.existing((0,gr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new Tm(this.scene,354,352)},n.createPraise=function(){this.praise=new Rm(this.scene)},e}(Phaser.GameObjects.Container),Om=_m,Dm=n(469),Bm=n(470),Lm=Ar.default.DEFAULT,Fm=Lm.KEY,Nm=Lm.FRAME,Gm=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).glare=void 0,s.bestScoreText=void 0,s.tweenGlare=void 0,s.tweenScoreText=void 0,s.scorePanel=void 0,s.closeButton=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.paperFireworksCelebration=void 0,s.starTwinkle=void 0,s.scene=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.setVisible(!0),s.runOpenAnimation(),s.paperFireworksCelebration.run(0,s.scene.gameZone.height,375,200),s.scene.audio.playSound(Xr.default.CONGRATULATION),s.setBestScoreText(e.bestScore)},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.screen.close(s.name)})),bu.emit("best_score_screen_close")},s.scene=e,s.setVisible(!1),s.setDepth(Wr),s.createContent(),s.createConfetti(),s.createStarTwinkle(),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t=this,e=this.getData(["duration"])[0],n=void 0===e?0:e;this.scene.time.delayedCall(n,(function(){t.runCloseAnimation()}))},n.createConfetti=function(){this.paperFireworksCelebration=new Dm.default(this.scene),this.paperFireworksCelebration.setDepth(jr.default.ON_TOP)},n.createStarTwinkle=function(){this.starTwinkle=new Bm.default(this.scene),this.add(this.starTwinkle)},n.runAnim=function(){this.glare.setScale(0).setAlpha(0),this.bestScoreText.setScale(0).setAlpha(0),this.tweenScoreText.play(),this.tweenGlare.play()},n.createContent=function(){this.createCup(),this.createScorePanel(),this.createButtons()},n.createCup=function(){var t=this.scene.make.image({key:Fm,frame:Nm.ICON_CUP});t.setWorldSize(290,216),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-105)},n.createScorePanel=function(){this.scorePanel=this.scene.add.container();var t=this.scene.make.image({key:Fm,frame:Nm.POPUP_SCORE_PANEL});t.setWorldSize(200,56),this.scorePanel.add(t),this.bestScoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(60),origin:{x:.5,y:.5}}),this.bestScoreText.setText("0"),this.scorePanel.add(this.bestScoreText),this.add(this.scorePanel),Phaser.Display.Align.In.Center(t,this.scorePanel,0,0),Phaser.Display.Align.In.Center(this.bestScoreText,this.scorePanel,0,1.5),Phaser.Display.Align.In.Center(this.scorePanel,this,0,46.5)},n.createButtons=function(){this.createCloseButton(),this.createCloseBlueButton()},n.createCloseButton=function(){var t=new Kr.default(this.scene,Fm,Nm.BUTTON_CLOSE,0,0);t.button.setWorldSize(35,35),t.setName("Close"),this.add(t),t.onClick=this.handleClosePopup,Phaser.Display.Align.In.Center(t,this,126,-213)},n.createCloseBlueButton=function(){this.closeButton=new Kr.default(this.scene,Fm,Nm.BUTTON_DARK_BLUE_SMALL,119,46),this.closeButton.onClick=this.handleClosePopup,this.closeButton.setName("Share");var t=this.scene.make.image({key:Fm,frame:Nm.TEXT_CLOSE_BLUE});t.setWorldSize(58.5,13),this.closeButton.add(t),this.add(this.closeButton),Phaser.Display.Align.In.Center(t,this.closeButton,0,0),Phaser.Display.Align.In.Center(this.closeButton,this,0,129)},n.setBestScoreText=function(t){this.bestScoreText.setText(""+t)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this],delay:t,duration:e,props:{y:250,scale:0},onComplete:function(){i.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){var t=this;this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.scene.time.delayedCall(2e3,(function(){t.scene.postSessionScore()}))},n.runPopupEntrancesAnimation=function(t,e){var n=this;if(!this.popupShowUpAnimation){var i=this.y,a=this.scale;this.popupShowUpAnimation=new uo({targets:[this],delay:t,duration:e,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}},onComplete:function(){n.starTwinkle.run(1,0,-108,290,216),n.handleDelegate()}})}this.popupShowUpAnimation.play()},e}(GameCore.Screen),Um=Gm,Vm=n(471),Ym=Ar.default.DEFAULT,zm=Ym.KEY,Wm=Ym.FRAME,Hm=function(t){function e(e){var n;return(n=t.call(this,e,zm,Wm.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:zm,frame:Wm.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),Xm=Hm,Km=Ar.default.DEFAULT,jm=Km.KEY,qm=Km.FRAME,Zm=function(t){function e(e){var n;return(n=t.call(this,e,jm,qm.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:jm,frame:qm.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),Jm=Zm,Qm=Ar.default.DEFAULT,$m=Qm.KEY,tv=Qm.FRAME,ev=function(t){function e(e){var n;return(n=t.call(this,e,$m,tv.BUTTON_DARK_BLUE_BIG)||this).button.setWorldSize(120,55),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:$m,frame:tv.ICON_SWORD_BLUE});t.setWorldSize(22,20),this.add(t),Phaser.Display.Align.In.Center(t,this,-40)},n.createText=function(){var t=this.scene.make.image({key:$m,frame:tv.TEXT_PLAY_WITH_BLUE});t.setWorldSize(159.5,15.5),this.add(t),Phaser.Display.Align.In.Center(t,this,12)},e}(Kr.default),nv=ev,iv=Ar.default.DEFAULT,av=iv.KEY,sv=iv.FRAME,rv=function(t){function e(e){var n;return(n=t.call(this,e,av,sv.BUTTON_GREEN_BIG)||this).button.setWorldSize(120,55),n.setName("Play"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:av,frame:sv.ICON_I_PLAY});t.setWorldSize(22,27),this.add(t),Phaser.Display.Align.In.Center(t,this,-35,-2)},n.createText=function(){var t=this.scene.make.image({key:av,frame:sv.TEXT_PLAY});t.setWorldSize(74,17),this.add(t),Phaser.Display.Align.In.Center(t,this,15,-2)},e}(Kr.default),ov=rv,cv=Ar.default.DEFAULT,hv=cv.KEY,lv=cv.FRAME,uv=function(t){function e(e){var n;return(n=t.call(this,e)||this).popup=void 0,n.avatarMe=void 0,n.textScoreMe=void 0,n.avatarOpponent=void 0,n.textScoreOpponent=void 0,n.title=void 0,n.titleFrame=void 0,n.contents=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.myInfoBlock=void 0,n.tweenMyInfoBlock=void 0,n.opponentInfoBlock=void 0,n.tweenOpponentInfoBlock=void 0,n.icon=void 0,n.tweenIcon=void 0,n.iconCrown=void 0,n.tweenIconCrown=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.homeButton=void 0,n.shareButton=void 0,n.buttonClose=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(ep());case 2:bu.emit(Ch.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(Zd());case 2:bu.emit(Ch.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickShare=function(){n.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d,p,f;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,s=i.analytics,r=i.facebook,o=i.globalScene,c=i.lang,t.prev=1,o.screen.open(Er,{message:c.Text.LOADING,loading:!0}),h=n(),t.next=6,_u(h);case 6:return l=t.sent,console.log("imageShare === ",l),Cu(l),u=a.getPlayer(),d=u.playerId,p=u.name,f=u.photo,t.next=12,r.shareAsync({text:c.Text.SHARE_GAME_RESULTS,intent:"SHARE",image:l||"",data:{playerId:d,playerName:p,playerPhoto:f,type:Gs}});case 12:s.event(ni.AnalyticsEvents.SHARE,{share_content_type:"MatchResult",success:!0}),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),s.event(ni.AnalyticsEvents.SHARE,{share_content_type:"MatchResult",success:!1}),(0,Wt.sendException)(t.t0);case 19:return t.prev=19,o.screen.close(Er),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[1,15,19,22]])})));return function(e,n){return t.apply(this,arguments)}}())},n.handleShareBestScore=function(){n.scene.storage.dispatch(Mu())},n.createPopup(),n.createPopupContent(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new vo(this.scene,0,0,290,290,{forceHeightTop:54}),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createContentBackground(),this.createMyInfoBlock(),this.createOpponentInfoBlock(),this.createIcon(),this.createIconCrown(),this.createButtons(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.playButton,this.shareButton])},n.updateButtons=function(){try{this.checkExistConnectedPlayerId()?(this.playWithFriendsButton.setVisible(!0),this.playButton.setVisible(!1)):(this.playWithFriendsButton.setVisible(!1),this.playButton.setVisible(!0))}catch(t){console.log(t)}},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:hv,frame:lv.TEXT_WAITING_OPPONENT}),this.titleFrame.setWorldSize(238,25),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,10),this.buttonClose=new Kr.default(this.scene,hv,lv.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add([this.titleFrame,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createContentBackground=function(){var t=this.scene.make.image({key:hv,frame:lv.POPUP_CONTENT_BACKGROUND});t.setWorldSize(263,140),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-30)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonShare()},n.createButtonHome=function(){this.homeButton=new Xm(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.popup,-100,80)},n.clickHome=function(){this.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new nv(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.popup,0,80)},n.createButtonPlay=function(){this.playButton=new ov(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.popup,0,80)},n.createButtonShare=function(){this.shareButton=new Jm(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this.popup,100,80)},n.createMyInfoBlock=function(){this.myInfoBlock=this.scene.add.container(),this.avatarMe=new Il(this.scene,{key:hv,frame:lv.AVATAR_BORDER_BIG,background:lv.AVATAR_BACKGROUND,width:87,height:87,borderWidth:8}),this.myInfoBlock.add(this.avatarMe),Phaser.Display.Align.In.Center(this.avatarMe,this.myInfoBlock,0,0);var t=this.scene.make.image({key:hv,frame:lv.SCORE_PANEL_DARK});t.setWorldSize(95,26),this.myInfoBlock.add(t),Phaser.Display.Align.In.BottomCenter(t,this.avatarMe,0,10),this.textScoreMe=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.myInfoBlock.add(this.textScoreMe),Phaser.Display.Align.In.Center(this.textScoreMe,t),this.popup.add(this.myInfoBlock),Phaser.Display.Align.In.Center(this.myInfoBlock,this.popup,-72,-38),this.myInfoBlock.setAlpha(0),this.tweenMyInfoBlock=this.scene.tweens.add({targets:this.myInfoBlock,paused:!0,duration:200,delay:400,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createOpponentInfoBlock=function(){this.opponentInfoBlock=this.scene.add.container(),this.avatarOpponent=new Il(this.scene,{key:hv,frame:lv.AVATAR_BORDER_BIG,background:lv.AVATAR_BACKGROUND,width:87,height:87,borderWidth:8}),this.opponentInfoBlock.add(this.avatarOpponent),Phaser.Display.Align.In.Center(this.avatarOpponent,this.opponentInfoBlock,0,0);var t=this.scene.make.image({key:hv,frame:lv.SCORE_PANEL_DARK});t.setWorldSize(95,26),this.opponentInfoBlock.add(t),Phaser.Display.Align.In.BottomCenter(t,this.avatarOpponent,0,10),this.textScoreOpponent=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.opponentInfoBlock.add(this.textScoreOpponent),Phaser.Display.Align.In.Center(this.textScoreOpponent,t),this.popup.add(this.opponentInfoBlock),Phaser.Display.Align.In.Center(this.opponentInfoBlock,this.popup,72,-38),this.opponentInfoBlock.setAlpha(0),this.tweenOpponentInfoBlock=this.scene.tweens.add({targets:this.opponentInfoBlock,paused:!0,duration:200,delay:500,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createIcon=function(){this.icon=this.scene.make.image({key:hv,frame:lv.TEXT_VS}),this.icon.setWorldSize(86,16.5);var t=this.icon.scale;this.popup.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.popup,0,-30),this.icon.setAlpha(0),this.tweenIcon=this.scene.tweens.add({targets:this.icon,paused:!0,duration:200,delay:300,scale:{from:1.5,to:t},alpha:{from:0,to:1},ease:"Power1"})},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:hv,frame:lv.ICON_CROWN_BIG}),this.iconCrown.setWorldSize(50,46),this.iconCrown.setVisible(!1);var t=this.iconCrown.scale;this.popup.add(this.iconCrown),this.iconCrown.setScale(0),this.tweenIconCrown=this.scene.tweens.add({targets:this.iconCrown,paused:!0,duration:200,delay:300,scale:{from:1.5,to:t},alpha:{from:0,to:1},ease:"Power1"})},n.runCloseAnimation=function(){console.log("CLose popup result"),this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Xr.default.POPUP_SHOW),console.log("WWWWWWWW ",this.popup.scale,this.popup.visible),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.updateInfo=function(){var t=this.scene.storage.getState(),e=yu(t),n=this.scene.player.getPlayer().playerId,i=cu(t).playerId,a=lu(t,{playerId:n}),s=uu(t,{opponentId:i}),r=(e[n]||{}).score,o=void 0===r?0:r,c=(e[i]||{}).score,h=void 0===c?0:c;return this.textScoreMe.setText(String(o)),this.textScoreOpponent.setText(String(h)),a&&s?o===h?(this.titleFrame.setFrame(lv.TEXT_DRAW),this.titleFrame.setWorldSize(83.5,20.5),void this.scene.audio.playSound(Xr.default.DRAW)):o>h?(this.titleFrame.setFrame(lv.TEXT_WIN),this.titleFrame.setWorldSize(182.5,25),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarMe,-110,-80),void this.scene.audio.playSound(Xr.default.WIN)):o<h?(this.titleFrame.setFrame(lv.TEXT_LOSE),this.titleFrame.setWorldSize(193.5,20.5),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarOpponent,35,-80),void this.scene.audio.playSound(Xr.default.LOSE)):void 0:(this.titleFrame.setFrame(lv.TEXT_WAITING_OPPONENT),this.titleFrame.setWorldSize(238,25),void this.scene.audio.playSound(Xr.default.WAIT_OPPONENT))},n.loadAvatars=function(){var t=this.scene.storage.getState(),e=this.scene.player.getPlayer(),n=e.photo,i=e.playerId,a=cu(t),s=a.playerId,r=a.photo;this.avatarMe.loadPhoto(i,n,5),this.avatarOpponent.loadPhoto(s,r,5)},n.runAnim=function(){this.icon.setVisible(!0),this.myInfoBlock.setVisible(!0),this.opponentInfoBlock.setVisible(!0),this.iconCrown.setScale(0),this.tweenIconCrown.play(),this.tweenIcon.play(),this.tweenMyInfoBlock.play(),this.tweenOpponentInfoBlock.play()},n.checkExistConnectedPlayerId=function(){var t=this,e=this.scene.player.getConnectedPlayerIds(20,0),n=h()(e).call(e,(function(e){return e!==t.scene.player.getPlayerId()}));return console.log("players === ",n,zd),!(n.length<=zd.length)},e}(Phaser.GameObjects.Container),dv=uv,pv={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},fv=function(t){function e(e){return t.call(this,pv,e)||this}return(0,Kt.default)(e,t),e}(eo.default),gv=fv,mv=Ar.default.DEFAULT,vv=mv.KEY,yv=mv.FRAME,Sv=function(t){function e(e){var n;return(n=t.call(this,e,vv,yv.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("JourneyIcon"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:vv,frame:yv.ICON_BROWN_JOURNEY});t.setWorldSize(28,26),this.add(t),Phaser.Display.Align.In.Center(t,this)},e}(Kr.default),Av=Sv,xv=Ar.default.DEFAULT,Ev=xv.KEY,bv=xv.FRAME,wv=function(t){function e(e){var n;return(n=t.call(this,e)||this).popup=void 0,n.title=void 0,n.contents=void 0,n.scoreText=void 0,n.bestScoreText=void 0,n.tweenScoreText=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.scoreBlock=void 0,n.bestScoreBlock=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.homeButton=void 0,n.journeyButton=void 0,n.bestScore=void 0,n.currentScore=void 0,n.payload=void 0,n.buttonClose=void 0,n.counterAnimation=void 0,n.scoreAnimation=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(ep());case 2:bu.emit(Ch.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.scene.storage.dispatch(Zd()),bu.emit(Ch.REPLAY)},n.clickJourney1=function(){n.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)},n.initScore(),n.scene=e,n.createPopup(),n.createPopupContent(),n.createScoreAnimation(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new vo(this.scene,0,0,290,290,{forceHeightTop:54}),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.playButton,this.journeyButton])},n.updateButtons=function(){try{this.playWithFriendsButton.setVisible(!1),this.playButton.setVisible(!0)}catch(t){console.log(t)}},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:Ev,frame:bv.TEXT_YOUR_SCORE});t.setWorldSize(124.5,20.5),Phaser.Display.Align.In.Center(t,this.title,0,10),this.buttonClose=new Kr.default(this.scene,Ev,bv.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container();var t=this.scene.make.image({key:Ev,frame:bv.SCORE_PANEL});t.setWorldSize(263,70),this.scoreBlock.add(t),this.scoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(85),text:"0",origin:{x:.5,y:.5}}),this.scoreBlock.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.scoreBlock,0,4),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-78)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var t=this.scene.make.image({key:Ev,frame:bv.BEST_SCORE_FRAME_LONG});t.setWorldSize(193,77),this.bestScoreBlock.add(t),this.bestScoreText=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(44),text:"0",origin:{x:.5,y:.5}}),this.bestScoreBlock.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,16),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,65)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonJourney()},n.createButtonHome=function(){this.homeButton=new Xm(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.bestScoreBlock,-100,80)},n.clickHome=function(){this.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new nv(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.bestScoreBlock,0,80)},n.createButtonPlay=function(){this.playButton=new ov(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.bestScoreBlock,0,80)},n.createButtonJourney=function(){this.journeyButton=new Av(this.scene),this.journeyButton.onClick=this.clickJourney1,this.popup.add(this.journeyButton),Phaser.Display.Align.In.Center(this.journeyButton,this.bestScoreBlock,100,80)},n.runCloseAnimation=function(){console.log("Close popup your score"),this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(t){this.bestScoreText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Xr.default.POPUP_SHOW),console.log("WWWWWWWW ",this.popup.scale,this.popup.visible),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=Su(t),n=e.score,i=e.bestScore;if(void 0===n&&void 0===i){var a=yu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(t){this.payload=t;var e=t.bestScore,n=t.currentScore;if(this.setBestScore(e),n<=e)return this.setCurrentScore(0),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter()},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new gv({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var t,e=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(t=this.counterAnimation)||t.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(t){e.scene.audio.playSound(Xr.default.SCORE_COUNT);var n=Math.floor(t.getValue());e.runScoreAnimation(),e.setCurrentScore(n)},onComplete:function(){e.setBestScore(i<a?a:i),e.setCurrentScore(a)}})},n.setCurrentScore=function(t){this.scoreText.setText(""+t)},e}(Phaser.GameObjects.Container),Tv=wv,Cv=(GameCore.Configs.LeadersBoard,Ar.default.DEFAULT),Mv=(Cv.KEY,Cv.FRAME,function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).bestScore=void 0,s.currentScore=void 0,s.confettiLeftEffect=void 0,s.confettiRightEffect=void 0,s.queueScreens=[],s.popupYourScore=void 0,s.popupResult=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.open=function(){t.prototype.open.call((0,gr.default)(s)),s.popupYourScore.setVisible(!1),s.popupResult.setVisible(!1),s.runFadeInMaskAnimation(100,300),s.initScore(),s.updateScore(),s.showPopupYourScore(),s.scene.audio.playSound(Xr.default.GAME_OVER_SCENE)},s.onPopupClose=function(){var t,e;null==(t=s.popupYourScore)||t.runCloseAnimation(),null==(e=s.popupResult)||e.runCloseAnimation(),s.runFadeOutMaskAnimation(0,200),s.scene.time.delayedCall(300,(function(){s.close(),s.scene.screen.open(kr,{onClose:function(){s.scene.storage.dispatch(Zd()),bu.emit(Ch.START_GAME)}})}))},s.createConfettiSmallAnimation(),s.createPopups(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.showQueueScreens=function(){var t=this.queueScreens.pop();if(t&&t===Cr)this.showPopupResult()},n.showPopupBestScore=function(){},n.showPopupYourScore=function(){this.popupYourScore.setVisible(!0),this.popupYourScore.runOpenAnimation(),this.popupYourScore.updateButtons(),this.popupYourScore.updateScore()},n.showPopupResult=function(){this.popupResult.setVisible(!0),this.popupResult.runOpenAnimation(),this.popupResult.updateInfo(),this.popupResult.loadAvatars(),this.popupResult.updateButtons(),this.popupResult.runAnim()},n.updateQueueScreens=function(){this.updateQueueResultScreen()},n.updateQueueResultScreen=function(){var t,e=this.scene.storage.getState(),n=_l(e);if(-1!==g()(t=[Ks,js,qs]).call(t,n)&&ru(e)){var i=cu(e).playerId;n===js&&i===Hs.playerId||this.queueScreens.push(Cr)}},n.createPopups=function(){this.createPopupYourScore(),this.createPopupResult()},n.createPopupYourScore=function(){this.popupYourScore=new Tv(this.scene),this.popupYourScore.setVisible(!1),this.popupYourScore.buttonClose.onClick=this.onPopupClose,this.add(this.popupYourScore),Phaser.Display.Align.In.Center(this.popupYourScore,this,0,0)},n.createPopupResult=function(){this.popupResult=new dv(this.scene),this.popupResult.setVisible(!1),this.popupResult.buttonClose.onClick=this.onPopupClose,this.add(this.popupResult),Phaser.Display.Align.In.Center(this.popupResult,this,0,-61)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Vm.default(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Vm.default(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(jr.default.ON_TOP),this.confettiRightEffect.setDepth(jr.default.ON_TOP)},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=Su(t),n=e.score,i=e.bestScore;if(this.bestScore=i,void 0===n||void 0===i){var a=yu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen)),Iv=Mv,Pv=n(248),kv=n.n(Pv),Rv=function(t){return t.lives},_v=(0,be.createSelector)([function(t){return Rv(t).lives}],(function(t){return t})),Ov=(0,be.createSelector)([function(t){return Rv(t).lastBonusLifeTime}],(function(t){return t})),Dv=(0,be.createSelector)([function(t){return Rv(t).countDownStartAt}],(function(t){return t})),Bv=GameCore.Configs,Lv=Bv.Match,Fv=Bv.Lives,Nv=function(t){return function(e){setTimeout((function(){e(Vv()),e(Uv()),e(Gv())}),t)}},Gv=function(){return function(t){var e=60*Fv.bonusDurationMins*1e3;setInterval((function(){t(Vv()),t(Uv())}),e)}},Uv=function(){return function(t){t({type:ms,payload:{}})}},Vv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=_v(r),(c=Fv.bonusLife+o)>Fv.livesCapacity&&(c=Fv.livesCapacity),h={lives:c,lastBonusLifeTime:(new Date).getTime()},e({type:fs,payload:{data:h}}),t.next=11,window.FBInstant.player.setDataAsync({lives:h});case 11:Le(Lv.LivesStore+"-"+s,h),t.next=16;break;case 14:t.prev=14,t.t0=t.catch(0);case 16:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}()},Yv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=_v(r),c=Ov(r),(h=o-Fv.bonusLife)>Fv.livesCapacity&&(h=Fv.livesCapacity),h<0&&(h=0),e({type:fs,payload:{data:l={lives:h,lastBonusLifeTime:c}}}),t.next=13,window.FBInstant.player.setDataAsync({lives:l});case 13:Le(Lv.LivesStore+"-"+s,l),t.next=18;break;case 16:t.prev=16,t.t0=t.catch(0);case 18:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,n){return t.apply(this,arguments)}}()},zv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=n(),a=_v(i)||0,s=Ov(i)){t.next=8;break}return t.next=7,e(Wv({lives:a,lastBonusLifeTime:(new Date).getTime()}));case 7:return t.abrupt("return");case 8:return r=(new Date).getTime(),o=Math.floor((r-s)/1e3/(60*Fv.bonusDurationMins)),(c=o+a)>Fv.livesCapacity&&(c=Fv.livesCapacity),h={lives:c,lastBonusLifeTime:c===a?s:(new Date).getTime()},t.next=15,e(Wv(h));case 15:t.next=19;break;case 17:t.prev=17,t.t0=t.catch(0);case 19:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,n){return t.apply(this,arguments)}}()},Wv=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game.player,a=i.getPlayer(),s=a.playerId,n({type:fs,payload:{data:t}}),e.next=5,window.FBInstant.player.setDataAsync({lives:t});case 5:Le(Lv.LivesStore+"-"+s,t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Hv=n(63),Xv=Ar.default.GAMEPLAY_32.FRAME,Kv="vertical",jv="horizontal",qv="left",Zv="right",Jv="top",Qv="bottom",$v="vertical_left",ty="vertical_right",ey="horizontal_left",ny="horizontal_right",iy="gem/gem",ay="gem/diamond/diamond-10",sy="gem/diamond/diamond-11",ry="gem/diamond/diamond-12",oy="gem/diamond/diamond-13",cy="gem/diamond/diamond-14",hy="gem/diamond/diamond-15",ly="gem/ruby/ruby-20",uy="gem/sapphire/sapphire-30",dy=[{level:1,frames:[],width:480,height:189},{level:2,frames:[Ar.default.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[Ar.default.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[Ar.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],py=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],fy="l",gy="l_1",my="l_3",vy="line_2",yy="line_3",Sy="line_4",Ay="line_5",xy="square_1",Ey="square_2",by="square_3",wy="trapezoid",Ty="triangle",Cy="t_piece",My="plus_piece",Iy="cross_piece_2",Py="cross_piece_3",ky="cross_piece_4",Ry="cross_piece_5",_y="u_piece",Oy=[fy,gy,my,vy,yy,Sy,Ay,xy,Ey,by,Ty,wy,Cy,My,Iy,Py,ky,Ry,_y],Dy=[{type:fy,rate:3},{type:gy,rate:4},{type:my,rate:2},{type:vy,rate:16},{type:yy,rate:12},{type:Sy,rate:8},{type:Ay,rate:4},{type:xy,rate:16},{type:Ey,rate:8},{type:Ty,rate:4},{type:wy,rate:4},{type:Cy,rate:2},{type:My,rate:1},{type:Iy,rate:4},{type:Py,rate:2},{type:ky,rate:1},{type:_y,rate:2}],By=[[1,0],[1,0],[1,1]],Ly=[[0,1],[0,1],[1,1]],Fy=[[1,0],[1,1]],Ny=[[1,0,0],[1,0,0],[1,1,1]],Gy=[[1,1,1],[1,0,0]],Uy=[[1,1,1],[0,0,1]],Vy=[[1,1],[1,0]],Yy=[[1,1,1],[1,0,0],[1,0,0]],zy=[[1,1],[0,1],[0,1]],Wy=[[1,1],[1,0],[1,0]],Hy=[[1,1],[0,1]],Xy=[[1,1,1],[0,0,1],[0,0,1]],Ky=[[0,0,1],[1,1,1]],jy=[[1,0,0],[1,1,1]],qy=[[0,1],[1,1]],Zy=[[0,0,1],[0,0,1],[1,1,1]],Jy=[[1],[1]],Qy=[[1,1]],$y=[[1],[1],[1]],tS=[[1,1,1]],eS=[[1],[1],[1],[1]],nS=[[1,1,1,1]],iS=[[1],[1],[1],[1],[1]],aS=[[1,1,1,1,1]],sS=[[1]],rS=[[1,1],[1,1]],oS=[[1,1,1],[1,1,1],[1,1,1]],cS=[[1,0],[1,1],[0,1]],hS=[[0,1],[1,1],[1,0]],lS=[[1,1,0],[0,1,1]],uS=[[0,1,1],[1,1,0]],dS=[[0,1],[1,1],[0,1]],pS=[[1,0],[1,1],[1,0]],fS=[[0,1,0],[1,1,1]],gS=[[1,1,1],[0,1,0]],mS=[[0,0,1],[1,1,1],[0,0,1]],vS=[[1,0,0],[1,1,1],[1,0,0]],yS=[[0,1,0],[0,1,0],[1,1,1]],SS=[[1,1,1],[0,1,0],[0,1,0]],AS=[[0,1,0],[1,1,1],[0,1,0]],xS=[[1,0],[0,1]],ES=[[0,1],[1,0]],bS=[[1,0,0],[0,1,0],[0,0,1]],wS=[[0,0,1],[0,1,0],[1,0,0]],TS=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],CS=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],MS=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],IS=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],PS=[[1,1],[0,1],[1,1]],kS=[[1,1],[1,0],[1,1]],RS=[[1,0,1],[1,1,1]],_S=[[1,1,1],[1,0,1]],OS={1:Xv.GEM,10:Xv.GEM_DIAMOND_10,11:Xv.GEM_DIAMOND_11,12:Xv.GEM_DIAMOND_12,13:Xv.GEM_DIAMOND_13,14:Xv.GEM_DIAMOND_14,15:Xv.GEM_DIAMOND_15},DS={1:{type:xy,direction:null,isReverse:!1,data:sS},I2:{type:vy,direction:Kv,isReverse:!1,data:Jy},I3:{type:yy,direction:Kv,isReverse:!1,data:$y},I4:{type:Sy,direction:Kv,isReverse:!1,data:eS},I5:{type:Ay,direction:Kv,isReverse:!1,data:iS},II2:{type:vy,direction:jv,isReverse:!1,data:Qy},II3:{type:yy,direction:jv,isReverse:!1,data:tS},II4:{type:Sy,direction:jv,isReverse:!1,data:nS},II5:{type:Ay,direction:jv,isReverse:!1,data:aS},J1:{type:fy,direction:Jv,isReverse:!0,data:By},J2:{type:fy,direction:qv,isReverse:!0,data:jy},J3:{type:fy,direction:Qv,isReverse:!0,data:Wy},J4:{type:fy,direction:Zv,isReverse:!0,data:Uy},L1:{type:fy,direction:Jv,isReverse:!1,data:By},L2:{type:fy,direction:Zv,isReverse:!1,data:Gy},L3:{type:fy,direction:Qv,isReverse:!1,data:zy},L4:{type:fy,direction:qv,isReverse:!1,data:Ky},O:{type:Ey,direction:null,isReverse:!1,data:rS},"polyplet-left-2":{type:Iy,direction:qv,isReverse:!1,data:xS},"polyplet-left-3":{type:Py,direction:qv,isReverse:!1,data:bS},"polyplet-left-4":{type:ky,direction:qv,isReverse:!1,data:TS},"polyplet-left-5":{type:Ry,direction:qv,isReverse:!1,data:MS},"polyplet-right-2":{type:Iy,direction:Zv,isReverse:!1,data:ES},"polyplet-right-3":{type:Py,direction:Zv,isReverse:!1,data:wS},"polyplet-right-4":{type:ky,direction:Zv,isReverse:!1,data:CS},"polyplet-right-5":{type:Ry,direction:Zv,isReverse:!1,data:IS},S1:{type:wy,direction:ny,isReverse:!1,data:uS},S2:{type:wy,direction:$v,isReverse:!1,data:cS},T1:{type:Ty,direction:Jv,isReverse:!1,data:fS},T2:{type:Ty,direction:Zv,isReverse:!1,data:pS},T3:{type:Ty,direction:Qv,isReverse:!1,data:gS},T4:{type:Ty,direction:qv,isReverse:!1,data:dS},TT1:{type:Cy,direction:Qv,isReverse:!1,data:SS},TT2:{type:Cy,direction:qv,isReverse:!1,data:mS},TT3:{type:Cy,direction:Jv,isReverse:!1,data:yS},TT4:{type:Cy,direction:Zv,isReverse:!1,data:vS},U1:{type:_y,direction:Jv,isReverse:!1,data:RS},U2:{type:_y,direction:Zv,isReverse:!1,data:kS},U3:{type:_y,direction:Qv,isReverse:!1,data:_S},U4:{type:_y,direction:qv,isReverse:!1,data:PS},V1:{type:gy,direction:Zv,isReverse:!1,data:Vy},V2:{type:gy,direction:Qv,isReverse:!1,data:Hy},V3:{type:gy,direction:Jv,isReverse:!1,data:Fy},V4:{type:gy,direction:qv,isReverse:!1,data:qy},VV1:{type:my,direction:Zv,isReverse:!1,data:Yy},VV2:{type:my,direction:Qv,isReverse:!1,data:Xy},VV3:{type:my,direction:Jv,isReverse:!1,data:Ny},VV4:{type:my,direction:qv,isReverse:!1,data:Zy},X:{type:My,direction:null,isReverse:!1,data:AS},Z1:{type:wy,direction:ey,isReverse:!1,data:lS},Z2:{type:wy,direction:ty,isReverse:!1,data:hS}},BS=GameCore.Configs.Board,LS=(BS.cols,BS.rows,0),FS=function(){return LS},NS=function(t,e){LS=0;for(var n=[],i=t.length,a=t[0].length,s=[],r=[],o=function(e){for(var i=!0,r=0;r<a;r++)0===t[e][r].value&&(i=!1);if(i){s.push(e);for(var o=function(i){n.some((function(t){return t.x===i&&t.y===e}))||n.push({x:i,y:e,frame:t[e][i].frame})},c=0;c<a;c++)o(c)}},c=0;c<i;c++)o(c);for(var h=function(e){for(var a=!0,s=0;s<i;s++)0===t[s][e].value&&(a=!1);if(a){r.push(e);for(var o=function(i){n.some((function(t){return t.x===e&&t.y===i}))||n.push({x:e,y:i,frame:t[i][e].frame})},c=0;c<i;c++)o(c)}},l=0;l<a;l++)h(l);var u=VS(t,e);if(u&&u.length>0)for(var d=function(e){var i=u[e],a=i.x,s=i.y;n.some((function(t){return t.x===a&&t.y===s}))||n.push({x:a,y:s,frame:t[s][a].frame})},p=0;p<u.length;p++)d(p);return LS+=s.length,LS+=r.length,LS+=Math.floor(u.length/9),n},GS=function(t,e){if(0===t.length)return!1;var n=h()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||n.length<=0)},US=function(t,e){for(var n=e.x,i=e.y,a=[],s=n;s<n+3;s++)for(var r=i;r<i+3;r++){if(0===t[r][s].value)return[];a.push({x:s,y:r})}return a},VS=function(t,e){for(var n=[],i=function(t){for(var e,n=[],i=0;i<t.length;i++){var a=(e=t[i],{x:3*Math.floor(e.x/3),y:3*Math.floor(e.y/3)});GS(n,a)||n.push(a)}return n}(e),a=0;a<i.length;a++){var s=i[a],r=US(t,s);n.push.apply(n,r)}return n},YS=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<e;a++){for(var s=!0,r=0;r<n;r++)0===t[a][r].value&&(s=!1);s&&i.push(a)}return i},zS=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<e;r++)0===t[r][a].value&&(s=!1);s&&i.push(a)}return i},WS=function(t,e){var n=t.length,i=t[0].length;if(0===e.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<e.length;r++)if(HS(t,s,a,e[r]))return!1;return!0},HS=function(t,e,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(t[n+s]&&t[n+s][e+r]&&0===t[n+s][e+r].value||(a=!1));return a},XS=function(t,e){for(var n=t.length,i=t[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(HS(t,s,a,e))return!0;return!1},KS=0,jS=function(){return KS+1},qS=function(t){var e=t;switch(t){case iy:e="g";break;case ay:e="d10";break;case sy:e="d11";break;case ry:e="d12";break;case oy:e="d13";break;case cy:e="d14";break;case hy:e="d15";break;case ly:e="r20";break;case uy:e="s30";break;case fy:e="l";break;case gy:e="l1";break;case my:e="l3";break;case vy:e="e2";break;case yy:e="e3";break;case Sy:e="e4";break;case Ay:e="e5";break;case xy:e="s1";break;case Ey:e="s2";break;case by:e="s3";break;case wy:e="tz";break;case Ty:e="ta";break;case My:e="pl";break;case Cy:e="tp";break;case Iy:e="cr2";break;case Py:e="cr3";break;case ky:e="cr4";break;case Ry:e="cr5";break;case _y:e="up";break;case Jv:e="dt";break;case qv:e="dl";break;case Zv:e="dr";break;case Qv:e="db";break;case Kv:e="v";break;case jv:e="h";break;case $v:e="vl";break;case ty:e="vr";break;case ey:e="hl";break;case ny:e="hr"}return e},ZS=function(t){var e=t;switch(t){case"g":e=iy;break;case"d10":e=ay;break;case"d11":e=sy;break;case"d12":e=ry;break;case"d13":e=oy;break;case"d14":e=cy;break;case"d15":e=hy;break;case"r20":e=ly;break;case"s30":e=uy;break;case"b":case"c":case"d":case"g":case"o":case"p":case"q":case"r":case"y":e="gem/gem";break;case"l":e=fy;break;case"l1":e=gy;break;case"l3":e=my;break;case"e2":e=vy;break;case"e3":e=yy;break;case"e4":e=Sy;break;case"e5":e=Ay;break;case"s1":e=xy;break;case"s2":e=Ey;break;case"s3":e=by;break;case"tz":e=wy;break;case"ta":e=Ty;break;case"pl":e=My;break;case"tp":e=Cy;break;case"cr2":e=Iy;break;case"cr3":e=Py;break;case"cr4":e=ky;break;case"cr5":e=Ry;break;case"up":e=_y;break;case"dt":e=Jv;break;case"dl":e=qv;break;case"dr":e=Zv;break;case"db":e=Qv;break;case"v":e=Kv;break;case"h":e=jv;break;case"vl":e=$v;break;case"vr":e=ty;break;case"hl":e=ey;break;case"hr":e=ny}return e},JS=function(t){for(var e=[],n=t.split(","),i=0;i<n.length;i++){var a=n[i],s=ZS(a);"x"===a?e.push({value:0,frame:"gem/gem_transparent"}):e.push({value:1,frame:s})}return e},QS=function(t){var e=t.split("|"),n=e[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:ZS(n[0]),direction:ZS(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,fenPiece:e[1]}},$S=Ar.default.DEFAULT,tA=$S.KEY,eA=$S.FRAME,nA=Ar.default.GAMEPLAY,iA=nA.KEY,aA=nA.FRAME,sA=Ar.default.GAMEPLAY_32,rA=sA.KEY,oA=sA.FRAME,cA=GameCore.Configs,hA=cA.Network,lA=cA.Board,uA=function(t){function e(e,n,i,a){var s;(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var t=s.getData(["onClose"])[0];s.scene.screen.close(s.name),t&&t()}))},s.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}};try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(Wr),s.background.setAlpha(.5)}catch(r){console.log("ex === ",r)}return s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=gu(t),n=ed[e];n||(n=ed[ed.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.scene.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(a,s),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Wt.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!gu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Fd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:hA.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(Er)},n.createPopup=function(){this.popup=new vo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:tA,frame:eA.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.buttonClose=new Kr.default(this.scene,tA,eA.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:tA,frame:eA.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:tA,frame:eA.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=gu(n),a=ed[i];a||(a=ed[ed.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,Hv.isArray)(s)&&!(s.length<2))for(var r=s[0].value,o=kv()(t=kv()(e=kv()(r).call(r,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),c=JSON.parse(o),h=Y()(c),l=this.calcPosition(h.length),u=0;u<h.length;u++){var d=h[u],p=OS[d],f=c[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:rA,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:iA,frame:aA.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<lA.rows;t++){this.boardCellData[t]=[];for(var e=0;e<lA.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=oA.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(s)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=pu(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<lA.rows;t++)for(var e=0;e<lA.cols;e++){this.boardCellData[t][e].setFrame(oA.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=rf()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=ZS(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=gu(t),n=ed[e],i=this.scene.make.tilemap({key:n.key}).layers;if((0,Hv.isArray)(i)){var a=i[0].data;if((0,Hv.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=OS[c.index-1];this.boardCellData[s][o].setFrame(h)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:rA,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Kr.default(this.scene,tA,eA.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:tA,frame:eA.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:tA,frame:eA.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this,e=this.scene.storage.getState();_v(e)<1?this.scene.screen.open(zr):(this.scene.storage.dispatch(Yv()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=gu(e);n>ed.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Jd()))})))},n.getLevelName=function(t){var e;return"journey_"+Sr()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),dA=Ar.default.DEFAULT,pA=dA.KEY,fA=dA.FRAME,gA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textTargetScore=void 0,s.textScore=void 0,s.backgroundContent=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this);var e=this.scene.levelManager.getCurrentTargetScore();this.textScore.setText(""+e),this.runOpenAnimation()},n.createPopup=function(){this.popup=new vo(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:pA,frame:fA.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:pA,frame:fA.TEXT_NEXT_MILESTONE});t.setWorldSize(234.5,24.5),this.title.add([t]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextTargetScore(),this.createTextScore()},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.popup,0,-60)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.popup,0,-15)},n.createButtons=function(){this.createButtonContinue()},n.createButtonContinue=function(){var t=this.scene.make.image({key:pA,frame:fA.TEXT_PLAY});t.setWorldSize(83,19),this.buttonContinue=new Kr.default(this.scene,pA,fA.BUTTON_GREEN,172,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t);var e=this.scene.make.image({key:pA,frame:fA.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonContinue.add(e),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(t,this.buttonContinue,20,-2),Phaser.Display.Align.In.Center(e,this.buttonContinue,-50,-2),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,0,55)},n.clickButtonContinue=function(){this.scene.nextLevel(),this.runCloseAnimation()},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.scene.main.board.handleTweenStartMission(),n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),mA=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).textMain=void 0,i.payload=void 0,i.chars=void 0,i.listText=[],i.tweenText=void 0,i.payload=n,i.createTextMain(),i.initListText(),i.createAnim(),i.scene.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createTextMain=function(){var t=this.payload,e=t.font,n=t.size,i=t.text;this.textMain=this.scene.make.bitmapText({font:e,size:n,origin:{x:.5,y:.5},text:i}).setVisible(!1),this.add(this.textMain)},n.initListText=function(){var t=this.payload,e=t.text,n=t.font,i=t.size;if(e){this.chars=e.split("");for(var a=0,s=0;s<this.chars.length;s++){var r=this.chars[s],o=this.scene.make.bitmapText({font:n,size:i,origin:{x:.5,y:.5},text:r});this.listText.push(o),a+=o.width}for(var c=-a/2+4,h=0;h<this.chars.length;h++){var l=this.listText[h],u=0;"!"===l.text&&(u=-5),"W"===l.text&&(u=6),l.setX(c+u),l.setAlpha(0),c+=l.width+1}this.add(this.listText)}},n.createAnim=function(){this.tweenText=this.scene.tweens.add({targets:this.listText,paused:!0,duration:150,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Back.easeOut",delay:this.scene.tweens.stagger(100,{})})},n.runAnim=function(){this.resetListText(),this.tweenText.play()},n.resetListText=function(){for(var t=0;t<this.listText.length;t++)this.listText[t].setScale(0).setAlpha(0)},n.restart=function(){this.resetListText()},n.start=function(t){var e=this;void 0===t&&(t=0),t?this.scene.time.addEvent({delay:t,callback:function(){e.runAnim()}}):this.runAnim()},e}(Phaser.GameObjects.Container),vA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textNoSpaceLeft=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.runPopupEntrancesAnimation(300,300),s.handleDelegate()},s.close=function(){t.prototype.close.call((0,gr.default)(s))},s.scene=e,s.setDepth(Wr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.textNoSpaceLeft.setVisible(!1),e.textNoSpaceLeft.restart(),e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new mA(this.scene,{text:"\u041c\u0415\u0421\u0422\u0410 \u041d\u0415 \u041e\u0421\u0422\u0410\u041b\u041e\u0421\u042c!",font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(76)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},e}(GameCore.Screen),yA=Ar.default.DEFAULT,SA=yA.KEY,AA=yA.FRAME,xA=GameCore.Configs.Match,EA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.isUseRescue=void 0,s.countdownCount=void 0,s.popup=void 0,s.skipText=void 0,s.continueButton=void 0,s.tweenContinueButton=void 0,s.continueButtonAnimation=void 0,s.textRescueTime=void 0,s.tweenTextRescueTime=void 0,s.progressCircle=void 0,s.skipTextTween=void 0,s.countdownTimer=void 0,s.bgProgress=void 0,s.popupShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.open=function(){t.prototype.open.call((0,gr.default)(s)),s.scene.audio.playSound(Xr.default.RESCUE_TIME),s.runOpenAnimation()},s.close=function(){t.prototype.close.call((0,gr.default)(s)),s.bgProgress.setVisible(!1),s.progressCircle.setVisible(!1),s.continueButton.setVisible(!1),s.skipText.setVisible(!1),s.textRescueTime.setScale(0).setAlpha(0)},s.handleShowRewardedVideoAd=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=s.scene.game,n=e.globalScene,i=e.lang,a=e.audio,s.countdownTimer.remove(),t.prev=2,!s.isUseRescue){t.next=5;break}return t.abrupt("return");case 5:return s.isUseRescue=!0,s.scene.audio.pauseMusic(),n.screen.open(Er,{message:i.Text.LOADING_AD,duration:0,loading:!0}),a.pauseMusic(),a.muteAll(),t.next=12,s.scene.ads.showRewardedVideoAsync();case 12:s.scene.storage.dispatch(hp()),s.scene.analytics.showRewardedVideoAd(s.scene.getSceneName()),n.screen.close(Er),bu.emit(Ch.RESCUE),s.scene.screen.close(s.name),s.scene.audio.playSound(Xr.default.DAILY_REWARD),n.screen.close(Er),t.next=29;break;case 21:if(t.prev=21,t.t0=t.catch(2),s.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,s.getScreenName(),t.t0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=28;break}if("USER_INPUT"!==t.t0.code){t.next=28;break}return s.showNotifySkipAds(),t.abrupt("return");case 28:s.showNotifyNoAds();case 29:return t.prev=29,s.scene.audio.unmuteAll(),s.scene.audio.playMusic(),s.scene.ads.preloadRewardedVideoAsync().catch((function(t){return console.log(t)})),t.finish(29);case 34:case"end":return t.stop()}}),t,null,[[2,21,29,34]])}))),s.showNotifyNoAds=function(t){if(!t||t.name===Er){var e=s.scene.game,n=e.globalScene,i=e.lang;n.screen.events.off(GameCore.Screens.Events.CLOSE),n.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),n.screen.open(Er,{message:i.Text.NO_ADS_TO_DISPLAY,duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var t=s.scene.game,e=t.globalScene,n=t.lang;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(Er,{message:n.Text.NO_REWARDS+"\n"+n.Text.CANCELLED_AD,duration:3e3,loading:!1})},s.showGameOver=function(t){t&&t.name!==Er||(s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.endGame())},s.handleSkip=function(){s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.endGame()},s.handleRunCountdown=function(){s.countdownCount-=1,s.countdownCount<=0?s.rescueTimeout():s.setTime(s.countdownCount)},s.scene=e,s.countdownCount=xA.MaxRescueCount,s.setDepth(Wr),s.background.setAlpha(.5),s.createPopup(),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.tweenTextRescueTime.play(),this.skipText.setVisible(!0),this.skipTextTween.play(),this.tweenContinueButton.play()},n.updateInfo=function(){var t=this.scene.storage.getState(),e=Su(t);this.textRescueTime.setText(String(e.score||0))},n.setTime=function(t){this.textRescueTime.setText(""+t),Phaser.Display.Align.In.Center(this.textRescueTime,this.zone,0,-42)},n.createPopup=function(){this.popup=new vo(this.scene,0,-5,290,310),this.add(this.popup)},n.createContent=function(){this.createTitle(),this.createTextRescueTime(),this.createBgProgressCircle(),this.createProgressCircle(),this.createContinueButton(),this.createSkipText()},n.createTitle=function(){var t=this.scene.add.container(),e=this.scene.make.image({key:SA,frame:AA.TEXT_SECOND_CHANGE});e.setWorldSize(194.5,24),Phaser.Display.Align.In.Center(e,t,0,12),t.add([e]),this.popup.add(t),Phaser.Display.Align.In.TopCenter(t,this.popup,0,-2)},n.createTextRescueTime=function(){this.textRescueTime=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(140),origin:{x:.5,y:.5}}),this.textRescueTime.setOrigin(.5).setScale(0).setAlpha(0),this.add(this.textRescueTime),Phaser.Display.Align.In.Center(this.textRescueTime,this,0,-40),this.tweenTextRescueTime=this.scene.tweens.add({delay:100,targets:this.textRescueTime,paused:!0,duration:200,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Power1"})},n.createProgressCircle=function(){this.progressCircle=this.scene.add.graphics(),this.add(this.progressCircle)},n.setProgressCircle=function(t){var e=Phaser.Math.DegToRad(-90),n=Phaser.Math.DegToRad(t-360-90);this.progressCircle.clear(),this.progressCircle.beginPath(),this.progressCircle.lineStyle(7,16762368),this.progressCircle.arc(0,-44,54,e,n,!0,.02),this.progressCircle.strokePath(),this.progressCircle.closePath()},n.runCountdown=function(){this.startProgressCircle();var t={delay:1e3,loop:!0,callback:this.handleRunCountdown};this.countdownTimer=this.scene.time.addEvent(t)},n.startProgressCircle=function(){var t=this;this.scene.tweens.addCounter({from:0,to:360,duration:1e3*xA.RescueGamePopupTimeout,onUpdate:function(e){var n=+e.getValue().toFixed(2);t.setProgressCircle(n)},onComplete:function(){t.setProgressCircle(0),t.progressCircle.setAlpha(1)}})},n.createBgProgressCircle=function(){this.bgProgress=this.scene.make.image({key:SA,frame:AA.BG_PROGRESS_CIRCLE}),this.bgProgress.setWorldSize(115,115),this.popup.add(this.bgProgress),Phaser.Display.Align.In.Center(this.bgProgress,this.popup,0,-38)},n.rescueTimeout=function(){this.countdownTimer.remove(),this.scene.screen.close(this.name),this.scene.endGame()},n.createContinueButton=function(){this.continueButton=new Kr.default(this.scene,SA,AA.BUTTON_GREEN,160,54),this.continueButton.setName("Continue"),this.add(this.continueButton),this.continueButton.onClick=this.handleShowRewardedVideoAd;var t=this.scene.add.image(0,0,SA,AA.ICON_ADS);t.setWorldSize(30,27),Phaser.Display.Align.In.Center(t,this.continueButton,-54,-2.5),this.continueButton.add(t);var e=this.scene.make.image({key:SA,frame:this.scene.lang.Texture.CONTINUE});e.setWorldSize(99,16),this.continueButton.add(e),Phaser.Display.Align.In.Center(e,this.continueButton,19,-2),Phaser.Display.Align.In.Center(this.continueButton,this.textRescueTime,0,115),this.continueButton.setScale(0).setAlpha(0),this.tweenContinueButton=this.scene.tweens.add({paused:!0,targets:this.continueButton,ease:so.default,props:{alpha:{from:0,to:1},scale:{from:1.2,to:1}},delay:300,duration:300})},n.createSkipText=function(){this.skipText=new Kr.default(this.scene,SA,this.scene.lang.Texture.NO_THANKS,98,17),this.skipText.setName("NoThanks"),this.add(this.skipText),this.skipText.onClick=this.handleSkip,Phaser.Display.Align.In.BottomCenter(this.skipText,this.continueButton,0,43.5),this.skipText.setVisible(!1).setAlpha(0),this.skipTextTween=this.scene.tweens.add({targets:this.skipText,delay:xA.DelayNoThank,paused:!0,alpha:{from:0,to:1},ease:"Power1",duration:500})},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runPopupEntrancesAnimation=function(t,e){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.bgProgress.setVisible(!0),n.progressCircle.setVisible(!0),n.continueButton.setVisible(!0),n.skipText.setVisible(!0),n.runAnim(),n.updateInfo(),n.isUseRescue=!1,n.countdownCount=xA.RescueGamePopupTimeout,n.setTime(n.countdownCount),n.runCountdown()}})}this.popupShowUpAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),bA=EA,wA=n(559),TA=n.n(wA),CA=function(t,e,n){return void 0===e&&(e=.1),void 0===n&&(n=.04),e*t+TA()(t)*n*t*t},MA=function(t){function e(n){var i;return(i=t.call(this,n)||this).windX=1,i.airFrictionX=.05,i.airFrictionY=.01,i._lastRotaion=0,i.rotationRate=Math.random()+e.bonusRotationRate<.5?-1:1,i.scaleXNumber=i.getRandomFloat(.1,.2),i.scaleYNumber=i.scaleXNumber,i.scaleRate=-1,i.maxScale=i.getRandomFloat(.5,1),i.deltaAlpha=0,i.airFrictionX=.01*Math.random()+(e.bonusAirFrictionX||.007),i.airFrictionY=.004*Math.random()+(e.bonusAirFrictionY||.006),i.maxScale=Math.max(i.scaleXNumber,i.maxScale),i.alpha=0,(0,gr.default)(i)||(0,gr.default)(i)}(0,Kt.default)(e,t);var n=e.prototype;return n.getRandomNumberBetween=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},n.getRandomFloat=function(t,e){return Math.random()*(e-t)+t},n.setValueAirFrictionX=function(t){e.bonusAirFrictionX=t,this.airFrictionX=.01*Math.random()+(e.bonusAirFrictionX||.007)},n.setValueAirFrictionY=function(t){e.bonusAirFrictionY=t},n.setValueRotationRate=function(t){e.bonusRotationRate=t},n.reset=function(){this.scaleXNumber=this.getRandomFloat(.3,.8),this.scaleYNumber=this.scaleXNumber,this.scaleRate=-1,this.alpha=0,this.deltaAlpha=0},n.update=function(e,n,i){for(var a=t.prototype.update.call(this,e,n,i),s=.5,r=e;r>16.67;)this.velocityX-=CA(this.velocityX,s,this.airFrictionX)/60,this.velocityY-=CA(this.velocityY,s,this.airFrictionY)/60,r-=16.67;if(this.velocityX-=CA(this.velocityX,s,this.airFrictionX)*r/1e3,this.velocityY-=CA(this.velocityY,s,this.airFrictionY)*r/1e3,this._lastRotaion=this.rotation,this.lifeCurrent>3*this.life/4)this.scaleX=this.maxScale,this.scaleY=this.maxScale,this.deltaAlpha+=e/(this.life/4),this.alpha=this.deltaAlpha;else if(this.lifeCurrent>0){var o=this.scaleRate>0?this.maxScale:1;this.scaleXNumber+=o*this.scaleRate*(e/(3*this.life/4)*3),this.scaleYNumber+=o*this.scaleRate*(e/(3*this.life/4)*3),this.scaleX=this.scaleXNumber,this.scaleY=this.scaleYNumber,this.alpha=this.deltaAlpha,this.scaleX<=0&&(this.scaleRate=1),this.scaleX>=this.maxScale&&(this.scaleRate=-1)}else this.reset();return a},e}(Phaser.GameObjects.Particles.Particle);MA.bonusAirFrictionX=0,MA.bonusAirFrictionY=0,MA.bonusRotationRate=0,MA.scaleXNumber=void 0,MA.scaleYNumber=void 0,MA.bonusAirFrictionX=0,MA.bonusAirFrictionY=0,MA.bonusRotationRate=0,MA.scaleXNumber=Math.random(),MA.scaleYNumber=Math.random();var IA=MA,PA=Ar.default.EFFECTS,kA=PA.KEY,RA=PA.FRAME,_A=function(t){function e(e){var n;return(n=t.call(this,e,kA)||this).position1={x:-70,y:-180},n.emitterStar1=void 0,n.circleImage1=void 0,n.tweenShowCircle1=void 0,n.tweenHideCircle1=void 0,n.position2={x:-20,y:190},n.emitterStar2=void 0,n.circleImage2=void 0,n.tweenShowCircle2=void 0,n.tweenHideCircle2=void 0,n.position3={x:90,y:0},n.emitterStar3=void 0,n.circleImage3=void 0,n.tweenShowCircle3=void 0,n.tweenHideCircle3=void 0,n.setDepth(jr.default.ON_TOP+1),n.createEmitterStars(),n.createTweenCircle(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createEmitterStars=function(){var t=[RA.GLARE_CROSS,RA.DUST],e=[16636263,5289969,15880535];this.emitterStar1=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position1.x,y:this.position1.y,speed:{min:50,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:IA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar2=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position2.x,y:this.position2.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:IA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar3=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position3.x,y:this.position3.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:IA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}})},n.createTweenCircle=function(){var t=this;this.circleImage1=this.scene.make.image({x:this.position1.x,y:this.position1.y,key:kA,frame:RA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle1.play()}}),this.tweenHideCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage1.setVisible(!1),t.emitterStar1.stop()}}),this.circleImage2=this.scene.make.image({x:this.position2.x,y:this.position2.y,key:kA,frame:RA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle2.play()}}),this.tweenHideCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage2.setVisible(!1),t.emitterStar2.stop()}}),this.circleImage3=this.scene.make.image({x:this.position3.x,y:this.position3.y,key:kA,frame:RA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle3.play()}}),this.tweenHideCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage3.setVisible(!1),t.emitterStar3.stop()}})},n.getImages=function(){return[this.circleImage1,this.circleImage2,this.circleImage3]},n.playConfettiAnimation=function(){var t=this;this.scene.time.addEvent({delay:300,callback:function(){t.emitterStar1.flow(1e4,30),t.circleImage1.setVisible(!0),t.tweenShowCircle1.play()},callbackScope:this}),this.scene.time.addEvent({delay:800,callback:function(){t.emitterStar2.flow(1e4,25),t.circleImage2.setVisible(!0),t.tweenShowCircle2.play()},callbackScope:this}),this.scene.time.addEvent({delay:1300,callback:function(){t.emitterStar3.flow(1e4,30),t.circleImage3.setVisible(!0),t.tweenShowCircle3.play()},callbackScope:this})},e}(Phaser.GameObjects.Particles.ParticleEmitterManager),OA=_A,DA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textScoreReached=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.starSuperTwinkle=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.scene.enableInput(),s.runPopupEntrancesAnimation(300,300),s.textScoreReached.restart(),s.scene.audio.playSound(Xr.default.SCORE_REACHED)},s.close=function(){t.prototype.close.call((0,gr.default)(s))},s.scene=e,s.setDepth(Wr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.textScoreReached.start(),n.starSuperTwinkle.playConfettiAnimation(),n.handleDelegate(),n.runAnim()}})),this.tweenBackground.play()},n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText(),this.createAnim()},n.createText=function(){this.textScoreReached=new mA(this.scene,{text:"\u0421\u0427\u0415\u0422 \u0414\u041e\u0421\u0422\u0418\u0413\u041d\u0423\u0422!",font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textScoreReached),Phaser.Display.Align.In.Center(this.textScoreReached,this)},n.createAnim=function(){this.starSuperTwinkle=new OA(this.scene),this.add(this.starSuperTwinkle),this.add(this.starSuperTwinkle.getImages())},e}(GameCore.Screen),BA=Ar.default.DEFAULT,LA=BA.KEY,FA=BA.FRAME,NA=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).onClick=void 0,i.options=void 0,i.text=void 0,i.panel=void 0,i.icon=void 0,i.animOn=void 0,i.animOff=void 0,i.setSize(n.width,n.height),i.options=n,i.createPanel(),i.createIcon(),i.createText(),i.createAnimation(),i.updateStatus(i.options.enable),i.createInput(),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createInput=function(){var t=this;this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){t.options.enable?t.animOff.play():t.animOn.play(),t.onClick&&t.onClick(!t.options.enable)}))},n.createPanel=function(){this.panel=this.scene.make.image({key:LA,frame:FA.BUTTON_TOGGLE_ON}),this.panel.setWorldSize(this.width,this.height),this.add(this.panel),Phaser.Display.Align.In.Center(this.panel,this)},n.createIcon=function(){this.icon=this.scene.make.image({key:LA,frame:FA.BUTTON_CIRCLE}),this.icon.setWorldSize(27,27),this.add(this.icon),Phaser.Display.Align.In.LeftCenter(this.icon,this)},n.createText=function(){this.text=this.scene.make.image({key:LA}),this.text.setWorldSize(30,17),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.panel)},n.createAnimation=function(){var t=this;this.animOn=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:-this.panel.width/2+this.icon.width/2,to:this.panel.width/2-this.icon.width/2-3},onComplete:function(){t.text.setFrame(FA.TEXT_ON),t.text.setWorldSize(35,15.5),t.panel.setFrame(FA.BUTTON_TOGGLE_ON),t.panel.setWorldSize(t.width,t.height),Phaser.Display.Align.In.LeftCenter(t.text,t.panel,-15),t.options.enable=!0}}),this.animOff=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:this.panel.width/2-this.icon.width/2,to:-this.panel.width/2+this.icon.width/2},onComplete:function(){t.text.setFrame(FA.TEXT_OFF),t.text.setWorldSize(50.5,15.5),t.panel.setFrame(FA.BUTTON_TOGGLE_OFF),t.panel.setWorldSize(t.width,t.height),Phaser.Display.Align.In.RightCenter(t.text,t.panel,-10),t.options.enable=!1}})},n.updateStatus=function(t){this.options.enable=t,t?this.animOn.play():this.animOff.play()},e}(Phaser.GameObjects.Container),GA=NA,UA=Ar.default.DEFAULT,VA=UA.KEY,YA=UA.FRAME,zA=function(t){function e(e){var n;return(n=t.call(this,e,VA,YA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:VA,frame:YA.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),WA=zA,HA=Ar.default.DEFAULT,XA=HA.KEY,KA=HA.FRAME,jA=function(t){function e(e){var n;return(n=t.call(this,e,XA,KA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Journey"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:XA,frame:KA.ICON_JOURNEY_2});t.setWorldSize(35,28),this.add(t),Phaser.Display.Align.In.Center(t,this,-.25,-1.5)},e}(Kr.default),qA=jA,ZA=Ar.default.DEFAULT,JA=ZA.KEY,QA=ZA.FRAME,$A=function(t){function e(e){var n;return(n=t.call(this,e,JA,QA.BUTTON_DARK_BLUE)||this).button.setWorldSize(246,53),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:JA,frame:QA.ICON_SWORD_BLUE});t.setWorldSize(31,25),this.add(t),Phaser.Display.Align.In.Center(t,this,-60)},n.createText=function(){var t=this.scene.make.image({key:JA,frame:QA.TEXT_PLAY_WITH_BLUE});t.setWorldSize(159.5,15.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20)},e}(Kr.default),tx=$A,ex=Ar.default.DEFAULT,nx=ex.KEY,ix=ex.FRAME,ax=function(t){function e(e){var n;return(n=t.call(this,e,nx,ix.BUTTON_BROWN)||this).button.setWorldSize(246,53),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:nx,frame:ix.ICON_REPLAY});t.setWorldSize(26,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-45,-2)},n.createText=function(){var t=this.scene.make.image({key:nx,frame:ix.TEXT_REPLAY});t.setWorldSize(69.5,14.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-1)},e}(Kr.default),sx=ax,rx=Ar.default.DEFAULT,ox=rx.KEY,cx=rx.FRAME,hx=function(t){function e(e){var n;return(n=t.call(this,e,ox,cx.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:ox,frame:cx.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),lx=hx,ux=Ar.default.DEFAULT,dx=ux.KEY,px=ux.FRAME,fx=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.buttonReplay=void 0,s.buttonPlayWithFriend=void 0,s.buttonHome=void 0,s.buttonJourney=void 0,s.buttonShare=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(t){s.scene.player.setSetting("music",t),t?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(t){s.scene.player.setSetting("sound",t)},s.handleVibrateSetting=function(t){t&&um(199),s.scene.player.setSetting("vibrate",t)},s.clickReplay=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.scene.screen.close(s.name),t.next=3,s.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=window.game,s=a.globalScene,r=a.lang,s.screen.open(Er,{message:r.Text.LOADING,loading:!0}),o=n(),c=_l(o),u()(i=[Xs,qs]).call(i,c)&&(e(Pd()),e(wd())),h=null,c===Ks&&(h=cu(o),e({type:ga,payload:{}})),e(Gd()),t.next=11,e(sp(c,h));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 16:return t.prev=16,Xd(300),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:bu.emit(Ch.REPLAY);case 4:case"end":return t.stop()}}),t)}))))},s.clickButtonPlayWithFriends=function(){s.scene.storage.dispatch($d()),s.scene.screen.close(s.name)},s.clickButtonHome=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},s.clickButtonLeaderboard=function(){s.scene.screen.open(Pr)},s.clickButtonShare=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.storage.dispatch(Bu());case 1:case"end":return t.stop()}}),t)}))))},s.createPopup(),s.createTitle(),s.createContentBackground(),s.createSwitchButtons(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:dx,frame:px.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-48)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,290,390),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:dx,frame:px.TEXT_SETTING});t.setWorldSize(151.5,24),this.buttonClose=new Kr.default(this.scene,dx,px.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createJourneyButton(),this.createShareButton()},n.createReplayButton=function(){this.buttonReplay=new sx(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,43)},n.createPlayWithFriendButton=function(){this.buttonPlayWithFriend=new tx(this.scene),this.popup.add(this.buttonPlayWithFriend),this.buttonPlayWithFriend.onClick=this.clickButtonPlayWithFriends,Phaser.Display.Align.In.Center(this.buttonPlayWithFriend,this.buttonReplay,0,65)},n.createHomeButton=function(){this.buttonHome=new WA(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,72)},n.createJourneyButton=function(){this.buttonJourney=new qA(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,72)},n.clickButtonJourney=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.createShareButton=function(){this.buttonShare=new lx(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.buttonReplay,90,72)},n.createSwitchButtons=function(){var t=this.scene.player.getPlayerSettings(),e=(t.music,t.sound),n=t.vibrate;this.createSoundButton(e),cm()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.backgroundContent,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,0)},n.createMusicButton=function(t){this.settingMusicContainer=this.scene.make.container({});var e=this.scene.make.image({key:dx,frame:px.ICON_MUSIC});e.setWorldSize(37,40),this.settingMusic=new GA(this.scene,{enable:t,width:89,height:31}),this.settingMusic.setName("Music"),Phaser.Display.Align.In.Center(e,this.settingMusicContainer,-60),Phaser.Display.Align.In.Center(this.settingMusic,this.settingMusicContainer,40),this.settingMusicContainer.add([e,this.settingMusic]),this.popup.add(this.settingMusicContainer),Phaser.Display.Align.In.Center(this.settingMusicContainer,this.backgroundContent,0,60)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:dx,frame:px.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new GA(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:dx,frame:px.ICON_SOUND});e.setWorldSize(41,36),this.settingSound=new GA(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),gx=fx,mx=Ar.default.DEFAULT,vx=mx.KEY,yx=mx.FRAME,Sx=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textTargetScore=void 0,s.textScore=void 0,s.titleFrame=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.createTextTargetScore(),s.createTextScore(),s.addItem(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.scene.levelManager.getCurrentTargetScore(),a=this.scene.levelManager.getCurrentIndex();this.textScore.setText(""+i),0===a?(this.titleFrame.setFrame(yx.TEXT_FIRST_MILESTONE),this.titleFrame.setWorldSize(166,20)):(this.titleFrame.setFrame(yx.TEXT_NEXT_MILESTONE),this.titleFrame.setWorldSize(234.5,24.5));var s=this.getData(["duration"])[0];this.runOpenAnimation(),this.scene.time.delayedCall(s,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:vx,frame:yx.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.backgroundContent,0,-30)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.backgroundContent,0,15)},n.createPopup=function(){this.popup=new vo(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:vx,frame:yx.TEXT_FIRST_MILESTONE}),this.titleFrame.setWorldSize(166,20),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterTargetScoreScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),Ax=Sx,xx=Ar.default.DEFAULT,Ex=xx.KEY,bx=xx.FRAME,wx=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.contents=void 0,s.scoreText=void 0,s.bestScoreText=void 0,s.tweenScoreText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.scoreBlock=void 0,s.bestScoreBlock=void 0,s.playWithFriendsButton=void 0,s.homeButton=void 0,s.shareButton=void 0,s.bestScore=void 0,s.currentScore=void 0,s.payload=void 0,s.counterAnimation=void 0,s.scoreAnimation=void 0,s.scene=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.initScore(),s.updateScore(),s.setVisible(!0),s.runOpenAnimation()},s.clickPlayWithFriends=function(){s.scene.storage.dispatch($d())},s.clickShare=function(){s.scene.storage.dispatch(Mu())},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){}))},s.setVisible(!1),s.scene=e,s.setDepth(Wr),s.createPopup(),s.createPopupContent(),s.createScoreAnimation(),Phaser.Display.Align.In.Center(s.popup,s.zone,0,-100),s.background.setVisible(!1),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new vo(this.scene,0,0,300,310),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.shareButton])},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:Ex,frame:bx.TEXT_YOUR_SCORE});t.setWorldSize(124.5,20.5),Phaser.Display.Align.In.Center(t,this.title,0,10);var e=new Kr.default(this.scene,Ex,bx.BUTTON_CLOSE,35,35);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.RightCenter(e,this.title,165,-15),this.title.add([t,e]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container();var t=this.scene.make.image({key:Ex,frame:bx.SCORE_PANEL});t.setWorldSize(263,76),this.scoreBlock.add(t),this.scoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(55),text:"0",origin:{x:.5,y:.5}}),this.scoreBlock.add(this.scoreText),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-90)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var t=this.scene.make.image({key:Ex,frame:bx.BEST_SCORE_FRAME_LONG});t.setWorldSize(193,77),this.bestScoreBlock.add(t),this.bestScoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(48),text:"0",origin:{x:.5,y:.5}}),this.bestScoreBlock.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,16),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,65)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonShare()},n.createButtonHome=function(){this.homeButton=new Xm(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.bestScoreBlock,-100,80)},n.clickHome=function(){this.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new nv(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.bestScoreBlock,0,80)},n.createButtonShare=function(){this.shareButton=new Jm(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this.bestScoreBlock,100,80)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(t){this.bestScoreText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=Su(t),n=e.score,i=e.bestScore;if(void 0===n&&void 0===i){var a=yu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(t){this.payload=t;var e=t.bestScore,n=t.currentScore;if(this.setBestScore(e),n<=e)return this.setCurrentScore(n),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter(),this.scene.time.delayedCall(1300,(function(){}))},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new gv({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var t,e=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(t=this.counterAnimation)||t.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(t){e.scene.audio.playSound(Xr.default.SCORE_COUNT);var n=Math.floor(t.getValue());e.runScoreAnimation(),e.setCurrentScore(n)},onComplete:function(){e.setBestScore(i<a?a:i),e.setCurrentScore(a),e.scene.audio.playSound(Xr.default.GAME_OVER)}})},n.setCurrentScore=function(t){this.scoreText.setText(""+t)},e}(GameCore.Screen),Tx=wx,Cx=GameCore.Configs,Mx=Cx.Match,Ix=(Cx.Network,Cx.Tutorial),Px=Cx.Board,kx=Cx.Ads,Rx=Ar.default.GAMEPLAY_32.FRAME,_x=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).lastTimeInputEnabled=0,n.usedRescue=!1,n.levelManager=void 0,n.bestScoreGlareEffect=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.tutorialManager=void 0,n.effectManager=void 0,n.bestScore=0,n.isBestScoreScreenShowed=void 0,n.isGameOver=void 0,n.isShowedNextTargetScreen=void 0,n.piecesByFen=void 0,n.isGameError=void 0,n.gamePlayMode=void 0,n.isNextTarget=!1,n.run=function(){var t=n.storage.getState();if(null===Ll(t)&&n.storage.dispatch(jd(!1)),n.checkAndAddShortcut(),n.tutorialManager.isValidForTutorial()||Ix.ForceUseTutorial)return n.handleStartTutorial(),void n.player.incUserGuideDisplays();var e=n.player.getPlayerId(),i=cu(t).playerId,a=lu(t,{playerId:e}),s=uu(t,{opponentId:i});a&&s?n.screen.open(Mr):n.startGame()},n.create=function(){t.prototype.create.call((0,gr.default)(n)),n.createBackground(Ws.default.BACKGROUND.KEY);var e=n.player.getBestScore();n.bestScore=e,n.createLevelManager(),n.createMain(),n.createHeader(),n.createFooter(),n.createTutorialManager(),n.createEffectManager(),n.createScreens(),n.createBestScoreGlareEffect(),n.createInput(),n.listenEvents(),n.input.setTopOnly(!0),n.preLoadAds()},n.closeSettingScreen=function(){(0,gr.default)(n).screen.close(wr)},n.closeGameOverScreen=function(){(0,gr.default)(n).screen.close(Mr)},n.handlePauseGame=function(){n.isGameOver||n.checkReachTargetScore()||(0,gr.default)(n).screen.open(wr)},n.handleShowInterstitialAd=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=!0),t.prev=1,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,n.ads.showInterstitialAdAsync();case 7:n.analytics.showInterstitialAd(n.getSceneName()),t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return");case 13:return t.prev=13,e&&n.postSessionScore(),n.audio.playMusic(),n.ads.preloadInterstitialAdAsync().catch(Wt.sendException),n.audio.playMusic(),t.finish(13);case 19:case"end":return t.stop()}}),t,null,[[1,10,13,19]])})));return function(e){return t.apply(this,arguments)}}(),n.rescued=function(){try{var t=n.getLevelLogInfo(),e=t.level,i=t.score,a=t.levelName;n.analytics.levelRescue(e,i,a),n.main.board.rescue(),n.nextLevel(),n.usedRescue=!0}catch(s){}},n.replay=function(){n.restartGame(),n.startGame()},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(t){return console.log(t)})),this.ads.preloadRewardedVideoAsync().catch((function(t){return console.log(t)}))},n.createHeader=function(){this.header=new im(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createLevelManager=function(){this.levelManager=new Hp},n.createBestScoreGlareEffect=function(){this.bestScoreGlareEffect=new Gp(this),Phaser.Display.Align.In.Center(this.bestScoreGlareEffect,this.gameZone)},n.createMain=function(){this.main=new Om(this)},n.createFooter=function(){this.footer=new fg(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new Th(this)},n.createEffectManager=function(){this.effectManager=new ig(this)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createSettingScreen(),this.createRescueScreen(),this.createGameOverScreen(),this.createYourScoreScreen(),this.createScoreReachedScreen(),this.createNextTargetScoreScreen(),this.createBestScoreScreen(),this.createNoSpaceLeftScreen(),this.createTargetScoreScreen(),this.createLeaderboardScreen(),this.createMiniJourneyScreen()},n.createLeaderboardScreen=function(){this.screen.add(Pr,Lp)},n.createMiniJourneyScreen=function(){this.screen.add(kr,uA)},n.createTargetScoreScreen=function(){this.screen.add(Yr,Ax)},n.createNoSpaceLeftScreen=function(){this.screen.add(Nr,vA)},n.createBestScoreScreen=function(){this.screen.add(Tr,Um)},n.createNextTargetScoreScreen=function(){this.screen.add(Ur,gA)},n.createScoreReachedScreen=function(){this.screen.add(Gr,DA)},n.createYourScoreScreen=function(){this.screen.add(_r,Tx)},n.createSettingScreen=function(){this.screen.add(wr,gx)},n.startGame=function(){var t=this;try{this.isGameOver=!1,this.tutorialManager.skipTutorial(),this.closeSettingScreen(),this.closeGameOverScreen(),this.handleUsedRescue(),this.restartGame(),this.header.setVisible(!0),this.header.progressBar.reset(),this.handleGameModeUI(),this.updateCurrentBestScore(),this.updateLevelManager(),this.updateProgressBar(),this.header.buttonSetting.setDisabled(!0),this.time.delayedCall(300,(function(){t.header.buttonSetting.setDisabled(!1)})),this.openTargetScoreScreen(),this.handleGameModeChange()}catch(e){this.isGameError||(this.isGameError=!0,this.replay()),(0,Wt.sendExceptionWithScope)(new Error("Start game scene"),{error:e,scene:"GameScene"})}},n.handleGameModeChange=function(){var t=this,e=[{selector:_l,callback:function(e){e!==t.gamePlayMode&&t.handleGameModeUI()}}];this.handleStateChange(e)},n.handleGameModeUI=function(){var t,e=this.storage.getState();this.gamePlayMode=_l(e),this.gamePlayMode&&this.gamePlayMode!==Xs&&g()(t=[js,Ks,qs]).call(t,this.gamePlayMode)>=0?this.handleStartGameFriendMode():this.handleStartGameSingleMode()},n.startGameAfterTargetScoreScreenClose=function(){var t,e=this.storage.getState(),n=_l(e),i=this.getLevelLogInfo(),a=i.level,s=i.score,r=i.levelName;this.analytics.levelStart(a,s,r),this.levelManager.getCurrentIndex()>0&&this.main.board.handleTweenStartMission(),g()(t=[js,Ks,qs]).call(t,n)>=0?this.footer.pieces.showNewPieces():this.piecesByFen?this.footer.pieces.showAvailablePieces(this.piecesByFen):this.footer.pieces.showNewPieces()},n.openTargetScoreScreen=function(){var t=this;this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Yr,{duration:1500})}))},n.handleUsedRescue=function(){this.usedRescue&&this.storage.dispatch(hp())},n.handleStartTutorial=function(){this.analytics.event(ni.AnalyticsEvents.TUTORIAL_BEGIN),this.tutorialManager.start(),this.header.setVisible(!1)},n.handleStartGameSingleMode=function(){var t,e,n=this.storage.getState(),i=(null==(t=nu(n))?void 0:t.data)||{},a=(null==(e=nu(n))?void 0:e.score)||0;if(i){var s=i.fen,r=null;if(this.piecesByFen=null,s){var o=this.main.board.getBoardByFen(s);r=this.handleDynamicFenSize(o),this.piecesByFen=this.footer.pieces.getPiecesByFen(s),this.isFenGameOver(r,this.piecesByFen)&&(r=null,this.piecesByFen=null,this.storage.dispatch(Gd()),n=this.storage.getState(),a=0,this.resetRescued())}this.main.board.clearBoard(),r&&this.main.board.startGame(r),this.footer.pieces.clearPieces(),this.header.showItemSingleMode(),this.header.mainScoreBlock.setScore(a),this.header.mainScoreBlock.setScoreText(a),this.main.praise.reset()}},n.handleStartGameFriendMode=function(){this.header.showItemPlayWithFriendsMode(),this.header.myScoreBlock.updateInfo(),this.header.opponentScoreBlock.updateInfo(),this.main.praise.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces()},n.listenEvents=function(){var t=this;bu.on(Ch.START_GAME,(function(){t.startGame()})),bu.on(Ch.RESCUE,this.rescued),bu.on(Ch.REPLAY,this.replay),bu.on(Ch.GAME_OVER,this.handleGameOver.bind(this)),bu.on("handle_state_change",this.handleStateChange.bind(this))},n.postSessionScore=function(){var t=this.storage.getState(),e=Su(t).score,n=void 0===e?0:e;this.storage.dispatch(Zl(n))},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.createRescueScreen=function(){this.screen.add(br,bA)},n.createGameOverScreen=function(){this.screen.add(Mr,Iv)},n.updateCurrentBestScore=function(){var t=this.player.getBestScore()||0,e=this.storage.getState(),n=Su(e),i=n.score,a=void 0===i?0:i,s=n.bestScore,r=void 0===s?0:s,o=t>r?t:r;o=o>a?o:a,this.player.setScore(o),this.header.bestScoreBlock.setScoreText(o)},n.updateLevelManager=function(){var t=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(t)},n.updateProgressBar=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);this.header.progressBar.setTargetScore(e),this.header.progressBar.setPercent(t/e)},n.setIsGameOver=function(t){this.isGameOver=t},n.handleGameOver=function(){this.isGameOver=!0;var t=this.getLevelLogInfo(),e=t.level,n=t.score,i=t.levelName;this.analytics.levelFail(e,n,i),this.screen.open(Mr)},n.handleRequestFinishGame=function(){var t=this;this.isGameOver=!0;var e=this.storage.getState(),n=Ol(e);n<Mx.MaxRescueCount&&this.ads.preloadRewardedVideoAsync().catch((function(t){return console.log(t)})),this.screen.open(Nr,{duration:3e3,onClose:function(){if(t.enableInput(),n<Mx.MaxRescueCount&&kx.Enabled)return t.screen.open(br),void(t.isGameOver=!1);t.usedRescue=!1,t.endGame()}})},n.checkAnimPlaying=function(){var t=this.tweens.getAllTweens();return!(!t||0===t.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(t){return t.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.restartGame=function(){var t;null==(t=this.header.mainScoreBlock.addScore)||t.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.header.myScoreBlock.setScore(0),this.header.myScoreBlock.setScoreText(0),this.header.progressBar.hideProgressBar(),this.header.progressBar.setPercent(0),this.levelManager.restart(),this.main.praise.listScore=[]},n.endGame=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.restartGame(),this.handleShowInterstitialAd(!1).catch(Wt.sendException),this.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A,x,E,b,w,T,C,M,I;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.analytics,s=i.facebook,r=i.globalScene,o=i.lang,r.screen.open(Er,{message:o.Text.LOADING,loading:!0}),c=n(),h=_l(c),l=Su(c),u=l.score,d=void 0===u?0:u,p=l.level,f=void 0===p?0:p,e(Zl(d)),e(ap(d)),t.next=10,e(op(h,{score:d}));case 10:if(c=n(),g=Dl(c),m=Bl(c),v=Math.floor((m-g)/1e3),a.event(ni.AnalyticsEvents.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(h),level:f,level_name:"level_"+f,time_played:v}),y=s.getContextID(),h===js&&y&&e(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=window.game.analytics,t.prev=1,a=window.game.facebook.getContextID(),Nu({contextId:a}),s=n(),r=du(s),o=r.playerId,c=r.score,h=Su(s),l=h.score,!o||o===Hs.playerId){t.next=25;break}if(!(l>c)){t.next=18;break}return t.next=13,Ou(s);case 13:return u=t.sent,t.next=16,qu(u,s);case 16:t.next=23;break;case 18:return t.next=20,Pu(s);case 20:return u=t.sent,t.next=23,Zu(u,s);case 23:t.next=30;break;case 25:return t.next=27,Pu(s);case 27:return u=t.sent,t.next=30,Zu(u,s);case 30:Uu({imageShare:u}),i.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"InviteGroup",success:!0}),t.next=38;break;case 34:t.prev=34,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"InviteGroup",success:!0}),(0,Wt.sendException)(t.t0);case 38:case"end":return t.stop()}}),t,null,[[1,34]])})));return function(e,n){return t.apply(this,arguments)}}()),!y||h!==Ks){t.next=26;break}if(S=cu(c),(A=S.playerId)&&A!==Hs.playerId){t.next=21;break}return t.abrupt("return");case 21:x=yu(c),E=x[A]||{},b=E.score,w=void 0===b?0:b,T=su(c),C=T._id,M=T.whitePlayerFinish,I=T.blackPlayerFinish,e(M&&I?d>w?Ku(A,{matchId:C,contextId:y}):Xu(A,{matchId:C,contextId:y}):ju(A,{matchId:C,contextId:y,score:d}));case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 31:return t.prev=31,Xd(300),t.finish(31);case 34:case"end":return t.stop()}}),t,null,[[0,28,31,34]])})));return function(e,n){return t.apply(this,arguments)}}()),this.resetRescued();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.handleUpdateScore=function(t){if(!this.tutorialManager.isRunning()){var e=this.getCurrentScoreByMode()+t;this.storage.dispatch(Vd({score:e})),this.updateMatchData()}},n.handleAddScoreAnim=function(t){var e,n=this.storage.getState(),i=_l(n);this.tutorialManager.isRunning()?this.header.mainScoreBlock.animAddScore(t):i&&i!==Xs&&g()(e=[js,Ks,qs]).call(e,i)>=0?this.header.myScoreBlock.animAddScore(t):this.header.mainScoreBlock.animAddScore(t)},n.getBestScore=function(){var t=this.storage.getState();return Su(t).bestScore},n.bestScoreReached=function(){if(!this.isBestScoreScreenShowed&&!this.isGameOver){var t=this.getBestScore(),e=this.getCurrentScoreByMode();!t||t>=e||(this.player.setScore(e),this.isBestScoreScreenShowed=!0,this.audio.playSound(Xr.default.CONGRATULATION),this.bestScoreGlareEffect.playEffect())}},n.updateProgressTargetScore=function(t){var e=t/this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(e)},n.checkReachTargetScore=function(){return this.getCurrentScoreByMode()>=this.header.progressBar.getTargetScore()},n.handleNextTargetScore=function(){var t=this;if(!this.isGameOver&&(this.checkReachTargetScore()&&!this.isShowedNextTargetScreen)){this.isShowedNextTargetScreen=!0,this.disableInput();var e=this.getLevelLogInfo(),n=e.level,i=e.score,a=e.levelName;this.analytics.levelComplete(n,i,a),this.screen.open(Gr,{duration:4e3,onClose:function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isShowedNextTargetScreen=!1,t.handleShowInterstitialAd(!1).catch(Wt.sendException),t.showNextTargetScreen();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},n.getCurrentScoreByMode=function(){var t,e=this.storage.getState(),n=_l(e);return n&&n!==Xs&&g()(t=[js,Ks,qs]).call(t,n)>=0?this.header.myScoreBlock.score:this.header.mainScoreBlock.score},n.showNextTargetScreen=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);console.log("wwwwwwwwwwww ",t,e),this.screen.open(Ur)},n.updateMatchData=function(){if(!this.tutorialManager.isRunning()){var t=this.getFen(),e=this.storage.getState(),n=nu(e).data||{},i=_l(e),a=Ol(e);if(!i||i===Xs){var s,r,o=iu(e),c=Su(e).score,h=void 0===c?0:c;this.storage.dispatch((s=o,r={score:h,rescued:a,data:(0,Tt.default)({},n,{fen:t}),updateAt:Date.now()},function(t,e){try{fd((0,Tt.default)({matchId:s},r));var n=e(),i=iu(n);gd({matchId:s,currentMatchId:i}),t({type:ta,payload:{match:r}});var a=r.data;r.data=Ed(a),Le(xd.SingleMatchStore,r)}catch(o){if(o instanceof Ju)return;(0,Wt.sendException)(o)}}))}}},n.nextLevel=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);console.log("wwwwwwwwwwww ",t,e),this.isNextTarget=!0,this.header.progressBar.hideProgressBar(),this.header.progressBar.setTargetScore(e),this.header.progressBar.setPercent(t/e);var n=this.getLevelLogInfo(),i=n.level,a=n.levelName;this.analytics.levelStart(i,t,a)},n.update=function(t){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=t:t-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=t)},n.isFenGameOver=function(t,e){for(var n=[],i=0;i<e.length;i++){var a=e[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case Ko:case jo:case qo:n.push({data:Lf.getData(s,r,o)});break;case Zo:case Jo:case Qo:case $o:n.push({data:Nf.getData(s,r)});break;case tc:case ec:case nc:n.push({data:Uf.getData(s)});break;case ac:n.push({data:Yf.getData(r)});break;case sc:n.push({data:Xf.getData(r)});break;case uc:n.push({data:Qf.getData(r)});break;case oc:case cc:case hc:case lc:n.push({data:Zf.getData(s,r)});break;case ic:n.push({data:Wf.getData(r)});break;case rc:n.push({data:jf.getData()})}}return yf(t,n)},n.handleDynamicFenSize=function(t){var e,n,i=0;if((n=t.length)&&(i=t[0].length),0===n||0===i)return t;var a=et()(e=[]).call(e,t);if(n>Px.rows)vr()(a).call(a,Px.rows,n-Px.rows);else if(i<Px.rows)for(var s=0;s<Px.rows-n;s++){var r;a.push(A()(r=new Array(n)).call(r,{value:0,frame:Rx.GEM_TRANSPARENT}))}return i>Px.cols?a.forEach((function(t){vr()(t).call(t,Px.cols,i-Px.cols)})):i<Px.cols&&a.forEach((function(t){for(var e=0;e<Px.cols-i;e++)t.push({value:0,frame:Rx.GEM_TRANSPARENT})})),a},n.checkAndAddShortcut=function(){if(!this.game.player.getPlayer().isUserNew){var t=this.storage.getState();$s(t)!=qs&&this.facebook.attemptToAddShortcut()}},n.getLevelName=function(){var t,e=this.levelManager.getCurrentIndex()+1;return"target_"+Sr()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.getLevelLogInfo=function(){return{level:this.levelManager.getCurrentIndex()+1,score:this.getCurrentScoreByMode(),levelName:this.getLevelName()}},n.resetRescued=function(){this.storage.dispatch((function(t){t({type:Ki,payload:{}}),Le(Yd.SingleMatchStore,{rescued:0})}))},e}(Fp.default);for(var Ox=_x,Dx=function(t){return{type:vi,payload:{sceneKey:t}}},Bx=(0,be.createSelector)([function(t){return t.scene.currentSceneKey}],(function(t){return t})),Lx=Ar.default.DEFAULT,Fx=Lx.KEY,Nx=Lx.FRAME,Gx=function(t){function e(e){var n;return(n=t.call(this,e,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(t){if(!(t-n.lastUpdate<800)){n.lastUpdate=t;var e=Math.floor(n.scene.game.loop.actualFps);n.setFps(e)}},n.createFps(),n.setDepth(jr.default.DEBUG),n.scene.add.existing((0,gr.default)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,Kt.default)(e,t);var n=e.prototype;return n.setFps=function(t){this.fps=t;var e=Phaser.Utils.String.Format(this.fpsString,[t]);this.fpsText.setText(e)},n.createFps=function(){this.background=this.scene.make.image({key:Fx,frame:Nx.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:qr.default.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},e}(Phaser.GameObjects.Container),Ux=Gx,Vx=function(t){function e(e){var n;if((n=t.call(this,e,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(t){if(!(t-n.lastUpdate<1e3)){n.lastUpdate=t;var e=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(e/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),e>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),e>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(jr.default.DEBUG),n.scene.add.existing((0,gr.default)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,gr.default)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,Kt.default)(e,t);var n=e.prototype;return n.isSupport=function(){var t;return this.performance&&!(null==(t=this.performance)||!t.memory)},n.setMaxMemory=function(t){this.maxMemoryLimit=Math.round(t)},n.setMemory=function(t){this.memory=t;var e=Phaser.Utils.String.Format(this.memoryString,[t,this.maxMemoryLimit]);this.memoryText.setText(e)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:qr.default.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},e}(Phaser.GameObjects.Container),Yx=Vx,zx=Ar.default.DEFAULT,Wx=zx.KEY,Hx=zx.FRAME,Xx=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.contents=void 0,s.buttonNo=void 0,s.buttonYes=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onHandleYes=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.setVisible(!0);var n=s.getData(["message","onHandleYes"]),i=n[0],a=void 0===i?"":i,r=n[1];s.setTextMessage(a),s.onHandleYes=r,s.runOpenAnimation()},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.screen.close(s.name)}))},s.handleNo=function(){s.close()},s.handleYes=function(){s.onHandleYes&&s.onHandleYes(),s.close()},s.setVisible(!1),s.setDepth(Wr),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createTitle(),this.createMessage(),this.createButtonNo(),this.createButtonYes(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonNo,this.buttonYes])},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:Wx,frame:Hx.TEXT_TUTORIAL});t.setWorldSize(122,19);var e=new Kr.default(this.scene,Wx,Hx.BUTTON_CLOSE,35,35);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.Center(e,this.title,155,-19),Phaser.Display.Align.In.Center(t,this.title,0,10),this.title.add([t,e]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createButtonNo=function(){this.buttonNo=new Kr.default(this.scene,Wx,Hx.BUTTON_DARK_BLUE,120,40),this.buttonNo.setName("No");var t=this.scene.make.image({key:Wx,frame:Hx.TEXT_NO});t.setWorldSize(36,16.5),this.buttonNo.add(t),Phaser.Display.Align.In.Center(t,this.buttonNo),this.popup.add(this.buttonNo),Phaser.Display.Align.In.Center(this.buttonNo,this.popup,80,60),this.buttonNo.onClick=this.handleNo},n.createButtonYes=function(){this.buttonYes=new Kr.default(this.scene,Wx,Hx.BUTTON_GREEN_LARGE,120,40),this.buttonYes.setName("Yes");var t=this.scene.make.image({key:Wx,frame:Hx.TEXT_YES});t.setWorldSize(28.5,20),this.buttonYes.add(t),Phaser.Display.Align.In.Center(t,this.buttonYes),this.popup.add(this.buttonYes),Phaser.Display.Align.In.Center(this.buttonYes,this.popup,-80,60),this.buttonYes.onClick=this.handleYes},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(45),origin:{x:.5,y:.5}}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-40),this.messageText.setScale(0).setAlpha(0)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setTextMessage=function(t){this.messageText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},e}(GameCore.Screen),Kx=Xx,jx=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).loadingIcon=void 0,s.messageText=void 0,s.openAnimation=void 0,s.closeTimerEvent=void 0,s.addLoadingIcon(),s.addMessageText(),s.setDepth(Hr),s.background.setAlpha(.8),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n,i=this;t.prototype.open.call(this,e);var a=this.getData(["message","duration","loading"]),s=a[0],r=void 0===s?"":s,o=a[1],c=void 0===o?0:o,h=a[2],l=void 0!==h&&h;this.setMessage(r),this.showLoading(l),null==(n=this.closeTimerEvent)||n.remove(),c>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:c,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new Cl(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(50),font:qr.default.PRIMARY_LIGHT.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.setMessage=function(t){this.messageText.setText(t)},n.showLoading=function(t){this.loadingIcon.setVisible(t);var e=!1===t?20:80;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,e)},n.runOpenAnimation=function(){var t,e;null==(t=this.openAnimation)||t.stop(),null==(e=this.openAnimation)||e.remove(),this.openAnimation=new co({targets:[this.messageText,this.loadingIcon],props:{scale:{getStart:function(t){return t.scale-.3},getEnd:function(t){return t.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},e}(GameCore.Screen),qx=jx,Zx=Ar.default.DEFAULT,Jx=Zx.KEY,Qx=Zx.FRAME,$x=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.switchScene=function(t){n.currentScene.key!==t&&n.currentScene.switch(t)},n.runScene=function(t){n.currentScene.run(t)},n.emitGameEventStartScene=function(t){var e=t.scene.key;console.info("%cScene start","color: #D27D2D",e),n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(e),n.game.events.emit(Phaser.Scenes.Events.START,e),(0,Wt.addBreadcrumbSentry)("scene","Start scene: "+e)},n.emitGameEventSleepScene=function(t){var e=t.scene.scene.key;console.info("%cScene sleep","color: #D27D2D",e),e!==ar.SceneKeys.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,e))},n.emitGameEventWakeScene=function(t){var e=t.scene.scene.key;console.info("%cScene wake","color: #D27D2D",e),e!==ar.SceneKeys.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(e),n.game.events.emit(Phaser.Scenes.Events.WAKE,e))},n.emitGameEventPauseScene=function(t){var e=t.scene.scene.key;console.info("%cScene pause","color: #D27D2D",e),n.game.events.emit(Phaser.Scenes.Events.PAUSE,e)},n.emitGameEventResumeScene=function(t){var e=t.scene.key;console.info("%cScene resume","color: #D27D2D",e),n.game.events.emit(Phaser.Scenes.Events.RESUME,e)},n.emitGameEventShutdownScene=function(t){var e=t.scene.scene.key;console.info("%cScene shutdown","color: #D27D2D",e),n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,e)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addAlertScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var t=this.screen.add(Er,qx);Phaser.Display.Align.In.Center(t,this.gameZone)},n.addAlertScreen=function(){var t=this.screen.add(xr,Kx);Phaser.Display.Align.In.Center(t,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:Jx,frame:Qx.BLANK});var t=this.gameZone,e=t.width,n=t.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(0),this.mask.setWorldSize(e,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new Ux(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new Yx(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){},n.runMaskFadeOutAnimation=function(){},n.listenScenesEvents=function(){var t=this;this.scene.manager.getScenes(!1).forEach((function(e){e.events.on(Phaser.Scenes.Events.CREATE,t.emitGameEventStartScene),e.events.on(Phaser.Scenes.Events.SLEEP,t.emitGameEventSleepScene),e.events.on(Phaser.Scenes.Events.WAKE,t.emitGameEventWakeScene),e.events.on(Phaser.Scenes.Events.PAUSE,t.emitGameEventPauseScene),e.events.on(Phaser.Scenes.Events.RESUME,t.emitGameEventResumeScene),e.events.on(Phaser.Scenes.Events.SHUTDOWN,t.emitGameEventShutdownScene)})),this.events.on(ar.SceneEvents.SWITCH,this.switchScene),this.events.on(ar.SceneEvents.RUN,this.runScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.updateActiveSceneKey=function(t){t!==ar.SceneKeys.GLOBAL_SCENE&&this.storage.dispatch(Dx(t))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,Se.default)(e,[{key:"currentScene",get:function(){var t=this.storage.getState(),e=Bx(t);return(e?this.scene.manager.getScene(e):this.getActiveScene()).scene}}]),e}(Fp.default),tE=$x,eE=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="LoadResourceFail",i.message=e||"Load resource fail",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),nE=[{id:"pass-levels",title:"PASS_10_LEVELS",require:{level:10},reward:{diamond:100}},{id:"collect-diamonds",title:"COLLECT_300_DIAMONDS",require:{diamond:300},reward:{diamond:100}},{id:"reach-score",title:"REACH_TOTAL_SCORES",require:{score:1e5},reward:{diamond:200}}],iE=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nE);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),aE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.tasks}],(function(t){return t})),sE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.process}],(function(t){return t})),rE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.isRequesting}],(function(t){return t})),oE=((0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.isNotice}],(function(t){return t})),GameCore.Configs.DailyTasks),cE=function(t){return function(e){e({type:Qa,payload:{tasks:t}});var n=window.game.player.getCustomData("dailyTasks")||{},i=n.startedTime,a=void 0===i?0:i,s=n.logTasks,r=void 0===s?{}:s;e((Date.now()-a)/1e3>oE.Duration?hE(t):lE(r))}},hE=function(t){return function(e){var n={};t.forEach((function(t){var e=t.id,i=t.require;n[e]={},Y()(i).forEach((function(t){var i;n[e]=((i={})[t]=0,i.rewarded=!1,i)}))})),window.game.player.setCustomData("dailyTasks",{logTasks:n,startedTime:Date.now()}),e(lE(n)),bu.emit(tu.EVENTS.TASKS_RESET)}},lE=function(t){return{type:$a,payload:{process:t}}},uE=n(322),dE=n.n(uE),pE=function(){var t=(window.game.player.getCustomData("dailyTasks")||{}).logTasks;return GameCore.Utils.Json.clone(t)},fE=function(){function t(t,e){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(t,e){var i;void 0===e&&(e=!0);var a=t.type,s=t.value;if(!(s<1)&&(-1!==g()(i=n.requireTypes).call(i,a)&&!n.isPassRequiredTarget(a)&&n.processMore(t))){a=t.type,s=t.value;var r=n.getCorrectValue(a,s);n.game.storage.dispatch(function(t,e,n,i){return void 0===i&&(i=!0),function(a){var s=pE();if(GameCore.Utils.Valid.isObject(s)){var r=s;GameCore.Utils.Object.hasOwn(r,t)&&!r[t].rewarded&&(i&&(r[t][e]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:r})),a({type:ts,payload:{id:t,type:e,value:n}}))}}}(n.id,a,r,e)),n.isTaskFinished(a)&&n.game.storage.dispatch(function(t){return function(e){e({type:is,payload:{id:t}}),bu.emit(tu.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=t,this.id=e,this.init()}var e=t.prototype;return e.init=function(){var t=this,e=this.game.storage.getState(),n=aE(e)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:dE()(n).call(n,(function(e){return e.id===t.id}));i&&(this.taskData=i,this.requireTypes=Y()(this.taskData.require),this.initEvents())}},e.getDataByType=function(t){var e=this.game.storage.getState(),n=sE(e),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var a=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(a)&&GameCore.Utils.Object.hasOwn(a,t)){var s=a[t];"number"===typeof s&&(i.value=s)}return i.target=this.taskData.require[t]||0,i},e.getCorrectValue=function(t,e){var n=this.getDataByType(t),i=n.value,a=n.target,s=e;return i+e>a&&(s=a-i),Math.round(s)},e.isPassRequiredTarget=function(t){var e=this.getDataByType(t);return e.value>=e.target},e.isTaskFinished=function(t){var e=this.getDataByType(t);return e.value>=e.target},t}(),gE=fE,mE=tu.COLLECT_DIAMONDS,vE=mE.ID,yE=mE.EVENTS,SE=function(t){function e(e){return t.call(this,e,vE)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){bu.off(yE.COLLECT_DIAMONDS,this.process),bu.on(yE.COLLECT_DIAMONDS,this.process)},n.processMore=function(){return!0},e}(gE),AE=SE,xE=tu.PASS_LEVELS,EE=xE.ID,bE=xE.EVENTS,wE=function(t){function e(e){return t.call(this,e,EE)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){bu.off(bE.PASS_LEVEL,this.process),bu.on(bE.PASS_LEVEL,this.process)},n.processMore=function(){return!0},e}(gE),TE=wE,CE=tu.REACH_SCORE,ME=CE.ID,IE=CE.EVENTS,PE=function(t){function e(e){var n;return(n=t.call(this,e,ME)||this).totalScore=void 0,n.lastUpdate=void 0,n.totalScore=0,n.lastUpdate=Date.now(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){bu.off(IE.ADD_SCORE,this.process),bu.on(IE.ADD_SCORE,this.process)},n.processMore=function(t){var e=t.value,n=Date.now();return n-this.lastUpdate<3e3?(this.totalScore+=e,!1):(t.value+=this.totalScore,this.totalScore=0,this.lastUpdate=n,!0)},e}(gE),kE=PE,RE=function(){function t(t){var e=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.eventsListener={},t.next=3,e.initData();case 3:e.initEvents();case 4:case"end":return t.stop()}}),t)}))),this.initData=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.game.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),!rE(i)){t.next=4;break}return t.abrupt("return");case 4:return e({type:Ja,payload:{}}),t.next=7,iE();case 7:a=t.sent,e(cE(a));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),this.game=t,this.init()}var e=t.prototype;return e.getEventListener=function(t){return this.eventsListener[t]},e.initEvents=function(){this.eventsListener[tu.PASS_LEVELS.ID]=new TE(this.game),this.eventsListener[tu.REACH_SCORE.ID]=new kE(this.game),this.eventsListener[tu.COLLECT_DIAMONDS.ID]=new AE(this.game)},t}(),_E=RE,OE=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],DE=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",OE);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),BE=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.missions}],(function(t){return t})),LE=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.isRequesting}],(function(t){return t})),FE=((0,be.createSelector)([BE,function(t,e){return e.name}],(function(t,e){return t?"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:null:null})),function(t){return{type:Ha,payload:{missions:t}}}),NE={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"}},GE=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.mission}],(function(t){return t})),UE=((0,be.createSelector)([GE],(function(t){return t?t.name:null})),function(){function t(t,e,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(t){var e=t.id,n=t.type,a=t.value;a<1||i.id===e&&i.isTypeRequired(n)&&i.processMore(t)&&(i.game.storage.dispatch(function(t,e,n){return{type:Ka,payload:{name:t,type:e,value:n}}}(i.name,n,a)),i.isMissionComplete()&&(bu.emit(NE.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(t){return{type:ja,payload:{name:t}}}(i.name))))},this.id=e,this.name=n,this.game=t}var e=t.prototype;return e.start=function(){var t=this.game.storage.getState(),e=GE(t);e&&e.name===this.name&&(this.reward=e.reward,this.initEvents())},e.getMissionData=function(){var t=this.game.storage.getState(),e=GE(t);return e?e.name!==this.name?null:e:null},e.getDataByType=function(t){var e=this.getMissionData();if(!e)return null;var n=e.require[t];return{value:e.process[t],target:n}},e.isTypeRequired=function(t){var e=this.getDataByType(t);return!!e&&e.target>0},e.isMissionComplete=function(){var t=this.getMissionData();if(!t)return!0;var e=t.require,n=t.process,i=!0;return Y()(e).forEach((function(t){if(i){var a=e[t];n[t]<a&&(i=!1)}})),i},t}()),VE=UE,YE=NE.EVENTS,zE=NE.TYPES,WE=function(t){function e(e,n){return t.call(this,e,zE.COLLECT_GEMS,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){bu.off(YE.MISSION_UPDATE,this.process),bu.on(YE.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},e}(VE),HE=WE,XE=NE.EVENTS,KE=NE.TYPES,jE=function(t){function e(e,n){return t.call(this,e,KE.COMBO,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){bu.off(XE.MISSION_UPDATE,this.process),bu.on(XE.MISSION_UPDATE,this.process)},n.processMore=function(t){var e=this.getMissionData();if(!e)return!1;var n=t.type;return t.value>=e.require[n]},e}(VE),qE=jE,ZE=NE.EVENTS,JE=NE.TYPES,QE=function(t){function e(e,n){return t.call(this,e,JE.USE_ITEM,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){bu.off(ZE.MISSION_UPDATE,this.process),bu.on(ZE.MISSION_UPDATE,this.process)},n.processMore=function(t){return console.log("UseItem",{payload:t}),!0},e}(VE),$E=QE,tb=function(){function t(t){var e=this;this.game=void 0,this.listener=void 0,this.init=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:e.initListeners(),e.initEvents();case 4:case"end":return t.stop()}}),t)}))),this.initData=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.game.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),!LE(i)){t.next=4;break}return t.abrupt("return");case 4:return e({type:Wa,payload:{}}),t.next=7,DE();case 7:a=t.sent,e(FE(a));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),this.startListener=function(t){e.listener[t]&&e.listener[t].start()},this.game=t,this.init()}var e=t.prototype;return e.initListeners=function(){var t=this;this.listener={};var e=this.game.storage.getState(),n=BE(e);n&&Y()(n).forEach((function(e){switch(n[e].id){case NE.TYPES.COLLECT_GEMS:t.listener[e]=new HE(t.game,e);break;case NE.TYPES.COMBO:t.listener[e]=new qE(t.game,e);break;case NE.TYPES.USE_ITEM:t.listener[e]=new $E(t.game,e)}}))},e.initEvents=function(){bu.off(NE.EVENTS.MISSION_START,this.startListener),bu.on(NE.EVENTS.MISSION_START,this.startListener)},t}(),eb=tb,nb=(GameCore.Configs.Match,function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,c,h,l,u,d,p,f,m,v,y,S,A,x,E,b,w,T,C,M;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),a=Qs(i),s=$s(i),r=window.game,o=r.player,c=r.analytics,h=r.facebook,l=r.globalScene,u=o.getPlayer(),d=a.contextId,p=a.entryPointData,m=(f=p||{}).type,v=f.matchId,y=f.opponentId,S=f.playerId,A=f.playerName,x=f.playerPhoto,E=f.playerScore,b=u.playerId===S,w=Hs,b||"string"!==typeof S||"string"!==typeof A||(w={playerId:S,name:A,photo:"string"===typeof x?x:"",locale:"en_US"}),u.isUserNew&&c.event(ni.AnalyticsEvents.NEW_USER),s!==qs){t.next=25;break}return t.prev=12,t.next=15,h.getTournamentAsync();case 15:T=t.sent,C=T.getID().toString(),e(Hl(C)),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(12),(0,Wt.sendException)(t.t0);case 23:return e(qd()),t.abrupt("return");case 25:if(s!==Ks){t.next=34;break}if(m!==Gs){t.next=30;break}return b||o.updateConnectedPlayers([w]),e($d(d,w.playerId,!0)),t.abrupt("return");case 30:if(!(g()(M=[y,S]).call(M,u.playerId)>=0)||m!==Ys){t.next=34;break}return e(ip(v,b?y:S)),t.abrupt("return");case 34:if(s!==js){t.next=39;break}return e(Ud(S,{score:E,level:0})),e(np(w)),t.abrupt("return");case 39:if(!u.isUserNew){t.next=42;break}return e(Zd()),t.abrupt("return");case 42:l.events.emit(ar.SceneEvents.SWITCH,ar.SceneKeys.DASHBOARD_SCENE);case 43:case"end":return t.stop()}}),t,null,[[12,20]])})));return function(e,n){return t.apply(this,arguments)}}()}),ib={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json"}},ab=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).handleFBInstantGameStarted=function(){window.__fbGameReady=!0,n.player.requestConnectedPlayers(),setTimeout(n.subscribebot,500)},n.startGame=function(){n.analytics.event(ni.AnalyticsEvents.APP_READY),n.storage.dispatch(Dx(ar.SceneKeys.LOAD_SCENE)),n.storage.dispatch(nb())},n.subscribebot=function(){n.facebook.attemptToSubscribeBot()},n.handleLoadSoundCompleted=function(){n.audio.initSound(ib.EFFECTS.KEY)},n.handleLoadMusicCompleted=function(){n.audio.initMusic(ib.BACKGROUND.KEY),n.audio.playMusic()},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){var t=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(ni.AnalyticsEvents.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(e){t.facebook.progressLoading.onProgress(e)})),this.load.setPath("https://vietnguyen2000.github.io/wbj/"),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(t){var e=new eE("Load resources at LoadScene failed.");(0,Wt.sendExceptionWithScope)(e,{file:null==t?void 0:t.url})})),this.load.multiatlas(Ar.default.DEFAULT.KEY,Ar.default.DEFAULT.JSON,Ar.default.DEFAULT.URL),this.load.bitmapFont(qr.default.PRIMARY.KEY,qr.default.PRIMARY.TEXTURE,qr.default.PRIMARY.DATA),this.load.bitmapFont(qr.default.PRIMARY_LIGHT.KEY,qr.default.PRIMARY_LIGHT.TEXTURE,qr.default.PRIMARY_LIGHT.DATA),this.load.atlas({key:Ar.default.EFFECTS.KEY,textureURL:Ar.default.EFFECTS.PATH,atlasURL:Ar.default.EFFECTS.JSON}),this.load.atlas({key:Ar.default.GAMEPLAY_32.KEY,textureURL:Ar.default.GAMEPLAY_32.TEXTURE,atlasURL:Ar.default.GAMEPLAY_32.JSON}),this.load.bitmapFont(qr.default.NUMBER_LIGHT.KEY,qr.default.NUMBER_LIGHT.TEXTURE,qr.default.NUMBER_LIGHT.DATA),this.load.atlas({key:Ar.default.GAMEPLAY.KEY,textureURL:Ar.default.GAMEPLAY.TEXTURE,atlasURL:Ar.default.GAMEPLAY.JSON}),this.load.bitmapFont(qr.default.NUMBER_DARK.KEY,qr.default.NUMBER_DARK.TEXTURE,qr.default.NUMBER_DARK.DATA),this.load.image(Ws.default.BACKGROUND.KEY,Ws.default.BACKGROUND.FILE),this.load.image(Ws.default.AVATAR.KEY,Ws.default.AVATAR.FILE),this.load.spine(Np.BEST_SCORE.KEY,Np.BEST_SCORE.JSON,Np.BEST_SCORE.ATLAS),this.load.spine(Np.LOGO.KEY,Np.LOGO.JSON,[Np.LOGO.ATLAS],!0),this.player.updateData().then().catch(Wt.sendException)},n.create=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.analytics.event(ni.AnalyticsEvents.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.lazyLoadResource(),this.startGame();case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setupGlobalScene=function(){var t=this.scene.get(ar.SceneKeys.GLOBAL_SCENE);t instanceof tE&&t.setup()},n.initModules=function(){new eb(this.game),new _E(this.game)},n.lazyLoadResource=function(){var t=this;setTimeout((function(){t.scene.wake(),t.loadSounds(),t.loadWideframesResource(),t.lazyLoadLevel(),t.lazyLoadLives(),t.load.once(Phaser.Loader.Events.COMPLETE,(function(){t.scene.sleep()}))}),1500)},n.lazyLoadLevel=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.storage.getState(),!gu(e)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.storage.dispatch(Fd());case 7:this.loadLevelConfig(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.lazyLoadLives=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,c,h,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,t.prev=2,e({type:ps,payload:{}}),t.next=6,null==(s=window.FBInstant.player.getDataAsync(["lives"]))?void 0:s.lives;case 6:return r=t.sent,o=Be(Lv.LivesStore+"-"+a)||{},c=o.lives,h=void 0===c?Fv.livesCapacity:c,l=o.lastBonusLifeTime,u=void 0===l?0:l,r&&(h=r.lives||0,u=r.lastBonusLifeTime||0),e({type:fs,payload:{data:{lives:h,lastBonusLifeTime:u}}}),e((function(t,e){t(Uv());var n=e(),i=60*Fv.bonusDurationMins*1e3,a=(new Date).getTime(),s=Ov(n),r=a-s;console.log(";remainingTime === ",r),t(r<i?Nv(i-(a-s)):Gv())})),t.next=15,e(zv());case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),e({type:gs,payload:{}});case 20:case"end":return t.stop()}}),t,null,[[2,17]])})));return function(e){return t.apply(this,arguments)}}());case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),n.loadLevelConfig=function(){try{var t=this.storage.getState(),e=gu(t),n=ed[e];n||(n=ed[ed.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.cache.tilemap.exists(a))return;this.load.tilemapTiledJSON(a,s),this.load.start()}catch(r){(0,Wt.sendException)(r)}},n.loadSounds=function(){var t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+ib.EFFECTS.KEY,this.handleLoadSoundCompleted),this.load.audioSprite(ib.EFFECTS.KEY,ib.EFFECTS.JSON,ib.EFFECTS.FILE)},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},e}(Phaser.Scene),sb=ab,rb=n(120),ob=n.n(rb),cb=function(){return(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,c,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.analytics,a=e.facebook,s=e.globalScene,t.prev=1,s.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",loading:!0}),r=n.getPlayer(),o=r.playerId,c=r.name,h=r.photo,t.next=6,a.inviteAsync({template:Us,cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:"Great! I have a best score!",localizations:{en_US:"Great! I have a best score!",vi_VN:"Th\u1eadt tuy\u1ec7t! M\xecnh v\u1eeba ph\xe1 k\u1ef7 l\u1ee5c n\xe0y!"}},image:"",data:{playerId:o,playerName:c,playerPhoto:h,type:Us}});case 6:i.event(ni.AnalyticsEvents.INVITE,{invite_content_type:"BestScore",success:!0}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.INVITE,{invite_content_type:"BestScore",success:!1}),(0,Wt.sendException)(t.t0);case 13:return t.prev=13,s.screen.close(Er),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,9,13,16]])})))},hb=n(328),lb={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(hb)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},ub=function(t){function e(e){return t.call(this,lb,e)||this}return(0,Kt.default)(e,t),e}(eo.default),db=ub,pb=Ar.default.DEFAULT,fb=pb.KEY,gb=pb.FRAME,mb=GameCore.Configs.Lives,vb=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.circle=void 0,n.icon=void 0,n.textLives=void 0,n.textTimer=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.iconBeat=void 0,n.intervalTimer=void 0,n.scene.add.existing((0,gr.default)(n)),n.createBackgroundLives(),n.createTextLives(),n.createTextTimer(),n.createIconPlus(),n.createHeartBeatAnimation(),n.setSize(140,27),n.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){n.scene.screen.open(zr)})),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackgroundLives=function(){this.background=this.scene.make.image({key:fb,frame:gb.LIVES_TIME_BLOCK}),this.background.setWorldSize(111,27),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.setFrameLivesTimeBlock2=function(){this.background.setFrame(gb.LIVES_TIME_BLOCK_2)},n.createIconPlus=function(){this.icon=this.scene.make.image({key:fb,frame:gb.ICON_PLUS}),this.icon.setWorldSize(14,14),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,-62,11)},n.createTextLives=function(){this.circle=this.scene.make.image({key:fb,frame:gb.LIVES_HEART}),this.circle.setWorldSize(38,31),this.add(this.circle),Phaser.Display.Align.In.Center(this.circle,this,-51,0);var t=this.scene.storage.getState(),e=_v(t);this.textLives=this.scene.make.text({text:""+e,style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}}),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.circle)},n.createTextTimer=function(){this.textTimer=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(40),text:"00:00",origin:{x:.2,y:.5}}),this.add(this.textTimer),Phaser.Display.Align.In.Center(this.textTimer,this,8,2)},n.updateTextLives=function(){var t=this.scene.storage.getState(),e=_v(t);this.textLives.setText(e)},n.startIntervalTimer=function(){var t=this;this.runHeartBeatAnimation();var e=60*mb.bonusDurationMins*1e3;this.intervalTimer=setInterval((function(){var n,i,a=t.scene.storage.getState(),s=_v(a)||0;if(s===mb.livesCapacity)return t.textTimer.setText("\u041f\u043e\u043b\u043d\u044b\u0439"),void t.textLives.setText(String(mb.livesCapacity));var o=Dv(a),c=Ov(a),h=(new Date).getTime();h-c<e&&(o=c);var l=(0,Ge.convertHMS)(e-(h-o)),u=r()(n="0"+l.minutes).call(n,-2),d=r()(i="0"+l.seconds).call(i,-2);ob()(t.textLives.text)!==s&&t.updateTextLives(),t.textTimer.setText(u+":"+d)}),1e3)},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setLives=function(t){this.textLives.setText(String(t))},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play(),this.iconBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new db({targets:[this.circle],props:{scale:"+=0.005"}}),this.textLivesBeat=new db({targets:[this.textLives],props:{scale:"+=0.05"}}),this.iconBeat=new db({targets:[this.icon],props:{scale:"+=0.025"}})},e}(Phaser.GameObjects.Container),yb=vb,Sb=Ar.default.DEFAULT,Ab=Sb.KEY,xb=Sb.FRAME,Eb=function(t){function e(e){var n;return(n=t.call(this,e,Ab,xb.BUTTON_DARK_BLUE)||this).button.setWorldSize(231,63),n.setName("Invite"),n.createText(),n}return(0,Kt.default)(e,t),e.prototype.createText=function(){var t=this.scene.make.image({key:Ab,frame:xb.TEXT_INVITE_FRIENDS});t.setWorldSize(198,21.5),this.add(t),Phaser.Display.Align.In.Center(t,this,0,0)},e}(Kr.default),bb=Eb,wb=Ar.default.DEFAULT,Tb=wb.KEY,Cb=wb.FRAME,Mb=GameCore.Configs.Lives,Ib=function(t){function e(e){var n;return(n=t.call(this,e,Tb,Cb.BUTTON_GREEN)||this).heart=void 0,n.textLives=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.button.setWorldSize(231,63),n.setName("RefillLives"),n.createText(),n.createIcon(),n.createHeart(),n.createHeartBeatAnimation(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createText=function(){var t=this.scene.make.image({key:Tb,frame:Cb.TEXT_REFILL_LIVES});t.setWorldSize(158,13),this.add(t),Phaser.Display.Align.In.Center(t,this,-18,0)},n.createIcon=function(){var t=this.scene.make.image({key:Tb,frame:Cb.ICON_ADS});t.setWorldSize(33,32),this.add(t),Phaser.Display.Align.In.Center(t,this,85,-3)},n.createHeart=function(){this.heart=this.scene.make.image({key:Tb,frame:Cb.LIVES_HEART}),this.heart.setAngle(-30),this.heart.setWorldSize(46,36),this.add(this.heart),Phaser.Display.Align.In.Center(this.heart,this,-105,-20),this.textLives=this.scene.make.text({text:"+"+Mb.livesCapacity,style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}}),this.textLives.setAngle(-30),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.heart)},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new db({targets:[this.heart],props:{scale:"+=0.005"}}),this.textLivesBeat=new db({targets:[this.textLives],props:{scale:"+=0.025"}})},e}(Kr.default),Pb=Ib,kb=Ar.default.DEFAULT,Rb=kb.KEY,_b=kb.FRAME,Ob=GameCore.Configs,Db=Ob.Network,Bb=Ob.Lives,Lb=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.currentScreen=void 0,s.refillLivesButton=void 0,s.inviteFriendButton=void 0,s.textTitle=void 0,s.livesContent=void 0,s.textContent=void 0,s.adsTimer=void 0,s.livesTimer=void 0,s.intervalTimer=void 0,s.textBlock=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.clickPlayWithFriend=function(){s.scene.storage.dispatch(cb())},s.handleShowRewardedVideoAd=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.scene.game,n=e.globalScene,i=e.audio,t.prev=2,e.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:Db.Timeout,loading:!0}),i.pauseMusic(),t.next=7,new(mt())((function(t,e){var n;null==(n=s.adsTimer)||n.remove(),s.adsTimer=s.scene.time.delayedCall(Db.Timeout,e),s.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?s.scene.ads.events.once(GameCore.Ads.Events.LOADED,t):s.scene.ads.preloadRewardedVideoAsync().then(t).catch(e)}));case 7:return t.next=9,s.scene.ads.showRewardedVideoAsync();case 9:s.scene.audio.playSound(Xr.default.DAILY_REWARD),s.scene.analytics.showRewardedVideoAd(s.getScreenName()),s.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={lives:Fv.livesCapacity,lastBonusLifeTime:(new Date).getTime()},t.next=4,e(Wv(n));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()),s.close(),t.next=23;break;case 15:if(t.prev=15,t.t0=t.catch(2),s.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,s.getScreenName(),t.t0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=22;break}if("USER_INPUT"!==t.t0.code){t.next=22;break}return s.showNotifySkipAds(),t.abrupt("return");case 22:s.showNotifyNoAds();case 23:return t.prev=23,null==(a=s.adsTimer)||a.destroy(),s.scene.audio.playMusic(),n.screen.close(Er),s.scene.ads.preloadRewardedVideoAsync().catch((function(t){console.log(t)})),r=s.getData(["onClose"]),(o=r[0])&&o(),t.finish(23);case 31:case"end":return t.stop()}}),t,null,[[2,15,23,31]])}))),s.showNotifyNoAds=function(t){if(!t||t.name===Er){var e=s.scene.game.globalScene;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(Er,{message:"\u041d\u0435\u0442 \u0440\u0435\u043a\u043b\u0430\u043c\u044b \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f!",duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var t=s.scene.game.globalScene;t.screen.events.off(GameCore.Screens.Events.CLOSE),t.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),t.screen.open(Er,{message:"\u0418\u0437\u0432\u0438\u043d\u0438, \u043d\u0430\u0433\u0440\u0430\u0434 \u043d\u0435\u0442!\n\u0422\u044b \u043e\u0442\u043a\u0430\u0437\u0430\u043b\u0441\u044f \u043e\u0442 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0440\u0435\u043a\u043b\u0430\u043c\u044b!",duration:3e3,loading:!1})},s.showGameOver=function(t){t&&t.name!==Er||s.scene.screen.close(s.name)},s.createPopup(),s.createLivesTimer(),s.createTitle(),s.createContentBackground(),s.createLiveContent(),s.createTextContent(),s.createButtons(),s.addItem(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){t.prototype.open.call(this,e),this.updateIntervalTimer(),this.startIntervalTimer(),this.runOpenAnimation(),null!=e&&e.currentScreen&&(this.currentScreen=e.currentScreen),this.showLivesTimer()},n.showLivesTimer=function(){var t=this.getData(["showLivesTimer"])[0];this.livesTimer.setVisible(t),t&&this.livesTimer.startIntervalTimer()},n.createLivesTimer=function(){this.livesTimer=new yb(this.scene),this.popup.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this.popup,0,-270)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:Rb,frame:_b.LIVES_HEART}),this.backgroundContent.setWorldSize(114,93),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createLiveContent=function(){var t=this.scene.storage.getState(),e=_v(t);this.livesContent=this.scene.make.text({text:""+e,style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(150)+"px",fontStyle:"700",align:"center"}}),this.livesContent.setTint(16777215),this.popup.add(this.livesContent),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)},n.createTextContent=function(){this.textBlock=this.scene.make.image({key:Rb,frame:_b.LIVES_TIME_BLOCK}),this.popup.add(this.textBlock),this.textBlock.setWorldSize(167,30),Phaser.Display.Align.In.Center(this.textBlock,this.backgroundContent,0,80),this.textContent=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(33),origin:{x:.5,y:.5}}),this.popup.add(this.textContent),Phaser.Display.Align.In.Center(this.textContent,this.textBlock,0,2)},n.startIntervalTimer=function(){var t=this;this.intervalTimer=setInterval((function(){t.updateIntervalTimer()}),1e3)},n.updateIntervalTimer=function(){var t,e,n=60*Bb.bonusDurationMins*1e3,i=this.scene.storage.getState(),a=_v(i),s=Dv(i),o=Ov(i),c=(new Date).getTime();c-o<n&&(s=o);var h=(0,Ge.convertHMS)(n-(c-s)),l=r()(t="0"+h.minutes).call(t,-2),u=r()(e="0"+h.seconds).call(e,-2);this.setTextContent("\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0436\u0438\u0437\u043d\u044c: "+l+":"+u),a>0?(this.textTitle.setFrame(_b.TEXT_KEEP_PLAYING),this.textTitle.setWorldSize(261,23.5)):(this.textTitle.setFrame(_b.TEXT_OUT_OF_LIVE),this.textTitle.setWorldSize(234,19)),ob()(this.livesContent.text)!=a&&(this.livesContent.setText(""+a),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)),a===Bb.livesCapacity?(this.setTextContent("\u041f\u043e\u043b\u043d\u044b\u0439"),this.refillLivesButton.setVisible(!1),this.inviteFriendButton.setVisible(!0)):(this.refillLivesButton.setVisible(!0),this.refillLivesButton.runHeartBeatAnimation(),this.inviteFriendButton.setVisible(!1))},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setTextContent=function(t){this.textContent.setText(t),Phaser.Display.Align.In.Center(this.textContent,this.textBlock,0,2)},n.createPopup=function(){this.popup=new vo(this.scene,0,-30,290,323),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-30)},n.createTitle=function(){this.title=this.scene.add.container(),this.textTitle=this.scene.make.image({key:Rb,frame:_b.TEXT_OUT_OF_LIVE}),this.textTitle.setWorldSize(234,19),this.buttonClose=new Kr.default(this.scene,Rb,_b.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.handleClose,this.title.add([this.textTitle,this.buttonClose]),this.popup.add([this.title]),Phaser.Display.Align.In.Center(this.textTitle,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtons=function(){this.createRefillLivesButton(),this.createInviteFriendButton()},n.createRefillLivesButton=function(){this.refillLivesButton=new Pb(this.scene),this.popup.add(this.refillLivesButton),this.refillLivesButton.onClick=this.handleShowRewardedVideoAd,Phaser.Display.Align.In.Center(this.refillLivesButton,this.popup,0,85)},n.createInviteFriendButton=function(){this.inviteFriendButton=new bb(this.scene),this.inviteFriendButton.setVisible(!1),this.popup.add(this.inviteFriendButton),this.inviteFriendButton.onClick=this.clickPlayWithFriend,Phaser.Display.Align.In.Center(this.inviteFriendButton,this.popup,0,85)},n.addItem=function(){this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){var n=this;if(!this.popupFadeOutMaskAnimation){var i=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:i,from:i,to:0}},onComplete:function(){var t=n.getData(["onClose"])[0];t&&t()}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),Fb=Lb,Nb=Ar.default.DEFAULT,Gb=Nb.KEY,Ub=Nb.FRAME,Vb=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.createBackground(),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.createBackground=function(){this.background=this.scene.make.image({key:Gb,frame:Ub.FOOTER,origin:{x:.5,y:1}}),this.background.setWorldSize(375,85),this.add(this.background)},e}(Phaser.GameObjects.Container),Yb=Vb,zb=Ar.default.DEFAULT,Wb=zb.KEY,Hb=zb.FRAME,Xb=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,Wb,Hb.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),Kb=Xb,jb=function(t){function e(e){var n;return(n=t.call(this,e)||this).leaf=void 0,n.createLeaf(),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.createLeaf=function(){this.leaf=new Kb(this.scene),this.add(this.leaf),Phaser.Display.Align.In.Center(this.leaf,this,0,this.leaf.displayHeight/2)},e}(Phaser.GameObjects.Container),qb=jb,Zb=Ar.default.DEFAULT,Jb=Zb.KEY,Qb=Zb.FRAME,$b=GameCore.Configs.Match,tw=function(t){function e(e){var n;return(n=t.call(this,e,Jb,Qb.BUTTON_MINOR)||this).suggestDailyMode=void 0,n.button.setWorldSize(62,53),n.setName("DailyChallenge"),n.createIcon(),n.createSuggestDailyMode(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Jb,frame:Qb.ICON_DAILY});t.setWorldSize(35,35),this.add(t),Phaser.Display.Align.In.Center(t,this,.5,-2.5)},n.createSuggestDailyMode=function(){this.suggestDailyMode=this.scene.make.image({key:Jb,frame:Qb.ICON_DOT_RED}),this.suggestDailyMode.setWorldSize(17,17),this.suggestDailyMode.setVisible(!1),this.add(this.suggestDailyMode),Phaser.Display.Align.In.Center(this.suggestDailyMode,this,28,-25)},n.checkSuggestDailyMode=function(){var t=window.game.player.getPlayer().playerId,e=Be($b.JourneyMatchStore+"-"+t)||{},n=Object(e).updateAt||0;(0,Ge.checkIsToday)(n)?this.suggestDailyMode.setVisible(!1):this.suggestDailyMode.setVisible(!0)},e}(Kr.default),ew=tw,nw=Ar.default.DEFAULT,iw=nw.KEY,aw=nw.FRAME,sw=function(t){function e(e){var n;return(n=t.call(this,e,iw,aw.BUTTON_BROWN)||this).button.setWorldSize(242,54),n.setName("Journey"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:iw,frame:aw.ICON_JOURNEY});t.setWorldSize(35,29),this.add(t),Phaser.Display.Align.In.Center(t,this,-77,-2)},n.createText=function(){var t=this.scene.make.image({key:iw,frame:aw.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-2)},e}(Kr.default),rw=sw,ow=Ar.default.DEFAULT,cw=ow.KEY,hw=ow.FRAME,lw=function(t){function e(e){var n;return(n=t.call(this,e,cw,hw.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("LeaderBoard"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:cw,frame:hw.ICON_RANK});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),uw=lw,dw=function(t){function e(e,n,i){var a;return(a=t.call(this,e,n,i)||this).logo=void 0,a.drawLogo(),e.add.existing((0,gr.default)(a)),a}return(0,Kt.default)(e,t),e.prototype.drawLogo=function(){var t=this;this.logo=this.scene.add.spine(0,0,Np.LOGO.KEY,Np.LOGO.ANIMATIONS.START_GROW),this.add(this.logo),this.logo.on("complete",(function(e){e.animation.name===Np.LOGO.ANIMATIONS.START_GROW&&t.logo.play(Np.LOGO.ANIMATIONS.IDLE_GROW,!0)}))},e}(Phaser.GameObjects.Container),pw=dw,fw=Ar.default.DEFAULT,gw=fw.KEY,mw=fw.FRAME,vw=function(t){function e(e){var n;return(n=t.call(this,e,gw,mw.BUTTON_GREEN_LARGE)||this).button.setWorldSize(242,70),n.setName("PlaySingle"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:gw,frame:mw.ICON_PLAY_GREEN});t.setWorldSize(31,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-93,-2)},n.createText=function(){var t=this.scene.make.image({key:gw,frame:mw.TEXT_SINGLE});t.setWorldSize(183.5,22),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-2)},e}(Kr.default),yw=vw,Sw=Ar.default.DEFAULT,Aw=Sw.KEY,xw=Sw.FRAME,Ew=function(t){function e(e){var n;return(n=t.call(this,e,Aw,xw.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Aw,frame:xw.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-1.5)},e}(Kr.default),bw=Ew,ww=function(t){function e(e){var n;return(n=t.call(this,e)||this).logo=void 0,n.playSingleButton=void 0,n.journeyButton=void 0,n.leaderBoardButton=void 0,n.dailyChallengeButton=void 0,n.settingButton=void 0,n.playSingleButtonAnimation=void 0,n.createLogo(),n.createPlaySingleButton(),n.createJourneyButton(),n.createLeaderBoardButton(),n.createDailyChallengeButton(),n.createSettingButton(),n.alignButton(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLogo=function(){this.logo=new pw(this.scene,0,0),this.add(this.logo),Phaser.Display.Align.In.Center(this.logo,this,0,-140)},n.createPlaySingleButton=function(){this.playSingleButton=new yw(this.scene),this.add(this.playSingleButton)},n.runPlaySingleButtonAnimation=function(){this.playSingleButtonAnimation.play()},n.createPlaySingleButtonAnimation=function(){this.playSingleButtonAnimation=new db({targets:[this.playSingleButton],props:{scale:{from:1,to:1.05}}})},n.createJourneyButton=function(){this.journeyButton=new rw(this.scene),this.add(this.journeyButton)},n.createLeaderBoardButton=function(){this.leaderBoardButton=new uw(this.scene),this.add(this.leaderBoardButton)},n.createDailyChallengeButton=function(){this.dailyChallengeButton=new ew(this.scene),this.add(this.dailyChallengeButton)},n.createSettingButton=function(){this.settingButton=new bw(this.scene),this.add(this.settingButton)},n.alignButton=function(){Phaser.Display.Align.In.Center(this.playSingleButton,this,0,44),Phaser.Display.Align.In.Center(this.journeyButton,this,0,118),Phaser.Display.Align.In.Center(this.leaderBoardButton,this,-90,192),Phaser.Display.Align.In.Center(this.dailyChallengeButton,this,0,192),Phaser.Display.Align.In.Center(this.settingButton,this,90,192)},e}(Phaser.GameObjects.Container),Tw=ww,Cw=[{key:"daily-level-0",mapJson:"./assets/json/daily-levels/level-0.json"}],Mw=1;Mw<=57;Mw++)Cw.push({key:"daily-level-"+Mw,mapJson:"./assets/json/daily-levels/level-"+Mw+".json"});var Iw=function(){var t=new Date("01/01/2022"),e=(new Date).getTime()-t.getTime();return Math.floor(e/864e5)%Cw.length},Pw=function(){var t=Iw();return Cw[t]},kw=Ar.default.DEFAULT,Rw=kw.KEY,_w=kw.FRAME,Ow=Ar.default.GAMEPLAY,Dw=Ow.KEY,Bw=Ow.FRAME,Lw=Ar.default.GAMEPLAY_32,Fw=Lw.KEY,Nw=Lw.FRAME,Gw=GameCore.Configs,Uw=Gw.Network,Vw=Gw.Board,Yw=function(t){function e(e,n,i,a){var s;(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var t=s.getData(["onClose"])[0];s.scene.screen.close(s.name),t&&t()}))},s.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},s.scene=e;try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(Wr),s.background.setAlpha(.5)}catch(r){console.log("ex === ",r)}return s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.prototype.open.call(this,n),this.showLoadingScreen(),this.loadLevelConfig();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=Pw(),e=t.key,n=t.mapJson;if(this.scene.cache.tilemap.exists(e))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(e,n),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(i){(0,Wt.sendException)(i)}},n.handleLoadCurrentMapComplete=function(){this.startGame(),this.hideLoadingScreen()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!gu(e)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.scene.storage.dispatch(Fd());case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:Uw.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(Er)},n.createPopup=function(){this.popup=new vo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:Rw,frame:_w.TEXT_DAILY_CHALLENGE});t.setWorldSize(261,20),this.buttonClose=new Kr.default(this.scene,Rw,_w.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:Rw,frame:_w.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:Rw,frame:_w.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=Pw().key,i=this.scene.make.tilemap({key:n}).properties;if(i&&(0,Hv.isArray)(i)&&!(i.length<2))for(var a=i[0].value,s=kv()(t=kv()(e=kv()(a).call(a,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),r=JSON.parse(s),o=Y()(r),c=this.calcPosition(o.length),h=0;h<o.length;h++){var l=o[h],u=OS[l],d=r[l],p=this.targetData[h];p||(p=this.spawnTargetItem(u,d));var f=p,g=f.container,m=f.text,v=f.gem;g.setVisible(!0),m.setText("x"+d),v.setFrame(u),this.targetData.push(p),Phaser.Display.Align.In.Center(g,this.popup,c[h],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:Fw,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:Dw,frame:Bw.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<Vw.rows;t++){this.boardCellData[t]=[];for(var e=0;e<Vw.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=Nw.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(s)}}},n.updateCellBoard=function(){this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<Vw.rows;t++)for(var e=0;e<Vw.cols;e++){this.boardCellData[t][e].setFrame(Nw.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=rf()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=ZS(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var t=Pw().key,e=this.scene.make.tilemap({key:t}).layers;if((0,Hv.isArray)(e)){var n=e[0].data;if((0,Hv.isArray)(n))for(var i=0;i<n.length;i++)for(var a=n[i],s=0;s<a.length;s++){var r=a[s];if(!(r.index<0)){var o=OS[r.index-1];this.boardCellData[i][s].setFrame(o)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:Fw,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Kr.default(this.scene,Rw,_w.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:Rw,frame:_w.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:Rw,frame:_w.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-32,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState();gu(e)>ed.length||(t.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e({type:oa,payload:{}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.scene.storage.dispatch(Jd()),t.scene.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_BEGIN))}))},n.getLevelName=function(t){var e;return"journey_"+Sr()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),zw=Ar.default.DEFAULT,Ww=zw.KEY,Hw=zw.FRAME,Xw=Ar.default.GAMEPLAY,Kw=Xw.KEY,jw=Xw.FRAME,qw=Ar.default.GAMEPLAY_32,Zw=qw.KEY,Jw=qw.FRAME,Qw=GameCore.Configs,$w=Qw.Network,tT=Qw.Board,eT=function(t){function e(e,n,i,a){var s;(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var t=s.getData(["onClose"])[0];s.scene.screen.close(s.name),t&&t()}))},s.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}};try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(Wr),s.background.setAlpha(.5)}catch(r){console.log("ex === ",r)}return s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=gu(t),n=ed[e];n||(n=ed[ed.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.scene.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(a,s),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Wt.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!gu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Fd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:$w.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(Er)},n.createPopup=function(){this.popup=new vo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:Ww,frame:Hw.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.buttonClose=new Kr.default(this.scene,Ww,Hw.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:Ww,frame:Hw.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:Ww,frame:Hw.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=gu(n),a=ed[i];a||(a=ed[ed.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,Hv.isArray)(s)&&!(s.length<2))for(var r=s[0].value,o=kv()(t=kv()(e=kv()(r).call(r,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),c=JSON.parse(o),h=Y()(c),l=this.calcPosition(h.length),u=0;u<h.length;u++){var d=h[u],p=OS[d],f=c[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:Zw,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:Kw,frame:jw.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<tT.rows;t++){this.boardCellData[t]=[];for(var e=0;e<tT.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=Jw.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(s)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=pu(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<tT.rows;t++)for(var e=0;e<tT.cols;e++){this.boardCellData[t][e].setFrame(Jw.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=rf()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=ZS(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=gu(t),n=ed[e];n||(n=ed[ed.length-1]);var i=this.scene.make.tilemap({key:n.key}).layers;if((0,Hv.isArray)(i)){var a=i[0].data;if((0,Hv.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=OS[c.index-1];this.boardCellData[s][o].setFrame(h)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:Zw,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Kr.default(this.scene,Ww,Hw.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:Ww,frame:Hw.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:Ww,frame:Hw.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this,e=this.scene.storage.getState();_v(e)<1?this.scene.screen.open(zr):(this.scene.storage.dispatch(Yv()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=gu(e);n>ed.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Jd()))})))},n.getLevelName=function(t){var e;return"journey_"+Sr()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),nT=Ar.default.DEFAULT,iT=nT.KEY,aT=nT.FRAME,sT=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(t){s.scene.player.setSetting("music",t),t?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(t){s.scene.player.setSetting("sound",t)},s.handleVibrateSetting=function(t){t&&um(199),s.scene.player.setSetting("vibrate",t)},s.createPopup(),s.createContentBackground(),s.createTitle(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){var t=this.scene.make.image({key:iT,frame:aT.POPUP_CONTENT_BACKGROUND});t.setWorldSize(260,145),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-4)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,286,226),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:iT,frame:aT.TEXT_SETTING});t.setWorldSize(151.5,24),this.buttonClose=new Kr.default(this.scene,iT,aT.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-18)},n.createButtons=function(){var t=this.scene.player.getPlayerSettings(),e=t.sound,n=t.vibrate;this.createSoundButton(e),cm()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.popup,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,0)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:iT,frame:aT.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new GA(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:iT,frame:aT.ICON_SOUND});e.setWorldSize(40,35),this.settingSound=new GA(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-33)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),rT=sT,oT=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).main=void 0,n.header=void 0,n.footer=void 0,n.run=function(){n.checkAndAddShortcut(),n.main.dailyChallengeButton.checkSuggestDailyMode(),n.ads.showBannerAdAsync().catch(Wt.sendException)},n.onCreate=function(){var t=n.storage.getState(),e=Ll(t);null===e?n.storage.dispatch(jd(!1)):!1===e&&n.showMiniJourneyScreen(),n.run()},n.onResume=function(){n.run()},n.onWake=function(){n.run();var t=n.storage.getState();Ll(t)||n.showMiniJourneyScreen()},n.clickPlayWithFriend=function(){n.storage.dispatch($d())},n.clickPlaySolo=function(){n.storage.dispatch(Zd())},n.clickJourney=function(){console.log("Click journey"),n.storage.dispatch(Jd())},n.clickLevelScene=function(){console.log("Click Level Scene"),n.scene.switch(ar.SceneKeys.LEVEL_SCENE)},n.clickLeaderBoard=function(){n.screen.open(Pr)},n.clickJourney1=function(){console.log("Click journey 1"),n.scene.switch(ar.SceneKeys.LEVEL_SCENE)},n.clickSetting=function(){n.screen.open(wr)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.showDailyChallengeScreen=function(){this.storage.dispatch(jd(!0)),this.screen.open(Rr)},n.checkAndAddShortcut=function(){var t=this.storage.getState();$s(t)===Xs&&this.facebook.attemptToAddShortcut()},n.preload=function(){this.events.on("wake",this.onWake),this.events.on("resume",this.onResume),this.events.on("create",this.onCreate)},n.create=function(){t.prototype.create.call(this),this.createBackground(Ws.default.BACKGROUND.KEY),this.createHeaderBar(),this.createMainContent(),this.createFooterBar(),this.createScreens()},n.createHeaderBar=function(){this.header=new qb(this),this.header.setDepth(jr.default.BUTTON),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createMainContent=function(){this.main=new Tw(this),this.main.setDepth(jr.default.LOGO),this.main.playSingleButton.onClick=this.clickPlaySolo,this.main.journeyButton.onClick=this.clickLevelScene,this.main.leaderBoardButton.onClick=this.clickLeaderBoard,this.main.dailyChallengeButton.onClick=this.showDailyChallengeScreen.bind(this),this.main.settingButton.onClick=this.clickSetting,Phaser.Display.Align.In.Center(this.main,this.gameZone)},n.createFooterBar=function(){this.footer=new Yb(this),this.footer.setDepth(jr.default.BUTTON),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createScreens=function(){this.createSettingsScreen(),this.createLeaderBoardScreen(),this.createDailyChallengeScreen(),this.createMiniJourneyScreen(),this.createClaimHeartScreen()},n.createSettingsScreen=function(){this.screen.add(wr,rT)},n.createLeaderBoardScreen=function(){this.screen.add(Pr,Lp)},n.createDailyChallengeScreen=function(){this.screen.add(Rr,Yw)},n.createMiniJourneyScreen=function(){this.screen.add(kr,eT)},n.createClaimHeartScreen=function(){this.screen.add(zr,Fb)},n.showMiniJourneyScreen=function(){this.storage.dispatch(jd(!0)),this.screen.open(kr)},e}(Fp.default);var cT=oT,hT=Ar.default.GAMEPLAY_32,lT=hT.KEY,uT=hT.FRAME,dT=function(t){function e(e,n){var i;return(i=t.call(this,e,n.x+(n.padding||0),n.y+(n.padding||0),lT,uT.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenStartMission=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenFadeOut=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.alpha0=i.alpha,i.scene=e,i.createTweenFadeOut(),i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),e.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createTweenFadeOut=function(){this.tweenFadeOut=this.scene.add.tween({targets:[this],duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:this.alpha,to:0},scale:{from:this.scale,to:0},paused:!0})},n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:lT,frame:uT.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:lT,frame:uT.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:lT,frame:uT.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:lT,frame:uT.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var t=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:t,to:0,start:t},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){var t=this.frame.name+"_light";this.imageHighlight.setFrame(t),this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(t){this.rateShaking=t},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var t=this.alpha0<90?1:-1;this.t0+=3e3/1900;var e=.016*this.t0,n=Jp(this.v0,this.alpha0,e),i=Qp(this.v0,this.alpha0,e);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,console.log("this.imageBreak.y === ",e,this.t0,this.imageBreak.y),this.imageBreak.rotation+=.04*t,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},n.playAnimFadeOut=function(){this.tweenFadeOut.play()},e}(Phaser.GameObjects.Image),pT=dT,fT=n(482),gT=n(458),mT=function(){function t(t){this.scene=void 0,this.tweenScaleUp=void 0,this.tweenScaleDown=void 0,this.tweenMoveTo=void 0,this.target=void 0,this.handleOnComplete=void 0,this.playing=void 0,this.path=void 0,this.scene=t,this.path=new Phaser.Curves.Path}var e=t.prototype;return e.runScaleUpAnimation=function(t,e){var n;null==(n=this.tweenScaleUp)||n.remove(),this.tweenScaleUp||(this.tweenScaleUp=new fT.default({targets:[this.target],delay:t,duration:e,props:{scale:"+=0.05"}})),this.tweenScaleUp.play()},e.runScaleDownAnimation=function(t,e){var n;null==(n=this.tweenScaleDown)||n.remove(),this.tweenScaleDown||(this.tweenScaleDown=new gT.default({targets:[this.target],delay:t,duration:e,props:{scale:"-=0.15"}})),this.tweenScaleDown.play()},e.runAnimMoveToPosition=function(t,e,n,i){var a=this;this.playing=!0,this.target.setDepth(jr.default.ON_TOP);var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=Math.abs(n-s)/2,c=Math.abs(i-r),h=Phaser.Math.Between(1,2),l=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=(o-d*Phaser.Math.Between(o/4,o/3))*h,f=r-u*(c/4);l.push(new Phaser.Math.Vector2(p,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var g=new Phaser.Curves.Spline(l);this.tweenMoveTo=this.scene.add.tween({delay:t,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:e,onUpdate:function(t){var e=t.getValue(0),n=g.getPoint(e);a.target.setPosition(n.x,n.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}})},e.runGemMoveToPosition=function(t,e,n,i){var a=this;this.playing=!0;var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=this.scene.gameZone.width/2,c=Math.abs(n-s)+o-50,h=Math.abs(i-r),l=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=1.5*(c-d*Phaser.Math.Between(c/8,c/7)),f=r-u*(h/4);l.push(new Phaser.Math.Vector2(p,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var g=new Phaser.Curves.Spline(l);return this.tweenMoveTo=this.scene.add.tween({delay:t,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:e,onUpdate:function(t){var e=t.getValue(0),n=1-e+.1,i=g.getPoint(e);a.target.setAlpha(n),a.target.setPosition(i.x,i.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}}),this.tweenMoveTo},e.setTarget=function(t){this.target=t},(0,Se.default)(t,[{key:"onComplete",set:function(t){this.handleOnComplete=t}},{key:"isPlaying",get:function(){return this.playing}}]),t}(),vT=function(){function t(t){this.scene=void 0,this.listAnimCollectionItem=[],this.scene=t}var e=t.prototype;return e.handleShowEffect=function(t){var e=this;if(t&&0!==t.length){for(var n=this.scene.header.collectItems.getTargetKeys(),i=this.scene.header.collectItems.getJsonAmount(),a=this.scene.header.collectItems.getJsonTarget(),s=0,r=function(r){var o=n[r],c=h()(t).call(t,(function(t){return t.frame===o}));i[o]+c.length>=a[o]&&s++,e.showEffect(c)},o=0;o<n.length;o++)r(o);s===Y()(a).length&&this.scene.setLevelCompleted(!0),this.scene.time.delayedCall(2e3,(function(){e.scene.handleCollectionItemsComplete()}))}},e.showEffect=function(t){for(var e=this,n=t.length,i=this.scene.main.board.dataBoard,a=function(a){var s=t[a],r=s.x,o=s.y,c=s.frame,h=i[o][r].cell,l=h.imageBreak,u=e.scene.gameZone.width/2,d=e.scene.header.collectItems.getPositionCollectionItem(c),p=u+d.x,f=d.y-24,g=e.getFreeAnim();h.resetImageBreak(),l.setVisible(!0),l.setFrame(c),g.setTarget(l),g.onComplete=function(){(n--,l.setVisible(!1),l.setPosition(h.x,h.y),e.scene.header.collectItems.collectItem(c),n<=0)&&(e.scene.header.collectItems.getCollectItemByKey(c).runAnimCollectionItem(),e.scene.updateMatchData())},g.runScaleUpAnimation(0,300),g.runScaleDownAnimation(450,400),g.runAnimMoveToPosition(700,Phaser.Math.Between(500,1e3),p,f)},s=0;s<t.length;s++)a(s)},e.getFreeAnim=function(){var t=new mT(this.scene);return this.listAnimCollectionItem.push(t),t},t}(),yT=vT,ST=function(){function t(t){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createTweenBreaking()},e.handleShowEffect=function(t){var e=this;t&&0!==t.length&&(this.removeCaptureCell(),this.captureCells=t,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){e.breakingTween.isPlaying()||e.removeCaptureCell()}}))},e.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var t=this.scene.main.board.dataBoard,e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.removeCaptureCell=function(){var t=this.scene.main.board.dataBoard;if(this.captureCells)for(var e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.setValueCaptureCell=function(){for(var t=this.scene.main.board.dataBoard,e=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,e),a=Phaser.Math.Between(82,98)*Math.PI/180,s=Phaser.Math.Between(3,10)/1e3,r=this.captureCells[n],o=r.x,c=t[r.y][o].cell;c.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,c.imageBreak.setVisible(!0),c.imageBreak.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM),c.v0=i,c.alpha0=a,c.scaleRate0=s}},e.createTweenBreaking=function(){var t=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(e){if(t.captureCells)for(var n=t.scene.main.board.dataBoard,i=0;i<t.captureCells.length;i++){t.angle=Phaser.Math.Between(-15,15);var a=t.captureCells[i],s=a.x,r=n[a.y][s].cell,o=r.imageBreak,c=r.maxScale0,h=r.alpha0<1.57?1:-1,l=.016*e.getValue(),u=Jp(r.v0,r.alpha0,l),d=Qp(r.v0,r.alpha0,l);o.setVisible(!0),o.x=r.x0+u,o.y=r.y0+-d,o.rotation+=.04*h,o.scale>c?o.scale-=r.scaleRate0:o.scale=c}},onComplete:function(){t.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},t}(),AT=ST,xT=Ar.default.GAMEPLAY,ET=xT.KEY,bT=xT.FRAME,wT=Ar.default.GAMEPLAY_32,TT=wT.KEY,CT=wT.FRAME,MT=GameCore.Configs.Board,IT=MT.cols,PT=MT.rows,kT=Ar.default.DEFAULT.FRAME,RT=GameCore.Configs.Gameplay.VibrateValue,_T=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=4.5,a.borderTopSize=3,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.collectionEffect=void 0,a.canCaptureLines=function(t,e){void 0===e&&(e=5);for(var n=t.length,i=t[0].length,a=[],s=[],r=[],o=0;o<n;o++){for(var c=0,h={x:-1,y:-1},l=0;l<i;l++)0===o&&(r[l]={count:0,x:-1,y:-1}),1===t[o][l].value?(r[l].count++,c++):(h.x=l,h.y=o,r[l].x=l,r[l].y=o);if(c===i-1&&s.push((0,Tt.default)({row:o},h)),o===n-1)for(var u=0;u<i;u++)r[u].count===n-1&&a.push((0,Tt.default)({col:u},r[u]))}if(s.length>=e)for(var d=0,p={x:-1,y:-1},f=0;f<s.length;f++)if(0!==f){if(s[f].x===p.x&&s[f].y===p.y+1?(p.x=s[f].x,p.y=s[f].y,d++):d=1,d>=e)return{isCapture:!0,direction:"vertical",minLine:e}}else p.x=s[f].x,p.y=s[f].y,d++;if(a.length>=e)for(var g=0,m={x:-1,y:-1},v=0;v<a.length;v++)if(0!==v){if(a[v].x===m.x+1&&a[v].y===m.y?(m.x=a[v].x,m.y=a[v].y,g++):g=1,g>=e)return{isCapture:!0,direction:"horizontal",minLine:e}}else m.x=a[v].x,m.y=a[v].y,g++;return{isCapture:!1,direction:"",minLine:e}},a.scene=e,a.setSize(n,i),a.woodenEffect=new AT(a.scene),a.collectionEffect=new yT(a.scene),a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var t=this.scene.gameZone,e=t.width/2,n=t.height/2-27;this.boardFrame=this.scene.make.image({x:e,y:n,key:ET,frame:bT.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=1.8,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(IT+1))/IT},n.initDataBoard=function(){for(var t=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,e=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<PT;n++){this.dataBoard[n]=[];for(var i=0;i<IT;i++){var a=t+i*this.cellSize+this.cellPadding*i,s=e+n*this.cellSize+this.cellPadding*n,r={x:a,y:s,width:this.cellSize,height:this.cellSize,texture:TT,frame:CT.GEM_TRANSPARENT,depth:jr.default.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new pT(this.scene,r);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:s,width:this.cellSize,height:this.cellSize,frame:CT.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleHighlight=function(t,e){this.cellsHighlight=t;for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y,r=i.frame;if(this.dataBoard[s]&&this.dataBoard[s][a]&&0===this.dataBoard[s][a].value){var o=this.dataBoard[s][a].cell;this.dataBoard[s][a].frame=r||CT.GEM,o.setVisible(!0),o.setFrame(r||CT.GEM),o.setAlpha(.3)}}this.canCaptureCells(t,e)},n.handleTweenStartMission=function(){for(var t=this,e=100,n=0;n<PT;n++)for(var i=function(i){var a=t.dataBoard[n][i].cell,s=0;s=4==n&&4==i?e:n>=3&&n<=5&&i>=3&&i<=5?200:n>=2&&n<=6&&i>=2&&i<=6?300:n>=1&&n<=7&&i>=1&&i<=7?400:500,t.scene.time.delayedCall(s,(function(){a.playTweenStartMission()}))},a=0;a<IT;a++)i(a)},n.handleCapturePiece=function(t){var e=this;try{!function(){if(!t||t.length<=0)throw KS=0,new Error("Invalid Capture");var n=h()(t).call(t,(function(t){return t.frame!==CT.GEM}));e.collectionEffect.handleShowEffect(n);for(var i=300,a=0,s=YS(e.dataBoard),r=zS(e.dataBoard),o=FS(),c=function(n){var c=t[n],h=c.x,l=c.y,u=e.dataBoard[l][h].cell,d=0,p=0,f=0;if(s.length>0&&r.length>0){var m=0,v=0;a=i/IT,-1!==g()(s).call(s,l)&&-1===g()(r).call(r,h)&&(m=a*h,v=0,p=g()(s).call(s,l)),-1===g()(s).call(s,l)&&-1!==g()(r).call(r,h)&&(m=0,v=a*l,p=g()(r).call(r,h)),-1!==g()(s).call(s,l)&&-1!==g()(r).call(r,h)&&(m=a*h,v=a*l,p=Math.max(g()(r).call(r,h),g()(s).call(s,l),0)),-1===g()(s).call(s,l)&&-1===g()(r).call(r,h)&&(m=a*h,v=a*l),d=Math.max(m,v,0)}else if(r.length>0)d=(a=i/IT)*l,p=g()(r).call(r,h),f=l;else if(s.length>0)d=(a=i/PT)*h,p=g()(s).call(s,l),f=h;else{a=100;var y=t[0].x;d=a*(h-y),p=0}u.hideImageHighlight(),e.scene.time.delayedCall(d,(function(){if(u.frame.name===CT.GEM){u.resetImageBreak();var t="";o>2&&(r.length>=3||s.length>=3)?(t=rm[f]||rm[0],u.imageBreak.setFrame(t)):(t=sm[p]||sm[0],u.imageBreak.setFrame(t)),u.playTweenScaleDown()}0==e.dataBoard[l][h].value&&u.setVisible(!1)})),e.dataBoard[l][h].frame=CT.GEM_TRANSPARENT,e.dataBoard[l][h].value=0},l=0;l<t.length;l++)c(l)}()}catch(n){}},n.checkPositionCellOnCaptureCell=function(t,e){var n=h()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return n&&n.length>0},n.handlePraise=function(t,e){for(var n=[],i=0;i<t.length;i++){var a=t[i];this.checkPositionCellOnCaptureCell(a,e)&&n.push(a)}0!==n.length&&this.playEatSound(1)},n.handleStreakBreak=function(t,e){var n=FS(),i=jS();if(t-75<0&&(t=75),t+75>375&&(t=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&um(s),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(kT.BG_STREAK),this.scene.effectManager.streakBreak.playAnim(t,e-20)}},n.getVibrateByLevel=function(t){return RT[t]||0},n.playEatSound=function(t){switch(this.scene.audio.playSound(Xr.default.EAT_BLOCK),t){default:break;case 2:this.scene.audio.playSound(Xr.default.GOOD);break;case 3:this.scene.audio.playSound(Xr.default.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(Xr.default.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var t=0;t<this.cellsHighlight.length;t++){var e=this.cellsHighlight[t],n=e.x,i=e.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=CT.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(CT.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){console.log(s)}},n.canCaptureCells=function(t,e){for(var n=this,i=this.dataBoard,a=[],s=0;s<i.length;s++){a[s]=[];for(var r=0;r<i[s].length;r++)a[s][r]=(0,Tt.default)({},i[s][r])}for(var o=0;o<t.length;o++){var c=t[o],h=c.x;a[c.y][h].value=1}this.removeAnimCanCaptureCells(a,t);var l=NS(a,t);if(!l||l.length<=0)return!1;for(var u=function(e){var i=l[e],a=i.x,s=i.y;t.some((function(t){return t.x===a&&t.y===s}))||n.cellSharking.push((0,Tt.default)({},l[e]))},d=0;d<l.length;d++)u(d);for(var p=0;p<this.cellSharking.length;p++){var f=this.cellSharking[p],g=f.x,m=f.y,v=this.dataBoard[m][g].cell;v.isHighlight()||v.showImageHighlight()}e(YS(a),zS(a),VS(a,t),t)},n.removeAnimCanCaptureCells=function(t,e){var n=this;if(0!==this.cellSharking.length){for(var i=YS(t),a=zS(t),s=VS(t,e),r=function(t){var e=n.cellSharking[t],r=e.x,o=e.y,c=n.dataBoard[o][r].cell;if(-1!==g()(i).call(i,o)||-1!==g()(a).call(a,r)||s.some((function(t){return t.x===r&&t.y===o})))return"continue";c.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)r(o);this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var t=0;t<this.cellSharking.length;t++){var e=this.cellSharking[t],n=e.x,i=e.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(t){try{this.suggestCells=t;for(var e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(CT.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){console.log(r)}},n.handleRemoveSuggestMove=function(){try{for(var t=0;t<this.suggestCells.length;t++){var e=this.suggestCells[t],n=e.x,i=e.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(CT.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){console.log(s)}},n.handleMove=function(t,e){try{for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y,r=i.frame,o=void 0===r?CT.GEM:r;if(this.dataBoard[s]&&this.dataBoard[s][a]){this.dataBoard[s][a].frame=o,this.dataBoard[s][a].value=1;var c=this.dataBoard[s][a].cell;c.setVisible(!0),c.setFrame(o),c.setAlpha(1)}}var h=NS(this.dataBoard,t);this.handleCapturePiece(h),this.handlePraise(t,h),e&&e(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(l){console.log(l)}},n.handleResetFrameBoard=function(){for(var t=0;t<PT;t++)for(var e=0;e<IT;e++)if(this.dataBoard[t]&&this.dataBoard[t][e]&&1===this.dataBoard[t][e].value){var n=this.dataBoard[t][e],i=n.frame,a=n.cell;a.visible||(0,Wt.sendException)(new Error("Cell is invisible")),a.frame.name!==i&&(0,Wt.sendException)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.handleGameOver=function(){if(!this.scene.isLevelComplete){for(var t=[],e=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<e.length;i++){var a=e[i],s=a.position;if(!a.used){var r=n[s].piece;t.push({data:r.data,type:r.type,direction:r.direction,isReverse:r.isReverse,frame:r.frame})}}WS(this.dataBoard,t)&&(this.scene.disableInput(),this.runAnimationGameOver())}},n.runAnimationGameOver=function(){var t=this;try{this.scene.audio.playSound(Xr.default.BOARD_GAME_OVER);for(var e=[],n=function(n){for(var i=function(i){if(t.dataBoard[n]&&t.dataBoard[n][i]&&1===t.dataBoard[n][i].value){var a=Math.floor(100*(n+1));e.push({delay:a,x:i,y:n}),t.scene.time.delayedCall(a,(function(){t.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<IT;a++)i(a)},i=0;i<PT;i++)n(i);this.scene.time.addEvent({delay:e[e.length-1].delay+300,callback:function(){t.scene.handleRequestFinishGame()}})}catch(a){console.log(a)}},n.hasPieceL5=function(){var t=this.scene.footer.pieces.piecesActive;return h()(t).call(t,(function(t){return t.type===Ay})).length>0},n.hasPieceCross5=function(){var t=this.scene.footer.pieces.piecesActive;return h()(t).call(t,(function(t){return t.type===Ry})).length>0},n.getBoardByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){e[s]=[];for(var r=JS(i[s]),o=0;o<r.length;o++)e[s][o]=r[o]}return e},n.getFenByBoard=function(){for(var t="",e=0;e<PT;e++){for(var n="",i=0;i<IT;i++){var a=this.dataBoard[e][i],s=a.value,r=a.frame,o=qS(r)||"g";switch(s){case 0:n+=",x";break;case 1:n+=","+o}}t+="/"+(n=n.substring(1))}return t.substring(1)},n.startGame=function(t,e){if(t){for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++){var a=t[n][i].frame,s=t[n][i].value,r=this.dataBoard[n][i];1===s&&(a&&a!==CT.GEM_TRANSPARENT||((0,Wt.sendExceptionWithScope)(new Error("MapByBoardError"),{level:this.scene.levelManager.getLevel(),row:n,col:i,frame:a,fen:e}),a=CT.GEM),r.value=1,r.frame=a,r.cell.setFrame(a),r.cell.setVisible(!0),r.cell.setWorldSize(this.cellSize,this.cellSize),r.cell.setAlpha(0),r.cell.setScale(0))}this.fadeIn()}},n.clearBoard=function(){for(var t=0;t<PT;t++)for(var e=0;e<IT;e++){var n=this.dataBoard[t][e];n.value=0,n.frame=CT.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(CT.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(t){var e,n=h()(e=this.cellsHighlight).call(e,(function(e){return e.x===t.x&&e.y&&t.y}));return!!(n&&n.length>0)},n.setFrameBoardByIndex=function(t,e,n){var i=this.dataBoard[t][e],a=i.cell;a.setFrame(n),a.setVisible(!0),i.frame=n,i.value=1,a.setScale(0),a.setAlpha(0)},n.getFrameByMapItemIndex=function(t){return console.log("index === ",t),OS[t]},n.fadeOut=function(){for(var t=[],e=0;e<PT;e++)for(var n=0;n<IT;n++){var i=this.dataBoard[e][n];i.value&&t.push(i.cell)}if(!t||0===t.length)return null;var a=this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:1,to:0},scale:{from:t[0].scale,to:0},paused:!0});return a.play(),a},n.fadeIn=function(){for(var t=[],e=0;e<PT;e++)for(var n=0;n<IT;n++){var i=this.dataBoard[e][n];i.value&&t.push(i.cell)}t&&0!==t.length&&this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:t[0].alpha0},scale:{from:0,to:t[0].scale0},paused:!0}).play()},e}(Phaser.GameObjects.Container),OT="score",DT="collect",BT=GameCore.Configs.Gameplay.VibrateValue,LT=Ar.default.EFFECTS,FT=LT.KEY,NT=LT.FRAME,GT=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=e,e.add.existing((0,gr.default)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(FT),this.particle.setDepth(jr.default.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:NT.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(jr.default.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var t,e=this,n=this.scene.storage.getState(),i=_l(n),a=this.scene.gameZone.width/2;g()(t=[js,Ks,qs]).call(t,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:1e3,duration:300,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var t=this.scene.storage.getState(),e=0;_l(t)===Xs&&(e=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(e+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(e+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:FT}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(jr.default.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var t=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var e=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:e},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){t.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:e,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){t.praiseFrame.setScale(0),t.praiseFrame.setAlpha(0),t.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(jr.default.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(t,e,n,i){this.startX=t,this.startY=e+15,this.listScore.push(n);var a=t-10,s=this.scene.targetMissionManager.getTargetType()===OT;this.scoreText.setPosition(a,e+15),this.scoreText.setText("+"+n),this.scoreText.setVisible(s),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,e+15)),s&&(this.playAnimShowScoreText(),this.handlePraiseFrameText(t,e,i));var r=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&um(r),i<=1||this.changeExplode(a,e,i)},n.getVibrateByLevel=function(t){return BT[t]||0},n.changeExplode=function(t,e,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,t,e)},n.handlePraiseFrameText=function(t,e,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0,r=this.scene.targetMissionManager.getTargetType()===OT?-40:0;switch(i){case NT.TEXT_COOL:a=112,s=31.5;break;case NT.TEXT_GOOD:a=163.5,s=31.5;break;case NT.TEXT_EXCELLENT:a=149.5,s=31}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s),this.praiseFrame.setPosition(t-a/2<0?a/2:t,e+r),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(t){return py[t-1]||py[0]||null},n.getMainFrameByLevel=function(t){var e=dy[t-1]||dy[0];return Phaser.Utils.Array.GetRandom(e.frames)},n.reset=function(){this.createTweenScoreText()},e}(Phaser.GameObjects.Container),UT=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=e,e.add.existing((0,gr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new _T(this.scene,354,352)},n.createPraise=function(){this.praise=new GT(this.scene)},e}(Phaser.GameObjects.Container),VT=UT,YT=Ar.default.DEFAULT,zT=YT.KEY,WT=YT.FRAME,HT=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.bestScoreText=void 0,n.titleText=void 0,n.dayText=void 0,n.titleDayText=void 0,n.setPosition(0,48.5),n.createBackground(),n.createScoreText(),n.createLevelTitleText(),n.createTitleDayText(),n.createDayText(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:zT,frame:WT.BEST_SCORE_FRAME}),this.background.setWorldSize(55,77),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(32),origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,23)},n.createTitleDayText=function(){this.titleDayText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(18),origin:{x:.5,y:.5},text:"dd.mm.yy"}),this.add(this.titleDayText),Phaser.Display.Align.In.Center(this.titleDayText,this.background,0,4)},n.createDayText=function(){this.dayText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"0"}),this.add(this.dayText),Phaser.Display.Align.In.Center(this.dayText,this.background,0,23)},n.createLevelTitleText=function(){this.titleText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"\u0423\u0420\u041e\u0412\u0415\u041d\u042c"}),this.add(this.titleText),Phaser.Display.Align.In.Center(this.titleText,this.background,0,4)},n.setScoreText=function(t){this.bestScoreText.setText(String(t))},n.setDayText=function(t){this.dayText.setText(t)},n.showTextScore=function(){this.titleText.setVisible(!0),this.bestScoreText.setVisible(!0),this.titleDayText.setVisible(!1),this.dayText.setVisible(!1)},n.showTextDay=function(){this.titleText.setVisible(!1),this.bestScoreText.setVisible(!1),this.titleDayText.setVisible(!0),this.dayText.setVisible(!0)},e}(Phaser.GameObjects.Container),XT=HT,KT=Ar.default.GAMEPLAY,jT=KT.KEY,qT=KT.FRAME,ZT=Ar.default.GAMEPLAY_32.KEY,JT=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.imageGem=void 0,n.imageCheck=void 0,n.text=void 0,n.particle=void 0,n.emitter=void 0,n.currentPosition=void 0,n.imageGlow=void 0,n.tweenGlow=void 0,n.imageGlowCrop=void 0,n.tweenCropMaskTopDown=void 0,n.tweenCropMaskDownBottom=void 0,n.imageStar=void 0,n.tweenShowStar=void 0,n.tweenHideStar=void 0,n.tweenShowMe=void 0,n.scene=e,n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createImageGem(),this.createImageCheck(),this.createText(),this.createParticle(),this.createEmitter(),this.createGlow(),this.createTweenGlow(),this.createGlowCrop(),this.createStar(),this.createTweenStar(),this.createTweenShowMe()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:ZT}),this.imageGem.setWorldSize(22,22),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-7)},n.createImageCheck=function(){this.imageCheck=this.scene.make.image({key:jT,frame:qT.ICON_CHECK}),this.imageCheck.setWorldSize(22,17),this.imageCheck.setVisible(!1),this.add(this.imageCheck),Phaser.Display.Align.In.Center(this.imageCheck,this.imageGem)},n.createText=function(){this.text=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,0,19)},n.createParticle=function(){this.particle=this.scene.add.particles(jT).setDepth(jr.default.ON_TOP)},n.createEmitter=function(){var t=1.5/this.scene.world.getPixelRatio();this.emitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[qT.DUST],lifespan:1e3,quantity:1,scale:{start:t,end:0,ease:"Quart.easeIn"},speed:50})},n.createGlow=function(){this.imageGlow=this.scene.make.image({key:jT,frame:qT.VIOLET_GLOW}),this.imageGlow.setVisible(!1).setScale(0).setAlpha(0),this.add(this.imageGlow),Phaser.Display.Align.In.Center(this.imageGlow,this.imageGem)},n.createTweenGlow=function(){var t=this;this.tweenGlow=this.scene.tweens.add({targets:[this.imageGlow],paused:!0,scale:{from:0,to:.6},alpha:{from:0,to:1},delay:100,duration:600,onComplete:function(){t.imageGlow.setVisible(!1).setScale(0).setAlpha(0),t.playAnimMaskCrop(),t.playAnimStar()}})},n.createGlowCrop=function(){this.imageGlowCrop=this.scene.make.image({key:jT,frame:qT.MASK}),this.imageGlowCrop.setVisible(!1),this.imageGlowCrop.setWorldSize(this.imageGem.displayWidth,this.imageGem.displayHeight),this.add(this.imageGlowCrop),Phaser.Display.Align.In.Center(this.imageGlowCrop,this.imageGem)},n.createStar=function(){this.imageStar=this.scene.make.image({key:jT,frame:qT.ICON_STAR_1}),this.imageStar.setVisible(!1).setScale(0).setAlpha(0),this.imageStar.setWorldSize(27,26),this.add(this.imageStar),Phaser.Display.Align.In.Center(this.imageStar,this.imageGem,-10,-10)},n.createTweenStar=function(){var t=this;this.tweenHideStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:1,to:0},alpha:{from:1,to:0},delay:100,duration:500,onComplete:function(){t.imageStar.setVisible(!1).setScale(0).setAlpha(0)}}),this.tweenShowStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:0,to:1},alpha:{from:0,to:1},delay:100,duration:500,onComplete:function(){t.tweenHideStar.play()}})},n.createTweenShowMe=function(){this.tweenShowMe=this.scene.add.tween({paused:!0,targets:[this],alpha:{from:0,to:1},duration:200})},n.cropTopDownImageGlow=function(){var t=this;if(!this.tweenCropMaskTopDown){var e=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskTopDown=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*e;t.imageGlowCrop.setCrop(0,0,n/i,r/a)},onComplete:function(){t.cropDownBottomImageGlow()}})}this.tweenCropMaskTopDown.play()},n.cropDownBottomImageGlow=function(){var t=this;if(!this.tweenCropMaskDownBottom){var e=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskDownBottom=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*e;t.imageGlowCrop.setCrop(0,r/a,n/i,e/a)}})}this.tweenCropMaskDownBottom.play()},n.playAnimStar=function(){this.imageStar.setVisible(!0),this.tweenShowStar.play()},n.playAnimMaskCrop=function(){this.imageGlowCrop.setVisible(!0).setCrop(0,0,0,0),this.cropTopDownImageGlow()},n.setFrame=function(t){this.imageGem.setFrame(t)},n.getFrame=function(){return this.imageGem.frame.name},n.setText=function(t,e){this.text.setText(t+" / "+e)},n.completeMission=function(){this.imageGem.setAlpha(.3),this.text.setAlpha(.3),this.imageCheck.setVisible(!0)},n.reset=function(){this.imageGem.setAlpha(1),this.text.setAlpha(1),this.imageCheck.setVisible(!1)},n.updateCurrentPosition=function(t){this.currentPosition=t},n.runAnimCollectionItem=function(){var t=this.scene.gameZone.width/2;this.tweenGlow.play(),this.emitter.explode(8,t+this.currentPosition.x,this.currentPosition.y-25)},n.playAnimShowMe=function(){this.setVisible(!0).setAlpha(0),this.tweenShowMe.play()},e}(Phaser.GameObjects.Container),QT=Ar.default.GAMEPLAY,$T=QT.KEY,tC=QT.FRAME,eC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.target=void 0,n.targetKeys=[],n.jsonPosition={},n.jsonAmount={},n.jsonTarget={},n.jsonCollectItem={},n.textMission=void 0,n.background=void 0,n.listCollectItems=[],n.scene=e,n.createBackground(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:$T,frame:tC.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.calcPosition=function(t){for(var e=[],n=200/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.parseTargetToJson=function(){if(!(0,Hv.isObject)(this.target)){for(var t=JSON.parse(this.target),e=Y()(t),n=this.calcPosition(e.length),i=0;i<e.length;i++){var a=e[i],s=OS[a];this.targetKeys.push(s),this.jsonAmount[s]=0,this.jsonTarget[s]=t[a],this.jsonPosition[s]={x:n[i],y:68};var r=this.listCollectItems[i];r||(r=new JT(this.scene),this.add(r),this.listCollectItems.push(r)),r.updateCurrentPosition(this.jsonPosition[s]),r.setVisible(!0),r.setX(n[i]),r.setFrame(s),r.setText(0,t[a]),this.jsonCollectItem[s]=r}console.log("this.targetKeys === ",this.targetKeys)}},n.hideListCollectItems=function(){this.listCollectItems.forEach((function(t){t.setVisible(!1),t.reset()}))},n.showListCollectItems=function(){this.listCollectItems.forEach((function(t){t.reset(),t.playAnimShowMe()}))},n.showCollectItemByKey=function(t){var e,n=h()(e=this.listCollectItems).call(e,(function(e){return e.getFrame()===t}));n&&0!==n.length&&(this.jsonAmount[t]>=this.jsonTarget[t]?n[0].completeMission():n[0].reset(),n[0].playAnimShowMe())},n.start=function(){this.parseTargetToJson()},n.setTargets=function(t){var e,n;this.target=kv()(e=kv()(n=kv()(t).call(t,"{",'{"')).call(n,", ",', "')).call(e,":",'":')},n.collectItem=function(t){if(t in this.jsonAmount){this.jsonAmount[t]++;var e=this.jsonAmount[t],n=this.jsonTarget[t];e===n&&this.jsonCollectItem[t].completeMission(),this.jsonCollectItem[t].setText(e,n)}},n.checkCompleteMission=function(){for(var t=Y()(this.jsonTarget),e=0;e<t.length;e++){var n=t[e];if(this.jsonTarget[n]>this.jsonAmount[n])return!1}return!0},n.reset=function(){this.hideListCollectItems(),this.targetKeys=[],this.jsonAmount={},this.jsonTarget={},this.jsonCollectItem={},this.jsonPosition={}},n.getPositionCollectionItem=function(t){return this.jsonPosition[t]},n.getTargetKeys=function(){return this.targetKeys},n.getJsonAmount=function(){return this.jsonAmount},n.getJsonTarget=function(){return this.jsonTarget},n.getCollectItemByKey=function(t){return this.jsonCollectItem[t]},n.updateJsonAmountByFen=function(t){this.jsonAmount=JSON.parse(O()(t));for(var e=Y()(this.jsonTarget),n=0;n<e.length;n++){var i=e[n],a=this.jsonCollectItem[i];this.jsonTarget[i]>this.jsonAmount[i]?a.reset():a.completeMission(),a.setText(this.jsonAmount[i],this.jsonTarget[i])}},n.resetTextAmount=function(){for(var t=Y()(this.jsonTarget),e=0;e<t.length;e++){var n=t[e],i=this.listCollectItems[e];i&&i.setText(0,this.jsonTarget[n])}},e}(Phaser.GameObjects.Container),nC=Ar.default.DEFAULT,iC=nC.KEY,aC=nC.FRAME,sC=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,iC,aC.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.setInteractive().on(Phaser.Input.Events.POINTER_MOVE,(function(){n.disableInteractive()})),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),rC=sC,oC=Ar.default.GAMEPLAY,cC=oC.KEY,hC=oC.FRAME,lC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=0,n.scene=e,n.scene.add.existing((0,gr.default)(n)),n.createBackground(),n.createScoreText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:cC,frame:hC.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.background)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.scoreText.setText(String(t))},n.animAddScore=function(t){var e=this;if(this.addScore&&this.addScore.isPlaying()){this.addScore.stop();var n=this.score+t;this.setScore(n),this.setScoreText(n)}this.addScore=this.scene.tweens.addCounter({from:0,to:t,duration:100,onUpdate:function(t){var n=e.score+Math.floor(t.getValue());e.setScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){var n=e.score+t;e.setScore(n),e.setScoreText(n),e.scene.handleCompleteScoreMission()}})},n.reset=function(){this.setScore(0),this.setScoreText(0)},e}(Phaser.GameObjects.Container),uC=lC,dC=Ar.default.GAMEPLAY,pC=dC.KEY,fC=dC.FRAME,gC=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.setSize(n,i),a.scene=e,a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup()},n.initBg=function(){this.leftBg=this.scene.make.image({key:pC,frame:fC.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:pC,frame:fC.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:pC,frame:fC.PROGRESS_BG_RIGHT});var t=this.leftBg,e=t.width,n=t.height,i=e*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var c=this.width-(i+o);this.midBg.setWorldSize(c,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:pC,frame:fC.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:pC,frame:fC.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:pC,frame:fC.PROGRESS_BAR_RIGHT});var t=this.leftProgress,e=t.width,n=t.height,i=e*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var c=this.width-(i+o)+2;this.midProgress.setWorldSize(c,this.height),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:pC,frame:fC.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:pC,frame:fC.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new xl({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(pC),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:fC.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createMilestoneFrame=function(){var t=this.scene.make.image({key:pC,frame:fC.FLAG});return t.setWorldSize(16,22),t},n.getMilestoneFrame=function(){var t,e=h()(t=this.listPoolMilestoneFrame).call(t,(function(t){return!t.visible}));if(!e||0===e.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return e[0]},n.handleSetAlphaListMilestone=function(t){this.listMilestoneFrame.forEach((function(e){e.score<=t?e.frame.setAlpha(1):e.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(t){t>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(t){t.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(t){this.targetScore=t},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(t){var e=t*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth;if(t>=1){if(this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}return this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,e<n?(this.leftProgress.setVisible(!0),void this.leftProgress.setCrop(0,0,e/this.leftProgress.scaleX,2*this.height)):e>n+i?(this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),void this.rightProgress.setCrop(0,0,(e-(n+i-2))/this.rightProgress.scaleX,2*this.height)):(this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),void this.midProgress.setCrop(0,0,(e-n)/this.midProgress.scaleX,2*this.height))},e}(Phaser.GameObjects.Container),mC=Ar.default.GAMEPLAY,vC=mC.KEY,yC=mC.FRAME,SC=function(t){function e(e){var n;return(n=t.call(this,e,vC,yC.BUTTON_WOOD_SMALL)||this).button.setWorldSize(55,48),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:vC,frame:yC.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,1,-1.5)},e}(Kr.default),AC=SC,xC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.progressBar=void 0,n.collectItems=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,0),e.add.existing((0,gr.default)(n)),n.createSettingButton(),n.createBestScoreBlock(),n.createMainScoreBlock(),n.createProgressBar(),n.createCollectItems(),n.createLeaf(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLeaf=function(){var t=new rC(this.scene);this.add(t),Phaser.Display.Align.In.Center(t,this,0,t.displayHeight/2)},n.createBestScoreBlock=function(){this.bestScoreBlock=new XT(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this,-132,-12.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new uC(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createSettingButton=function(){this.buttonSetting=new AC(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,132,51)},n.createProgressBar=function(){this.progressBar=new gC(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92),this.progressBar.setVisible(!1)},n.createCollectItems=function(){this.collectItems=new eC(this.scene),this.add(this.collectItems),Phaser.Display.Align.In.Center(this.collectItems,this,0,52),this.collectItems.setVisible(!1)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1)},n.start=function(){switch(this.scene.targetMissionManager.getTargetType()){case OT:this.targetScore();break;case DT:this.targetCollect()}},n.targetScore=function(){var t=ob()(this.scene.targetMissionManager.getTargetValue()),e=this.scene.storage.getState(),n=vu(e)||0;(0,Hv.isArray)(t)||(this.progressBar.reset(),this.progressBar.setVisible(!0),this.progressBar.setTargetScore(t),this.progressBar.setPercent(n/t),this.scene.header.mainScoreBlock.reset(),this.scene.header.mainScoreBlock.setVisible(!0),this.scene.header.mainScoreBlock.setScore(n),this.scene.header.mainScoreBlock.setScoreText(n),this.collectItems.setVisible(!1))},n.targetCollect=function(){this.collectItems.reset(),this.mainScoreBlock.setVisible(!1),this.progressBar.setVisible(!1);var t=this.scene.targetMissionManager.getTargetValue();this.collectItems.setTargets(t),this.collectItems.setVisible(!0),this.collectItems.start()},e}(Phaser.GameObjects.Container),EC=xC,bC=Ar.default.GAMEPLAY_32,wC=bC.KEY,TC=bC.FRAME,CC=GameCore.Configs.Board,MC=CC.cols,IC=CC.rows,PC=function(t){function e(n,i,a){var s;return(s=t.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.cellItems=[],s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=e.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,gr.default)(s)),s.createWrapPiece(),s.listenEvents(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createWrapPiece=function(){var t=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:wC,frame:TC.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(t,t)},n.updatePosition=function(t,e){var n=this.getContainerSize(),i=n.width,a=n.height,s=this.parent.cellSize,r=this.scene.gameZone.width;this.setPosition(t+r/6-i/2+s/2,e-a/2+s/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(t,e){this.wrapPiece.setPosition(t+this.wrapPiece.displayWidth/2,e-20)},n.listenEvents=function(){var t=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(e){t.handleDragStart(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(e){t.handleDrag(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){t.handleDragEnd(),t.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(t){this.index=t},n.updateDataPiece=function(t){this.data=t},n.setInteractiveContainer=function(){var t=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,t/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(t){var e,n,i=this;if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove){if(this.scene.tutorialManager.isRunning()){if(!this.scene.tutorialManager.validStep(this.index))return;this.scene.tutorialManager.stopAnimHand()}null==(e=this.animScaleUp)||e.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(jr.default.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.audio.playSound(Xr.default.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,s=this.getContainerSize(),r=s.width,o=s.height,c=t.worldX+this.parent.cellSize*a/2-r*a/2,h=0;if(jp())h=t.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,h=t.worldY-u}this.distancePY=t.worldY-h;var d=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(d),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:c,y:h,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(c,h);var t=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(t,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(t){if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var e=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(e)}this.resetCellItems(),this.scene.game.updateFps(Xp.default.max);var n=this.getContainerSize().width,i=t.worldX+this.parent.cellSize*this.scale/2-n/2,a=t.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var s=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(s,this.highlightCellCanCapture.bind(this))}catch(r){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(t,e,n,i){for(var a=this,s=MC,r=IC,o=[],c=0;c<i.length;c++){var l=i[c],u=l.x,d=l.y;s>u&&(s=u),r>d&&(r=d)}for(var p=function(e){var n=t[e],s=h()(i).call(i,(function(t){return t.y===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var c=s[r];a.checkItemInArray(o,c)||o.push(c)}},f=0;f<t.length;f++)p(f);for(var g=function(t){var n=e[t],s=h()(i).call(i,(function(t){return t.x===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var c=s[r];a.checkItemInArray(o,c)||o.push(c)}},m=0;m<e.length;m++)g(m);for(var v=function(t){var e=n[t],s=h()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!s||0===s.length)return"continue";var r=s[0];a.checkItemInArray(o,r)||o.push(r)},y=0;y<n.length;y++)v(y);for(var S=function(t){var e,n=o[t],i=n.x,c=n.y,l=h()(e=a.cellItems).call(e,(function(t){return t.x===i-s&&t.y===c-r}));if(!l||0===l.length)return"continue";var u=a.getFrameLight(l[0].cell.frame.name);l[0].cell.setFrame(u)},A=0;A<o.length;A++)S(A)},n.getFrameLight=function(t){var e=t;switch(t){case TC.GEM:e=TC.GEM_LIGHT;break;case TC.GEM_DIAMOND_10:e=TC.GEM_DIAMOND_10_LIGHT;break;case TC.GEM_DIAMOND_11:e=TC.GEM_DIAMOND_11_LIGHT;break;case TC.GEM_DIAMOND_12:e=TC.GEM_DIAMOND_12_LIGHT;break;case TC.GEM_DIAMOND_13:e=TC.GEM_DIAMOND_13_LIGHT;break;case TC.GEM_DIAMOND_14:e=TC.GEM_DIAMOND_14_LIGHT;break;case TC.GEM_DIAMOND_15:e=TC.GEM_DIAMOND_15_LIGHT}return e},n.resetCellItems=function(){for(var t=0;t<this.cellItems.length;t++){var e=this.cellItems[t].cell.frame.name.replace("_light","");this.cellItems[t].cell.setFrame(e)}},n.checkItemInArray=function(t,e){var n=h()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(jr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),!this.scene.isGameOver&&!this.scene.isLevelComplete)){this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(Xr.default.PIECE_DROP),this.handleBoardMoveCompleted(),this.scene.updateMatchData(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(jr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(t,e){return 15==t?this.parent.cellSize*e*-2:30==t?0:45==t?this.parent.cellSize*e*2:60==t?this.parent.cellSize*e*4:75==t?this.parent.cellSize*e*6:t},n.handleBoardMoveCompleted=function(){var t=this,e=this.getPositionTopLeftInBoard();if(e){if(this.scene.targetMissionManager.getTargetType()===OT){var n=this.calcScore();this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0)}var i=e.x,a=e.y,s=this.scene.main.board.dataBoard[a][i],r=s.x+this.scene.main.board.cellPadding,o=s.y+this.scene.main.board.cellPadding,c=this.getCellsHighlight();this.scene.add.tween({targets:this,x:r,y:o,duration:50,onComplete:function(){t.updateCellsWithPadding(.5),t.scene.main.board.handleRemoveHighlight(),t.hide(),t.setScale(1),t.parent.removeActivePiece(t.index),t.scene.main.board.handleMove(c,t.onBoardHandleMoveCompleted.bind(t))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var t;if(!this.matrixData)return 0;var e=this.matrixData.length||0;if(0===e)return 0;for(var n=(null==(t=this.matrixData[0])?void 0:t.length)||0,i=0,a=0;a<e;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.nextStep()},n.drawSuggestCells=function(){var t=function(t,e){for(var n=t.length,i=t[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var c=0;c<i;c++)if(HS(t,c,o,e)&&(s=c,r=o,++a>1))return null;if(0===a)return null;for(var h=[],l=0;l<e.data.length;l++)for(var u=0;u<e.data[l].length;u++)e.data[l][u].texture&&h.push({x:s+u,y:r+l});return h&&h.length>0?h:null}(this.scene.main.board.dataBoard,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.getPositionFirstCellHighlight=function(){var t=this.scene.main.board.dataBoard,e=this.getPositionTopLeftInBoard();if(!e)return{x:0,y:0};var n=e.x,i=e.y;return e?{x:t[i][n].x,y:-(this.scene.scale.height-this.parentHeight-t[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var t=this;this.scene.audio.playSound(Xr.default.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){t.updateCellsWithPadding(.5)}}),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.handleStep()},n.canMove=function(){var t=this.scene.main.board.dataBoard,e=this.getCellsHighlight();if(0===e.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<e.length;i++){var a=e[i],s=a.x,r=a.y;if(!t[r]||!t[r][s]||0!==t[r][s].value){n=!1;break}}if(!n||0===e.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var t=this.scene.main.board.dataBoard,e=[],n=this.getPositionTopLeftInBoard();if(null===n)return e;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return e;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=t[r]&&t[r][s]?t[r][s].x:0,c=t[r]&&t[r][s]?t[r][s].y:0;if(r>=IC||s>=MC||!t[r][s]||1===t[r][s].value)return[];e.push({x:s,y:r,pX:o,pY:c,frame:this.data[i][a].texture})}return e},n.getPositionTopLeftInBoard=function(){for(var t=this.scene.main.board.dataBoard,e=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,s=-1,r=0;r<IC;r++)for(var o=0;o<MC;o++)if(t[r][o].x-i/2<=e&&t[r][o].x+t[r][o].width+i/2>=e&&t[r][o].y-i/2<=n&&t[r][o].y+t[r][o].height+i/2>=n){a=o,s=r;break}return a<0||a>MC-1||s<0||s>IC-1?null:{x:a,y:s}},e.buildData=function(t){for(var e=[],n=0;n<t.length;n++){e[n]=[];for(var i=0;i<t[n].length;i++){var a=1===t[n][i]?TC.GEM:null;e[n][i]={x:i,y:n,texture:a}}}return e},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell?this.updateCells():this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var t=this,e=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:e,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Linear,onComplete:function(){t.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Linear})},n.createCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture&&"x"!==this.data[n][i].texture){var a={x:0+i*e+t,y:0+n*e+t,width:e-2*t,height:e-2*t},s=new pT(this.scene,a);s.setFrame(this.data[n][i].texture),s.setVisible(!0),this.cells[n][i]=s,this.cellItems.push({x:i,y:n,cell:s}),this.add(s)}}this.isCreateCell=!0},n.updateCells=function(){for(var t=0;t<this.data.length;t++)for(var e=0;e<this.data[t].length;e++)if(this.data[t][e].texture&&"x"!==this.data[t][e].texture){var n=this.cells[t][e];n.setFrame(this.data[t][e].texture),n.setVisible(!0),this.cells[t][e]=n}},n.updateCellsWithPadding=function(t){for(var e=this.parent.cellSize,n=e-2*t,i=e-2*t,a=0;a<this.data.length;a++)for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r=this.cells[a][s],o=s*e+t,c=a*e+t;r.setWorldSize(n,i),r.setPosition(o,c)}},n.getContainerSize=function(){for(var t=0,e=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>t&&(t=this.data[n].length);var i=this.parent.cellSize;return{width:t*i*this.scale,height:e*i*this.scale}},n.setCanMove=function(t){this.isCanMove=t,this.correctAlpha=t?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive(),this.data=e.buildData(this.matrixData)},n.getScore=function(){if(!this.matrixData)return 0;for(var t=0,e=0;e<this.matrixData.length;e++)for(var n=0;n<this.matrixData[0].length;n++)1===this.matrixData[e][n]&&t++;return t},e}(Phaser.GameObjects.Container),kC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e,n){void 0===n&&(n=!1);var i=[];switch(e){case qv:n?i=jy:(i=Ky,t===gy&&(i=qy),t===my&&(i=Zy));break;case Zv:n?i=Uy:(i=Gy,t===gy&&(i=Vy),t===my&&(i=Yy));break;case Jv:if(n){i=Ly;break}i=By,t===gy&&(i=Fy),t===my&&(i=Ny);break;case Qv:n?i=Wy:(i=zy,t===gy&&(i=Hy),t===my&&(i=Xy))}return i},e.getData=function(t,n,i){return void 0===i&&(i=!1),e.buildData(e.getMatrixData(t,n,i))},e}(PC),RC=kC,_C=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e){var n=[];switch(t){case Ay:n=e===Kv?iS:aS;break;case Sy:n=e===Kv?eS:nS;break;case vy:n=e===Kv?Jy:Qy;break;case yy:n=e===Kv?$y:tS}return n},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(PC),OC=_C,DC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){case xy:e=sS;break;case Ey:e=rS;break;case by:e=oS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(PC),BC=DC,LC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=dS;break;case Zv:e=pS;break;case Jv:e=fS;break;case Qv:e=gS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(PC),FC=LC,NC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=cS;break;case ty:e=hS;break;case ny:e=uS;break;case ey:e=lS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(PC),GC=NC,UC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=mS;break;case Zv:e=vS;break;case Jv:e=yS;break;case Qv:e=SS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(PC),VC=UC,YC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData()}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(){return AS},e.getData=function(){return e.buildData(e.getMatrixData())},e}(PC),zC=YC,WC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getDataByDirectionCross2=function(t){var e=[];if(t===Zv)e=ES;else e=xS;return e},e.getDataByDirectionCross3=function(t){var e=[];if(t===Zv)e=wS;else e=bS;return e},e.getDataByDirectionCross4=function(t){var e=[];if(t===Zv)e=CS;else e=TS;return e},e.getDataByDirectionCross5=function(t){var e=[];if(t===Zv)e=IS;else e=MS;return e},e.getMatrixData=function(t,n){var i=[];switch(t){case Iy:i=e.getDataByDirectionCross2(n);break;case Py:i=e.getDataByDirectionCross3(n);break;case ky:i=e.getDataByDirectionCross4(n);break;case Ry:i=e.getDataByDirectionCross5(n)}return i},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(PC),HC=WC,XC=function(t){function e(n,i,a){return t.call(this,n,i,(0,Tt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=PS;break;case Zv:e=kS;break;case Jv:e=RS;break;case Qv:e=_S}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(PC),KC=XC,jC=function(){function t(){}return t.create=function(t,e,n){var i;switch(n.type){case fy:case gy:case my:i=new RC(t,e,n);break;case vy:case yy:case Sy:case Ay:i=new OC(t,e,n);break;default:i=new BC(t,e,n);break;case Ty:i=new FC(t,e,n);break;case Cy:i=new VC(t,e,n);break;case _y:i=new KC(t,e,n);break;case My:i=new zC(t,e,n);break;case Iy:case Py:case ky:case Ry:i=new HC(t,e,n);break;case wy:i=new GC(t,e,n)}return i},t}(),qC=jC,ZC=Ar.default.GAMEPLAY_32,JC=ZC.KEY,QC=ZC.FRAME,$C=zt.Configs,tM=$C.Gameplay,eM=$C.Match,nM=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],n.listPieceMap=[],n.amountPieceContainGem=0,n.hasPieceContainGem=void 0,n.segmentAmountPiece1Min=0,n.segmentAmountPiece1Max=0,n.segmentAmountPiece1Cur=0,n.segmentAmountPiece5Min=0,n.segmentAmountPiece5Max=0,n.segmentAmountPiece5Cur=0,n.segmentAvgScore=0,n.segmentTotalPieceScore=0,n.segmentTotalPiece=0,n.segmentTotalScore=0,n.segmentPieceDistancePerGem=0,n.segmentPieceRandomGem=!1,e.add.existing((0,gr.default)(n)),n.scene=e,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps(),this.addDebuggerBtnRandomPieces()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(t,e){this.setPosition(t,e)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(t){if([xy,Ey,by].some((function(e){return e===t})))return[];var e=[];switch(t){case fy:case gy:case my:case Ty:case Cy:case _y:e=[Jv,qv,Zv,Qv];break;case vy:case yy:case Sy:case Ay:e=[Kv,jv];break;case wy:e=[$v,ty,ey,ny];break;case My:e=[];break;case Iy:case Py:case ky:case Ry:e=[qv,Zv]}return e},n.createAllPieces=function(){for(var t=this.cellSize,e=[],n=0;n<Oy.length;n++){var i=this.getDirectionsByType(Oy[n]);if(i.length<=0)e.push({type:Oy[n]});else{for(var a=0;a<i.length;a++)e.push({type:Oy[n],direction:i[a]});if(fy===Oy[n])for(var s=0;s<i.length;s++)e.push({type:Oy[n],direction:i[s],isReverse:!0})}}for(var r=0;r<e.length;r++){var o=(0,Tt.default)({},e[r],{texture:JC,frame:QC.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2),cellLength:Math.floor(t/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2)}}),c=qC.create(this.scene,this,o);c.hide(),this.allPieces.push({piece:c,isUsed:!1})}},n.createAllPiecesGroup=function(){for(var t=0;t<this.allPieces.length;t++){var e=this.allPieces[t].piece;this.allPiecesGroup[e.type]||(this.allPiecesGroup[e.type]=[]),this.allPiecesGroup[e.type].push(t)}},n.randomPieces=function(){var t=this;this.scene.game.updateFps(Xp.default.max);for(var e=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*e.length),a=e[i];if(!t.allPiecesGroup[a])return"continue";var s=Math.floor(Math.random()*t.allPiecesGroup[a].length),r=t.allPiecesGroup[a][s],o=[Sy,Ay].some((function(t){return t===a}));if(t.canCaptureLines.isCapture&&o){for(var c=0;c<t.allPiecesGroup[a].length;c++){var h=t.allPiecesGroup[a][c],l=t.allPieces[h].piece;if(l&&l.direction===t.canCaptureLines.direction){r=h;break}}e=t.buildPieceRates(!1)}n.some((function(t){return t.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r].piece;a.push({position:r,texture:JC,frame:QC.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(t){void 0===t&&(t=!0);for(var e=[],n=0;n<Dy.length;n++)e.push((0,Tt.default)({},Dy[n]));if(t){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var s=0;s<e.length;s++)e[s].type===Ay&&(e[s].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<e.length;r++)e[r].type===Sy&&(e[r].rate=8)}for(var o=[],c=0;c<e.length;c++)for(var h=e[c],l=h.type,u=h.rate,d=0;d<u;d++)o.push(l);return o},n.drawPieces=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=[20,e/3,2*e/3-20],a=n/2+176-13,s=a+(n-85-a)/2;console.log("this.piecesActive === ",this.piecesActive);for(var r=0;r<this.piecesActive.length;r++){var o=this.piecesActive[r],c=o.position,h=o.fenPiece,l=this.allPieces[c].piece,u=i[r];if(h){var d=this.convertFenPiecesToData(h);d&&l.updateDataPiece(d)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var p=this.getRandomPieceData(l.data);p&&l.updateDataPiece(p)}}l.updatePosition(u,s),l.updatePositionWrapPiece(u+20*(r-1),s),l.setIndex(r),l.drawPiece(),this.allPieces[c]={piece:l,isUsed:!0}}},n.isPieceContainGem=function(){if(1===Phaser.Math.Between(0,1)&&!this.hasPieceContainGem)return this.amountPieceContainGem++,this.hasPieceContainGem=!0,!0;if(this.amountPieceContainGem<tM.RatePieceContainGem)return this.amountPieceContainGem++,!1;if(this.amountPieceContainGem>=tM.RatePieceContainGem){var t=this.hasPieceContainGem;return this.amountPieceContainGem=0,this.hasPieceContainGem=!1,!t}return!1},n.convertFenPiecesToData=function(t){if(!t)return null;var e=t.split("/");if(0===e.length)return null;for(var n=[],i=0;i<e.length;i++){var a=e[i].split(",");n[i]=[];for(var s=0;s<a.length;s++){var r=ZS(a[s]);"null"!==a[s]&&"x"!==a[s]||(r=null),n[i].push({x:i,y:s,texture:r})}}return n},n.getRandomPieceData=function(t){var e=this.scene.header.collectItems.getTargetKeys();if(!e||0===e.length)return null;for(var n=0,i=t.length,a=t[0].length,s=0;s<i;s++)for(var r=0;r<a;r++)if(t[s][r].texture&&Phaser.Math.Between(0,1)){var o=QC.GEM;if(n<tM.MaxGemInPiece)o=e[Phaser.Math.Between(0,e.length-1)];t[s][r]={x:s,y:r,texture:o},n++}return t},n.removeActivePiece=function(t){this.piecesActive[t].used=!0},n.existPiecesActive=function(){var t,e=h()(t=this.piecesActive).call(t,(function(t){return!t.used}));return e&&e.length>0},n.showNewPieces=function(){this.resetAllPieces(),this.listPieceMap.length>0?this.showListPieceMap():(this.randomPieces(),this.setActivePieces(),this.drawPieces())},n.setActivePieces=function(){for(var t=this.scene.main.board.dataBoard,e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e].position,i=this.allPieces[n].piece,a=XS(t,i);i.setCanMove(a)}},n.getPiecesByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=vr()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==rf()(s=i[a]).call(s)){var o=QS(rf()(r=i[a]).call(r));e.push(o)}}return e},n.getFenByPieces=function(){for(var t="l",e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e],i=n.type,a=n.direction,s=n.isReverse,r=n.used,o=n.position;if(!r){var c=qS(i);a&&""!==a&&(c+="-"+qS(a)),s&&(c+="-r");var h=this.allPieces[o].piece;t+=" "+c+"|"+this.getFenDataPiece(h)}}return t},n.getFenDataPiece=function(t){for(var e=t.data,n=e.length,i=e[0].length,a="",s=0;s<n;s++){for(var r="",o=0;o<i;o++)r+=","+qS(e[s][o].texture);a+="/"+r.substring(1)}return a.substring(1)},n.clearPieces=function(){for(var t=0;t<this.piecesActive.length;t++){var e=this.piecesActive[t].position;this.allPieces[e].isUsed=!1,this.allPieces[e].piece.hide()}this.piecesActive=[],this.listPieceMap=[]},n.resetAllPieces=function(){for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].isUsed=!1,this.allPieces[t].piece.reset()},n.showAvailablePieces=function(t){if(t&&!(t.length<=0)){this.resetAllPieces();for(var e=[],n=0;n<t.length;n++){for(var i=t[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,c=!1,h=0;h<this.allPieces.length;h++){var l=this.allPieces[h],u=l.piece,d=l.isUsed;if(a===u.type&&s===u.direction&&r===u.isReverse){if(d){c=!0;continue}c=!1,e.push({position:h,texture:JC,frame:o,type:u.type,direction:u.direction,isReverse:u.isReverse,fenPiece:t[n].fenPiece}),this.allPieces[h].isUsed=!0;break}}if(c){var p=this.spawnPiece(a,s,r),f=p.piece,g=p.index;e.push({position:g,texture:JC,frame:o,type:f.type,direction:f.direction,isReverse:f.isReverse,fenPiece:t[n].fenPiece})}}this.piecesActive=e,this.setActivePieces(),this.drawPieces()}},n.spawnPiece=function(t,e,n){var i=this.cellSize,a={type:t,direction:e,isReverse:n,texture:JC,frame:QC.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2),cellLength:Math.floor(i/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2)}},s=qC.create(this.scene,this,a);return s.hide(),this.allPieces.push({piece:s,isUsed:!0}),{piece:s,index:this.allPieces.length-1}},n.showListPieceMap=function(){var t;if(this.piecesActive=vr()(t=this.listPieceMap).call(t,0,3),this.showAvailablePieces(this.piecesActive),this.scene.footer.textExist){var e=this.listPieceMap.length<=0?"Done":"Exits";this.scene.footer.textExist.setText(e)}},n.validItemsPieceMap=function(t){for(var e,n=!0,i=et()(e=[]).call(e,t),a=function(){var t=i.shift(),e=h()(i).call(i,(function(e){return e.type===(null==t?void 0:t.type)&&e.direction===t.direction&&e.isReverse===t.isReverse}));e&&e.length>0&&(n=!1)};i.length>1;)a();return n},n.getPieceDataByType=function(t){return DS[t]},n.addItemPieceMap=function(t){if(t.properties){var e=this.getFenPieceForPropertiesPieceMap(t);e&&(t=(0,Tt.default)({},t,{fenPiece:e}))}this.listPieceMap.push(t)},n.getFenPieceForPropertiesPieceMap=function(t){var e,n;if(!t.properties)return"";var i="",a=null==(e=h()(n=this.allPieces).call(n,(function(e){var n=e.piece;return n.direction===t.direction&&n.isReverse===t.isReverse&&n.type===t.type}))[0])?void 0:e.piece,s=t.properties[0].value.split(","),r=t.properties[1].value.split(","),o=0;if(!a)return i;for(var c=a.data,l=c.length,u=c[0].length,d=0;d<l;d++){for(var p="",f=0;f<u;f++){var m=c[d][f].texture,v=m,y=g()(r).call(r,String(o));m&&(-1!==y&&(v=OS[s[y]]),o++);var S=null;v&&(S=qS(v)),p+=","+S}i+="/"+p.substring(1)}return i.substring(1)},n.start=function(){0!==this.listPieceMap.length?this.showListPieceMap():this.showNewPieces()},n.getListPieceMap=function(){return this.listPieceMap},n.setListPieceMap=function(t){var e;this.listPieceMap=et()(e=[]).call(e,t)},n.buildPiecesByMap=function(){var t=this.scene.mapManager.getTileMap().layers[0].properties;if(t&&!(t.length<=0)){for(var e=0;e<t.length;e++){var n=t[e].value;if(n){var i=n.avgScore,a=n.score,s=n.pieceDistancePerGem;console.log("pieceDistancePerGem === ",s,i,a);var r=n.piece1,o=n.piece5;r=r.replace("min",'"min"').replace("max",'"max"'),o=o.replace("min",'"min"').replace("max",'"max"');var c=JSON.parse(r),h=JSON.parse(o);this.segmentAvgScore=i,this.segmentAmountPiece1Min=c.min,this.segmentAmountPiece1Max=c.max,this.segmentAmountPiece5Min=h.min,this.segmentAmountPiece5Max=h.max,this.segmentTotalScore=a,this.segmentPieceDistancePerGem=s,this.segmentTotalPieceScore=0,this.segmentTotalPiece=0,this.listPieceMap=[],this.buildObjectPieces()}}console.log("listttttttt ",this.listPieceMap)}},n.buildObjectPieces=function(){for(;this.checkAverageScore();)this.buildObjectPiece()},n.checkAverageScore=function(){return 0===this.segmentTotalPiece||0===this.segmentTotalPieceScore||!(this.segmentTotalPiece>eM.PieceRandoms.maxPiece)&&!(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore+eM.PieceRandoms.measureError&&this.segmentTotalPieceScore/this.segmentTotalPiece>=this.segmentAvgScore-eM.PieceRandoms.measureError&&this.segmentTotalPieceScore>=this.segmentTotalScore)},n.buildObjectPiece=function(){var t=this.getPieceByAvgScore();if(t)if(this.checkPieceMaxAmountConfig(t)){var e="";if(Math.floor((this.segmentTotalPiece-1)/3)%this.segmentPieceDistancePerGem===0){if(Phaser.Math.Between(0,1)&&!this.segmentPieceRandomGem||!this.segmentPieceRandomGem&&this.segmentTotalPiece%3===2){var n=this.getRandomPieceData(t.data);n&&(t.updateDataPiece(n),e=this.getFenDataPiece(t)),this.segmentPieceRandomGem=!0}}else this.segmentPieceRandomGem=!1;this.listPieceMap.push({type:t.type,direction:t.direction,isReverse:t.isReverse,fenPiece:e})}else this.buildObjectPiece()},n.checkPieceMaxAmountConfig=function(t){var e=t.getScore();switch(e){case 1:if(this.segmentAmountPiece1Max<=this.segmentAmountPiece1Cur)return!1;this.segmentAmountPiece1Cur++;break;case 5:if(this.segmentAmountPiece5Max<=this.segmentAmountPiece5Cur)return!1;this.segmentAmountPiece5Cur++}return this.segmentTotalPiece++,this.segmentTotalPieceScore+=e,!0},n.getPieceByAvgScore=function(){var t=this;if(this.segmentTotalPieceScore<this.segmentTotalScore){var e=this.buildPieceRates(!1),n=e[Math.floor(Math.random()*e.length)];if(!this.allPiecesGroup[n])return null;var i=Math.floor(Math.random()*this.allPiecesGroup[n].length),a=this.allPiecesGroup[n][i];return this.allPieces[a].piece}if(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore){var s,r=h()(s=this.allPieces).call(s,(function(e){return e.piece.getScore()<=t.segmentAvgScore}));return r&&0!==r.length?r[Phaser.Math.Between(0,r.length-1)].piece:null}if(this.segmentTotalPieceScore/this.segmentTotalPiece>this.segmentAvgScore){var o,c=h()(o=this.allPieces).call(o,(function(e){return e.piece.getScore()>t.segmentAvgScore}));return c&&0!==c.length?c[Phaser.Math.Between(0,c.length-1)].piece:null}return null},n.debuggerNextPieces=function(){for(var t=0;t<this.piecesActive.length;t++)this.removeActivePiece(t);for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].piece.wrapPiece.setVisible(!1);this.showNewPieces()},n.addDebuggerBtnRandomPieces=function(){var t=this;if(zt.Utils.Valid.isDebugger())for(var e=[80,187.5,295],n=this.scene.gameZone.height,i=function(i){var a=new Kr.default(t.scene,JC,QC.GEM,50,30);t.add(a),a.onClick=function(){t.debuggerNewPieces(i)},a.setPosition(e[i],n)},a=0;a<3;a++)i(a)},n.debuggerNewPieces=function(t){this.removeActivePiece(t);var e=this.piecesActive[t],n=this.allPieces[e.position].piece;n.setVisible(!1);var i=Phaser.Math.Between(0,this.allPieces.length-1);this.piecesActive[t]={position:i,texture:JC,frame:QC.GEM,type:n.type,direction:n.direction,isReverse:n.isReverse};var a=this.scene.gameZone,s=a.width,r=a.height,o=[20,s/3,2*s/3-20],c=r/2+176-13,h=c+(r-85-c)/2,l=this.piecesActive[t],u=l.position,d=l.fenPiece,p=this.allPieces[u].piece,f=o[t];if(d){var g=this.convertFenPiecesToData(d);g&&p.updateDataPiece(g)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var m=this.getRandomPieceData(p.data);m&&p.updateDataPiece(m)}}p.updatePosition(f,h),p.updatePositionWrapPiece(f+20*(t-1),h),p.setIndex(t),p.drawPiece()},e}(Phaser.GameObjects.Container),iM=Ar.default.GAMEPLAY,aM=iM.KEY,sM=iM.FRAME,rM=Ar.default.DEFAULT,oM=rM.KEY,cM=rM.FRAME,hM=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,85),e.add.existing((0,gr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createDebugButton()},n.createBackground=function(){var t=this.scene.make.image({key:oM,frame:cM.FOOTER}),e=this.scene.gameZone.width;t.setWorldSize(e,this.height),this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPieces=function(){this.pieces=new nM(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new Kr.default(this.scene,aM,sM.BUTTON_WOOD_SMALL,100,30),this.debugButton.setName("Debug");var t=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([t]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},e}(Phaser.GameObjects.Container),lM=hM,uM=function(){function t(t){this.scene=void 0,this.currentLevel=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){var t=this.scene.storage.getState(),e=gu(t)||1;this.currentLevel=e},e.setLevel=function(t){this.currentLevel=t},e.getLevel=function(){return this.currentLevel},e.getLevelConfig=function(){var t=this.scene.storage.getState();return mu(t)?Pw():ed[this.currentLevel]},e.getNextLevel=function(){return this.currentLevel+1},e.getNextLevelConfig=function(){return ed[this.currentLevel+1]},e.increaseLevel=function(){this.currentLevel++},t}(),dM=function(){function t(t){this.scene=void 0,this.map=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.initMap()},e.initMap=function(){var t=this.scene.levelManager.getLevelConfig();this.map=this.scene.make.tilemap({key:t.key})},e.getTileMap=function(){return De()(this)},e.reloadMap=function(){var t,e=this.scene.levelManager.getLevelConfig();console.log("reloadMap === ",e),null==(t=De()(this))||t.destroy(),this.map=this.scene.make.tilemap({key:e.key})},t}(),pM=function(){function t(){this.targetType=void 0,this.targetValue=void 0,this.init()}var e=t.prototype;return e.init=function(){},e.setTargetType=function(t){this.targetType=t},e.setTargetValue=function(t){this.targetValue=t},e.getTargetType=function(){return this.targetType},e.getTargetValue=function(){return this.targetValue},t}(),fM=Ar.default.GAMEPLAY_32.KEY,gM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textWellDone=void 0,s.listTargetFrame=[],s.listAnim=[],s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.runPopupEntrancesAnimation(0,300)},s.close=function(){t.prototype.close.call((0,gr.default)(s))},s.scene=e,s.setDepth(Wr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText()},n.createText=function(){this.textWellDone=new mA(this.scene,{text:"\u041e\u0422\u041b\u0418\u0427\u041d\u041e!",font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textWellDone),Phaser.Display.Align.In.Center(this.textWellDone,this)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=0;e<3;e++){var n=this.scene.make.image({key:fM});n.setWorldSize(30,30),n.setFrame(t[e]||t[0]),n.setVisible(!1).setAlpha(0),this.listTargetFrame.push(n)}this.add(this.listTargetFrame)}},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length)for(var e=0;e<3;e++){var n=this.listTargetFrame[e];n.setWorldSize(30,30),n.setFrame(t[e]||t[0]),n.setVisible(!1).setAlpha(0)}},n.createAnimTargetItems=function(){for(var t=[100,500,700],e=[-120,0,120],n=[-100,-150,-100],i=[.7,1,.7],a=0;a<3;a++){this.listTargetFrame[a].setAlpha(0).setVisible(!0);var s=this.scene.add.tween({targets:this.listTargetFrame[a],delay:t[a],x:{from:0,to:e[a]},y:{from:300,to:n[a]},alpha:{from:0,to:1},scale:{from:0,to:i[a]},rotation:{from:-180,to:0},duration:500});this.listAnim.push(s)}},n.playAnimTargetItems=function(){for(var t=0;t<3;t++){this.listTargetFrame[t].setAlpha(0).setVisible(!0),this.listAnim[t].play()}},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.listTargetFrame.forEach((function(t){t.setAlpha(0)})),this.textWellDone.restart(),this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.textWellDone.start(),0===n.listTargetFrame.length?(n.createTargetItems(),n.createAnimTargetItems()):(n.updateTargetItems(),n.playAnimTargetItems()),n.handleDelegate(),n.runAnim()}})),this.background.setAlpha(0),this.tweenBackground.play()},e}(GameCore.Screen),mM=Ar.default.DEFAULT,vM=mM.KEY,yM=mM.FRAME,SM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textLevel=void 0,s.textLevelComplete=void 0,s.backgroundContent=void 0,s.listTargets=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var t=this.scene.levelManager.getLevel();this.textLevel.setText("\u0423\u0440\u043e\u0432\u0435\u043d\u044c "+t)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:vM,frame:yM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:vM,frame:yM.TEXT_CONGRATULATION});t.setWorldSize(185.5,25),this.buttonClose=new Kr.default(this.scene,vM,yM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,150,-15),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 1",origin:{x:.5,y:.5}}),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-60)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(60),text:"\u0417\u0410\u0412\u0415\u0420\u0428\u0415\u041d",origin:{x:.5,y:.5}}),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,-20)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.scene.make.image({key:Ar.default.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){this.popup.remove(this.listTargets);for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:Ar.default.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(t){for(var e=[],n=310/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var t=this.scene.make.image({key:vM,frame:yM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new Kr.default(this.scene,vM,yM.BUTTON_MINOR,70,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-88,55)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))},n.createButtonContinue=function(){var t=this.scene.make.image({key:vM,frame:yM.TEXT_NEXT_LEVEL});t.setWorldSize(102,35.5),this.buttonContinue=new Kr.default(this.scene,vM,yM.BUTTON_GREEN,172,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,37,55)},n.clickButtonContinue=function(){var t=this,e=this.scene.storage.getState();if(_v(e)<1)return this.setVisible(!1),void this.scene.screen.open(zr);this.scene.storage.dispatch(Yv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.startGame()}))},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),AM=Ar.default.DEFAULT,xM=AM.KEY,EM=AM.FRAME,bM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textLevel=void 0,s.textLevelComplete=void 0,s.backgroundContent=void 0,s.livesTimer=void 0,s.listTargets=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.createLivesTimer(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var t=this.scene.levelManager.getLevel();t<ed.length-1&&(t-=1),this.textLevel.setText("\u0423\u0440\u043e\u0432\u0435\u043d\u044c "+t)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,290,234),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:xM,frame:EM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(260,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-66)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:xM,frame:EM.TEXT_CONGRATULATION});t.setWorldSize(185.5,25),this.buttonClose=new Kr.default(this.scene,xM,EM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,30),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(40),text:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 1",origin:{x:.5,y:.5}}),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-23)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(44),text:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d",origin:{x:.5,y:.5}}),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,3)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.scene.make.image({key:Ar.default.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){this.popup.remove(this.listTargets);for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:Ar.default.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(t){for(var e=[],n=310/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var t=this.scene.make.image({key:xM,frame:EM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new Kr.default(this.scene,xM,EM.BUTTON_MINOR,62,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-90,52)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))},n.createButtonContinue=function(){var t=this.scene.make.image({key:xM,frame:EM.TEXT_NEXT_LEVEL});t.setWorldSize(102,35.5),this.buttonContinue=new Kr.default(this.scene,xM,EM.BUTTON_GREEN,178,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,33,52)},n.clickButtonContinue=function(){var t=this,e=this.scene.storage.getState();if(_v(e)<1)return this.runCloseAnimation(),void this.scene.screen.open(zr,{onClose:function(){t.scene.screen.open(Br)}});gu(e)>=ed.length-1?this.scene.game.globalScene.screen.open(Er,{message:"\u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u043f\u0440\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f...",duration:3e3}):(this.scene.storage.dispatch(Yv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.analytics.levelStart(t.scene.levelManager.getLevel(),void 0,t.scene.getLevelName());var e=t.scene.main.board.fadeOut();e?e.on("complete",(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.startGame()})):(t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.startGame())})))},n.createLivesTimer=function(){this.livesTimer=new yb(this.scene),this.livesTimer.startIntervalTimer(),this.livesTimer.setFrameLivesTimeBlock2(),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),wM=Ar.default.GAMEPLAY,TM=(wM.KEY,wM.FRAME,function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textNoSpaceLeft=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(e){t.prototype.open.call((0,gr.default)(s),e),s.runPopupEntrancesAnimation(300,300),s.handleDelegate()},s.close=function(){t.prototype.close.call((0,gr.default)(s))},s.scene=e,s.setDepth(Wr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.textNoSpaceLeft.setVisible(!1),e.textNoSpaceLeft.restart(),e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new mA(this.scene,{text:"\u041c\u0415\u0421\u0422\u0410 \u041d\u0415 \u041e\u0421\u0422\u0410\u041b\u041e\u0421\u042c!",font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(76)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},e}(GameCore.Screen)),CM=Ar.default.DEFAULT,MM=CM.KEY,IM=CM.FRAME,PM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonRetry=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textLevelFail=void 0,s.buttonClose=void 0,s.livesTimer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.createLivesTimer(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.scene.enableInput(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new vo(this.scene,0,0,290,234),this.add(this.popup),this.popup.setFrameTop(IM.POPUP_TOP_DARK),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:MM,frame:IM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(260,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-66)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:MM,frame:IM.TEXT_LOSE});t.setWorldSize(193.5,20.5),this.buttonClose=new Kr.default(this.scene,MM,IM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,30),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextLevelFail()},n.createTextLevelFail=function(){this.textLevelFail=this.scene.make.image({key:MM,frame:IM.TEXT_LEVEL_FAIL}),this.textLevelFail.setWorldSize(250,18.5),this.popup.add(this.textLevelFail),Phaser.Display.Align.In.Center(this.textLevelFail,this.popup,0,-10)},n.createButtons=function(){this.createButtonBack(),this.createButtonRetry()},n.createButtonBack=function(){var t=this.scene.make.image({key:MM,frame:IM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new Kr.default(this.scene,MM,IM.BUTTON_MINOR,62,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-90,52)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))},n.createButtonRetry=function(){var t=this.scene.make.image({key:MM,frame:IM.TEXT_RETRY});t.setWorldSize(113,15.5);var e=this.scene.make.image({key:MM,frame:IM.ICON_RETRY});e.setWorldSize(33,35),this.buttonRetry=new Kr.default(this.scene,MM,IM.BUTTON_GREEN,178,54),this.buttonRetry.setName("Retry"),this.buttonRetry.add(t),this.buttonRetry.add(e),Phaser.Display.Align.In.Center(t,this.buttonRetry,22,-3),Phaser.Display.Align.In.Center(e,this.buttonRetry,-58,-3),this.popup.add(this.buttonRetry),this.buttonRetry.onClick=this.clickButtonRetry.bind(this),Phaser.Display.Align.In.Center(this.buttonRetry,this.popup,33,52)},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))},n.clickButtonRetry=function(){var t=this,e=this.scene.storage.getState();_v(e)<1?this.scene.screen.open(zr,{currentScreen:this}):(this.scene.storage.dispatch(Yv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.handleRetryLevel()})))},n.createLivesTimer=function(){this.livesTimer=new yb(this.scene),this.livesTimer.startIntervalTimer(),this.livesTimer.setFrameLivesTimeBlock2(),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.livesTimer.startIntervalTimer(),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.livesTimer.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),kM=Ar.default.DEFAULT,RM=kM.KEY,_M=kM.FRAME,OM=function(t){function e(e){var n;return(n=t.call(this,e,RM,_M.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:RM,frame:_M.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),DM=OM,BM=Ar.default.DEFAULT,LM=BM.KEY,FM=BM.FRAME,NM=function(t){function e(e){var n;return(n=t.call(this,e,LM,FM.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Journey"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:LM,frame:FM.ICON_JOURNEY_2});t.setWorldSize(35,28),this.add(t),Phaser.Display.Align.In.Center(t,this,-.25,-1.5)},e}(Kr.default),GM=NM,UM=Ar.default.DEFAULT,VM=UM.KEY,YM=UM.FRAME,zM=function(t){function e(e){var n;return(n=t.call(this,e,VM,YM.BUTTON_DARK_BLUE)||this).button.setWorldSize(246,53),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:VM,frame:YM.ICON_SWORD_BLUE});t.setWorldSize(31,25),this.add(t),Phaser.Display.Align.In.Center(t,this,-60)},n.createText=function(){var t=this.scene.make.image({key:VM,frame:YM.TEXT_PLAY_WITH_BLUE});t.setWorldSize(159.5,15.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20)},e}(Kr.default),WM=zM,HM=Ar.default.DEFAULT,XM=HM.KEY,KM=HM.FRAME,jM=function(t){function e(e){var n;return(n=t.call(this,e,XM,KM.BUTTON_BROWN)||this).button.setWorldSize(246,53),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:XM,frame:KM.ICON_REPLAY});t.setWorldSize(26,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-45,-2)},n.createText=function(){var t=this.scene.make.image({key:XM,frame:KM.TEXT_REPLAY});t.setWorldSize(69.5,14.5),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-1)},e}(Kr.default),qM=jM,ZM=Ar.default.DEFAULT,JM=ZM.KEY,QM=ZM.FRAME,$M=function(t){function e(e){var n;return(n=t.call(this,e,JM,QM.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:JM,frame:QM.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),tI=$M,eI=Ar.default.DEFAULT,nI=eI.KEY,iI=eI.FRAME,aI=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonReplay=void 0,s.buttonPlayWithFriend=void 0,s.buttonHome=void 0,s.buttonJourney=void 0,s.buttonShare=void 0,s.debuggerCurrentLevelText=void 0,s.debuggerCurrentLevel=0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(t){s.scene.player.setSetting("music",t),t?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(t){s.scene.player.setSetting("sound",t)},s.handleVibrateSetting=function(t){t&&um(199),s.scene.player.setSetting("vibrate",t)},s.clickReplay=function(){var t=s.scene.storage.getState();if(_v(t)<1)return s.setVisible(!1),void s.scene.screen.open(zr);s.scene.storage.dispatch(Yv()),s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.screen.close(s.name),s.scene.handleRetryLevel();case 2:case"end":return t.stop()}}),t)}))))},s.clickButtonPlayWithFriends=function(){s.scene.storage.dispatch($d()),s.scene.screen.close(s.name)},s.clickButtonHome=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},s.clickButtonLeaderboard=function(){s.scene.screen.open(Pr)},s.clickButtonShare=function(){s.scene.storage.dispatch(Bu())},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.createSwitchButtons(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.createDebuggerInputLevel(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:nI,frame:iI.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-48)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new vo(this.scene,0,0,290,390),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:nI,frame:iI.TEXT_SETTING});t.setWorldSize(151.5,24),this.buttonClose=new Kr.default(this.scene,nI,iI.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createJourneyButton(),this.createShareButton()},n.createReplayButton=function(){this.buttonReplay=new qM(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,43)},n.createPlayWithFriendButton=function(){this.buttonPlayWithFriend=new WM(this.scene),this.popup.add(this.buttonPlayWithFriend),this.buttonPlayWithFriend.onClick=this.clickButtonPlayWithFriends,Phaser.Display.Align.In.Center(this.buttonPlayWithFriend,this.buttonReplay,0,65)},n.createHomeButton=function(){this.buttonHome=new DM(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,72)},n.createJourneyButton=function(){this.buttonJourney=new GM(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,72)},n.clickButtonJourney=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(ar.SceneKeys.LEVEL_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.createShareButton=function(){this.buttonShare=new tI(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.buttonReplay,90,72)},n.createSwitchButtons=function(){var t=this.scene.player.getPlayerSettings(),e=(t.music,t.sound),n=t.vibrate;this.createSoundButton(e),cm()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.backgroundContent,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,0)},n.createMusicButton=function(t){this.settingMusicContainer=this.scene.make.container({});var e=this.scene.make.image({key:nI,frame:iI.ICON_MUSIC});e.setWorldSize(37,40),this.settingMusic=new GA(this.scene,{enable:t,width:89,height:31}),this.settingMusic.setName("Music"),Phaser.Display.Align.In.Center(e,this.settingMusicContainer,-60),Phaser.Display.Align.In.Center(this.settingMusic,this.settingMusicContainer,40),this.settingMusicContainer.add([e,this.settingMusic]),this.popup.add(this.settingMusicContainer),Phaser.Display.Align.In.Center(this.settingMusicContainer,this.backgroundContent,0,60)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:nI,frame:iI.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new GA(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:nI,frame:iI.ICON_SOUND});e.setWorldSize(41,36),this.settingSound=new GA(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.createDebuggerInputLevel=function(){var t=this;if(GameCore.Utils.Valid.isDebugger()){for(var e=this.scene.make.container({}),n=function(n){var i=t.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:t.scene.fontSize(34),origin:{x:.5,y:.5},text:""+n});e.add(i),i.setInteractive(),i.on("pointerdown",(function(){t.debuggerHandleClick(n)})),Phaser.Display.Align.In.Center(i,e,20*n)},i=0;i<10;i++)n(i);this.add(e),Phaser.Display.Align.In.Center(e,this.popup,-100,190),this.debuggerCurrentLevelText=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 0"}),this.add(this.debuggerCurrentLevelText),Phaser.Display.Align.In.Center(this.debuggerCurrentLevelText,this.popup,0,210);var a=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Go"});this.add(a),a.setInteractive(),a.on("pointerdown",(function(){t.close(),t.scene.time.delayedCall(300,(function(){t.scene.levelManager.setLevel(t.debuggerCurrentLevel),t.scene.startGame()}))})),Phaser.Display.Align.In.Center(a,this.popup,0,230);var s=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Clear"});s.setInteractive(),s.on("pointerdown",(function(){t.debuggerCurrentLevel=0,t.debuggerCurrentLevelText.setText("Level "+String(t.debuggerCurrentLevel))})),this.add(s),Phaser.Display.Align.In.Center(s,this.popup,50,230)}},n.debuggerHandleClick=function(t){console.log("index ------\x3e ",t);var e=this.debuggerCurrentLevel+""+t;this.debuggerCurrentLevel=ob()(e),this.debuggerCurrentLevelText.setText("Level "+String(this.debuggerCurrentLevel))},e}(GameCore.Screen),sI=aI,rI=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidTileMap",i.message=e||"This tile is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),oI=Ar.default.DEFAULT,cI=(oI.KEY,oI.FRAME,Ar.default.GAMEPLAY_32.KEY),hI=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.imageGem=void 0,n.text=void 0,n.scene=e,n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createImageGem(),this.createText()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:cI}),this.imageGem.setWorldSize(35,35),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-10.5)},n.createText=function(){this.text=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(42),origin:{x:.5,y:.5},text:"0"}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,29)},n.updateGem=function(t){this.imageGem.setFrame(t)},n.updateText=function(t){this.text.setText("x"+t)},n.getFrame=function(){return this.imageGem.frame.name},e}(Phaser.GameObjects.Container),lI=Ar.default.DEFAULT,uI=lI.KEY,dI=lI.FRAME,pI=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.backgroundContent=void 0,s.listItems=[],s.targetImages=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.listAnimCollectionItem=[],s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.addItem(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.getData(["duration"])[0];this.hideAllCollectionItems(),this.createCollectionItems(),this.alginCollectionItems(),this.runOpenAnimation(),this.scene.time.delayedCall(i,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:uI,frame:dI.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createCollectionItems=function(){for(var t=this.getData(["jsonTarget"])[0],e=Y()(t),n=0;n<e.length;n++){var i=e[n],a=this.getCollectionItemFree(n);console.log("jsonTarget[key] === ",t[i]),a.updateGem(i),a.updateText(t[i])}},n.getCollectionItemFree=function(t){var e=this.listItems[t];return e||(e=new hI(this.scene),this.popup.add(e),this.listItems.push(e)),e.setVisible(!0),e},n.alginCollectionItems=function(){var t;this.targetImages=[];for(var e=h()(t=this.listItems).call(t,(function(t){return t.visible})),n=e.length,i=263/(n+1)+5,a=-i*(n-1)/2,s=0;s<n;s++){var r=e[s];Phaser.Display.Align.In.Center(r,this.backgroundContent,a+i*s);var o=r.getFrame(),c=this.scene.make.image({key:Ar.default.GAMEPLAY_32.KEY,frame:o});c.setWorldSize(22,22),c.setVisible(!1),this.targetImages.push(c),Phaser.Display.Align.In.Center(c,this.backgroundContent,a+i*s+this.scene.gameZone.width/2,this.scene.gameZone.height/2)}},n.hideAllCollectionItems=function(){for(var t=0;t<this.listItems.length;t++){this.listItems[t].setVisible(!1)}},n.moveGemsToCollectItems=function(){var t=this;console.log("moveGemsToCollectItems"),this.resetPositionTargetImages();for(var e=this.scene.header.collectItems,n=e.getTargetKeys(),i=this.scene.gameZone.width/2,a=function(a){var s=n[a],r=e.getPositionCollectionItem(s),o=i+r.x,c=r.y-23;t.targetImages[a].setAlpha(1),t.targetImages[a].setVisible(!0);var h=t.getFreeAnim(),l=Phaser.Math.Between(500,1e3);h.setTarget(t.targetImages[a]),h.runGemMoveToPosition(0,l,o,c).on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){t.scene.header.collectItems.showCollectItemByKey(s),t.targetImages[a].setVisible(!1),a==t.targetImages.length-1&&t.scene.main.board.handleTweenStartMission()}))},s=0;s<n.length;s++)a(s)},n.resetPositionTargetImages=function(){for(var t,e=h()(t=this.listItems).call(t,(function(t){return t.visible})),n=263/(e.length+1)+5,i=-n*(e.length-1)/2,a=0;a<e.length;a++){var s;this.targetImages[a]&&(null==(s=this.targetImages[a])||s.setVisible(!1),Phaser.Display.Align.In.Center(this.targetImages[a],this.backgroundContent,i+n*a+this.scene.gameZone.width/2,this.scene.gameZone.height/2))}},n.getFreeAnim=function(){var t=new mT(this.scene);return this.listAnimCollectionItem.push(t),t},n.createPopup=function(){this.popup=new vo(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:uI,frame:dI.TEXT_MISSION});t.setWorldSize(105,21),this.title.add([t]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e,n=this;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.scene.time.delayedCall(50,(function(){n.moveGemsToCollectItems()})),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),fI=pI,gI=Zr.STATUS,mI=Ar.default.GAMEPLAY,vI=mI.KEY,yI=mI.FRAME,SI=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.step=void 0,n.listPositionStart=void 0,n.listPositionTo=void 0,n.positionStart=void 0,n.positionTo=void 0,n.handFrame=void 0,n.tweenHand=void 0,n.validTargetPosition=function(t){var e={x:0,y:0};switch(n.step){case 0:case 1:e={x:3,y:3}}return e.x===t.x&&e.y===t.y},n.scene=e,n.step=0,n.initPosition(),n.createHand(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.start=function(){this.isRunning()||(this.setState(gI.RUNNING),this.handleStep())},n.initPosition=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=n/2+200,a=i+(n-85-i)/2;this.listPositionStart=[{x:e/2-90,y:a},{x:e/2+30,y:a+10}],this.listPositionTo=[{x:e/2-15,y:n/2-30},{x:e/2+55,y:n/2+30}]},n.createHand=function(){this.handFrame=this.scene.make.image({key:vI,frame:yI.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(jr.default.ON_TOP),this.handFrame.setWorldSize(64,55)},n.createTweenHand=function(){this.tweenHand=this.scene.add.tween({paused:!0,repeatDelay:500,targets:this.handFrame,repeat:-1,x:{from:this.positionStart.x,to:this.positionTo.x},y:{from:this.positionStart.y,to:this.positionTo.y},duration:1500,ease:Phaser.Math.Easing.Sine.InOut}),this.tweenHand.play()},n.handleStep=function(){switch(this.positionStart=this.listPositionStart[this.step],this.positionTo=this.listPositionTo[this.step],console.log("This.stepppp ",this.step),this.handFrame.setVisible(!0),this.handFrame.setPosition(this.positionStart.x,this.positionStart.y),this.createTweenHand(),this.step){case 0:this.handleStep1();break;case 1:this.handleStep2()}},n.handleStep1=function(){this.scene.main.board.dataBoard[3][3].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][4].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][3].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleStep2=function(){this.scene.main.board.dataBoard[5][3].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][4].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][5].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][5].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][5].cell.setFrame(Ar.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleCompleteTutorial=function(){this.setState(gI.STOPPED),this.stopAnimHand()},n.nextStep=function(){this.handFrame.setVisible(!1),this.step++,this.step>=2?this.handleCompleteTutorial():this.handleStep()},n.stopAnimHand=function(){var t;this.handFrame.setVisible(!1),null==(t=this.tweenHand)||t.stop()},n.runAnimHand=function(){this.handFrame.setVisible(!0),this.tweenHand.play()},n.validStep=function(t){return this.step===t},n.reset=function(){this.setState(gI.STOPPED),this.stopAnimHand(),this.step=0},e}(to),AI=SI,xI=function(t){return t.dailyChallenge},EI=(0,be.createSelector)([function(t){return xI(t).isRequesting}],(function(t){return t})),bI=(0,be.createSelector)([function(t){return xI(t).leaders}],(function(t){return t})),wI=(0,be.createSelector)([function(t){return xI(t).time}],(function(t){return t})),TI=Ar.default.DEFAULT,CI=TI.KEY,MI=TI.FRAME,II=function(t){function e(e){var n;return(n=t.call(this,e,CI,MI.BUTTON_DARK_BLUE_BIG)||this).button.setWorldSize(76,31),n.setName("Share"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:CI,frame:MI.ICON_SHARE_BLUE});t.setWorldSize(12,16),this.add(t),Phaser.Display.Align.In.Center(t,this,-26)},n.createText=function(){var t=this.scene.make.image({key:CI,frame:MI.TEXT_SHARE_BLUE});t.setWorldSize(53,9),this.add(t),Phaser.Display.Align.In.Center(t,this,9)},e}(Kr.default),PI=Ar.default.DEFAULT,kI=PI.KEY,RI=PI.FRAME,_I=function(t){function e(e){var n;return(n=t.call(this,e,kI,RI.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:kI,frame:RI.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,.5,-2)},e}(Kr.default),OI=_I,DI=Ar.default.DEFAULT,BI=DI.KEY,LI=DI.FRAME,FI=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.background=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.textTime=void 0,i.createBackground(),i.updateSize(),i.createRank(),i.createUsername(),i.createTimeBlock(),n&&i.updateInfo(n),i.scene.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(t){this.payload=(0,Tt.default)({backgroundFrame:""},t),this.updateBackground(),this.updateRank(),this.updateUsername(),this.updateTime()},n.createBackground=function(){this.background=this.scene.make.image({key:BI,frame:LI.DAILY_BG_ITEM_DARK}),this.background.setWorldSize(254,38),this.add(this.background)},n.updateBackground=function(){var t=this.payload.backgroundFrame;this.background.setVisible(!0),this.background.setFrame(t||LI.DAILY_BG_ITEM_DARK),this.background.setWorldSize(254,38)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var t=this.payload.rank;if(t<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(t),this.updateRankText(t)},n.createRankIcon=function(t){var e=this.getRankIconFrame(t);this.rankIcon=this.scene.make.image({key:BI,frame:e}),this.rankIcon.setWorldSize(28,24),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-15)},n.getRankIconFrame=function(t){var e=LI.ICON_CUP_GOLD;switch(t){case 1:e=LI.ICON_CUP_GOLD;break;case 2:e=LI.ICON_CUP_SILVER;break;case 3:e=LI.ICON_CUP_COPPER}return e},n.updateRankIcon=function(t){if(t<=3){this.rankText.setVisible(!1),this.rankIcon.setVisible(!0);var e=this.getRankIconFrame(t);this.rankIcon.setFrame(e)}else this.rankText.setVisible(!0).setText(String(t)),this.rankIcon.setVisible(!1)},n.createRankText=function(t){this.rankText=this.scene.make.bitmapText({font:qr.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(32),text:""+t,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(t){t<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(""+t),this.rankText.setFont(qr.default.NUMBER_DARK.KEY))},n.getShortName=function(t){var e=t.substring(0,7);return e.split(" ")[0]||e},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("Sang Le"),style:{fontFamily:qr.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(36)+"px",fontStyle:"700"}}),this.username.setTint(7551258),this.add(this.username),Phaser.Display.Align.In.Center(this.username,this.background,-44)},n.updateUsername=function(){var t=this.payload.name;this.username.setText(this.getShortName(t)),this.username.setTint(7551258)},n.createTimeBlock=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:BI,frame:LI.DAILY_BG_TIME});e.setWorldSize(85,24),t.add(e);var n=this.scene.make.image({key:BI,frame:LI.ICON_CLOCK});n.setWorldSize(17,17),t.add(n),Phaser.Display.Align.In.LeftCenter(n,e,-5),this.textTime=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(27),text:"0",origin:{x:.5,y:.5}}),t.add(this.textTime),Phaser.Display.Align.In.Center(this.textTime,e,10,1.5),this.add(t),Phaser.Display.Align.In.Center(t,this.background,70)},n.updateTime=function(){var t=this.payload.score;this.textTime.setText(this.secondsToHms(t))},n.secondsToHms=function(t){var e,n,i,a=Math.round(t/1e3%60),s=Math.floor(t/6e4%60),o=Math.floor(t/36e5%24);return r()(e="0"+o).call(e,-2)+":"+r()(n="0"+s).call(n,-2)+":"+r()(i="0"+a).call(i,-2)},e}(Phaser.GameObjects.Container),NI=FI;function GI(t,e){var n="undefined"!==typeof Rh()&&Oh()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return UI(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return UI(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function UI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var VI=Ar.default.DEFAULT,YI=VI.KEY,zI=VI.FRAME,WI=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scroller=void 0,n.scrollerValue=void 0,n.tweenMoveToRank=void 0,n.scene=e,n.createReuseScroller(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createReuseScroller=function(){this.scroller=new Ap(this.scene,{classType:NI,listConfigs:[],width:260,height:190,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(YI,zI.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,70),this.add(this.scroller)},n.updateData=function(t,e){var n=[],i=0;if(!(t.length<1)){for(var a,s=Na()(t).call(t,(function(t,e){return+t.score-+e.score})),r=window.game.player.getPlayer().playerId,o=0,c=GI(s);!(a=c()).done;){var h=a.value,l=h.playerId,u=h.score,d=h.name;i++;var p=zI.DAILY_BG_ITEM_LIGHT;i%2==0&&(p=zI.DAILY_BG_ITEM_DARK);var f={playerId:l,name:d,score:u,rank:i,backgroundFrame:p};n.push(f),l==r&&(o=i),e&&e==l&&this.runTweenMoveToRank(i)}if(this.scroller.updateConfig(n),!e){var g=this.scroller.getChildren()[0].height;this.scroller.value=-g*this.showDefaultRank(o)}this.showLeaders()}},n.showDefaultRank=function(t){return t<3?0:t-3},n.runTweenMoveToRank=function(t){var e=this,n=this.scroller.getChildren()[0].height;this.scrollerValue=-n*(t-3),this.tweenMoveToRank=this.scene.tweens.addCounter({from:this.scroller.value,to:this.scrollerValue,duration:1e3,onUpdate:function(t){e.scroller.value=t.getValue()}}),this.scene.time.delayedCall(2500,(function(){1!=t&&2!=t||(e.scroller.value=0)}))},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this,e=this.getLeaders();if(!(e.length<1)){for(var n=Math.min(e.length,6),i=0;i<n;i++){var a=e[i];a&&a.setVisible(!0)}var s=300+100*n+250;this.scene.time.delayedCall(s,(function(){t.scroller.setEnable(!0)}))}},n.getTestData=function(){return[{playerId:"001",name:"A",score:"001",rank:1},{playerId:"002",name:"B",score:"002",rank:2},{playerId:"003",name:"C",score:"003",rank:3},{playerId:"004",name:"D",score:"004",rank:4},{playerId:"005",name:"E",score:"005",rank:5},{playerId:"006",name:"F",score:"006",rank:6},{playerId:"007",name:"G",score:"007",rank:7}]},e}(Phaser.GameObjects.Container),HI=WI;function XI(t,e){var n="undefined"!==typeof Rh()&&Oh()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return KI(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return KI(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function KI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var jI=Ar.default.DEFAULT,qI=jI.KEY,ZI=jI.FRAME,JI=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonHome=void 0,s.buttonShare=void 0,s.contents=void 0,s.avatar=void 0,s.listLeaderItem=[],s.loading=void 0,s.backgroundContent=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.leaderItems=void 0,s.scene=e,s.createPopup(),s.createScroller(),s.createContentBackground(),s.createAvatar(),s.createTitle(),s.createButtons(),s.createLeaderBoard(),s.createLoading(),s.handleStateChange(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createScroller=function(){this.leaderItems=new HI(this.scene),this.popup.add(this.leaderItems),Phaser.Display.Align.In.Center(this.leaderItems,this.popup,0,36)},n.handleStateChange=function(){var t=this;[{selector:EI,callback:function(e){if(t.loading.setVisible(!0),t.leaderItems.setVisible(!1),!1===e){var n=t.getLeadersData();t.loading.setVisible(!1),t.leaderItems.setVisible(!0),t.leaderItems.updateData(n)}}}].forEach((function(e){var n=e.selector,i=e.callback;t.scene.storage.watch(n,i)}))},n.updateLeaderItems=function(){var t=window.game.player.getPlayer(),e=t.playerId,n=t.name,i=this.getLeadersData(),a=dE()(i).call(i,(function(t){return t.playerId===e}));a&&(i=h()(i).call(i,(function(t){return t.playerId!=e})));var s=this.scene.game.storage.getState(),r=wI(s);if(!(r>((null==a?void 0:a.score)||86399e3))){var o=this.checkRankByScore((null==a?void 0:a.score)||86399e3,i),c=this.checkRankByScore(r,i),l={playerId:e,name:n,score:r,rank:-1};i.push(l);var u=new NI(this.scene);u.updateInfo(l),this.popup.add(u),Phaser.Display.Align.In.Center(u,this.popup,0,85),this.leaderItems.updateData(i,e),this.scene.tweens.addCounter({from:o,to:c,duration:1300,onUpdate:function(t){var e=Math.floor(t.getValue());u.payload.rank=e,u.updateRank()}}),this.scene.time.delayedCall(2500,(function(){u.setVisible(!1)}))}},n.checkRankByScore=function(t,e){return h()(e).call(e,(function(e){return e.score<t})).length+1},n.getLeaderDefaultData=function(){var t=[],e=this.scene.game.storage.getState(),n=this.scene.player.getPlayer(),i=wI(e);t.push({playerId:n.playerId,name:n.name,score:i,rank:1});for(var a=0;a<4;a++)t.push({playerId:"???-"+a,name:"???",score:0,rank:a+2});return t},n.getLeadersData=function(){var t=this.scene.game.storage.getState(),e=bI(t),n=[];if(e&&0!==Y()(e).length){var i=La()(e)||[];if(i.length<1)return this.getLeaderDefaultData();for(var a,s=XI(Na()(i).call(i,(function(t,e){return+t.score-+e.score})));!(a=s()).done;){var r=a.value;n.push(r)}}else n=this.getLeaderDefaultData();return n},n.open=function(){t.prototype.open.call(this),this.loadAvatar(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new vo(this.scene,0,20,290,515,{forceHeightTop:54}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:qI,frame:ZI.DAILY_BACKGROUND}),this.backgroundContent.setWorldSize(258,132),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-86)},n.createAvatar=function(){this.avatar=new Il(this.scene,{key:qI,frame:ZI.AVATAR_BORDER,background:ZI.AVATAR_BACKGROUND,width:70,height:70,radius:10,borderWidth:10}),this.popup.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this.backgroundContent,71,-10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:qI,frame:ZI.TEXT_RESULT});t.setWorldSize(132,21),this.buttonClose=new Kr.default(this.scene,qI,ZI.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,20),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,0),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-30)},n.clickButtonClose=function(){this.runCloseAnimation(),this.scene.storage.dispatch(jd(!0)),this.scene.screen.open(kr)},n.createButtons=function(){this.createButtonShare(),this.createButtonHome()},n.createLeaderBoard=function(){this.createLeaderPanel(),this.createLeaderBorder()},n.createLoading=function(){this.loading=new Cl(this.scene),this.popup.add(this.loading),Phaser.Display.Align.In.Center(this.loading,this.popup,0,110)},n.createLeaderPanel=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:qI,frame:ZI.DAILY_TITLE_PANEL});e.setWorldSize(143,35),t.add(e),Phaser.Display.Align.In.TopCenter(e,t);var n=this.scene.make.image({key:qI,frame:ZI.TEXT_RANKING});n.setWorldSize(100,15),t.add(n),Phaser.Display.Align.In.Center(n,e),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-23)},n.createLeaderBorder=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:qI,frame:ZI.DAILY_BORDER_TOP});e.setWorldSize(260,15),t.add(e);var n=this.scene.make.image({key:qI,frame:ZI.DAILY_BORDER_MIDDLE});n.setWorldSize(260,180),t.add(n),Phaser.Display.Align.In.Center(n,e,0,90);var i=this.scene.make.image({key:qI,frame:ZI.DAILY_BORDER_BOTTOM});i.setWorldSize(260,15),t.add(i),Phaser.Display.Align.In.Center(i,n,0,90),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,17)},n.createButtonShare=function(){this.buttonShare=new II(this.scene),this.buttonShare.onClick=this.clickButtonShare.bind(this),this.popup.add(this.buttonShare),Phaser.Display.Align.In.Center(this.buttonShare,this.backgroundContent,7,43)},n.clickButtonShare=function(){this.scene.storage.dispatch(Mu())},n.createButtonHome=function(){this.buttonHome=new OI(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome.bind(this),Phaser.Display.Align.In.BottomCenter(this.buttonHome,this.popup,0,10)},n.clickButtonHome=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.loadAvatar=function(){var t=this.scene.player.getPlayer(),e=t.playerId,n=t.photo;this.avatar.loadPhoto(e,n)},e}(GameCore.Screen),QI=GameCore.Configs,$I=QI.OtherHost,tP=QI.DailyChallenge,eP=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("leaderboards/"+tP.LeaderBoardId+"/players/"+e,{score:n},{},$I);case 2:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),nP=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],a=tP.Prefix+"/"+tP.LeaderBoardId+"/leaders"){t.next=4;break}return t.abrupt("return",i);case 4:return t.next=6,Ke(a+"?limit="+e+"&offset="+n,{},$I);case 6:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=10;break}return t.abrupt("return",i);case 10:return i=r,t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function iP(t,e){var n="undefined"!==typeof Rh()&&Oh()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return aP(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return aP(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function aP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var sP,rP=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=t.time,a=t.limit,s=t.offset,r=window.game.player,o=r.getPlayerId(),n({type:cs,payload:{}}),n(hP(i)),e.next=8,eP(o,i);case 8:return e.next=10,(0,Ge.sleepAsync)(500);case 10:n(oP({limit:a,offset:s})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),(0,Wt.sendException)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()},oP=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A,x;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n({type:cs,payload:{}}),i=t.limit,a=t.offset,s=window.game,r=s.player,o=s.profile,c=r.getPlayerId(),r.getConnectedPlayerIds(5,0).push(c),e.next=9,nP(i,a);case 9:return h=e.sent,l=De()(h).call(h,(function(t){return t.playerId})),l.push(r.getPlayerId()),e.next=14,o.requestProfiles(l);case 14:u=o.getProfiles(),d={},p=iP(h);case 17:if((f=p()).done){e.next=26;break}if(g=f.value,m=g.playerId,v=g.score,y=g.rank,u[m]){e.next=22;break}return e.abrupt("continue",24);case 22:S=u[m],A=S.name,x=S.photo,d[m]={playerId:m,name:A,photo:x,score:v,rank:y};case 24:e.next=17;break;case 26:n(cP(d)),e.next=33;break;case 29:e.prev=29,e.t0=e.catch(0),n(cP([])),(0,Wt.sendException)(e.t0);case 33:case"end":return e.stop()}}),e,null,[[0,29]])})));return function(t){return e.apply(this,arguments)}}()},cP=function(t){return{type:hs,payload:{leaders:t}}},hP=function(t){return{type:ls,payload:{time:t}}},lP=Ar.default.DEFAULT,uP=lP.KEY,dP=lP.FRAME,pP=Ar.default.GAMEPLAY,fP=pP.KEY,gP=pP.FRAME,mP=Ar.default.GAMEPLAY_32,vP=mP.KEY,yP=mP.FRAME,SP=GameCore.Configs,AP=SP.Network,xP=SP.Board,EP=function(t){function e(e,n,i,a){var s;(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var t=s.getData(["onClose"])[0];s.scene.screen.close(s.name),s.scene.scene.switch(ar.SceneKeys.DASHBOARD_SCENE),t&&t()}))},s.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},s.scene=e;try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(Wr),s.background.setAlpha(.5)}catch(r){console.log("ex === ",r)}return s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=gu(t),n=ed[e];if(!n)return void this.handleLoadCurrentMapComplete();var i=n.key,a=n.mapJson;if(this.scene.cache.tilemap.exists(i))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(i,a),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(s){(0,Wt.sendException)(s)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!gu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Fd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:AP.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(Er)},n.createPopup=function(){this.popup=new vo(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:uP,frame:dP.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.buttonClose=new Kr.default(this.scene,uP,dP.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:uP,frame:dP.TEXT_COLLECT});t.setWorldSize(85,13);var e=this.scene.make.image({key:uP,frame:dP.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=gu(n),a=ed[i],s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,Hv.isArray)(s)&&!(s.length<2))for(var r=s[0].value,o=kv()(t=kv()(e=kv()(r).call(r,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),c=JSON.parse(o),h=Y()(c),l=this.calcPosition(h.length),u=0;u<h.length;u++){var d=h[u],p=OS[d],f=c[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:vP,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:fP,frame:gP.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<xP.rows;t++){this.boardCellData[t]=[];for(var e=0;e<xP.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=yP.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(s)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=pu(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<xP.rows;t++)for(var e=0;e<xP.cols;e++){this.boardCellData[t][e].setFrame(yP.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=rf()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=ZS(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=gu(t),n=ed[e],i=this.scene.make.tilemap({key:n.key}).layers;if((0,Hv.isArray)(i)){var a=i[0].data;if((0,Hv.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var c=r[o];if(!(c.index<0)){var h=OS[c.index-1];this.boardCellData[s][o].setFrame(h)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:vP,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new Kr.default(this.scene,uP,dP.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:uP,frame:dP.TEXT_PLAY});t.setWorldSize(65,15);var e=this.scene.make.image({key:uP,frame:dP.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=gu(e);t.scene.storage.dispatch(Nd()),n>ed.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Jd()),t.scene.handleRetryLevel())}))},n.getLevelName=function(t){var e;return"journey_"+Sr()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),bP=Ar.default.DEFAULT,wP=bP.KEY,TP=bP.FRAME,CP=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textTargetScore=void 0,s.textScore=void 0,s.titleFrame=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.createTextTargetScore(),s.createTextScore(),s.addItem(),s.setDepth(Wr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.scene.targetMissionManager.getTargetValue();this.textScore.setText(""+i);var a=this.getData(["duration"])[0];this.runOpenAnimation(),this.scene.time.delayedCall(a,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:wP,frame:TP.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.backgroundContent,0,-30)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.backgroundContent,0,15)},n.createPopup=function(){this.popup=new vo(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:wP,frame:TP.TEXT_MISSION}),this.titleFrame.setWorldSize(105,21),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Xr.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new uo({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new co({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new ao({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new Ph({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new ao({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),MP=CP,IP=Ar.default.DEFAULT,PP=IP.KEY,kP=IP.FRAME,RP=function(){function t(t){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createBackground(),this.createText(),this.createTween()},e.createBackground=function(){this.background=this.scene.make.image({key:PP,frame:kP.BG_STREAK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},e.createText=function(){this.text=this.scene.make.bitmapText({font:qr.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X \u041a\u041e\u041c\u0411\u041e!"}),this.text.setVisible(!1)},e.createTween=function(){var t=this,e=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:e}},paused:!0,onComplete:function(){t.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){t.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:e-.3}},paused:!0,onComplete:function(){t.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){t.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y-n),t.background.setPosition(t.x,t.y-n)},onComplete:function(){t.y=t.y-20,t.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y+n),t.background.setPosition(t.x,t.y+n)},onComplete:function(){t.y=t.y+5,t.tweenStep5.play(),t.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e-.3,to:e}},paused:!0,onComplete:function(){t.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){t.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.background.setVisible(!1),t.text.setScale(0),t.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.text.setScale(0)}})},e.playAnim=function(t,e){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=t,this.y=e,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(t,e),this.background.setPosition(t,e),this.text.setVisible(!0),this.tweenTextStep1.play()},e.setTextCombo=function(t){this.text.setText(t+"X \u041a\u041e\u041c\u0411\u041e!")},e.setTextStreak=function(t){this.text.setText(t+"X \u041f\u041e\u041b\u041e\u0421\u0410!")},e.setBgFrame=function(t){this.background.setFrame(t)},t}(),_P=function(){function t(t){this.scene=void 0,this.streakBreak=void 0,this.scene=t,this.init()}return t.prototype.init=function(){this.streakBreak=new RP(this.scene)},t}(),OP=GameCore.Configs,DP=OP.Board,BP=OP.Network,LP=Ar.default.GAMEPLAY_32.FRAME,FP=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).lastTimeInputEnabled=0,n.tutorialManager=void 0,n.levelManager=void 0,n.mapManager=void 0,n.targetMissionManager=void 0,n.effectManager=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.isGameOver=void 0,n.isLevelComplete=void 0,n.restartCurrentLevel=0,n.startGameAt=void 0,n.run=function(){var t=n.storage.getState();!0!==Ll(t)&&n.storage.dispatch(jd(!0)),n.updateCurrentBestScore(),n.preloadNextLevel(),n.startGame(),n.analytics.levelStart(n.levelManager.getLevel(),void 0,n.getLevelName())},n.create=function(){t.prototype.create.call((0,gr.default)(n)),n.createBackground(Ws.default.BACKGROUND.KEY),n.createTutorialManager(),n.createLevelManager(),n.createMapManager(),n.createTargetMissionManager(),n.createHeader(),n.createMain(),n.createFooter(),n.createEffectManager(),n.createScreens(),n.createInput(),n.input.setTopOnly(!0),n.preLoadAds()},n.handlePauseGame=function(){n.isGameOver||n.isLevelComplete||(0,gr.default)(n).screen.open(wr)},n.handleShowInterstitialAd=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.ads.showInterstitialAdAsync();case 6:n.analytics.showInterstitialAd(n.getSceneName()),t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return");case 12:return t.prev=12,n.audio.playMusic(),n.ads.preloadInterstitialAdAsync().catch(Wt.sendException),n.audio.playMusic(),t.finish(12);case 17:case"end":return t.stop()}}),t,null,[[0,9,12,17]])}))),n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(t){return console.log(t)})),this.ads.preloadRewardedVideoAsync().catch((function(t){return console.log(t)}))},n.createHeader=function(){this.header=new EC(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new AI(this)},n.createLevelManager=function(){this.levelManager=new uM(this)},n.createMapManager=function(){this.mapManager=new dM(this)},n.createEffectManager=function(){this.effectManager=new _P(this)},n.createTargetMissionManager=function(){this.targetMissionManager=new pM},n.createMain=function(){this.main=new VT(this)},n.createFooter=function(){this.footer=new lM(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createMissionScoreCompleteScreen(),this.createMissionCollectionCompleteScreen(),this.createCollectionCompletedScreen(),this.createNoSpaceLeftScreen(),this.createMissionFailScreen(),this.createSettingScreen(),this.createCollectionItemsScreen(),this.createLeaderboardScreeen(),this.createDailyChallengeModeScreen(),this.createMiniJourneyScreen(),this.createTargetScoreScreen(),this.createClaimHeartScreen()},n.createLeaderboardScreeen=function(){this.screen.add(Pr,Lp)},n.createCollectionCompletedScreen=function(){this.screen.add(Fr,gM)},n.createMissionScoreCompleteScreen=function(){this.screen.add(Dr,SM)},n.createMissionCollectionCompleteScreen=function(){this.screen.add(Br,bM)},n.createDailyChallengeModeScreen=function(){this.screen.add(Rr,JI)},n.createMissionFailScreen=function(){this.screen.add(Lr,PM)},n.createNoSpaceLeftScreen=function(){this.screen.add(Nr,TM)},n.createSettingScreen=function(){this.screen.add(wr,sI)},n.createCollectionItemsScreen=function(){this.screen.add(Vr,fI)},n.createMiniJourneyScreen=function(){this.screen.add(kr,EP)},n.createTargetScoreScreen=function(){this.screen.add(Yr,MP)},n.createClaimHeartScreen=function(){this.screen.add(zr,Fb)},n.updateCurrentBestScore=function(){var t=this.player.getBestScore(),e=this.storage.getState(),n=Su(e).bestScore,i=void 0===n?0:n,a=t>i?t:i;this.header.bestScoreBlock.setScoreText(a)},n.openLevelScreen=function(){this.screen.open(Or)},n.handleNextLevel=function(){var t=this.levelManager.getNextLevelConfig();if(t){var e=t.key;this.cache.tilemap.exists(e)?this.handleLoadMapComplete():(this.preloadNextLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}},n.handleSwitchJourney=function(){var t=this.levelManager.getLevelConfig();if(t){var e=t.key;this.cache.tilemap.exists(e)?this.handleSwitchMode():(this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}},n.handleSwitchMode=function(){var t,e=this.levelManager.getLevel();this.storage.dispatch((t={data:"",level:e,listPieceMap:[]},function(e,n){var i=window.game.player.getPlayerId(),a=n(),s=pu(a),r=(0,Tt.default)({},s,t),o=r.data;r.data=Ed(o),e(Id(r)),Le(xd.JourneyMatchStore+"-"+i,r)})),FBInstant.player.setDataAsync({level:e}),this.mapManager.reloadMap(),this.clearFen()},n.handleLoadMapComplete=function(){this.levelManager.increaseLevel();var t=this.levelManager.getLevel();FBInstant.player.setDataAsync({level:t}),this.mapManager.reloadMap()},n.handleGuideIfLevel1=function(){var t=this.storage.getState();mu(t)||1===this.levelManager.getLevel()&&this.tutorialManager.start()},n.startGame=function(){try{var t;this.isGameOver=!1,this.isLevelComplete=!1,this.mapManager.reloadMap(),null==(t=this.tutorialManager)||t.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),this.loadTargetByMap(),this.header.start(),this.loadBoardAndPieces(),this.loadTargetAmountByFen(),this.loadTextHeader(),this.restartCurrentLevel=0,this.openMissionScreen()}catch(e){console.log("Error ",e),this.handleRestartLevel(),(0,Wt.sendExceptionWithScope)(e,{scene:"Journey scene"})}},n.startGameAfterCollectionItemsScreenClose=function(){var t;this.startGameAt=(new Date).getTime();var e=this.storage.getState(),n=mu(e),i=((null==(t=pu(e))?void 0:t.data)||{}).fen;!i||n?(this.footer.pieces.start(),this.handleGuideIfLevel1()):this.loadPiecesByFen(i)},n.openMissionScreen=function(){switch(this.targetMissionManager.getTargetType()){case DT:this.openCollectionItemsScreen();break;case OT:this.openTargetScoreScreen()}},n.openCollectionItemsScreen=function(){var t=this,e=this.header.collectItems.getJsonTarget();this.header.collectItems.hideListCollectItems(),this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Vr,{jsonTarget:e,duration:1500})}))},n.openTargetScoreScreen=function(){var t=this;this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Yr,{duration:1500})}))},n.showCollectItems=function(){this.header.collectItems.showListCollectItems()},n.loadBoardAndPieces=function(){var t,e=this.storage.getState(),n=mu(e),i=((null==(t=pu(e))?void 0:t.data)||{}).fen,a=null,s=null;if(i&&!n){var r=this.main.board.getBoardByFen(i);return a=this.handleDynamicFenSize(r),s=this.footer.pieces.getPiecesByFen(i),this.isFenGameOver(a,s)?(this.clearFen(),this.loadBoardByMap(),void this.loadPiecesByMap()):void this.loadBoardByFen(i)}this.loadBoardByMap(),this.loadPiecesByMap()},n.loadBoardByFen=function(t){var e=this.main.board.getBoardByFen(t);this.main.board.startGame(e,t)},n.loadBoardByMap=function(){for(var t=this.mapManager.getTileMap().layers,e=t.length,n=0;n<e;n++)for(var i=t[n].data,a=0;a<i.length;a++)for(var s=i[a],r=0;r<s.length;r++){var o=s[r];if(!(o.index<0)){var c=this.main.board.getFrameByMapItemIndex(o.index-1);c&&c!==LP.GEM_TRANSPARENT||(c=this.main.board.getFrameByMapItemIndex(1),(0,Wt.sendExceptionWithScope)(new Error("MapByBoardError"),{index:o.index,level:this.levelManager.getLevel(),row:a,col:r})),this.main.board.setFrameBoardByIndex(a,r,c)}}this.main.board.fadeIn()},n.loadPiecesByFen=function(t){var e=this.footer.pieces.getPiecesByFen(t);this.footer.pieces.showAvailablePieces(e),this.loadListPieceMapByFen()},n.loadListPieceMapByFen=function(){var t=this.storage.getState(),e=pu(t).listPieceMap;e&&0!==e.length&&this.footer.pieces.setListPieceMap(e)},n.loadPiecesByMap=function(){this.footer.pieces.buildPiecesByMap();var t=this.mapManager.getTileMap().getObjectLayer("spawnOrder");if(console.log("objects === ",t),t)for(var e=t.objects,n=0;n<e.length;n++){var i=e[n],a=i.type,s=i.properties,r=this.footer.pieces.getPieceDataByType(a);s&&(r=(0,Tt.default)({},r,{properties:s})),r&&this.footer.pieces.addItemPieceMap(r)}},n.loadTargetByMap=function(){var t=this.mapManager.getTileMap().properties;if(!t||!(0,Hv.isArray)(t)||t.length<2)throw new rI;console.log("properties === ",t);var e=t[0].value,n=t[1].value;this.targetMissionManager.setTargetValue(e),this.targetMissionManager.setTargetType(n)},n.loadTargetAmountByFen=function(){var t;this.header.collectItems.resetTextAmount();var e=this.storage.getState();if(!mu(e)){var n=((null==(t=pu(e))?void 0:t.data)||{}).jsonAmount;n&&0!==Y()(n).length&&this.header.collectItems.updateJsonAmountByFen(n)}},n.loadTextHeader=function(){var t=this.storage.getState();if(mu(t))return this.header.bestScoreBlock.showTextDay(),void this.header.bestScoreBlock.setDayText(this.getTextDay());var e=this.levelManager.getLevel();this.header.bestScoreBlock.showTextScore(),this.header.bestScoreBlock.setScoreText(e)},n.getTextDay=function(){var t,e=new Date,n="0"+e.getDate(),i="0"+(e.getMonth()+1),a=r()(t=String(e.getFullYear())).call(t,-2);return r()(n).call(n,-2)+"."+r()(i).call(i,-2)+"."+a},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.handleRestartLevel=function(){this.restartCurrentLevel>0||(this.game.globalScene.screen.open(Er,{message:"Some thing went wrong. Restart map...",duration:BP.Timeout,loading:!0}),this.restartCurrentLevel++,this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this)),this.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR),this.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadCurrentMapError.bind(this)))},n.handleGameOver=function(){this.isGameOver=!0,this.screen.open(Mr)},n.handleRequestFinishGame=function(){var t=this;this.isGameOver=!0,this.clearFen();var e=this.storage.getState();if(mu(e)){var n,i=Iw(),a=Sr()(n=GameCore.Utils.Number).call(n,i,4,"0");this.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_FAIL,{level:i,levelName:"daily_challenge_"+a})}else this.analytics.levelFail(this.levelManager.getLevel(),void 0,this.getLevelName());this.screen.open(Nr,{duration:3e3,onClose:function(){t.handleShowInterstitialAd().catch(Wt.sendException),t.screen.open(Lr)}})},n.checkAnimPlaying=function(){var t=this.tweens.getAllTweens();return!(!t||0===t.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(t){return t.piece.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.handleUpdateScore=function(t){console.log("handleUpdateScore");var e=this.header.mainScoreBlock.score+t;this.storage.dispatch(function(t){return{type:ha,payload:{score:t}}}(e))},n.handleAddScoreAnim=function(t){this.header.mainScoreBlock.animAddScore(t)},n.updateProgressTargetScore=function(t){var e=this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(t/e)},n.handleCompleteScoreMission=function(){this.isGameOver||this.targetMissionManager.getTargetType()!==OT||(this.header.mainScoreBlock.score<ob()(this.targetMissionManager.getTargetValue())||(this.handleNextLevel(),this.screen.open(Dr)))},n.canUpdateFenMatch=function(){var t=this.storage.getState(),e=mu(t);return!(this.isGameOver||this.isLevelComplete||e)},n.updateMatchData=function(){var t;if(this.canUpdateFenMatch()){var e=this.getFen(),n=this.storage.getState(),i=pu(n).data||{},a=fu(n),s=vu(n)||0,r=this.levelManager.getLevel(),o=this.header.collectItems.getJsonAmount(),c=this.footer.pieces.getListPieceMap();this.storage.dispatch(Td(a,{score:s,data:(0,Tt.default)({},i,{fen:e,jsonAmount:(0,Tt.default)({},o)}),level:r,updateAt:Date.now(),listPieceMap:et()(t=[]).call(t,c)}))}},n.clearFen=function(){var t=this.storage.getState(),e=fu(t),n=Su(t).score,i=void 0===n?0:n,a=this.levelManager.getLevel();this.storage.dispatch(Td(e,{score:i,data:{fen:"",jsonAmount:{}},level:a,listPieceMap:[],updateAt:Date.now()}))},n.update=function(t){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=t:t-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=t)},n.isFenGameOver=function(t,e){for(var n=[],i=0;i<e.length;i++){var a=e[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case fy:case gy:case my:n.push({data:RC.getData(s,r,o)});break;case vy:case yy:case Sy:case Ay:n.push({data:OC.getData(s,r)});break;case xy:case Ey:case by:n.push({data:BC.getData(s)});break;case Ty:n.push({data:FC.getData(r)});break;case Cy:n.push({data:VC.getData(r)});break;case _y:n.push({data:KC.getData(r)});break;case Iy:case Py:case ky:case Ry:n.push({data:HC.getData(s,r)});break;case wy:n.push({data:GC.getData(r)});break;case My:n.push({data:zC.getData()})}}return WS(t,n)},n.handleDynamicFenSize=function(t){var e,n,i=0;if((n=t.length)&&(i=t[0].length),0===n||0===i)return t;var a=et()(e=[]).call(e,t);if(n>DP.rows)vr()(a).call(a,DP.rows,n-DP.rows);else if(i<DP.rows)for(var s=0;s<DP.rows-n;s++){var r;a.push(A()(r=new Array(n)).call(r,{value:0,frame:LP.GEM_TRANSPARENT}))}return i>DP.cols?a.forEach((function(t){vr()(t).call(t,DP.cols,i-DP.cols)})):i<DP.cols&&a.forEach((function(t){for(var e=0;e<DP.cols-i;e++)t.push({value:0,frame:LP.GEM_TRANSPARENT})})),a},n.handleCollectionItemsComplete=function(){var t=this;if(this.targetMissionManager.getTargetType()!==OT&&this.header.collectItems.checkCompleteMission()){this.clearFen(),this.audio.playSound(Xr.default.TARGET_REACHED);var e=this.levelManager.getLevel(),n=this.storage.getState();if(pu(n).challengeMode){var i,a=Iw(),s=Sr()(i=GameCore.Utils.Number).call(i,a,4,"0");this.handleSwitchJourney(),this.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_END,{level:a,levelName:"daily_challenge_"+s})}else this.handleNextLevel(),this.analytics.levelComplete(e,void 0,this.getLevelName());e>ed.length-1&&this.time.delayedCall(2e3,(function(){t.game.globalScene.screen.open(Er,{message:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u0435\u0439...",duration:1e3}),t.time.delayedCall(1e3,(function(){t.scene.switch(ar.SceneKeys.LEVEL_SCENE)}))})),this.screen.open(Fr,{duration:3e3,onClose:function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isLevelComplete=!1,t.handleShowInterstitialAd().catch(Wt.sendException),t.showPopupCompleteScreenAfterCollectionCompleted();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},n.showPopupCompleteScreenAfterCollectionCompleted=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.storage.getState(),!mu(e)){t.next=8;break}return n=(new Date).getTime()-this.startGameAt,this.storage.dispatch(rP({time:n,limit:100,offset:0})),this.storage.dispatch(Nd()),this.screen.open(Rr),t.abrupt("return");case 8:this.screen.open(Br);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setLevelCompleted=function(t){this.targetMissionManager.getTargetType()!==OT&&(this.isLevelComplete=t)},n.handleRetryLevel=function(){var t=this.storage.getState();if(pu(t).challengeMode){var e,n=Iw(),i=Sr()(e=GameCore.Utils.Number).call(e,n,4,"0");this.analytics.event(ni.AnalyticsEvents.DAILY_CHALLENGE_BEGIN,{level:n,levelName:"daily_challenge_"+i})}else this.analytics.levelStart(this.levelManager.getLevel(),void 0,this.getLevelName());this.header.progressBar.reset(),this.clearFen(),this.startGame()},n.preloadNextLevel=function(){var t=this.levelManager.getNextLevelConfig();if(t){var e=t.key,n=t.mapJson;"level-from-json"!==e&&(this.cache.tilemap.exists(e)||(this.load.tilemapTiledJSON(e,n),this.load.start()))}},n.preloadCurrentLevel=function(){var t=this.levelManager.getLevelConfig();if(t){var e=t.key,n=t.mapJson;this.cache.tilemap.exists(e)?this.handleLoadCurrentMapComplete():(this.load.tilemapTiledJSON(e,n),this.load.start())}},n.handleLoadCurrentMapComplete=function(){var t=this.game.globalScene;this.mapManager.reloadMap(),this.clearFen(),this.startGame(),t.screen.close(Er)},n.handleLoadCurrentMapError=function(t){var e=this.game.globalScene,n=new eE("Load resources at LoadScene failed.");(0,Wt.sendExceptionWithScope)(n,{file:null==t?void 0:t.url}),e.screen.close(Er)},n.getLevelName=function(){var t,e=this.levelManager.getLevel();return"journey_"+Sr()(t=GameCore.Utils.Number).call(t,e,4,"0")},e}(Fp.default),NP=FP;null==(sP=void 0)||sP.accept(GameCore.LiveUpdate.Scene(ar.SceneKeys.JOURNEY_SCENE));var GP,UP=NP,VP=Ar.default.GAMEPLAY,YP=VP.KEY,zP=VP.FRAME,WP=function(t){function e(e){var n;return(n=t.call(this,e,YP,zP.BUTTON_WOOD_SMALL)||this).button.setWorldSize(64,55),n.setName("AddFriends"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:YP,frame:zP.ICON_ADD_FRIEND});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,.25,-2.5)},e}(Kr.default),HP=WP,XP=Ar.default.GAMEPLAY,KP=XP.KEY,jP=XP.FRAME,qP=function(t){function e(e){var n;return(n=t.call(this,e,KP,jP.BUTTON_WOOD_SMALL)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:KP,frame:jP.ICON_HOME});t.setWorldSize(34,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(Kr.default),ZP=qP,JP=Ar.default.DEFAULT,QP=JP.KEY,$P=JP.FRAME,tk=function(t){function e(e){var n;return(n=t.call(this,e,QP,$P.BUTTON_GREEN)||this).nextLevel=void 0,n.button.setWorldSize(182,55),n.setName("Play Level"),n.createText(),n}return(0,Kt.default)(e,t),e.prototype.createText=function(){this.nextLevel=this.scene.make.image({key:QP,frame:$P.TEXT_NEXT_LEVEL}),this.nextLevel.setWorldSize(102,35.5),this.add(this.nextLevel),Phaser.Display.Align.In.Center(this.nextLevel,this,0,-1)},e}(Kr.default),ek=tk,nk=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonPlay=void 0,n.buttonHome=void 0,n.buttonInviteFriends=void 0,n.scene=e,n.init(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createButton()},n.createButton=function(){this.createButtonPlay(),this.createButtonHome(),this.createButtonAddFriends()},n.createButtonPlay=function(){this.buttonPlay=new ek(this.scene),this.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this,0,1)},n.createButtonHome=function(){this.buttonHome=new ZP(this.scene),this.add(this.buttonHome),Phaser.Display.Align.In.Center(this.buttonHome,this,-131,1)},n.createButtonAddFriends=function(){this.buttonInviteFriends=new HP(this.scene),this.add(this.buttonInviteFriends),Phaser.Display.Align.In.Center(this.buttonInviteFriends,this,131,1)},n.updateTextButtonPlay=function(){var t=this.scene.storage.getState();1===gu(t)?(this.buttonPlay.nextLevel.setFrame(Ar.default.DEFAULT.FRAME.TEXT_PLAY),this.buttonPlay.nextLevel.setWorldSize(83,19)):(this.buttonPlay.nextLevel.setFrame(Ar.default.DEFAULT.FRAME.TEXT_NEXT_LEVEL),this.buttonPlay.nextLevel.setWorldSize(102,35.5))},e}(Phaser.GameObjects.Container),ik=nk,ak=Ar.default.DEFAULT,sk=ak.KEY,rk=ak.FRAME,ok=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,sk,rk.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,gr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),ck=ok,hk=Ar.default.DEFAULT,lk=hk.KEY,uk=hk.FRAME,dk=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.livesTimer=void 0,n.scene=e,e.add.existing((0,gr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createText(),this.createLeaf(),this.createLivesTimer()},n.createText=function(){var t=this.scene.make.image({key:lk,frame:uk.TEXT_JOURNEY});t.setWorldSize(143.5,16.5),this.add(t),Phaser.Display.Align.In.Center(t,this,0,14)},n.createLeaf=function(){var t=new ck(this.scene);this.add(t),Phaser.Display.Align.In.TopCenter(t,this,0,t.displayHeight/2-30)},n.createLivesTimer=function(){this.livesTimer=new yb(this.scene),this.livesTimer.startIntervalTimer(),this.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this,0,50)},n.updateTextLives=function(){var t=this.scene.storage.getState(),e=_v(t);this.livesTimer.setLives(e)},e}(Phaser.GameObjects.Container),pk=dk;!function(t){t.PASSED="passed",t.READY="ready",t.WAITING="waiting"}(GP||(GP={}));var fk,gk=Ar.default.DEFAULT,mk=gk.KEY,vk=gk.FRAME,yk=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).scene=void 0,i.levelBackground=void 0,i.tick=void 0,i.levelNumber=void 0,i.level=void 0,i.tweenClick=void 0,i.payload=void 0,i.scene=e,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){var t=this;this.createLevelBackground(),this.createImageCheck(),this.createText(),this.updateSize(),this.alignLevelItem(),this.setInteractive(),this.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.scene.audio.playSound(Xr.default.BUTTON_CLICK),t.tweenClick?t.tweenClick.play():t.scene.handlePlay()}))},n.createLevelBackground=function(){this.levelBackground=this.scene.make.image({key:mk,frame:vk.LEVEL_PLAYING}),this.levelBackground.setWorldSize(75,60),this.levelBackground.setVisible(!1),this.add(this.levelBackground)},n.updateSize=function(){var t=this.levelBackground,e=t.width,n=t.height;this.setSize(e,n)},n.createImageCheck=function(){this.tick=this.scene.make.image({key:mk,frame:vk.ICON_CHECK}),this.tick.setWorldSize(30,23),this.tick.setVisible(!1),this.add(this.tick)},n.createText=function(){this.levelNumber=this.scene.make.bitmapText({font:qr.default.PRIMARY.KEY,size:this.scene.fontSize(40),text:""+this.level,origin:{x:.2,y:.5}}),this.levelNumber.setAlpha(.7),this.levelNumber.setTint(7813671),this.add(this.levelNumber)},n.getLevel=function(){return this.level},n.updateInfoLevel=function(){switch(this.disableInteractive(),this.payload.status){case GP.PASSED:this.levelNumber.setAlpha(.7),this.levelBackground.setFrame(vk.LEVEL_PLAYED),this.tick.setVisible(!0);break;case GP.READY:this.levelNumber.setAlpha(.7),this.setInteractive(),this.createTweenClick(),this.levelBackground.setFrame(vk.LEVEL_PLAYING),this.tick.setVisible(!1);break;case GP.WAITING:this.levelNumber.setAlpha(.5),this.levelBackground.setFrame(vk.LEVEL_LOCKED),this.tick.setVisible(!1)}},n.updateInfo=function(t){this.payload=(0,Tt.default)({},t),this.updateInfoLevel(),this.updateText(),this.updateBackground(),this.alignLevelItem()},n.createTweenClick=function(){var t=this,e=this.scale;this.tweenClick=this.scene.tweens.add({targets:[this],duration:100,paused:!0,yoyo:!0,scale:{from:e,to:e-.1},onComplete:function(){t.scene.handlePlay()}})},n.updateBackground=function(){this.levelBackground.setVisible(!0)},n.updateText=function(){this.levelNumber.setText(""+this.payload.level),Phaser.Display.Align.In.Center(this.levelNumber,this.levelBackground,0,0)},n.alignLevelItem=function(){Phaser.Display.Align.In.Center(this.tick,this.levelBackground,25,10),Phaser.Display.Align.In.Center(this.levelNumber,this.levelBackground,0,0)},n.setStatus=function(t){this.payload.status=t},n.setTextLevel=function(t){this.payload.level=t},e}(Phaser.GameObjects.Container),Sk=Ar.default.DEFAULT,Ak=Sk.KEY,xk=Sk.FRAME,Ek=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).scene=void 0,i.background=void 0,i.levelItem1=void 0,i.levelItem2=void 0,i.levelItem3=void 0,i.levelItem4=void 0,i.payload=void 0,i.scene=e,i.init(),n&&(i.updateInfo(n),console.log(i.payload)),i.scene.add.existing((0,gr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.updateSize(),this.createLevelItem()},n.createBackground=function(){this.background=this.scene.make.image({key:Ak,frame:xk.BG_DARK}),this.background.setWorldSize(325,64),this.background.setVisible(!1),this.add(this.background)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.updateInfo=function(t){this.payload=(0,Tt.default)({levelItem2:{level:0,status:""},levelItem3:{level:0,status:""},levelItem4:{level:0,status:""}},t),this.updateLevelItem()},n.createLevelItem=function(){this.levelItem1=new yk(this.scene,{level:1,status:GP.WAITING}),this.add(this.levelItem1),Phaser.Display.Align.In.Center(this.levelItem1,this,-120,0),this.levelItem2=new yk(this.scene,{level:2,status:GP.WAITING}),this.add(this.levelItem2),this.levelItem2.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem2,this,-40,0),this.levelItem3=new yk(this.scene,{level:3,status:GP.WAITING}),this.add(this.levelItem3),this.levelItem3.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem3,this,40,0),this.levelItem4=new yk(this.scene,{level:4,status:GP.WAITING}),this.add(this.levelItem4),this.levelItem4.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem4,this,120,0)},n.updateLevelItem=function(){if(this.levelItem1.setStatus(this.payload.levelItem1.status),this.levelItem1.updateInfoLevel(),this.levelItem1.setTextLevel(this.payload.levelItem1.level),this.levelItem1.updateText(),this.levelItem2){if(""==this.payload.levelItem2.status)return this.levelItem2.setVisible(!1),this.levelItem3&&this.levelItem3.setVisible(!1),void(this.levelItem4&&this.levelItem4.setVisible(!1));this.levelItem2.setStatus(this.payload.levelItem2.status),this.levelItem2.updateInfoLevel(),this.levelItem2.setVisible(!0),this.levelItem2.setTextLevel(this.payload.levelItem2.level),this.levelItem2.updateText()}if(this.levelItem3){if(""==this.payload.levelItem3.status)return this.levelItem3.setVisible(!1),void(this.levelItem4&&this.levelItem4.setVisible(!1));this.levelItem3.setStatus(this.payload.levelItem3.status),this.levelItem3.updateInfoLevel(),this.levelItem3.setVisible(!0),this.levelItem3.setTextLevel(this.payload.levelItem3.level),this.levelItem3.updateText()}if(this.levelItem4){if(""==this.payload.levelItem4.status)return void this.levelItem4.setVisible(!1);this.levelItem4.setStatus(this.payload.levelItem4.status),this.levelItem4.updateInfoLevel(),this.levelItem4.setVisible(!0),this.levelItem4.setTextLevel(this.payload.levelItem4.level),this.levelItem4.updateText()}},e}(Phaser.GameObjects.Container),bk=Ar.default.DEFAULT,wk=bk.KEY,Tk=bk.FRAME,Ck=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.backgroundContent=void 0,n.scroller=void 0,n.scene=e,n.init(),n.createReuseScroller(),n.scene.add.existing((0,gr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackgroundContent()},n.createReuseScroller=function(){this.scroller=new Ap(this.scene,{classType:Ek,listConfigs:[],width:325,height:385,padding:0,marginTop:0,marginBottom:0,maxScrollOver:.3,scrollingBackRate:5,useMask:!1}),this.scroller.setVisible(!1),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(Ar.default.DEFAULT.KEY,Ar.default.DEFAULT.FRAME.BLANK,40,1528359),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.setSizeBackground=function(t){var e=t*this.backgroundContent.displayWidth/this.backgroundContent.displayHeight;this.backgroundContent.setWorldSize(e,t)},n.updateData=function(){for(var t=this.scene.storage.getState(),e=gu(t),n=[],i={levelItem1:{status:"",level:0}},a={levelItem1:{status:"",level:0}},s=1;s<ed.length;s++){var r="";r=s>e?GP.WAITING:s<e?GP.PASSED:GP.READY;var o="";switch(s%4){case 1:o="levelItem1";break;case 2:o="levelItem2";break;case 3:o="levelItem3";break;case 0:o="levelItem4"}i[o]={level:s,status:r},a[o]={level:s,status:r},s%4===0&&(n.push((0,Tt.default)({},i)),a={levelItem1:{status:"",level:0}})}(ed.length-1)%4>0&&n.push((0,Tt.default)({},a)),this.scroller.updateConfig(n);var c=this.scroller.getChildren()[0].height;if(this.scroller.value=-c*this.showDefaultLevel(e),e>ed.length)return this.scene.game.globalScene.screen.open(Er,{message:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u0435\u0439...",duration:3e3});this.showLeaders()},n.showDefaultLevel=function(t){var e=Math.floor((t-1)/4),n=Math.floor((ed.length-1)/4);return n-e<3?n-5:e<3?0:e-2},n.removeLevelItems=function(){this.scroller.updateConfig([])},n.getLevelItems=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this.getLevelItems();if(!(t.length<1)){for(var e=t.length>8?8:t.length,n=0;n<e;n++){var i=t[n];if(!i)return;i.setVisible(!0)}this.scroller.setEnable(!0)}},n.createBackgroundContent=function(){this.backgroundContent=this.scene.make.image({key:wk,frame:Tk.BG_DARK}),this.backgroundContent.setWorldSize(340,399),this.add(this.backgroundContent)},e}(Phaser.GameObjects.Container),Mk=Ck,Ik=GameCore.Configs.Network,Pk=Ar.default.DEFAULT,kk=Pk.KEY,Rk=Pk.FRAME,_k=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).header=void 0,n.mainContent=void 0,n.footer=void 0,n.run=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.checkReceiveLevelFromFb();case 2:n.header.updateTextLives(),n.loadLevelConfig();case 4:case"end":return t.stop()}}),t)}))),n.create=function(){t.prototype.create.call((0,gr.default)(n)),n.createMainContent(),n.createBackground1(),n.createHeader(),n.createFooter(),n.createClaimHeartScreen()},n.createMainContent=function(){n.mainContent=new Mk((0,gr.default)(n)),Phaser.Display.Align.In.Center(n.mainContent,n.gameZone,0,-24)},n.createBackground1=function(){var t=n.make.container({}),e=(n.gameZone.height-385)/2+20,i=n.make.image({key:kk,frame:Rk.BG_TOP});i.setWorldSize(375,e);var a=n.make.image({key:kk,frame:Rk.BG_BOTTOM});a.setWorldSize(375,e);var s=n.make.image({key:kk,frame:Rk.BG_MIDDLE});s.setWorldSize(375,415),t.add([i,s,a]),Phaser.Display.Align.In.Center(s,t,0,0),Phaser.Display.Align.In.Center(i,s,0,-s.displayHeight/2-i.displayHeight/2),Phaser.Display.Align.In.Center(a,s,0,s.displayHeight/2+a.displayHeight/2),Phaser.Display.Align.In.Center(t,n.gameZone,0,-24),n.mainContent.setSizeBackground(i.displayHeight+s.displayHeight+a.displayHeight)},n.clickButtonHome=function(){n.scene.switch(ar.SceneKeys.DASHBOARD_SCENE)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.startGame=function(){this.mainContent.updateData(),this.footer.updateTextButtonPlay(),this.mainContent.scroller.setVisible(!0)},n.createClaimHeartScreen=function(){this.screen.add(zr,Fb)},n.createHeader=function(){this.header=new pk(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone,0,-15)},n.createFooter=function(){this.footer=new ik(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0,-90),this.footer.buttonHome.onClick=this.clickButtonHome.bind(this),this.footer.buttonPlay.onClick=this.handlePlay.bind(this),this.footer.buttonInviteFriends.onClick=this.handleInviteFriends.bind(this)},n.handlePlay=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.storage.getState(),!(_v(e)<1)){t.next=5;break}return this.screen.open(zr),t.abrupt("return");case 5:if(this.storage.dispatch(Yv()),n=gu(e),this.storage.dispatch(Nd()),!(n>ed.length)){t.next=12;break}return this.game.globalScene.screen.open(Er,{message:"\u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u043f\u0440\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f...",duration:3e3}),t.abrupt("return");case 12:this.analytics.levelStart(n,void 0,this.getLevelName(n)),this.storage.dispatch(Jd());case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.storage.getState(),!gu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.storage.dispatch(Fd());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Wt.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.game.globalScene.screen.open(Er,{message:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...",duration:Ik.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.game.globalScene.screen.close(Er)},n.loadLevelConfig=function(){try{var t=this.storage.getState(),e=gu(t),n=ed[e];n||(n=ed[ed.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.load.tilemapTiledJSON(a,s),this.load.start(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Wt.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.handleInviteFriends=function(){this.storage.dispatch(cb())},n.getLevelName=function(t){var e;return"journey_"+Sr()(e=GameCore.Utils.Number).call(e,t,4,"0")},e}(Fp.default),Ok=_k;null==(fk=void 0)||fk.accept(GameCore.LiveUpdate.Scene(ar.SceneKeys.LEVEL_SCENE));var Dk=Ok,Bk=function(t){function e(e,n,i){var a;return(a=t.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var t=a.options.checkInterval;a.checkTimer=t,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(t,e){if(a.checkTimer-=e,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,s=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===s&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=e,a.options=i,a.performance=n,a}(0,Kt.default)(e,t);var n=e.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var t=this.options.autoUpgradeQuality,e=!1;this.isLowFps()?e=this.performance.downgradeGraphicsQuality():t&&this.isHighFps()&&(e=this.performance.upgradeGraphicsQuality()),e&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},e}(Phaser.Events.EventEmitter),Lk=Bk,Fk=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],Nk=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(t){var e;if(u()(e=n.trackingSceneKeys).call(e,t)){var i=n.game.scene.getScene(t);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){var e=t.pixelRatio,n=t.minQuality,i=t.maxQuality,a=t.qualityAdjustStep,s=t.trackingSceneKeys,r=(0,Ht.default)(t,Fk);this.pixelRatio=e,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=a,this.trackingSceneKeys=s,this.fpsTracker=new Lk(this.game,this,r)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var t=this.pixelRatio;if(t<=this.minQuality)return!1;var e=+(t-this.qualityAdjustStep).toFixed(2);return!(e<this.minQuality)&&(this.pixelRatio=e,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\udcab Graphics quality was downgraded! ("+t+" -> "+e+")"),!0)},n.upgradeGraphicsQuality=function(){var t=this.pixelRatio;if(t>=this.maxQuality)return!1;var e=+(t+this.qualityAdjustStep).toFixed(2);return!(e>this.maxQuality)&&(this.pixelRatio=e,this.game.world.resize(this.pixelRatio),console.warn("\ud83d\ude80 Graphics quality was upgraded! ("+t+" -> "+e+")"),!0)},e}(Phaser.Plugins.BasePlugin),Gk=Nk,Uk=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).instance=void 0,i.placementId=void 0,i.instance=null,i.placementId=n,i}(0,Kt.default)(e,t),e.setGame=function(t){self.game=t};var n=e.prototype;return n.loadAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.status===GameCore.Ads.Status.IDLE){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this.status=GameCore.Ads.Status.LOADING,t.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=t.sent,null!==this.instance){t.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return t.next=11,this.instance.loadAsync();case 11:this.status=GameCore.Ads.Status.FILLED,t.next=19;break;case 14:throw t.prev=14,t.t0=t.catch(2),this.status=GameCore.Ads.Status.IDLE,this.instance=null,t.t0;case 19:case"end":return t.stop()}}),t,this,[[2,14]])})));return function(){return t.apply(this,arguments)}}(),n.showAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.status===GameCore.Ads.Status.FILLED){t.next=3;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 3:if(this.status=GameCore.Ads.Status.SHOWING,null!==this.instance){t.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return t.next=8,this.instance.showAsync();case 8:this.status=GameCore.Ads.Status.IDLE,this.instance=null,t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(0),t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code")&&"ADS_NOT_LOADED"===t.t0.code?this.status=GameCore.Ads.Status.FILLED:(this.status=GameCore.Ads.Status.IDLE,this.instance=null),t.t0;case 16:case"end":return t.stop()}}),t,this,[[0,12]])})));return function(){return t.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=self.game.facebook,t.t0=e,t.next=t.t0===GameCore.Ads.Types.REWARDED?4:t.t0===GameCore.Ads.Types.INTERSTITIAL?7:10;break;case 4:return t.next=6,n.getRewardedVideoAsync(this.placementId);case 6:case 9:return t.abrupt("return",t.sent);case 7:return t.next=9,n.getInterstitialAdAsync(this.placementId);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e}(GameCore.Ads.AdInstance),Vk=Uk,Yk='<div id="mockads"> <div style="color:#fff;display:flex;align-content:space-between;justify-content:space-between;flex-direction:column;flex-wrap:nowrap;position:absolute;width:100vw;height:100vh;top:0;left:0;font-family:sans-serif;background:#063b4d;background:linear-gradient(0deg,#063b4d 30%,#0e6171 100%)"> <div style="display:flex;height:6vh;background-color:#0b4d5b;flex-direction:row;justify-content:space-between;align-items:center;align-content:center;font-size:larger" id="ad-header"> <div style="width:80px;display:flex;align-items:center;justify-content:center;margin:0 10px;cursor:pointer" id="close-btn"> Close </div> <div style="width:80px;display:flex;align-items:center;justify-content:center;margin:0 10px;cursor:pointer" id="reward-btn"> Reward </div> </div> <div style="display:flex;flex-direction:column;flex-wrap:nowrap;align-content:center;justify-content:center;height:100%;align-items:center" id="ad-content"> <div style="display:flex;width:200px;height:50px;background-color:#1f7888;align-items:center;justify-content:center;border-radius:100vw;margin:10px;text-transform:uppercase"> <span>AD {AD_TYPE}</span> </div> <div style="background-color:#1f7888;display:flex;align-items:center;justify-content:center;width:80vw;border-radius:16px"> <img src="{AD_CONTENT}" style="position:relative;width:inherit;border-radius:6px"/> </div> </div> <div style="display:flex;height:3vh;flex-direction:row;justify-content:flex-start;align-items:center;background-color:#063f51" id="ad-footer"></div> </div> </div>',zk=GameCore.Configs.Ads.Mockup,Wk=zk.ErrorRate,Hk=zk.GiphyApiKey,Xk=function(t){return function(e){e.preventDefault();var n=document.getElementById("popup-ads");null==n||n.remove(),t()}},Kk=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new(mt())((function(t,n){var i=new Image;i.onload=function(){return t()},i.onerror=function(){return n()},i.src=e})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jk=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var s,r,o,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=Yk.markup||Yk,(r=document.createElement("div")).id="popup-ads",r.innerHTML=s.replace("{AD_TYPE}",e).replace("{AD_CONTENT}",n),document.body.appendChild(r),(o=document.getElementById("close-btn"))&&(e===GameCore.Ads.Types.REWARDED?(o.innerHTML="Skip",o.onclick=Xk((function(){a({code:"USER_INPUT",message:"Skip ads mock error"})}))):o.onclick=Xk(i)),(c=document.getElementById("reward-btn"))&&(e===GameCore.Ads.Types.REWARDED?c.onclick=Xk(i):c.remove());case 9:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),qk=function(){function t(t){this.type=void 0,this.adContent=void 0,this.apiAdContent=void 0,this.loadTimer=void 0,this.showTimer=void 0,this.type=t,this.adContent="",this.apiAdContent="https://api.giphy.com/v1/gifs/random?api_key="+Hk+"&rate=pg"}var e=t.prototype;return e.loadAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Phaser.Math.RND.between(0,100)<=Wk){t.next=13;break}return t.next=4,this.getAdContentAsync();case 4:return this.adContent=t.sent,t.prev=5,t.next=8,Kk(this.adContent);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),console.log("EEEEEEEEEEEEEEE ",t.t0);case 13:return t.abrupt("return",new(mt())((function(t,i){clearTimeout(n.loadTimer),e?i({code:"NETWORK_FAILURE",message:"Load ads mock error"}):t()})));case 14:case"end":return t.stop()}}),t,this,[[5,10]])})));return function(){return t.apply(this,arguments)}}(),e.showAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Phaser.Math.RND.between(0,100)<=Wk,t.abrupt("return",new(mt())((function(t,i){e?i({code:"RATE_LIMITED",message:"Show ads mock error"}):jk(n.type,n.adContent,t,i)})));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getPlacementID=function(){return"123"},e.getAdContentAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.apiAdContent,{method:"GET"});case 2:return e=t.sent,t.next=5,e.json();case 5:if(n=t.sent,GameCore.Utils.Valid.isObject(n)){t.next=8;break}return t.abrupt("return","");case 8:return i=n.data,t.abrupt("return",null==i?void 0:i.images.downsized.url);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(),Zk=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.createInstanceByType=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new qk(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}(Vk),Jk=Zk,Qk=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).Text=void 0,n.Texture=void 0,n.currentLocale=void 0,n.supportedLanguages=void 0,n.data=void 0,n.options=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){this.applyOptions(t)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(t){void 0===t&&(t="en");var e=this.getCorrectLocale(t);this.currentLocale=e,this.Text=this.data[e].Text,this.Texture=this.data[e].Texture},n.getText=function(t){if("object"==typeof t){var e=t.key,n=t.variables,i=void 0===n?[]:n,a=t.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Text[e];return this.replaceVariables(o,i)}return this.Text[t]},n.getTexture=function(t){if("object"==typeof t){var e=t.key,n=t.variables,i=void 0===n?[]:n,a=t.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Texture[e];return this.replaceVariables(o,i)}return this.Texture[t]},n.isSupportLanguage=function(t){var e;return g()(e=this.supportedLanguages).call(e,t)>=0},n.applyOptions=function(t){this.options=(0,Tt.default)({},t);var e=t.data,n=t.locale,i=void 0===n?"en":n,a=t.upperCaseText,s=void 0!==a&&a;this.data=e,this.supportedLanguages=Y()(e);var r=this.getCorrectLocale(i);if(this.currentLocale=r,this.Text=e[r].Text,this.Texture=e[r].Texture,s)for(var o in this.Text)this.Text[o]=this.Text[o].toUpperCase()},n.replaceVariables=function(t,e){var n=e.length;if(0==n)return t;var i=0;return t.replace(/{.*}/,(function(){return String(e[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(t){var e=t;return this.isSupportLanguage(t)||(e="en"),e},e}(Phaser.Plugins.BasePlugin),$k={ru:JSON.parse('{"Text":{"POP JEWELS":"\u0412\u0417\u0420\u042b\u0412\u041d\u042b\u0415 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422\u042b","DAILY_REWARDS":"\u0415\u0416\u0415\u0414\u041d\u0415\u0412\u041d\u042b\u0415 \u041d\u0410\u0413\u0420\u0410\u0414\u042b","CLAIM":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","CLAIM_X2":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c X2","DAY_{X}":"\u0414\u0415\u041d\u042c {X}","PLAY_NOW":"\u0418\u0413\u0420\u0410\u0422\u042c \u0421\u0415\u0419\u0427\u0410\u0421","PLAY_WITH_FRIENDS":"\u0418\u0413\u0420\u0410\u0422\u042c \u0421 \u0414\u0420\u0423\u0417\u042c\u042f\u041c\u0418","RANK":"\u041c\u0415\u0421\u0422\u041e","DAILY":"\u0415\u0416\u0415\u0414\u041d\u0415\u0412\u041d\u041e","GIFT":"\u041f\u041e\u0414\u0410\u0420\u041e\u041a","SETTINGS":"\u041d\u0410\u0421\u0422\u0420\u041e\u0419\u041a\u0418","LEADERBOARDS":"\u0422\u0410\u0411\u041b\u0418\u0426\u0410 \u041b\u0418\u0414\u0415\u0420\u041e\u0412","PLAY":"\u0418\u0413\u0420\u0410\u0422\u042c","WITH_FRIENDS":"\u0421 \u0414\u0420\u0423\u0417\u042c\u042f\u041c\u0418","FRIENDS":"\u0414\u0420\u0423\u0417\u042c\u042f","WORLD":"\u0412\u0415\u0421\u042c \u041c\u0418\u0420","DAILY_MISSION":"\u0415\u0416\u0415\u0414\u041d\u0415\u0412\u041d\u042b\u0415 \u041c\u0418\u0421\u0421\u0418\u0418","PASS_10_LEVELS":"\u041f\u0420\u041e\u0419\u0414\u0418 10 \u0423\u0420\u041e\u0412\u041d\u0415\u0419","COLLECT_300_DIAMONDS":"\u0421\u041e\u0411\u0415\u0420\u0418 300 \u0410\u041b\u041c\u0410\u0417\u041e\u0412","INVITE_2_FRIENDS":"\u041f\u0420\u0418\u0413\u041b\u0410\u0421\u0418 2 \u0414\u0420\u0423\u0417\u0415\u0419","REACH_TOTAL_SCORES":"\u041d\u0410\u0411\u0415\u0420\u0418 \u041e\u0411\u0429\u0415\u0415 \u0427\u0418\u0421\u041b\u041e \u041e\u0427\u041a\u041e\u0412","WATCH_A_VIDEO_TO_GET_{X}_DIAMONDS!":"\u041f\u041e\u0421\u041c\u041e\u0422\u0420\u0418 \u0412\u0418\u0414\u0415\u041e, \u0427\u0422\u041e\u0411\u042b \u041f\u041e\u041b\u0423\u0427\u0418\u0422\u042c\\n{X} \u0410\u041b\u041c\u0410\u0417\u041e\u0412!","GET_NOW":"\u041f\u041e\u041b\u0423\u0427\u0418 \u041f\u0420\u042f\u041c\u041e \u0421\u0415\u0419\u0427\u0410\u0421!","TARGET":"\u0426\u0415\u041b\u042c","MISSION":"\u041c\u0418\u0421\u0421\u0418\u042f","YOUR_SCORE":"\u0422\u0412\u041e\u0419 \u0420\u0415\u0417\u0423\u041b\u042c\u0422\u0410\u0422","LEVEL":"\u0423\u0420\u041e\u0412\u0415\u041d\u042c","REQUESTING":"\u0417\u0410\u041f\u0420\u041e\u0421...","LOADING_INTERSTITIAL_AD":"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410 \u041f\u0420\u041e\u041c\u0415\u0416\u0423\u0422\u041e\u0427\u041d\u041e\u0419 \u0420\u0415\u041a\u041b\u0410\u041c\u042b...","HAMMER":"\u041c\u041e\u041b\u041e\u0422\u041e\u041a","HAMMER_DESCRIPTION":"\u0418\u0421\u041f\u041e\u041b\u042c\u0417\u0423\u0419 \u041c\u041e\u041b\u041e\u0422\u041e\u041a, \u0427\u0422\u041e\u0411\u042b \u0420\u0410\u0417\u0411\u0418\u0422\u042c \u041b\u042e\u0411\u041e\u0419 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422","MAGIC_BOTTLE":"\u0412\u041e\u041b\u0428\u0415\u0411\u041d\u0410\u042f \u0411\u0423\u0422\u042b\u041b\u041a\u0410","MAGIC_BOTTLE_DESCRIPTION":"\u0418\u0421\u041f\u041e\u041b\u042c\u0417\u0423\u0419 \u0412\u041e\u041b\u0428\u0415\u0411\u041d\u0423\u042e \u0411\u0423\u0422\u042b\u041b\u041a\u0423, \u0427\u0422\u041e\u0411\u042b \u0418\u0417\u041c\u0415\u041d\u0418\u0422\u042c \u0426\u0412\u0415\u0422 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422\u0410","LEVEL_FAILED":"\u0423\u0420\u041e\u0412\u0415\u041d\u042c \u041d\u0415 \u041f\u0420\u041e\u0419\u0414\u0415\u041d","FAILED_TEXT":"\u0422\u042b \u041d\u0415 \u041d\u0410\u0411\u0420\u0410\u041b \u041d\u0423\u0416\u041d\u041e\u0415 \u0427\u0418\u0421\u041b\u041e \u041e\u0427\u041a\u041e\u0412","CONTINUE":"\u041f\u0420\u041e\u0414\u041e\u041b\u0416\u0418\u0422\u042c","BEST_SCORE":"\u041b\u0423\u0427\u0428\u0418\u0419 \u0420\u0415\u0417\u0423\u041b\u042c\u0422\u0410\u0422","GLOBAL":"\u0412\u0415\u0421\u042c \u041c\u0418\u0420","JOIN":"\u041f\u0420\u0418\u0421\u041e\u0415\u0414\u0418\u041d\u0418\u0422\u042c\u0421\u042f","REPLAY":"\u0418\u0413\u0420\u0410\u0422\u042c \u0417\u0410\u041d\u041e\u0412\u041e","HOME":"\u0414\u041e\u041c\u041e\u0419","TODAY_RECORD":"\u0421\u0415\u0413\u041e\u0414\u041d\u042f\u0428\u041d\u0418\u0419 \u0420\u0415\u0417\u0423\u041b\u042c\u0422\u0410\u0422","SHARE":"\u041f\u041e\u0414\u0415\u041b\u0418\u0422\u042c\u0421\u042f","WAITING":"\u041e\u0416\u0418\u0414\u0410\u041d\u0418\u0415","WAITING_FOR_OPPONENT":"\u041e\u0416\u0418\u0414\u0410\u041d\u0418\u0415 \u041e\u041f\u041f\u041e\u041d\u0415\u041d\u0422\u0410","RESTART":"\u041d\u0410\u0427\u0410\u0422\u042c \u0417\u0410\u041d\u041e\u0412\u041e","DRAW":"\u0416\u0415\u0420\u0415\u0411\u042c\u0415\u0412\u041a\u0410","YOU_LOSE":"\u0422\u042b \u041f\u0420\u041e\u0418\u0413\u0420\u0410\u0415\u0428\u042c","YOU_WIN":"\u0422\u042b \u0412\u042b\u0418\u0413\u0420\u0410\u0415\u0428\u042c","VS":"\u041f\u0420\u041e\u0422\u0418\u0412","GUIDE_TEXT_GEM":"\u041d\u0410\u0416\u041c\u0418 \u041d\u0410 \u0414\u0412\u0410 \u0418\u041b\u0418 \u0411\u041e\u041b\u042c\u0428\u0415 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422\u0410 \u041e\u0414\u041d\u041e\u0413\u041e \u0426\u0412\u0415\u0422\u0410, \u0427\u0422\u041e\u0411\u042b \u0423\u041d\u0418\u0427\u0422\u041e\u0416\u0418\u0422\u042c \u0418\u0425","GUIDE_TEXT_CURRENT_SCORE":"\u042d\u0422\u041e \u0422\u0412\u041e\u0419 \u0422\u0415\u041a\u0423\u0429\u0418\u0419 \u0420\u0415\u0417\u0423\u041b\u042c\u0422\u0410\u0422","GUIDE_TEXT_TARGET_SCORE":"\u042d\u0422\u041e \u041d\u0415\u041e\u0411\u0425\u041e\u0414\u0418\u041c\u042b\u0419 \u0420\u0415\u0417\u0423\u041b\u042c\u0422\u0410\u0422 \u0414\u041b\u042f \u041a\u0410\u0416\u0414\u041e\u0413\u041e \u0423\u0420\u041e\u0412\u041d\u042f, \u041a\u041e\u0422\u041e\u0420\u042b\u0419 \u0422\u0415\u0411\u0415 \u041d\u0423\u0416\u041d\u041e \u041f\u0420\u041e\u0419\u0422\u0418","GUIDE_TEXT_RAINBOW_GEM":"\u0420\u0410\u0414\u0423\u0416\u041d\u042b\u0419 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422 \u041c\u041e\u0416\u0415\u0422 \u0423\u0411\u0420\u0410\u0422\u042c \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422\u042b, \u041a\u041e\u0422\u041e\u0420\u042b\u0415 \u0415\u0413\u041e \u041e\u041a\u0420\u0423\u0416\u0410\u042e\u0422","GUIDE_TEXT_HAMMER":"\u042d\u0422\u041e \u041c\u041e\u041b\u041e\u0422\u041e\u041a. \u0418\u0421\u041f\u041e\u041b\u042c\u0417\u0423\u0419 \u0415\u0413\u041e, \u0427\u0422\u041e\u0411\u042b \u0420\u0410\u0417\u0411\u0418\u0422\u042c \u041b\u042e\u0411\u041e\u0419 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422!","GUIDE_TEXT_SHUFFLE":"\u042d\u0422\u041e \u041f\u041b\u0418\u0422\u041a\u0410 \u041f\u0415\u0420\u0415\u041c\u0415\u0428\u0418\u0412\u0410\u041d\u0418\u042f. \u0418\u0421\u041f\u041e\u041b\u042c\u0417\u0423\u0419 \u0415\u0415, \u0427\u0422\u041e\u0411\u042b \u041f\u0415\u0420\u0415\u041c\u0415\u0428\u0410\u0422\u042c \u0412\u0421\u0415 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422\u042b","GUIDE_TEXT_MAGIC_BOTTLE":"\u042d\u0422\u041e \u0412\u041e\u041b\u0428\u0415\u0411\u041d\u0410\u042f \u0411\u0423\u0422\u042b\u041b\u041a\u0410. \u0418\u0421\u041f\u041e\u041b\u042c\u0417\u0423\u0419 \u0415\u0415, \u0427\u0422\u041e\u0411\u042b \u0418\u0417\u041c\u0415\u041d\u0418\u0422\u042c \u0426\u0412\u0415\u0422 \u0421\u0410\u041c\u041e\u0426\u0412\u0415\u0422\u0410","NO_ADS_TO_DISPLAY":"\u041d\u0415\u0422 \u0420\u0415\u041a\u041b\u0410\u041c\u042b \u0414\u041b\u042f \u041e\u0422\u041e\u0411\u0420\u0410\u0416\u0415\u041d\u0418\u042f!","NO_REWARDS":"\u0418\u0417\u0412\u0418\u041d\u0418, \u041d\u0410\u0413\u0420\u0410\u0414 \u041d\u0415\u0422!","CANCELLED_AD":"\u0422\u042b \u041e\u0422\u041a\u0410\u0417\u0410\u041b\u0421\u042f \u041e\u0422 \u041f\u0420\u041e\u0421\u041c\u041e\u0422\u0420\u0410 \u0420\u0415\u041a\u041b\u0410\u041c\u042b!","LOADING":"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410...","LOADING_AD":"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410 \u0420\u0415\u041a\u041b\u0410\u041c\u042b...","YOU_HAVE_JUST_RECEIVED_{X}_DIAMONDS":"\u0422\u042b \u0422\u041e\u041b\u042c\u041a\u041e \u0427\u0422\u041e \u041f\u041e\u041b\u0423\u0427\u0418\u041b\\n{X} \u0410\u041b\u041c\u0410\u0417\u041e\u0412","CLOSE":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","LEADERBOARD_EMPTY":"\u043f\u0443\u0441\u0442\u043e\u0439","MESSAGE_INVITE":"{Playername} \u0431\u0440\u043e\u0441\u0430\u0435\u0442 \u0432\u044b\u0437\u043e\u0432 \u0432\u0430\u043c","MESSAGE_FINISH_MATCH":"{Playername} \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u043b. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0438\u0445 \u0441\u0435\u0439\u0447\u0430\u0441.","MESSAGE_BEST_SCORE":"{playername} \u043f\u043e\u0431\u0435\u0434\u0438\u043b \u0432\u0430\u0448 \u0432\u044b\u0441\u043e\u043a\u0438\u0439 \u0431\u0430\u043b\u043b. \u0418\u0445 \u043e\u0446\u0435\u043d\u043a\u0430: {\u0438\u0433\u0440\u043e\u043a\u0438}","MESSAGE_FINISH_TURN":"{Playername} \u043f\u043e\u043b\u0443\u0447\u0438\u043b \u043e\u0446\u0435\u043d\u043a\u0438. \u0422\u0430\u043a \u043f\u0440\u043e\u0441\u0442\u043e! \u0422\u044b \u043c\u043e\u0436\u0435\u0448\u044c?","SHARE_LEADERBOARDS":"\u0425\u0430, \u044f \u043b\u0443\u0447\u0448\u0438\u0439!","SHARE_GAME_RESULTS":"Pheww, \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0439 \u043c\u0430\u0442\u0447!","SHARE_BEST_SCORE":"\u0411\u043e\u043b\u044c\u0448\u043e\u0439! \u0423 \u043c\u0435\u043d\u044f \u0435\u0441\u0442\u044c \u043b\u0443\u0447\u0448\u0438\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442!"},"Texture":{"NO_THANKS":"texts/no-thank","COOL":"texts/cool","CONGRATULATIONS":"texts/congratulation","EXCELLENT":"texts/excellent","GOOD":"texts/good","GREAT":"texts/great","LOGO":"logo","CONTINUE":"texts/continue"}}')},tR=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.configure=function(e){t.prototype.configure.call(this,(0,Tt.default)({data:$k,locale:"en",upperCaseText:!1},e))},e}(Qk),eR=tR,nR=0,iR=0,aR=function(){function t(t){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=t}var e=t.prototype;return e.loadingProgressFbBootScene=function(){var t=this,e=100;iR=30;!function n(){e<=0?clearTimeout(t.progressFbTimeEvent):t.progressFbTimeEvent=setTimeout((function(){t.game.facebook.setLoadingProgress(Math.round(iR)),iR+=30/e,e--,n()}),50)}()},e.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},e.loadingProgressFbLoadScene=function(){var t=this;(!iR||iR<30)&&(iR=60),nR=iR;!function e(){t.progressFbTimeEvent=setTimeout((function(){t.game.facebook.setLoadingProgress(Math.round(iR)),iR+=.1,e()}),50)}()},e.onProgress=function(t){var e=100-iR,n=Math.round(t*e+iR);n>nR&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},t}(),sR=aR,rR=n(252),oR=n.n(rR),cR=n(413),hR=n.n(cR),lR=n(323),uR=n.n(lR),dR=n(319),pR=n.n(dR),fR=n(305),gR=n.n(fR),mR=n(306),vR=n.n(mR),yR=n(308),SR=n.n(yR),AR=n(303),xR=n.n(AR),ER=n(416),bR=n.n(ER),wR=n(421),TR=n.n(wR),CR=n(164),MR=n.n(CR),IR=n(250),PR=n.n(IR);window.SpinePlugin=function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||oR()(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Rh()&&hR()&&oR()(t,hR(),{value:"Module"}),oR()(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),oR()(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=63)}([function(t,e){function n(t,e,n,i){for(var s in e)if(e.hasOwnProperty(s)){var r=(l=e,u=s,f=p=void 0,f=(d=n)?l[u]:uR()(l,u),!d&&f.value&&"object"==typeof f.value&&(f=f.value),!(!f||!((p=f).get&&"function"==typeof p.get||p.set&&"function"==typeof p.set))&&(void 0===f.enumerable&&(f.enumerable=!0),void 0===f.configurable&&(f.configurable=!0),f));if(!1!==r){if(o=(i||t).prototype,c=s,h=void 0,(h=uR()(o,c))&&(h.value&&"object"==typeof h.value&&(h=h.value),!1===h.configurable)){if(a.ignoreFinals)continue;throw new Error("cannot override final property '"+s+"', set Class.ignoreFinals = true to skip")}oR()(t.prototype,s,r)}else t.prototype[s]=e[s]}var o,c,h,l,u,d,p,f}function i(t,e){if(e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)n(t,e[i].prototype||e[i])}}function a(t){var e,a,s;if((t=t||{}).initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");s=t.initialize,delete t.initialize}else s=t.Extends?(a=t.Extends,function(){a.apply(this,arguments)}):function(){};t.Extends?(s.prototype=Object.create(t.Extends.prototype),s.prototype.constructor=s,e=t.Extends,delete t.Extends):s.prototype.constructor=s;var r=null;return t.Mixins&&(r=t.Mixins,delete t.Mixins),i(s,r),n(s,t,!0,e),s}a.extend=n,a.mixin=i,a.ignoreFinals=!1,t.exports=a},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(0),a=n(32),s=new i({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new s(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,e){return a(this.x,t.x,e)&&a(this.y,t.y,e)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,n=t*t+e*e;return 0<n&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},transformMat3:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},transformMat4:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[4]*n+i[12],this.y=i[1]*e+i[5]*n+i[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&t<e&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e*this.x-n*this.y,n*this.x+e*this.y)}});s.ZERO=new s,s.RIGHT=new s(1,0),s.LEFT=new s(-1,0),s.UP=new s(0,-1),s.DOWN=new s(0,1),s.ONE=new s(1,1),t.exports=s},function(t,e){t.exports=function(t,e,n){return Math.max(e,Math.min(n,t))}},function(t,e){var n={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:pR()||-9007199254740991,MAX_SAFE_INTEGER:gR()||9007199254740991};t.exports=n},function(t,e){t.exports=function(t,e,n,i){var a=t.length;if(e<0||a<e||n<=e||a<n||a<e+n){if(i)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}},function(t,e){t.exports=function(t,e,n){var i=n-e;return e+((t-e)%i+i)%i}},function(t,e){t.exports=function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}},function(t,e,n){var i=n(4);t.exports=function(t){return t>Math.PI&&(t-=i.PI2),Math.abs(((t+i.TAU)%i.PI2-i.PI2)%i.PI2)}},function(t,e,n){var i=n(4);t.exports=function(t){return t*i.RAD_TO_DEG}},function(t,e){t.exports=function(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===g()(e).call(e,"."))return n;for(var i=e.split("."),a=t,s=n,r=0;r<i.length;r++){if(!a.hasOwnProperty(i[r])){s=n;break}s=a[i[r]],a=a[i[r]]}return s}return n}},function(t,e){t.exports=function(t,e,n){var i=typeof t;return t&&"number"!=i&&"string"!=i&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:n}},function(t,e){t.exports=function(t,e){if(!(e>=t.length)){for(var n=t.length-1,i=t[e],a=e;a<n;a++)t[a]=t[a+1];return t.length=n,i}}},function(t,e,n){var i=n(0),a=n(26),s=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.type=a.POINT,this.x=t,this.y=e},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});t.exports=s},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new i(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},crossVectors:function(t,e){var n=t.x,i=t.y,a=t.z,s=e.x,r=e.y,o=e.z;return this.x=i*o-a*r,this.y=a*s-n*o,this.z=n*r-i*s,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return Math.sqrt(e*e+n*n+i*i)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return e*e+n*n+i*i},length:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},lengthSq:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},normalize:function(){var t=this.x,e=this.y,n=this.z,i=t*t+e*e+n*n;return 0<i&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i,this.z=n*i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,s=t.y,r=t.z;return this.x=n*r-i*s,this.y=i*a-e*r,this.z=e*s-n*a,this},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=a+e*(t.z-a),this},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=a[0]*e+a[3]*n+a[6]*i,this.y=a[1]*e+a[4]*n+a[7]*i,this.z=a[2]*e+a[5]*n+a[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,s=1/(a[3]*e+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*e+a[4]*n+a[8]*i+a[12])*s,this.y=(a[1]*e+a[5]*n+a[9]*i+a[13])*s,this.z=(a[2]*e+a[6]*n+a[10]*i+a[14])*s,this},transformMat3:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=e*a[0]+n*a[3]+i*a[6],this.y=e*a[1]+n*a[4]+i*a[7],this.z=e*a[2]+n*a[5]+i*a[8],this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12],this.y=a[1]*e+a[5]*n+a[9]*i+a[13],this.z=a[2]*e+a[6]*n+a[10]*i+a[14],this},transformCoordinates:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,s=e*a[0]+n*a[4]+i*a[8]+a[12],r=e*a[1]+n*a[5]+i*a[9]+a[13],o=e*a[2]+n*a[6]+i*a[10]+a[14],c=e*a[3]+n*a[7]+i*a[11]+a[15];return this.x=s/c,this.y=r/c,this.z=o/c,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,s=t.y,r=t.z,o=t.w,c=o*e+s*i-r*n,h=o*n+r*e-a*i,l=o*i+a*n-s*e,u=-a*e-s*n-r*i;return this.x=c*o+u*-a+h*-r-l*-s,this.y=h*o+u*-s+l*-a-c*-r,this.z=l*o+u*-r+c*-s-h*-a,this},project:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,s=a[0],r=a[1],o=a[2],c=a[3],h=a[4],l=a[5],u=a[6],d=a[7],p=a[8],f=a[9],g=a[10],m=a[11],v=a[12],y=a[13],S=a[14],A=1/(e*c+n*d+i*m+a[15]);return this.x=(e*s+n*h+i*p+v)*A,this.y=(e*r+n*l+i*f+y)*A,this.z=(e*o+n*u+i*g+S)*A,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var n=t.x,i=t.y,a=t.z,s=t.w,r=this.x-n,o=s-this.y-1-i,c=this.z;return this.x=2*r/a-1,this.y=2*o/s-1,this.z=2*c-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0,0),i.LEFT=new i(-1,0,0),i.UP=new i(0,-1,0),i.DOWN=new i(0,1,0),i.FORWARD=new i(0,0,1),i.BACK=new i(0,0,-1),i.ONE=new i(1,1,1),t.exports=i},function(t,e){t.exports={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19}},function(t,e,n){var i=n(24),a=n(57);t.exports=function(t,e){var n;if(void 0===e&&(e=90),!i(t))return null;if("string"!=typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)vR()(n=t=a(t)).call(n);else if(-90===e||270===e||"rotateRight"===e)vR()(t).call(t),t=a(t);else if(180===Math.abs(e)||"rotate180"===e){for(var s=0;s<t.length;s++){var r;vR()(r=t[s]).call(r)}vR()(t).call(t)}return t}},function(t,e){t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}},function(t,e){t.exports=function(t,e){return Math.random()*(e-t)+t}},function(t,e,n){var i=n(4);t.exports=function(t){return t*i.DEG_TO_RAD}},function(t,e,n){var i=n(0),a=n(14),s=new i({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new s(this)},set:function(t){return this.copy(t)},setValues:function(t,e,n,i,a,s,r,o,c,h,l,u,d,p,f,g){var m=this.val;return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=a,m[5]=s,m[6]=r,m[7]=o,m[8]=c,m[9]=h,m[10]=l,m[11]=u,m[12]=d,m[13]=p,m[14]=f,m[15]=g,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,n){var i=r.fromQuat(n).val,a=e.x,s=e.y,o=e.z;return this.setValues(i[0]*a,i[1]*a,i[2]*a,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*o,i[9]*o,i[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,n){this.identity();var i=this.val;return i[12]=t,i[13]=e,i[14]=n,this},scaling:function(t,e,n){this.zero();var i=this.val;return i[0]=t,i[5]=e,i[10]=n,i[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[3],a=t[6],s=t[7],r=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=a,t[11]=t[14],t[12]=i,t[13]=s,t[14]=r,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],c=t[7],h=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15],v=e*r-n*s,y=e*o-i*s,S=e*c-a*s,A=n*o-i*r,x=n*c-a*r,E=i*c-a*o,b=h*f-l*p,w=h*g-u*p,T=h*m-d*p,C=l*g-u*f,M=l*m-d*f,I=u*m-d*g,P=v*I-y*M+S*C+A*T-x*w+E*b;return P?(P=1/P,this.setValues((r*I-o*M+c*C)*P,(i*M-n*I-a*C)*P,(f*E-g*x+m*A)*P,(u*x-l*E-d*A)*P,(o*T-s*I-c*w)*P,(e*I-i*T+a*w)*P,(g*S-p*E-m*y)*P,(h*E-u*S+d*y)*P,(s*M-r*T+c*b)*P,(n*T-e*M-a*b)*P,(p*x-f*S+m*v)*P,(l*S-h*x-d*v)*P,(r*w-s*C-o*b)*P,(e*C-n*w+i*b)*P,(f*y-p*A-g*v)*P,(h*A-l*y+u*v)*P)):this},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],c=t[7],h=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15];return this.setValues(r*(u*m-d*g)-l*(o*m-c*g)+f*(o*d-c*u),-(n*(u*m-d*g)-l*(i*m-a*g)+f*(i*d-a*u)),n*(o*m-c*g)-r*(i*m-a*g)+f*(i*c-a*o),-(n*(o*d-c*u)-r*(i*d-a*u)+l*(i*c-a*o)),-(s*(u*m-d*g)-h*(o*m-c*g)+p*(o*d-c*u)),e*(u*m-d*g)-h*(i*m-a*g)+p*(i*d-a*u),-(e*(o*m-c*g)-s*(i*m-a*g)+p*(i*c-a*o)),e*(o*d-c*u)-s*(i*d-a*u)+h*(i*c-a*o),s*(l*m-d*f)-h*(r*m-c*f)+p*(r*d-c*l),-(e*(l*m-d*f)-h*(n*m-a*f)+p*(n*d-a*l)),e*(r*m-c*f)-s*(n*m-a*f)+p*(n*c-a*r),-(e*(r*d-c*l)-s*(n*d-a*l)+h*(n*c-a*r)),-(s*(l*g-u*f)-h*(r*g-o*f)+p*(r*u-o*l)),e*(l*g-u*f)-h*(n*g-i*f)+p*(n*u-i*l),-(e*(r*g-o*f)-s*(n*g-i*f)+p*(n*o-i*r)),e*(r*u-o*l)-s*(n*u-i*l)+h*(n*o-i*r))},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],c=t[7],h=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15];return(e*r-n*s)*(u*m-d*g)-(e*o-i*s)*(l*m-d*f)+(e*c-a*s)*(l*g-u*f)+(n*o-i*r)*(h*m-d*p)-(n*c-a*r)*(h*g-u*p)+(i*c-a*o)*(h*f-l*p)},multiply:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],s=e[3],r=e[4],o=e[5],c=e[6],h=e[7],l=e[8],u=e[9],d=e[10],p=e[11],f=e[12],g=e[13],m=e[14],v=e[15],y=t.val,S=y[0],A=y[1],x=y[2],E=y[3];return e[0]=S*n+A*r+x*l+E*f,e[1]=S*i+A*o+x*u+E*g,e[2]=S*a+A*c+x*d+E*m,e[3]=S*s+A*h+x*p+E*v,S=y[4],A=y[5],x=y[6],E=y[7],e[4]=S*n+A*r+x*l+E*f,e[5]=S*i+A*o+x*u+E*g,e[6]=S*a+A*c+x*d+E*m,e[7]=S*s+A*h+x*p+E*v,S=y[8],A=y[9],x=y[10],E=y[11],e[8]=S*n+A*r+x*l+E*f,e[9]=S*i+A*o+x*u+E*g,e[10]=S*a+A*c+x*d+E*m,e[11]=S*s+A*h+x*p+E*v,S=y[12],A=y[13],x=y[14],E=y[15],e[12]=S*n+A*r+x*l+E*f,e[13]=S*i+A*o+x*u+E*g,e[14]=S*a+A*c+x*d+E*m,e[15]=S*s+A*h+x*p+E*v,this},multiplyLocal:function(t){var e=this.val,n=t.val;return this.setValues(e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12],e[0]*n[1]+e[1]*n[5]+e[2]*n[9]+e[3]*n[13],e[0]*n[2]+e[1]*n[6]+e[2]*n[10]+e[3]*n[14],e[0]*n[3]+e[1]*n[7]+e[2]*n[11]+e[3]*n[15],e[4]*n[0]+e[5]*n[4]+e[6]*n[8]+e[7]*n[12],e[4]*n[1]+e[5]*n[5]+e[6]*n[9]+e[7]*n[13],e[4]*n[2]+e[5]*n[6]+e[6]*n[10]+e[7]*n[14],e[4]*n[3]+e[5]*n[7]+e[6]*n[11]+e[7]*n[15],e[8]*n[0]+e[9]*n[4]+e[10]*n[8]+e[11]*n[12],e[8]*n[1]+e[9]*n[5]+e[10]*n[9]+e[11]*n[13],e[8]*n[2]+e[9]*n[6]+e[10]*n[10]+e[11]*n[14],e[8]*n[3]+e[9]*n[7]+e[10]*n[11]+e[11]*n[15],e[12]*n[0]+e[13]*n[4]+e[14]*n[8]+e[15]*n[12],e[12]*n[1]+e[13]*n[5]+e[14]*n[9]+e[15]*n[13],e[12]*n[2]+e[13]*n[6]+e[14]*n[10]+e[15]*n[14],e[12]*n[3]+e[13]*n[7]+e[14]*n[11]+e[15]*n[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.val,i=e.val,a=n[0],s=n[4],r=n[8],o=n[12],c=n[1],h=n[5],l=n[9],u=n[13],d=n[2],p=n[6],f=n[10],g=n[14],m=n[3],v=n[7],y=n[11],S=n[15],A=i[0],x=i[4],E=i[8],b=i[12],w=i[1],T=i[5],C=i[9],M=i[13],I=i[2],P=i[6],k=i[10],R=i[14],_=i[3],O=i[7],D=i[11],B=i[15];return this.setValues(a*A+s*w+r*I+o*_,c*A+h*w+l*I+u*_,d*A+p*w+f*I+g*_,m*A+v*w+y*I+S*_,a*x+s*T+r*P+o*O,c*x+h*T+l*P+u*O,d*x+p*T+f*P+g*O,m*x+v*T+y*P+S*O,a*E+s*C+r*k+o*D,c*E+h*C+l*k+u*D,d*E+p*C+f*k+g*D,m*E+v*C+y*k+S*D,a*b+s*M+r*R+o*B,c*b+h*M+l*R+u*B,d*b+p*M+f*R+g*B,m*b+v*M+y*R+S*B)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,n){var i=this.val;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,n){var i=this.val;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),a=1-n,s=t.x,r=t.y,o=t.z,c=a*s,h=a*r;return this.setValues(c*s+n,c*r-i*o,c*o+i*r,0,c*r+i*o,h*r+n,h*o-i*s,0,c*o-i*r,h*o+i*s,a*o*o+n,0,0,0,0,1)},rotate:function(t,e){var n=this.val,i=e.x,a=e.y,s=e.z,r=Math.sqrt(i*i+a*a+s*s);if(Math.abs(r)<1e-6)return this;i*=r=1/r,a*=r,s*=r;var o=Math.sin(t),c=Math.cos(t),h=1-c,l=n[0],u=n[1],d=n[2],p=n[3],f=n[4],g=n[5],m=n[6],v=n[7],y=n[8],S=n[9],A=n[10],x=n[11],E=n[12],b=n[13],w=n[14],T=n[15],C=i*i*h+c,M=a*i*h+s*o,I=s*i*h-a*o,P=i*a*h-s*o,k=a*a*h+c,R=s*a*h+i*o,_=i*s*h+a*o,O=a*s*h-i*o,D=s*s*h+c;return this.setValues(l*C+f*M+y*I,u*C+g*M+S*I,d*C+m*M+A*I,p*C+v*M+x*I,l*P+f*k+y*R,u*P+g*k+S*R,d*P+m*k+A*R,p*P+v*k+x*R,l*_+f*O+y*D,u*_+g*O+S*D,d*_+m*O+A*D,p*_+v*O+x*D,E,b,w,T)},rotateX:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],r=e[6],o=e[7],c=e[8],h=e[9],l=e[10],u=e[11];return e[4]=a*i+c*n,e[5]=s*i+h*n,e[6]=r*i+l*n,e[7]=o*i+u*n,e[8]=c*i-a*n,e[9]=h*i-s*n,e[10]=l*i-r*n,e[11]=u*i-o*n,this},rotateY:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],r=e[2],o=e[3],c=e[8],h=e[9],l=e[10],u=e[11];return e[0]=a*i-c*n,e[1]=s*i-h*n,e[2]=r*i-l*n,e[3]=o*i-u*n,e[8]=a*n+c*i,e[9]=s*n+h*i,e[10]=r*n+l*i,e[11]=o*n+u*i,this},rotateZ:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],r=e[2],o=e[3],c=e[4],h=e[5],l=e[6],u=e[7];return e[0]=a*i+c*n,e[1]=s*i+h*n,e[2]=r*i+l*n,e[3]=o*i+u*n,e[4]=c*i-a*n,e[5]=h*i-s*n,e[6]=l*i-r*n,e[7]=u*i-o*n,this},fromRotationTranslation:function(t,e){var n=t.x,i=t.y,a=t.z,s=t.w,r=n+n,o=i+i,c=a+a,h=n*r,l=n*o,u=n*c,d=i*o,p=i*c,f=a*c,g=s*r,m=s*o,v=s*c;return this.setValues(1-(d+f),l+v,u-m,0,l-v,1-(h+f),p+g,0,u+m,p-g,1-(h+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,a=t.w,s=e+e,r=n+n,o=i+i,c=e*s,h=e*r,l=e*o,u=n*r,d=n*o,p=i*o,f=a*s,g=a*r,m=a*o;return this.setValues(1-(u+p),h+m,l-g,0,h-m,1-(c+p),d+f,0,l+g,d-f,1-(c+u),0,0,0,0,1)},frustum:function(t,e,n,i,a,s){var r=1/(e-t),o=1/(i-n),c=1/(a-s);return this.setValues(2*a*r,0,0,0,0,2*a*o,0,0,(e+t)*r,(i+n)*o,(s+a)*c,-1,0,0,s*a*2*c,0)},perspective:function(t,e,n,i){var a=1/Math.tan(t/2),s=1/(n-i);return this.setValues(a/e,0,0,0,0,a,0,0,0,0,(i+n)*s,-1,0,0,2*i*n*s,0)},perspectiveLH:function(t,e,n,i){return this.setValues(2*n/t,0,0,0,0,2*n/e,0,0,0,0,-i/(n-i),1,0,0,n*i/(n-i),0)},ortho:function(t,e,n,i,a,s){var r=0===(r=t-e)?r:1/r,o=0===(o=n-i)?o:1/o,c=0===(c=a-s)?c:1/c;return this.setValues(-2*r,0,0,0,0,-2*o,0,0,0,0,2*c,0,(t+e)*r,(i+n)*o,(s+a)*c,1)},lookAtRH:function(t,e,n){var i=this.val;return l.subVectors(t,e),0===l.getLengthSquared()&&(l.z=1),l.normalize(),c.crossVectors(n,l),0===c.getLengthSquared()&&(1===Math.abs(n.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),c.crossVectors(n,l)),c.normalize(),h.crossVectors(l,c),i[0]=c.x,i[1]=c.y,i[2]=c.z,i[4]=h.x,i[5]=h.y,i[6]=h.z,i[8]=l.x,i[9]=l.y,i[10]=l.z,this},lookAt:function(t,e,n){var i=t.x,a=t.y,s=t.z,r=n.x,o=n.y,c=n.z,h=e.x,l=e.y,u=e.z;if(Math.abs(i-h)<1e-6&&Math.abs(a-l)<1e-6&&Math.abs(s-u)<1e-6)return this.identity();var d=i-h,p=a-l,f=s-u,g=1/Math.sqrt(d*d+p*p+f*f),m=o*(f*=g)-c*(p*=g),v=c*(d*=g)-r*f,y=r*p-o*d;(g=Math.sqrt(m*m+v*v+y*y))?(m*=g=1/g,v*=g,y*=g):y=v=m=0;var S=p*y-f*v,A=f*m-d*y,x=d*v-p*m;return(g=Math.sqrt(S*S+A*A+x*x))?(S*=g=1/g,A*=g,x*=g):x=A=S=0,this.setValues(m,S,d,0,v,A,p,0,y,x,f,0,-(m*i+v*a+y*s),-(S*i+A*a+x*s),-(d*i+p*a+f*s),1)},yawPitchRoll:function(t,e,n){this.zero(),r.zero(),o.zero();var i=this.val,a=r.val,s=o.val,c=Math.sin(n),h=Math.cos(n);return i[10]=1,i[15]=1,i[0]=h,i[1]=c,i[4]=-c,i[5]=h,c=Math.sin(e),h=Math.cos(e),a[0]=1,a[15]=1,a[5]=h,a[10]=h,a[9]=-c,a[6]=c,c=Math.sin(t),h=Math.cos(t),s[5]=1,s[15]=1,s[0]=h,s[2]=-c,s[8]=c,s[10]=h,this.multiplyLocal(r),this.multiplyLocal(o),this},setWorldMatrix:function(t,e,n,i,a){return this.yawPitchRoll(t.y,t.x,t.z),r.scaling(n.x,n.y,n.z),o.xyz(e.x,e.y,e.z),this.multiplyLocal(r),this.multiplyLocal(o),i&&this.multiplyLocal(i),a&&this.multiplyLocal(a),this},multiplyToMat4:function(t,e){var n=this.val,i=t.val,a=n[0],s=n[1],r=n[2],o=n[3],c=n[4],h=n[5],l=n[6],u=n[7],d=n[8],p=n[9],f=n[10],g=n[11],m=n[12],v=n[13],y=n[14],S=n[15],A=i[0],x=i[1],E=i[2],b=i[3],w=i[4],T=i[5],C=i[6],M=i[7],I=i[8],P=i[9],k=i[10],R=i[11],_=i[12],O=i[13],D=i[14],B=i[15];return e.setValues(A*a+x*c+E*d+b*m,x*s+x*h+E*p+b*v,E*r+x*l+E*f+b*y,b*o+x*u+E*g+b*S,w*a+T*c+C*d+M*m,w*s+T*h+C*p+M*v,w*r+T*l+C*f+M*y,w*o+T*u+C*g+M*S,I*a+P*c+k*d+R*m,I*s+P*h+k*p+R*v,I*r+P*l+k*f+R*y,I*o+P*u+k*g+R*S,_*a+O*c+D*d+B*m,_*s+O*h+D*p+B*v,_*r+O*l+D*f+B*y,_*o+O*u+D*g+B*S)},fromRotationXYTranslation:function(t,e,n){var i=e.x,a=e.y,s=e.z,r=Math.sin(t.x),o=Math.cos(t.x),c=Math.sin(t.y),h=Math.cos(t.y),l=i,u=a,d=s,p=-r,f=0-p*c,g=0-o*c,m=p*h,v=o*h;return n||(l=h*i+c*s,u=f*i+o*a+m*s,d=g*i+r*a+v*s),this.setValues(h,f,g,0,0,o,r,0,c,m,v,0,l,u,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}}),r=new s,o=new s,c=new a,h=new a,l=new a;t.exports=s},function(t,e,n){var i=n(0),a=n(15),s=n(205),r=n(11),o=n(216),c=n(45),h=n(217),l=n(46),u=new i({initialize:function(t,e){this.loader=t,this.cache=r(e,"cache",!1),this.type=r(e,"type",!1),this.key=r(e,"key",!1);var n=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+n),!this.type||!this.key)throw new Error("Invalid Loader."+this.type+" key");var i=r(e,"url");void 0===i?i=t.path+n+"."+r(e,"extension",""):"string"!=typeof i||i.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)||(i=t.path+i),this.url=i,this.src="",this.xhrSettings=l(r(e,"responseType",void 0)),r(e,"xhrSettings",!1)&&(this.xhrSettings=c(this.xhrSettings,r(e,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?a.FILE_POPULATED:a.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=r(e,"config",{}),this.multiFile,this.linkFile},setLink:function(t){(this.linkFile=t).linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){var t;this.state===a.FILE_POPULATED?this.loader.nextFile(this,!0):(this.state=a.FILE_LOADING,this.src=o(this,this.loader.baseURL),0===g()(t=this.src).call(t,"data:")?console.warn("Local data URIs are not supported: "+this.key):this.xhrLoader=h(this,this.loader.xhr))},onLoad:function(t,e){var n,i=t.responseURL&&0===g()(n=t.responseURL).call(n,"file://")&&0===e.target.status,s=!(e.target&&200!==e.target.status)||i;4===t.readyState&&400<=t.status&&t.status<=599&&(s=!1),this.state=a.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,s)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=a.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=a.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=a.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.cache.add(this.key,this.data),this.pendingDestroy()},pendingDestroy:function(t){void 0===t&&(t=this.data);var e=this.key,n=this.type;this.loader.emit(s.FILE_COMPLETE,e,n,t),this.loader.emit(s.FILE_KEY_COMPLETE+n+"-"+e,e,n,t),this.loader.flagForRemoval(this)},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});u.createObjectURL=function(t,e,n){var i;"function"==typeof SR()?t.src=SR().createObjectURL(e):((i=new FileReader).onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=t.onerror,i.readAsDataURL(e))},u.revokeObjectURL=function(t){"function"==typeof SR()&&SR().revokeObjectURL(t.src)},t.exports=u},function(t,e){var n={},i={install:function(t){for(var e in n)t[e]=n[e]},register:function(t,e){n[t]=e},destroy:function(){n={}}};t.exports=i},function(t,e,n){var i=n(0),a=n(4),s=n(2),r=new i({initialize:function(t,e,n,i,a,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===a&&(a=0),void 0===s&&(s=0),this.matrix=new Float32Array([t,e,n,i,a,s,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],s=t[3];return e||n?0<n?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):i||s?a.TAU-(0<s?Math.acos(-i/this.scaleY):-Math.acos(i/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var n=this.matrix;return n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this},scale:function(t,e){var n=this.matrix;return n[0]*=t,n[1]*=t,n[2]*=e,n[3]*=e,this},rotate:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.matrix,a=i[0],s=i[1],r=i[2],o=i[3];return i[0]=a*n+r*e,i[1]=s*n+o*e,i[2]=a*-e+r*n,i[3]=s*-e+o*n,this},multiply:function(t,e){var n=this.matrix,i=t.matrix,a=n[0],s=n[1],r=n[2],o=n[3],c=n[4],h=n[5],l=i[0],u=i[1],d=i[2],p=i[3],f=i[4],g=i[5],m=void 0===e?this:e;return m.a=l*a+u*r,m.b=l*s+u*o,m.c=d*a+p*r,m.d=d*s+p*o,m.e=f*a+g*r+c,m.f=f*s+g*o+h,m},multiplyWithOffset:function(t,e,n){var i=this.matrix,a=t.matrix,s=i[0],r=i[1],o=i[2],c=i[3],h=e*s+n*o+i[4],l=e*r+n*c+i[5],u=a[0],d=a[1],p=a[2],f=a[3],g=a[4],m=a[5];return i[0]=u*s+d*o,i[1]=u*r+d*c,i[2]=p*s+f*o,i[3]=p*r+f*c,i[4]=g*s+m*o+h,i[5]=g*r+m*c+l,this},transform:function(t,e,n,i,a,s){var r=this.matrix,o=r[0],c=r[1],h=r[2],l=r[3],u=r[4],d=r[5];return r[0]=t*o+e*h,r[1]=t*c+e*l,r[2]=n*o+i*h,r[3]=n*c+i*l,r[4]=a*o+s*h+u,r[5]=a*c+s*l+d,this},transformPoint:function(t,e,n){void 0===n&&(n={x:0,y:0});var i=this.matrix,a=i[0],s=i[1],r=i[2],o=i[3],c=i[4],h=i[5];return n.x=t*a+e*r+c,n.y=t*s+e*o+h,n},invert:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=e*a-n*i;return t[0]=a/o,t[1]=-n/o,t[2]=-i/o,t[3]=e/o,t[4]=(i*r-a*s)/o,t[5]=-(e*r-n*s)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){var e=this.matrix;return t.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,n,i,a,s){var r=this.matrix;return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r[4]=a,r[5]=s,this},decomposeMatrix:function(){var t,e,n=this.decomposedMatrix,i=this.matrix,a=i[0],s=i[1],r=i[2],o=i[3],c=a*o-s*r;return n.translateX=i[4],n.translateY=i[5],a||s?(t=Math.sqrt(a*a+s*s),n.rotation=0<s?Math.acos(a/t):-Math.acos(a/t),n.scaleX=t,n.scaleY=c/t):r||o?(e=Math.sqrt(r*r+o*o),n.rotation=.5*Math.PI-(0<o?Math.acos(-r/e):-Math.acos(r/e)),n.scaleX=c/e,n.scaleY=e):(n.rotation=0,n.scaleX=0,n.scaleY=0),n},applyITRS:function(t,e,n,i,a){var s=this.matrix,r=Math.sin(n),o=Math.cos(n);return s[4]=t,s[5]=e,s[0]=o*i,s[1]=r*i,s[2]=-r*a,s[3]=o*a,this},applyInverse:function(t,e,n){void 0===n&&(n=new s);var i=this.matrix,a=i[0],r=i[1],o=i[2],c=i[3],h=i[4],l=i[5],u=1/(a*c+o*-r);return n.x=c*u*t+-o*u*e+(l*o-h*c)*u,n.y=a*u*e+-r*u*t+(-l*a+h*r)*u,n},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,n){var i=this.getX(t,e);return n&&(i=Math.round(i)),i},getYRound:function(t,e,n){var i=this.getY(t,e);return n&&(i=Math.round(i)),i},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.decomposedMatrix=null}});t.exports=r},function(t,e){t.exports=function(t){if(!Array.isArray(t)||t.length<2||!Array.isArray(t[0]))return!1;for(var e=t[0].length,n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0}},function(t,e,n){var i=n(0),a=n(299),s=n(61),r=n(300),o=n(26),c=n(301),h=n(306),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=o.RECTANGLE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return a(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return r(this,t,e,n)},getRandomPoint:function(t){return h(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new c),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new c),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new c),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new c),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=l},function(t,e){t.exports={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}},function(t,e,n){var i=n(7);t.exports=function t(){var e,n,a,s,r,o,c=arguments[0]||{},h=1,l=arguments.length,u=!1;for("boolean"==typeof c&&(u=c,c=arguments[1]||{},h=2),l===h&&(c=this,--h);h<l;h++)if(null!=(e=arguments[h]))for(n in e)a=c[n],c!==(s=e[n])&&(u&&s&&(i(s)||(r=Array.isArray(s)))?(o=r?(r=!1,a&&Array.isArray(a)?a:[]):a&&i(a)?a:{},c[n]=t(u,o,s)):void 0!==s&&(c[n]=s));return c}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(i-e,n-t)}},function(t,e){t.exports=function(t){return 0<=(t%=2*Math.PI)?t:t+2*Math.PI}},function(t,e,n){var i=n(6);t.exports=function(t){return i(t,-Math.PI,Math.PI)}},function(t,e,n){var i=n(6);t.exports=function(t){return i(t,-180,180)}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}},function(t,e,n){var i=n(34);t.exports=function(t,e){return i(t)/i(e)/i(t-e)}},function(t,e){t.exports=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}},function(t,e){t.exports=function(t,e,n,i,a){var s=.5*(i-e),r=.5*(a-n),o=t*t;return(2*n-2*i+s+r)*(t*o)+(-3*n+3*i-2*s-r)*o+s*t+n}},function(t,e){t.exports=function(t,e,n){return(e-t)*n+t}},function(t,e){t.exports=function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)}},function(t,e){t.exports=function(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}},function(t,e){t.exports=function(t,e,n,i){var a=Math.cos(i),s=Math.sin(i),r=t.x-e,o=t.y-n;return t.x=r*a-o*s+e,t.y=r*s+o*a+n,t}},function(t,e){t.exports=function(t){return 0<t?Math.ceil(t):Math.floor(t)}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,a,s,r,o,c){void 0===c&&(c=new i);var h=Math.sin(s),l=Math.cos(s),u=l*r,d=h*r,p=-h*o,f=l*o,g=1/(u*f+p*-d);return c.x=f*g*t+-p*g*e+(a*p-n*f)*g,c.y=u*g*e+-d*g*t+(-a*u+n*d)*g,c}},function(t,e,n){var i=new(n(0))({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},fromMat4:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],c=t[7],h=t[8],l=h*s-r*c,u=-h*a+r*o,d=c*a-s*o,p=e*l+n*u+i*d;return p?(p=1/p,t[0]=l*p,t[1]=(-h*n+i*c)*p,t[2]=(r*n-i*s)*p,t[3]=u*p,t[4]=(h*e-i*o)*p,t[5]=(-r*e+i*a)*p,t[6]=d*p,t[7]=(-c*e+n*o)*p,t[8]=(s*e-n*a)*p,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],c=t[7],h=t[8];return t[0]=s*h-r*c,t[1]=i*c-n*h,t[2]=n*r-i*s,t[3]=r*o-a*h,t[4]=e*h-i*o,t[5]=i*a-e*r,t[6]=a*c-s*o,t[7]=n*o-e*c,t[8]=e*s-n*a,this},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],c=t[7],h=t[8];return e*(h*s-r*c)+n*(-h*a+r*o)+i*(c*a-s*o)},multiply:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],s=e[3],r=e[4],o=e[5],c=e[6],h=e[7],l=e[8],u=t.val,d=u[0],p=u[1],f=u[2],g=u[3],m=u[4],v=u[5],y=u[6],S=u[7],A=u[8];return e[0]=d*n+p*s+f*c,e[1]=d*i+p*r+f*h,e[2]=d*a+p*o+f*l,e[3]=g*n+m*s+v*c,e[4]=g*i+m*r+v*h,e[5]=g*a+m*o+v*l,e[6]=y*n+S*s+A*c,e[7]=y*i+S*r+A*h,e[8]=y*a+S*o+A*l,this},translate:function(t){var e=this.val,n=t.x,i=t.y;return e[6]=n*e[0]+i*e[3]+e[6],e[7]=n*e[1]+i*e[4]+e[7],e[8]=n*e[2]+i*e[5]+e[8],this},rotate:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],s=e[3],r=e[4],o=e[5],c=Math.sin(t),h=Math.cos(t);return e[0]=h*n+c*s,e[1]=h*i+c*r,e[2]=h*a+c*o,e[3]=h*s-c*n,e[4]=h*r-c*i,e[5]=h*o-c*a,this},scale:function(t){var e=this.val,n=t.x,i=t.y;return e[0]=n*e[0],e[1]=n*e[1],e[2]=n*e[2],e[3]=i*e[3],e[4]=i*e[4],e[5]=i*e[5],this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,a=t.w,s=e+e,r=n+n,o=i+i,c=e*s,h=e*r,l=e*o,u=n*r,d=n*o,p=i*o,f=a*s,g=a*r,m=a*o,v=this.val;return v[0]=1-(u+p),v[3]=h+m,v[6]=l-g,v[1]=h-m,v[4]=1-(c+p),v[7]=d+f,v[2]=l+g,v[5]=d-f,v[8]=1-(c+u),this},normalFromMat4:function(t){var e=t.val,n=this.val,i=e[0],a=e[1],s=e[2],r=e[3],o=e[4],c=e[5],h=e[6],l=e[7],u=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],v=e[14],y=e[15],S=i*c-a*o,A=i*h-s*o,x=i*l-r*o,E=a*h-s*c,b=a*l-r*c,w=s*l-r*h,T=u*m-d*g,C=u*v-p*g,M=u*y-f*g,I=d*v-p*m,P=d*y-f*m,k=p*y-f*v,R=S*k-A*P+x*I+E*M-b*C+w*T;return R?(R=1/R,n[0]=(c*k-h*P+l*I)*R,n[1]=(h*M-o*k-l*C)*R,n[2]=(o*P-c*M+l*T)*R,n[3]=(s*P-a*k-r*I)*R,n[4]=(i*k-s*M+r*C)*R,n[5]=(a*M-i*P-r*T)*R,n[6]=(m*w-v*b+y*E)*R,n[7]=(v*x-g*w-y*A)*R,n[8]=(g*b-m*x+y*S)*R,this):null}});t.exports=i},function(t,e,n){var i=n(0),a=n(42),s=n(1),r=n(14),o=new Int8Array([1,2,0]),c=new Float32Array([0,0,0]),h=new r(1,0,0),l=new r(0,1,0),u=new r,d=new a,p=new i({initialize:function(t,e,n,i){this.onChangeCallback=s,this.set(t,e,n,i)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,n,i,a){return void 0===a&&(a=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=n||0,this._w=i||0),a&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i;return 0<a&&(a=1/Math.sqrt(a),this._x=t*a,this._y=e*a,this._z=n*a,this._w=i*a),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z,s=this.w;return this.set(n+e*(t.x-n),i+e*(t.y-i),a+e*(t.z-a),s+e*(t.w-s))},rotationTo:function(t,e){var n=t.x*e.x+t.y*e.y+t.z*e.z;return n<-.999999?(u.copy(h).cross(t).length()<1e-6&&u.copy(l).cross(t),u.normalize(),this.setAxisAngle(u,Math.PI)):.999999<n?this.set(0,0,0,1):(u.copy(t).cross(e),this._x=u.x,this._y=u.y,this._z=u.z,this._w=1+n,this.normalize())},setAxes:function(t,e,n){var i=d.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=n.x,i[4]=n.y,i[7]=n.z,i[2]=-t.x,i[5]=-t.y,i[8]=-t.z,this.fromMat3(d).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var n=Math.sin(e);return this.set(n*t.x,n*t.y,n*t.z,Math.cos(e))},multiply:function(t){var e=this.x,n=this.y,i=this.z,a=this.w,s=t.x,r=t.y,o=t.z,c=t.w;return this.set(e*c+a*s+n*o-i*r,n*c+a*r+i*s-e*o,i*c+a*o+e*r-n*s,a*c-e*s-n*r-i*o)},slerp:function(t,e){var n=this.x,i=this.y,a=this.z,s=this.w,r=t.x,o=t.y,c=t.z,h=t.w,l=n*r+i*o+a*c+s*h;l<0&&(l=-l,r=-r,o=-o,c=-c,h=-h);var u,d,p=1-e,f=e;return 1e-6<1-l&&(u=Math.acos(l),d=Math.sin(u),p=Math.sin((1-e)*u)/d,f=Math.sin(e*u)/d),this.set(p*n+f*r,p*i+f*o,p*a+f*c,p*s+f*h)},invert:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i,s=a?1/a:0;return this.set(-t*s,-e*s,-n*s,i*s)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,s=Math.sin(t),r=Math.cos(t);return this.set(e*r+a*s,n*r+i*s,i*r-n*s,a*r-e*s)},rotateY:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,s=Math.sin(t),r=Math.cos(t);return this.set(e*r-i*s,n*r+a*s,i*r+e*s,a*r-n*s)},rotateZ:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,s=Math.sin(t),r=Math.cos(t);return this.set(e*r+n*s,n*r-e*s,i*r+a*s,a*r-i*s)},calculateW:function(){var t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(1-t*t-e*e-n*n),this},setFromEuler:function(t,e){var n=t.x/2,i=t.y/2,a=t.z/2,s=Math.cos(n),r=Math.cos(i),o=Math.cos(a),c=Math.sin(n),h=Math.sin(i),l=Math.sin(a);switch(t.order){case"XYZ":this.set(c*r*o+s*h*l,s*h*o-c*r*l,s*r*l+c*h*o,s*r*o-c*h*l,e);break;case"YXZ":this.set(c*r*o+s*h*l,s*h*o-c*r*l,s*r*l-c*h*o,s*r*o+c*h*l,e);break;case"ZXY":this.set(c*r*o-s*h*l,s*h*o+c*r*l,s*r*l+c*h*o,s*r*o-c*h*l,e);break;case"ZYX":this.set(c*r*o-s*h*l,s*h*o+c*r*l,s*r*l-c*h*o,s*r*o+c*h*l,e);break;case"YZX":this.set(c*r*o+s*h*l,s*h*o+c*r*l,s*r*l-c*h*o,s*r*o-c*h*l,e);break;case"XZY":this.set(c*r*o-s*h*l,s*h*o-c*r*l,s*r*l+c*h*o,s*r*o+c*h*l,e)}return this},setFromRotationMatrix:function(t){var e,n=t.val,i=n[0],a=n[4],s=n[8],r=n[1],o=n[5],c=n[9],h=n[2],l=n[6],u=n[10],d=i+o+u;return 0<d?(e=.5/Math.sqrt(d+1),this.set((l-c)*e,(s-h)*e,(r-a)*e,.25/e)):o<i&&u<i?(e=2*Math.sqrt(1+i-o-u),this.set(.25*e,(a+r)/e,(s+h)/e,(l-c)/e)):u<o?(e=2*Math.sqrt(1+o-i-u),this.set((a+r)/e,.25*e,(c+l)/e,(s-h)/e)):(e=2*Math.sqrt(1+u-i-o),this.set((s+h)/e,(c+l)/e,.25*e,(r-a)/e)),this},fromMat3:function(t){var e,n,i,a,s=t.val,r=s[0]+s[4]+s[8];return 0<r?(a=Math.sqrt(r+1),this.w=.5*a,a=.5/a,this._x=(s[7]-s[5])*a,this._y=(s[2]-s[6])*a,this._z=(s[3]-s[1])*a):(e=0,s[4]>s[0]&&(e=1),s[8]>s[3*e+e]&&(e=2),n=o[e],i=o[n],a=Math.sqrt(s[3*e+e]-s[3*n+n]-s[3*i+i]+1),c[e]=.5*a,a=.5/a,c[n]=(s[3*n+e]+s[3*e+n])*a,c[i]=(s[3*i+e]+s[3*e+i])*a,this._x=c[0],this._y=c[1],this._z=c[2],this._w=(s[3*i+n]-s[3*n+i])*a),this.onChangeCallback(this),this}});t.exports=p},function(t,e,n){t.exports={ADDED_TO_SCENE:n(180),BOOT:n(181),CREATE:n(182),DESTROY:n(183),PAUSE:n(184),POST_UPDATE:n(185),PRE_RENDER:n(186),PRE_UPDATE:n(187),READY:n(188),REMOVED_FROM_SCENE:n(189),RENDER:n(190),RESUME:n(191),SHUTDOWN:n(192),SLEEP:n(193),START:n(194),TRANSITION_COMPLETE:n(195),TRANSITION_INIT:n(196),TRANSITION_OUT:n(197),TRANSITION_START:n(198),TRANSITION_WAKE:n(199),UPDATE:n(200),WAKE:n(201)}},function(t,e,n){var i=n(27),a=n(46);t.exports=function(t,e){var n=void 0===t?a():i({},t);if(e)for(var s in e)void 0!==e[s]&&(n[s]=e[s]);return n}},function(t,e){t.exports=function(t,e,n,i,a,s){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=""),void 0===i&&(i=""),void 0===a&&(a=0),void 0===s&&(s=!1),{responseType:t,async:e,user:n,password:i,timeout:a,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:s}}},function(t,e){t.exports={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}},function(t,e){t.exports={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this}}},function(t,e){t.exports={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}},function(t,e){t.exports={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}},function(t,e,n){var i=n(4),a=n(23),s=n(41),r=n(30),o=n(31),c=n(2),h={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,0===(this._scaleY=t)?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){0===(this._scaleX=t)?this.renderFlags&=-5:this.renderFlags|=4}},scaleY:{get:function(){return this._scaleY},set:function(t){0===(this._scaleY=t)?this.renderFlags&=-5:this.renderFlags|=4}},angle:{get:function(){return o(this._rotation*i.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=r(t)}},setPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.w=i,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),this.x=t+Math.random()*n,this.y=e+Math.random()*i,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new a),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){void 0===t&&(t=new a),void 0===e&&(e=new a);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);for(t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)e.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),e.multiply(t,t),n=n.parentContainer;return t},getLocalPoint:function(t,e,n,i){n=n||new c;var a=(i=i||this.scene.sys.cameras.main).scrollX,r=i.scrollY,o=t+a*this.scrollFactorX-a,h=e+r*this.scrollFactorY-r;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(o,h,n):s(o,h,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};t.exports=h},function(t,e){t.exports={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}}},function(t,e,n){var i=n(0),a=n(54),s=n(222),r=n(229),o=n(55),c=n(44),h=new i({Extends:r,initialize:function(t,e){r.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(o.ADDED_TO_SCENE,this.addedToScene,this),this.on(o.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(t,e,n){return this.scene.sys.input.enable(this,t,e,n),this},disableInteractive:function(){return this.input&&(this.input.enabled=!1),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return a(this)},willRender:function(t){return!(h.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),(t=e).parentContainer);)e=e.parentContainer;return this.displayList?n.unshift(this.displayList.getIndex(t)):n.unshift(this.scene.sys.displayList.getIndex(t)),n},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||((this.displayList=t).add(this,!0),t.queueDepthSort(),this.emit(o.ADDED_TO_SCENE,this,this.scene),t.events.emit(c.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(o.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(c.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},destroy:function(){this.scene&&!this.ignoreDestroy&&(this.preDestroy&&this.preDestroy.call(this),this.emit(o.DESTROY,this),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});h.RENDER_MASK=15,t.exports=h},function(t,e){t.exports=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}},function(t,e,n){t.exports={ADDED_TO_SCENE:n(230),DESTROY:n(231),REMOVED_FROM_SCENE:n(232),VIDEO_COMPLETE:n(233),VIDEO_CREATED:n(234),VIDEO_ERROR:n(235),VIDEO_LOOP:n(236),VIDEO_PLAY:n(237),VIDEO_SEEKED:n(238),VIDEO_SEEKING:n(239),VIDEO_STOP:n(240),VIDEO_TIMEOUT:n(241),VIDEO_UNLOCKED:n(242)}},function(t,e,n){var i=n(23),a=new i,s=new i,r=new i,o={camera:a,sprite:s,calc:r};t.exports=function(t,e,n){var i=a,c=s,h=r;return c.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),c.e=t.x,c.f=t.y):(c.e-=e.scrollX*t.scrollFactorX,c.f-=e.scrollY*t.scrollFactorY),i.multiply(c,h),o}},function(t,e){t.exports=function(t){for(var e=t.length,n=t[0].length,i=new Array(n),a=0;a<n;a++){i[a]=new Array(e);for(var s=e-1;-1<s;s--)i[a][s]=t[s][a]}return i}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.shift(),t.push(n);return n}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.pop(),t.unshift(n);return n}},function(t,e){t.exports=function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}},function(t,e,n){var i=n(62),a=n(13);t.exports=function(t,e,n){if(void 0===n&&(n=new a),e<=0||1<=e)return n.x=t.x,n.y=t.y,n;var s=i(t)*e;return.5<e?(s-=t.width+t.height)<=t.width?(n.x=t.right-s,n.y=t.bottom):(n.x=t.x,n.y=t.bottom-(s-t.width)):s<=t.width?(n.x=t.x+s,n.y=t.y):(n.x=t.right,n.y=t.y+(s-t.width)),n}},function(t,e){t.exports=function(t){return 2*(t.width+t.height)}},function(t,e,n){var i,a=n(64),s=n(0),r=n(10),o=n(177),c=n(178),h=n(202),l=n(203),u=n(221),d=n(254),p=n(1),f=new s({Extends:c,initialize:function(t,e,n){c.call(this,t,e,n);var i=e.game;this.isWebGL=2===i.config.renderType,this.cache=i.cache.addCustom("spine"),this.spineTextures=i.cache.addCustom("spineTextures"),this.json=i.cache.json,this.textures=i.textures,this.drawDebug=!1,this.gl,this.renderer,this.sceneRenderer,this.skeletonRenderer,this.skeletonDebugRenderer,this.plugin=h,this.temp1,this.temp2,this.isWebGL?(this.runtime=h.webgl,this.renderer=i.renderer,this.gl=i.renderer.gl,this.getAtlas=this.getAtlasWebGL):(this.runtime=h.canvas,this.renderer=i.renderer,this.getAtlas=this.getAtlasCanvas),this.renderer||(this.renderer={width:i.scale.width,height:i.scale.height,preRender:p,postRender:p,render:p,destroy:p}),e.registerFileType("spine",this.spineFileCallback,t),e.registerGameObject("spine",(function(t,e,i,a,s){var r=this.scene.sys[n],o=new u(this.scene,r,t,e,i,a,s);return this.displayList.add(o),this.updateList.add(o),o}),(function(t,e){void 0===t&&(t={});var i=r(t,"key",null),s=r(t,"animationName",null),o=r(t,"loop",!1),c=this.scene.sys[n],h=new u(this.scene,c,0,0,i,s,o);void 0!==e&&(t.add=e),a(this.scene,h,t);var l=r(t,"skinName",!1);l&&h.setSkinByName(l);var d=r(t,"slotName",!1),p=r(t,"attachmentName",null);return d&&h.setAttachment(d,p),h.refresh()})),e.registerGameObject("spineContainer",(function(t,e,i){var a=this.scene.sys[n],s=new d(this.scene,a,t,e,i);return this.displayList.add(s),s}),(function(t,e){void 0===t&&(t={});var i=r(t,"x",0),s=r(t,"y",0),o=r(t,"children",null),c=this.scene.sys[n],h=new d(this.scene,c,i,s,o);return void 0!==e&&(t.add=e),a(this.scene,h,t),h}))},boot:function(){this.isWebGL?(this.bootWebGL(),this.onResize(),this.game.scale.on(o,this.onResize,this)):this.bootCanvas();var t=this.systems.events;t.once("shutdown",this.shutdown,this),t.once("destroy",this.destroy,this),this.game.events.once("destroy",this.gameDestroy,this)},bootCanvas:function(){this.skeletonRenderer=new h.canvas.SkeletonRenderer(this.scene.sys.context)},bootWebGL:function(){function t(t,e){var n;t===this.srcBlend&&e===this.dstBlend||(n=this.context.gl,this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend)))}i||((i=new h.webgl.SceneRenderer(this.renderer.canvas,this.gl,!0)).batcher.setBlendMode=t,i.shapes.setBlendMode=t),this.sceneRenderer=i,this.skeletonRenderer=i.skeletonRenderer,this.skeletonDebugRenderer=i.skeletonDebugRenderer,this.temp1=new h.webgl.Vector3(0,0,0),this.temp2=new h.webgl.Vector3(0,0,0)},getAtlasCanvas:function(t){var e=this.cache.get(t);if(e){var n,i=this.spineTextures;return i.has(t)?i.get(t):(n=this.textures,new h.TextureAtlas(e.data,(function(t){return new h.canvas.CanvasTexture(n.get(e.prefix+t).getSourceImage())})))}console.warn("No atlas data for: "+t)},getAtlasWebGL:function(t){var e=this.cache.get(t);if(e){var n,i,a=this.spineTextures,s=a.has(t)?a.get(t):(n=this.textures,(i=this.sceneRenderer.context.gl).pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),new h.TextureAtlas(e.data,(function(t){return new h.webgl.GLTexture(i,n.get(e.prefix+t).getSourceImage(),!1)})));return s}console.warn("No atlas data for: "+t)},spineFileCallback:function(t,e,n,i,a,s){var r;if(Array.isArray(t))for(var o=0;o<t.length;o++)r=new l(this,t[o]),this.addFile(r.files);else r=new l(this,t,e,n,i,a,s),this.addFile(r.files);return this},worldToLocal:function(t,e,n,i){var a=this.temp1,s=this.temp2,r=this.sceneRenderer.camera;a.set(t+n.x,e-n.y,0);var o=r.viewportWidth,c=r.viewportHeight;return r.screenToWorld(a,o,c),i&&null!==i.parent?(i.parent.worldToLocal(s.set(a.x-n.x,a.y-n.y,0)),new h.Vector2(s.x,s.y)):i?new h.Vector2(a.x-n.x,a.y-n.y):new h.Vector2(a.x,a.y)},getVector2:function(t,e){return new h.Vector2(t,e)},getVector3:function(t,e,n){return new h.webgl.Vector3(t,e,n)},setDebugBones:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawBones=t,this},setDebugRegionAttachments:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawRegionAttachments=t,this},setDebugBoundingBoxes:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawBoundingBoxes=t,this},setDebugMeshHull:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawMeshHull=t,this},setDebugMeshTriangles:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawMeshTriangles=t,this},setDebugPaths:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawPaths=t,this},setDebugSkeletonXY:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawSkeletonXY=t,this},setDebugClipping:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawClipping=t,this},setEffect:function(t){return this.sceneRenderer.skeletonRenderer.vertexEffect=t,this},createSkeleton:function(t,e){var n,i=t,a=t,s=-1!==g()(t).call(t,".");s&&(i=(n=t.split(".")).shift(),a=n.join("."));var o=this.cache.get(i),c=this.getAtlas(i);if(!c)return null;this.spineTextures.has(i)||this.spineTextures.add(i,c);var l,u,d=o.preMultipliedAlpha,p=new h.AtlasAttachmentLoader(c),f=new h.SkeletonJson(p);if(u=e||(l=this.json.get(i),s?r(l,a):l)){var m=f.readSkeletonData(u);return{skeletonData:m,skeleton:new h.Skeleton(m),preMultipliedAlpha:d}}return null},createAnimationState:function(t){var e=new h.AnimationStateData(t.data);return{stateData:e,state:new h.AnimationState(e)}},getBounds:function(t){var e=new h.Vector2,n=new h.Vector2;return t.getBounds(e,n,[]),{offset:e,size:n}},onResize:function(){var t=this.renderer,e=this.sceneRenderer,n=t.width,i=t.height;e.camera.position.x=n/2,e.camera.position.y=i/2,e.camera.setViewport(n,i)},shutdown:function(){this.systems.events.off("shutdown",this.shutdown,this),this.isWebGL&&this.game.scale.off(o,this.onResize,this)},destroy:function(){this.shutdown(),this.game=null,this.scene=null,this.systems=null,this.cache=null,this.spineTextures=null,this.json=null,this.textures=null,this.skeletonRenderer=null,this.gl=null},gameDestroy:function(){this.pluginManager.removeGameObject("spine",!0,!0),this.pluginManager.removeGameObject("spineContainer",!0,!0),this.pluginManager=null,i&&(i.dispose(),i=null),this.sceneRenderer=null}});f.SpineGameObject=u,f.SpineContainer=d,t.exports=f},function(t,e,n){var i=n(17),a=n(65);t.exports=function(t,e,n){e.x=a(n,"x",0),e.y=a(n,"y",0),e.depth=a(n,"depth",0),e.flipX=a(n,"flipX",!1),e.flipY=a(n,"flipY",!1);var s=a(n,"scale",null);"number"==typeof s?e.setScale(s):null!==s&&(e.scaleX=a(s,"x",1),e.scaleY=a(s,"y",1));var r=a(n,"scrollFactor",null);"number"==typeof r?e.setScrollFactor(r):null!==r&&(e.scrollFactorX=a(r,"x",1),e.scrollFactorY=a(r,"y",1)),e.rotation=a(n,"rotation",0);var o=a(n,"angle",null);null!==o&&(e.angle=o),e.alpha=a(n,"alpha",1);var c,h,l=a(n,"origin",null);return"number"==typeof l?e.setOrigin(l):null!==l&&(c=a(l,"x",.5),h=a(l,"y",.5),e.setOrigin(c,h)),e.blendMode=a(n,"blendMode",i.NORMAL),e.visible=a(n,"visible",!0),a(n,"add",!0)&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e}},function(t,e,n){var i=n(66),a=n(10);t.exports=function(t,e,n){var s=a(t,e,null);if(null===s)return n;if(Array.isArray(s))return i.RND.pick(s);if("object"==typeof s){if(s.hasOwnProperty("randInt"))return i.RND.integerInRange(s.randInt[0],s.randInt[1]);if(s.hasOwnProperty("randFloat"))return i.RND.realInRange(s.randFloat[0],s.randFloat[1])}else if("function"==typeof s)return s(e);return s}},function(t,e,n){var i=n(4),a=n(27)(!1,a={Angle:n(67),Distance:n(76),Easing:n(84),Fuzzy:n(129),Interpolation:n(134),Pow2:n(142),Snap:n(146),RandomDataGenerator:n(150),Average:n(151),Bernstein:n(33),Between:n(152),CatmullRom:n(35),CeilTo:n(153),Clamp:n(3),DegToRad:n(19),Difference:n(154),Euler:n(155),Factorial:n(34),FloatBetween:n(18),FloorTo:n(156),FromPercent:n(157),GetSpeed:n(158),IsEven:n(159),IsEvenStrict:n(160),Linear:n(36),MaxAdd:n(161),Median:n(162),MinSub:n(163),Percent:n(164),RadToDeg:n(9),RandomXY:n(165),RandomXYZ:n(166),RandomXYZW:n(167),Rotate:n(168),RotateAround:n(39),RotateAroundDistance:n(169),RotateTo:n(170),RoundAwayFromZero:n(40),RoundTo:n(171),SinCosTableGenerator:n(172),SmootherStep:n(38),SmoothStep:n(37),ToXY:n(173),TransformXY:n(41),Within:n(174),Wrap:n(6),Vector2:n(2),Vector3:n(14),Vector4:n(175),Matrix3:n(42),Matrix4:n(20),Quaternion:n(43),RotateVec3:n(176)},i);t.exports=a},function(t,e,n){t.exports={Between:n(28),BetweenPoints:n(68),BetweenPointsY:n(69),BetweenY:n(70),CounterClockwise:n(8),Normalize:n(29),Random:n(71),RandomDegrees:n(72),Reverse:n(73),RotateTo:n(74),ShortestBetween:n(75),Wrap:n(30),WrapDegrees:n(31)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(n-t,i-e)}},function(t,e,n){var i=n(18);t.exports=function(){return i(-Math.PI,Math.PI)}},function(t,e,n){var i=n(18);t.exports=function(){return i(-180,180)}},function(t,e,n){var i=n(29);t.exports=function(t){return i(t+Math.PI)}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=i.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=i.PI2:e-=i.PI2),t<e?t+=n:e<t&&(t-=n))),t}},function(t,e){t.exports=function(t,e){var n=e-t;return 0==n?0:n-360*Math.floor((n+180)/360)}},function(t,e,n){t.exports={Between:n(77),BetweenPoints:n(78),BetweenPointsSquared:n(79),Chebyshev:n(80),Power:n(81),Snake:n(82),Squared:n(83)}},function(t,e){t.exports=function(t,e,n,i){var a=t-n,s=e-i;return Math.sqrt(a*a+s*s)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},function(t,e){t.exports=function(t,e,n,i){return Math.max(Math.abs(t-n),Math.abs(e-i))}},function(t,e){t.exports=function(t,e,n,i,a){return void 0===a&&(a=2),Math.sqrt(Math.pow(n-t,a)+Math.pow(i-e,a))}},function(t,e){t.exports=function(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}},function(t,e){t.exports=function(t,e,n,i){var a=t-n,s=e-i;return a*a+s*s}},function(t,e,n){t.exports={Back:n(85),Bounce:n(89),Circular:n(93),Cubic:n(97),Elastic:n(101),Expo:n(105),Linear:n(109),Quadratic:n(111),Quartic:n(115),Quintic:n(119),Sine:n(123),Stepped:n(127)}},function(t,e,n){t.exports={In:n(86),Out:n(87),InOut:n(88)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((1+n)*t-n)*.5:.5*((t-=2)*t*((1+n)*t+n)+2)}},function(t,e,n){t.exports={In:n(90),Out:n(91),InOut:n(92)}},function(t,e){t.exports=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}},function(t,e){t.exports=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},function(t,e){t.exports=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}},function(t,e,n){t.exports={In:n(94),Out:n(95),InOut:n(96)}},function(t,e){t.exports=function(t){return 1-Math.sqrt(1-t*t)}},function(t,e){t.exports=function(t){return Math.sqrt(1- --t*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},function(t,e,n){t.exports={In:n(98),Out:n(99),InOut:n(100)}},function(t,e){t.exports=function(t){return t*t*t}},function(t,e){t.exports=function(t){return--t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},function(t,e,n){t.exports={In:n(102),Out:n(103),InOut:n(104)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/n)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*--t)*Math.sin((t-i)*(2*Math.PI)/n)*.5+1}},function(t,e,n){t.exports={In:n(106),Out:n(107),InOut:n(108)}},function(t,e){t.exports=function(t){return Math.pow(2,10*(t-1))-.001}},function(t,e){t.exports=function(t){return 1-Math.pow(2,-10*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}},function(t,e,n){t.exports=n(110)},function(t,e){t.exports=function(t){return t}},function(t,e,n){t.exports={In:n(112),Out:n(113),InOut:n(114)}},function(t,e){t.exports=function(t){return t*t}},function(t,e){t.exports=function(t){return t*(2-t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},function(t,e,n){t.exports={In:n(116),Out:n(117),InOut:n(118)}},function(t,e){t.exports=function(t){return t*t*t*t}},function(t,e){t.exports=function(t){return 1- --t*t*t*t}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},function(t,e,n){t.exports={In:n(120),Out:n(121),InOut:n(122)}},function(t,e){t.exports=function(t){return t*t*t*t*t}},function(t,e){t.exports=function(t){return--t*t*t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},function(t,e,n){t.exports={In:n(124),Out:n(125),InOut:n(126)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},function(t,e,n){t.exports=n(128)},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t<=0?0:1<=t?1:1/e*(1+(e*t|0))}},function(t,e,n){t.exports={Ceil:n(130),Equal:n(32),Floor:n(131),GreaterThan:n(132),LessThan:n(133)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),e-n<t}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}},function(t,e,n){t.exports={Bezier:n(135),CatmullRom:n(136),CubicBezier:n(137),Linear:n(138),QuadraticBezier:n(139),SmoothStep:n(140),SmootherStep:n(141)}},function(t,e,n){var i=n(33);t.exports=function(t,e){for(var n=0,a=t.length-1,s=0;s<=a;s++)n+=Math.pow(1-e,a-s)*Math.pow(e,s)*t[s]*i(a,s);return n}},function(t,e,n){var i=n(35);t.exports=function(t,e){var n=t.length-1,a=n*e,s=Math.floor(a);return t[0]===t[n]?(e<0&&(s=Math.floor(a=n*(1+e))),i(a-s,t[(s-1+n)%n],t[s],t[(s+1)%n],t[(s+2)%n])):e<0?t[0]-(i(-a,t[0],t[0],t[1],t[1])-t[0]):1<e?t[n]-(i(a-n,t[n],t[n],t[n-1],t[n-1])-t[n]):i(a-s,t[s?s-1:0],t[s],t[n<s+1?n:s+1],t[n<s+2?n:s+2])}},function(t,e){t.exports=function(t,e,n,i,a){return(h=1-t)*h*h*e+3*(c=1-(o=t))*c*o*n+3*(1-(r=t))*r*r*i+(s=t)*s*s*a;var s,r,o,c,h}},function(t,e,n){var i=n(36);t.exports=function(t,e){var n=t.length-1,a=n*e,s=Math.floor(a);return e<0?i(t[0],t[1],a):1<e?i(t[n],t[n-1],n-a):i(t[s],t[n<s+1?n:s+1],a-s)}},function(t,e){t.exports=function(t,e,n,i){return(r=1-t)*r*e+2*(1-(s=t))*s*n+(a=t)*a*i;var a,s,r}},function(t,e,n){var i=n(37);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){var i=n(38);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){t.exports={GetNext:n(143),IsSize:n(144),IsValue:n(145)}},function(t,e){t.exports=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}},function(t,e){t.exports=function(t,e){return 0<t&&0==(t&t-1)&&0<e&&0==(e&e-1)}},function(t,e){t.exports=function(t){return 0<t&&0==(t&t-1)}},function(t,e,n){t.exports={Ceil:n(147),Floor:n(148),To:n(149)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.ceil(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.floor(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.round(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,n=this.n;t=t.toString();for(var i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return 2.3283064365386963e-10*((this.n=n)>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var n=t[e];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=xR()(t[1]),this.s0=xR()(t[2]),this.s1=xR()(t[3]),this.s2=xR()(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(this.frac()*(e+1)),i=t[n];t[n]=t[e],t[e]=i}return t}});t.exports=i},function(t,e){t.exports=function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length}},function(t,e){t.exports=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.ceil(t*i)/i}},function(t,e){t.exports=function(t,e){return Math.abs(t-e)}},function(t,e,n){var i=n(3),a=n(0),s=n(20),r=n(1),o=new s,c=new a({initialize:function t(e,n,i,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=t.DefaultOrder),this._x=e,this._y=n,this._z=i,this._order=a,this.onChangeCallback=r},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,n,i){return void 0===i&&(i=this._order),this._x=t,this._y=e,this._z=n,this._order=i,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,n){return void 0===e&&(e=this._order),void 0===n&&(n=!1),o.fromQuat(t),this.setFromRotationMatrix(o,e,n)},setFromRotationMatrix:function(t,e,n){void 0===e&&(e=this._order),void 0===n&&(n=!1);var a=t.val,s=a[0],r=a[4],o=a[8],c=a[1],h=a[5],l=a[9],u=a[2],d=a[6],p=a[10],f=0,g=0,m=0,v=.99999;switch(e){case"XYZ":g=Math.asin(i(o,-1,1)),Math.abs(o)<v?(f=Math.atan2(-l,p),m=Math.atan2(-r,s)):f=Math.atan2(d,h);break;case"YXZ":f=Math.asin(-i(l,-1,1)),Math.abs(l)<v?(g=Math.atan2(o,p),m=Math.atan2(c,h)):g=Math.atan2(-u,s);break;case"ZXY":f=Math.asin(i(d,-1,1)),m=Math.abs(d)<v?(g=Math.atan2(-u,p),Math.atan2(-r,h)):Math.atan2(c,s);break;case"ZYX":g=Math.asin(-i(u,-1,1)),m=Math.abs(u)<v?(f=Math.atan2(d,p),Math.atan2(c,s)):Math.atan2(-r,h);break;case"YZX":m=Math.asin(i(c,-1,1)),g=Math.abs(c)<v?(f=Math.atan2(-l,h),Math.atan2(-u,s)):Math.atan2(o,p);break;case"XZY":m=Math.asin(-i(r,-1,1)),Math.abs(r)<v?(f=Math.atan2(d,h),g=Math.atan2(o,s)):f=Math.atan2(-l,p)}return this._x=f,this._y=g,this._z=m,this._order=e,n&&this.onChangeCallback(this),this}});c.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],c.DefaultOrder="XYZ",t.exports=c},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.floor(t*i)/i}},function(t,e,n){var i=n(3);t.exports=function(t,e,n){return(n-e)*(t=i(t,0,1))+e}},function(t,e){t.exports=function(t,e){return t/e/1e3}},function(t,e){t.exports=function(t){return t==xR()(t)?!(t%2):void 0}},function(t,e){t.exports=function(t){return t===xR()(t)?!(t%2):void 0}},function(t,e){t.exports=function(t,e,n){return Math.min(t+e,n)}},function(t,e){t.exports=function(t){var e=t.length;if(0===e)return 0;Na()(t).call(t,(function(t,e){return t-e}));var n=Math.floor(e/2);return e%2==0?(t[n]+t[n-1])/2:t[n]}},function(t,e){t.exports=function(t,e,n){return Math.max(t-e,n)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=e+1);var a=(t-e)/(n-e);return 1<a?void 0!==i?(a=(i-t)/(i-n))<0&&(a=0):a=1:a<0&&(a=0),a}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI;return t.x=Math.cos(n)*e,t.y=Math.sin(n)*e,t}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI,i=2*Math.random()-1,a=Math.sqrt(1-i*i)*e;return t.x=Math.cos(n)*a,t.y=Math.sin(n)*a,t.z=i*e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}},function(t,e){t.exports=function(t,e){var n=t.x,i=t.y;return t.x=n*Math.cos(e)-i*Math.sin(e),t.y=n*Math.sin(e)+i*Math.cos(e),t}},function(t,e){t.exports=function(t,e,n,i,a){var s=i+Math.atan2(t.y-n,t.x-e);return t.x=e+a*Math.cos(s),t.y=n+a*Math.sin(s),t}},function(t,e){t.exports=function(t,e,n,i,a){return t.x=e+a*Math.cos(i),t.y=n+a*Math.sin(i),t}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.round(t*i)/i}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),i*=Math.PI/t;for(var a=[],s=[],r=0;r<t;r++)e+=(n-=e*i)*i,a[r]=n,s[r]=e;return{sin:s,cos:a,length:t}}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,a){void 0===a&&(a=new i);var s=0,r=0;return 0<t&&t<=e*n&&(s=e-1<t?t-(r=Math.floor(t/e))*e:t,a.set(s,r)),a}},function(t,e){t.exports=function(t,e,n){return Math.abs(t-e)<=n}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,n,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i;return 0<a&&(a=1/Math.sqrt(a),this.x=t*a,this.y=e*a,this.z=n*a,this.w=i*a),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z,s=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=a+e*(t.z-a),this.w=s+e*(t.w-s),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,a=t.w-this.w||0;return Math.sqrt(e*e+n*n+i*i+a*a)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,a=t.w-this.w||0;return e*e+n*n+i*i+a*a},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,a=this.w,s=t.val;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*a,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*a,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*a,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*a,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,s=t.y,r=t.z,o=t.w,c=o*e+s*i-r*n,h=o*n+r*e-a*i,l=o*i+a*n-s*e,u=-a*e-s*n-r*i;return this.x=c*o+u*-a+h*-r-l*-s,this.y=h*o+u*-s+l*-a-c*-r,this.z=l*o+u*-r+c*-s-h*-a,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.distSq=i.prototype.distanceSq,i.prototype.len=i.prototype.length,i.prototype.lenSq=i.prototype.lengthSq,t.exports=i},function(t,e,n){var i=n(14),a=n(20),s=n(43),r=new a,o=new s,c=new i;t.exports=function(t,e,n){return o.setAxisAngle(e,n),r.fromRotationTranslation(o,c.set(0,0,0)),t.transformMat4(r)}},function(t,e){t.exports="resize"},function(t,e,n){var i=n(179),a=n(0),s=n(44),r=new a({Extends:i,initialize:function(t,e,n){i.call(this,e),this.scene=t,this.systems=t.sys,this.pluginKey=n,t.sys.events.once(s.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=r},function(t,e,n){var i=new(n(0))({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=i},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="boot"},function(t,e){t.exports="create"},function(t,e){t.exports="destroy"},function(t,e){t.exports="pause"},function(t,e){t.exports="postupdate"},function(t,e){t.exports="prerender"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="ready"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="render"},function(t,e){t.exports="resume"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="sleep"},function(t,e){t.exports="start"},function(t,e){t.exports="transitioncomplete"},function(t,e){t.exports="transitioninit"},function(t,e){t.exports="transitionout"},function(t,e){t.exports="transitionstart"},function(t,e){t.exports="transitionwake"},function(t,e){t.exports="update"},function(t,e){t.exports="wake"},function(t,e){(function(){var e,n,i,a,s,r,o,c,h,l,u,d,p,f,m,v,y,S,A,x,E,b,w,T,C,M,I,P,k,R,_,O,D,B,L,F,N,G,U,V,z,W,H,X,K,j,q,Z,J,Q,$,tt,et,nt,at,st,rt,ot,ct,ht,lt,ut,dt,pt,ft,gt,mt,vt,yt,St,At,xt,Et,bt,wt,Tt,Ct,Mt,It,Pt,kt,Rt,_t,Ot,Dt,Bt,Lt,Ft,Nt,Gt,Ut,Vt,Yt,zt,Wt,Ht,Xt,Kt,jt,qt,Zt,Jt,Qt,$t,te,ee,ne,ie,ae,se,re,oe,ce,he,le,ue,de,pe,fe,ge,me,ve,ye,Se,Ae,xe=this&&this.__extends||(e=function(t,n){return(e=bR()||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});function Ee(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}function be(t,e){void 0===e&&(e=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.rawDataUris={},this.textureLoader=t,this.pathPrefix=e}function we(t){this.atlas=t}function Te(t,e,n){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}function Ce(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}function Me(t){var e=S.call(this,t,0,!1)||this;return e.bones=new Array,e.bendDirection=1,e.compress=!1,e.stretch=!1,e.uniform=!1,e.mix=1,e.softness=0,e}function Ie(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var n=0,i=t.bones.length;n<i;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}function Pe(t){var e=w.call(this,t,0,!1)||this;return e.bones=new Array,e}function ke(t){this.toLoad=new Array,this.assets={},this.clientId=t}function Re(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}function _e(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var n,i=t.bones[e],a=void 0;null==i.parent?a=new _.Bone(i,this,null):(n=this.bones[i.parent.index],a=new _.Bone(i,this,n),n.children.push(a)),this.bones.push(a)}for(this.slots=new Array,this.drawOrder=new Array,e=0;e<t.slots.length;e++){var s=t.slots[e],r=(a=this.bones[s.boneData.index],new _.Slot(s,a));this.slots.push(r),this.drawOrder.push(r)}for(this.ikConstraints=new Array,e=0;e<t.ikConstraints.length;e++){var o=t.ikConstraints[e];this.ikConstraints.push(new _.IkConstraint(o,this))}for(this.transformConstraints=new Array,e=0;e<t.transformConstraints.length;e++){var c=t.transformConstraints[e];this.transformConstraints.push(new _.TransformConstraint(c,this))}for(this.pathConstraints=new Array,e=0;e<t.pathConstraints.length;e++){var h=t.pathConstraints[e];this.pathConstraints.push(new _.PathConstraint(h,this))}this.color=new _.Color(1,1,1,1),this.updateCache()}function Oe(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new D.Pool((function(){return D.Utils.newFloatArray(16)}))}function De(){this.triangulator=new L.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}function Be(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}function Le(t,e){if(this.deform=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new U.Color,this.darkColor=null==t.darkColor?null:new U.Color,this.setToSetupPose()}function Fe(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new W.Vector2,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}function Ne(t){var e=K.call(this,t,0,!1)||this;return e.bones=new Array,e.rotateMix=0,e.translateMix=0,e.scaleMix=0,e.shearMix=0,e.offsetRotation=0,e.offsetX=0,e.offsetY=0,e.offsetScaleX=0,e.offsetScaleY=0,e.offsetShearY=0,e.relative=!1,e.local=!1,e}function Ge(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new q.Pool((function(){return new Array})),this.polygonIndicesPool=new q.Pool((function(){return new Array}))}function Ue(t){var e=et.call(this,t)||this;return e.color=new tt.Color(1,1,1,1),e}function Ve(t){var e=st.call(this,t)||this;return e.color=new at.Color(.2275,.2275,.8078,1),e}function Ye(t){var e=ct.call(this,t)||this;return e.color=new ot.Color(1,1,1,1),e.tempColor=new ot.Color(0,0,0,0),e}function ze(t){var e=ut.call(this,t)||this;return e.closed=!1,e.constantSpeed=!1,e.color=new lt.Color(1,1,1,1),e}function We(t){var e=ft.call(this,t)||this;return e.color=new pt.Color(.38,.94,0,1),e}function He(t){var e=vt.call(this,t)||this;return e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,e.rotation=0,e.width=0,e.height=0,e.color=new mt.Color(1,1,1,1),e.offset=mt.Utils.newFloatArray(8),e.uvs=mt.Utils.newFloatArray(8),e.tempColor=new mt.Color(1,1,1,1),e}function Xe(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}function Ke(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}function je(t){return void 0===t&&(t=""),Tt.call(this,(function(t){return new bt.canvas.CanvasTexture(t)}),t)||this}function qe(t){return Pt.call(this,t)||this}function Ze(t){this.triangleRendering=!1,this.debugRendering=!1,this.vertices=Rt.Utils.newFloatArray(8192),this.tempColor=new Rt.Color,this.ctx=t}function Je(t,e){return void 0===e&&(e=""),Lt.call(this,(function(e){return new Dt.webgl.GLTexture(t,e)}),e)||this}function Qe(t,e){this.position=new Gt.Vector3(0,0,0),this.direction=new Gt.Vector3(0,0,-1),this.up=new Gt.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new Gt.Matrix4,this.inverseProjectionView=new Gt.Matrix4,this.projection=new Gt.Matrix4,this.view=new Gt.Matrix4,this.tmp=new Gt.Vector3,this.viewportWidth=t,this.viewportHeight=e,this.update()}function $e(t,e,n){void 0===n&&(n=!1);var i=zt.call(this,e)||this;return i.texture=null,i.boundUnit=0,i.useMipMaps=!1,i.context=t instanceof Yt.ManagedWebGLRenderingContext?t:new Yt.ManagedWebGLRenderingContext(t),i.useMipMaps=n,i.restore(),i.context.addRestorable(i),i}function tn(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n=10920),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,10920<n)throw new Error("Can't have more than 10920 triangles per batch: "+n);this.context=t instanceof jt.ManagedWebGLRenderingContext?t:new jt.ManagedWebGLRenderingContext(t);var i=e?[new jt.Position2Attribute,new jt.ColorAttribute,new jt.TexCoordAttribute,new jt.Color2Attribute]:[new jt.Position2Attribute,new jt.ColorAttribute,new jt.TexCoordAttribute];this.mesh=new jt.Mesh(t,i,n,3*n),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}function en(t,e,n){void 0===n&&(n=!0),this.twoColorTint=!1,this.activeRenderer=null,this.QUAD=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],this.QUAD_TRIANGLES=[0,1,2,2,3,0],this.WHITE=new Zt.Color(1,1,1,1),this.canvas=t,this.context=e instanceof Jt.ManagedWebGLRenderingContext?e:new Jt.ManagedWebGLRenderingContext(e),this.twoColorTint=n,this.camera=new Jt.OrthoCamera(t.width,t.height),this.batcherShader=n?Jt.Shader.newTwoColoredTextured(this.context):Jt.Shader.newColoredTextured(this.context),this.batcher=new Jt.PolygonBatcher(this.context,n),this.shapesShader=Jt.Shader.newColored(this.context),this.shapes=new Jt.ShapeRenderer(this.context),this.skeletonRenderer=new Jt.SkeletonRenderer(this.context,n),this.skeletonDebugRenderer=new Jt.SkeletonDebugRenderer(this.context)}function nn(t,e,n){this.vertexShader=e,this.fragmentShader=n,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=e,this.fsSource=n,this.context=t instanceof ne.ManagedWebGLRenderingContext?t:new ne.ManagedWebGLRenderingContext(t),this.context.addRestorable(this),this.compile()}function an(t,e){if(void 0===e&&(e=10920),this.isDrawing=!1,this.shapeType=re.Filled,this.color=new ae.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new ae.Vector2,10920<e)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof se.ManagedWebGLRenderingContext?t:new se.ManagedWebGLRenderingContext(t),this.mesh=new se.Mesh(t,[new se.Position2Attribute,new se.ColorAttribute],e,0),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}function sn(t){this.boneLineColor=new he.Color(1,0,0,1),this.boneOriginColor=new he.Color(0,1,0,1),this.attachmentLineColor=new he.Color(0,0,1,.5),this.triangleLineColor=new he.Color(1,.64,0,.5),this.pathColor=(new he.Color).setFromString("FF7F00"),this.clipColor=new he.Color(.8,0,0,2),this.aabbColor=new he.Color(0,1,0,.5),this.drawBones=!0,this.drawRegionAttachments=!0,this.drawBoundingBoxes=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawPaths=!0,this.drawSkeletonXY=!1,this.drawClipping=!0,this.premultipliedAlpha=!1,this.scale=1,this.boneWidth=2,this.bounds=new he.SkeletonBounds,this.temp=new Array,this.vertices=he.Utils.newFloatArray(2048),this.context=t instanceof le.ManagedWebGLRenderingContext?t:new le.ManagedWebGLRenderingContext(t)}function rn(t,e){void 0===e&&(e=!0),this.premultipliedAlpha=!1,this.vertexEffect=null,this.tempColor=new de.Color,this.tempColor2=new de.Color,this.vertexSize=8,this.twoColorTint=!1,this.renderable=new fe(null,0,0),this.clipper=new de.SkeletonClipping,this.temp=new de.Vector2,this.temp2=new de.Vector2,this.temp3=new de.Color,this.temp4=new de.Color,(this.twoColorTint=e)&&(this.vertexSize+=4),this.vertices=de.Utils.newFloatArray(1024*this.vertexSize)}function on(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=n}!function(t){var e,n,i,a,s,r,o=(c.prototype.hasTimeline=function(t){return 1==this.timelineIds[t]},c.prototype.apply=function(t,e,n,i,a,s,r,o){if(null==t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(n%=this.duration,0<e&&(e%=this.duration));for(var c=this.timelines,h=0,l=c.length;h<l;h++)c[h].apply(t,e,n,a,s,r,o)},c.binarySearch=function(t,e,n){void 0===n&&(n=1);var i=0,a=t.length/n-2;if(0==a)return n;for(var s=a>>>1;;){if(t[(s+1)*n]<=e?i=s+1:a=s,i==a)return(i+1)*n;s=i+a>>>1}},c.linearSearch=function(t,e,n){for(var i=0,a=t.length-n;i<=a;i+=n)if(t[i]>e)return i;return-1},c);function c(t,e,n){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var i=0;i<e.length;i++)this.timelineIds[e[i].getPropertyId()]=!0;this.duration=n}t.Animation=o,(n=e=t.MixBlend||(t.MixBlend={}))[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add",(a=i=t.MixDirection||(t.MixDirection={}))[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut",(r=s=t.TimelineType||(t.TimelineType={}))[r.rotate=0]="rotate",r[r.translate=1]="translate",r[r.scale=2]="scale",r[r.shear=3]="shear",r[r.attachment=4]="attachment",r[r.color=5]="color",r[r.deform=6]="deform",r[r.event=7]="event",r[r.drawOrder=8]="drawOrder",r[r.ikConstraint=9]="ikConstraint",r[r.transformConstraint=10]="transformConstraint",r[r.pathConstraintPosition=11]="pathConstraintPosition",r[r.pathConstraintSpacing=12]="pathConstraintSpacing",r[r.pathConstraintMix=13]="pathConstraintMix",r[r.twoColor=14]="twoColor";var h=(l.prototype.getFrameCount=function(){return this.curves.length/l.BEZIER_SIZE+1},l.prototype.setLinear=function(t){this.curves[t*l.BEZIER_SIZE]=l.LINEAR},l.prototype.setStepped=function(t){this.curves[t*l.BEZIER_SIZE]=l.STEPPED},l.prototype.getCurveType=function(t){var e=t*l.BEZIER_SIZE;if(e==this.curves.length)return l.LINEAR;var n=this.curves[e];return n==l.LINEAR?l.LINEAR:n==l.STEPPED?l.STEPPED:l.BEZIER},l.prototype.setCurve=function(t,e,n,i,a){var s=.03*(2*-e+i),r=.03*(2*-n+a),o=.006*(3*(e-i)+1),c=.006*(3*(n-a)+1),h=2*s+o,u=2*r+c,d=.3*e+s+.16666667*o,p=.3*n+r+.16666667*c,f=t*l.BEZIER_SIZE,g=this.curves;g[f++]=l.BEZIER;for(var m=d,v=p,y=f+l.BEZIER_SIZE-1;f<y;f+=2)g[f]=m,g[f+1]=v,d+=h,p+=u,h+=o,u+=c,m+=d,v+=p},l.prototype.getCurvePercent=function(e,n){n=t.MathUtils.clamp(n,0,1);var i=this.curves,a=e*l.BEZIER_SIZE,s=i[a];if(s==l.LINEAR)return n;if(s==l.STEPPED)return 0;for(var r=0,o=++a,c=a+l.BEZIER_SIZE-1;a<c;a+=2)if(n<=(r=i[a])){var h,u=void 0;return(h=a==o?u=0:(u=i[a-2],i[a-1]))+(i[a+1]-h)*(n-u)/(r-u)}var d=i[a-1];return d+(1-d)*(n-r)/(1-r)},l.LINEAR=0,l.STEPPED=1,l.BEZIER=2,l.BEZIER_SIZE=19,l);function l(e){if(e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=t.Utils.newFloatArray((e-1)*l.BEZIER_SIZE)}t.CurveTimeline=h;var u,d=(xe(p,u=h),p.prototype.getPropertyId=function(){return(s.rotate<<24)+this.boneIndex},p.prototype.setFrame=function(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+p.ROTATION]=n},p.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<h[0])switch(r){case e.setup:return void(l.rotation=l.data.rotation);case e.first:var u=l.data.rotation-l.rotation;l.rotation+=(u-360*(16384-(16384.499999999996-u/360|0)))*s}else if(i>=h[h.length-p.ENTRIES]){var d=h[h.length+p.PREV_ROTATION];switch(r){case e.setup:l.rotation=l.data.rotation+d*s;break;case e.first:case e.replace:d+=l.data.rotation-l.rotation,d-=360*(16384-(16384.499999999996-d/360|0));case e.add:l.rotation+=d*s}}else{var f=o.binarySearch(h,i,p.ENTRIES),g=h[f+p.PREV_ROTATION],m=h[f],v=this.getCurvePercent((f>>1)-1,1-(i-m)/(h[f+p.PREV_TIME]-m)),y=g+((y=h[f+p.ROTATION]-g)-360*(16384-(16384.499999999996-y/360|0)))*v;switch(r){case e.setup:l.rotation=l.data.rotation+(y-360*(16384-(16384.499999999996-y/360|0)))*s;break;case e.first:case e.replace:y+=l.data.rotation-l.rotation;case e.add:l.rotation+=(y-360*(16384-(16384.499999999996-y/360|0)))*s}}},p.ENTRIES=2,p.PREV_TIME=-2,p.PREV_ROTATION=-1,p.ROTATION=1,p);function p(e){var n=u.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e<<1),n}t.RotateTimeline=d;var f,g=(xe(m,f=h),m.prototype.getPropertyId=function(){return(s.translate<<24)+this.boneIndex},m.prototype.setFrame=function(t,e,n,i){t*=m.ENTRIES,this.frames[t]=e,this.frames[t+m.X]=n,this.frames[t+m.Y]=i},m.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<h[0])switch(r){case e.setup:return l.x=l.data.x,void(l.y=l.data.y);case e.first:l.x+=(l.data.x-l.x)*s,l.y+=(l.data.y-l.y)*s}else{var u,d,p,f=0,g=0;switch(i>=h[h.length-m.ENTRIES]?(f=h[h.length+m.PREV_X],g=h[h.length+m.PREV_Y]):(f=h[(u=o.binarySearch(h,i,m.ENTRIES))+m.PREV_X],g=h[u+m.PREV_Y],d=h[u],p=this.getCurvePercent(u/m.ENTRIES-1,1-(i-d)/(h[u+m.PREV_TIME]-d)),f+=(h[u+m.X]-f)*p,g+=(h[u+m.Y]-g)*p),r){case e.setup:l.x=l.data.x+f*s,l.y=l.data.y+g*s;break;case e.first:case e.replace:l.x+=(l.data.x+f-l.x)*s,l.y+=(l.data.y+g-l.y)*s;break;case e.add:l.x+=f*s,l.y+=g*s}}},m.ENTRIES=3,m.PREV_TIME=-3,m.PREV_X=-2,m.PREV_Y=-1,m.X=1,m.Y=2,m);function m(e){var n=f.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*m.ENTRIES),n}t.TranslateTimeline=g;var v,y=(xe(S,v=g),S.prototype.getPropertyId=function(){return(s.scale<<24)+this.boneIndex},S.prototype.apply=function(n,a,s,r,c,h,l){var u=this.frames,d=n.bones[this.boneIndex];if(d.active)if(s<u[0])switch(h){case e.setup:return d.scaleX=d.data.scaleX,void(d.scaleY=d.data.scaleY);case e.first:d.scaleX+=(d.data.scaleX-d.scaleX)*c,d.scaleY+=(d.data.scaleY-d.scaleY)*c}else{var p,f,g,m=0,v=0;if(v=s>=u[u.length-S.ENTRIES]?(m=u[u.length+S.PREV_X]*d.data.scaleX,u[u.length+S.PREV_Y]*d.data.scaleY):(m=u[(p=o.binarySearch(u,s,S.ENTRIES))+S.PREV_X],v=u[p+S.PREV_Y],f=u[p],g=this.getCurvePercent(p/S.ENTRIES-1,1-(s-f)/(u[p+S.PREV_TIME]-f)),m=(m+(u[p+S.X]-m)*g)*d.data.scaleX,(v+(u[p+S.Y]-v)*g)*d.data.scaleY),1==c)h==e.add?(d.scaleX+=m-d.data.scaleX,d.scaleY+=v-d.data.scaleY):(d.scaleX=m,d.scaleY=v);else{var y=0,A=0;if(l==i.mixOut)switch(h){case e.setup:y=d.data.scaleX,A=d.data.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-y)*c,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-A)*c;break;case e.first:case e.replace:y=d.scaleX,A=d.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-y)*c,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-A)*c;break;case e.add:y=d.scaleX,A=d.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-d.data.scaleX)*c,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-d.data.scaleY)*c}else switch(h){case e.setup:y=Math.abs(d.data.scaleX)*t.MathUtils.signum(m),A=Math.abs(d.data.scaleY)*t.MathUtils.signum(v),d.scaleX=y+(m-y)*c,d.scaleY=A+(v-A)*c;break;case e.first:case e.replace:y=Math.abs(d.scaleX)*t.MathUtils.signum(m),A=Math.abs(d.scaleY)*t.MathUtils.signum(v),d.scaleX=y+(m-y)*c,d.scaleY=A+(v-A)*c;break;case e.add:y=t.MathUtils.signum(m),A=t.MathUtils.signum(v),d.scaleX=Math.abs(d.scaleX)*y+(m-Math.abs(d.data.scaleX)*y)*c,d.scaleY=Math.abs(d.scaleY)*A+(v-Math.abs(d.data.scaleY)*A)*c}}}},S);function S(t){return v.call(this,t)||this}t.ScaleTimeline=y;var A,x=(xe(E,A=g),E.prototype.getPropertyId=function(){return(s.shear<<24)+this.boneIndex},E.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<h[0])switch(r){case e.setup:return l.shearX=l.data.shearX,void(l.shearY=l.data.shearY);case e.first:l.shearX+=(l.data.shearX-l.shearX)*s,l.shearY+=(l.data.shearY-l.shearY)*s}else{var u,d,p,f=0,g=0;switch(i>=h[h.length-E.ENTRIES]?(f=h[h.length+E.PREV_X],g=h[h.length+E.PREV_Y]):(f=h[(u=o.binarySearch(h,i,E.ENTRIES))+E.PREV_X],g=h[u+E.PREV_Y],d=h[u],p=this.getCurvePercent(u/E.ENTRIES-1,1-(i-d)/(h[u+E.PREV_TIME]-d)),f+=(h[u+E.X]-f)*p,g+=(h[u+E.Y]-g)*p),r){case e.setup:l.shearX=l.data.shearX+f*s,l.shearY=l.data.shearY+g*s;break;case e.first:case e.replace:l.shearX+=(l.data.shearX+f-l.shearX)*s,l.shearY+=(l.data.shearY+g-l.shearY)*s;break;case e.add:l.shearX+=f*s,l.shearY+=g*s}}},E);function E(t){return A.call(this,t)||this}t.ShearTimeline=x;var b,w=(xe(T,b=h),T.prototype.getPropertyId=function(){return(s.color<<24)+this.slotIndex},T.prototype.setFrame=function(t,e,n,i,a,s){t*=T.ENTRIES,this.frames[t]=e,this.frames[t+T.R]=n,this.frames[t+T.G]=i,this.frames[t+T.B]=a,this.frames[t+T.A]=s},T.prototype.apply=function(t,n,i,a,s,r,c){var h=t.slots[this.slotIndex];if(h.bone.active){var l=this.frames;if(i<l[0])switch(r){case e.setup:return void h.color.setFromColor(h.data.color);case e.first:var u=h.color,d=h.data.color;u.add((d.r-u.r)*s,(d.g-u.g)*s,(d.b-u.b)*s,(d.a-u.a)*s)}else{var p,f,g,m,v=0,y=0,S=0,A=0;i>=l[l.length-T.ENTRIES]?(v=l[(p=l.length)+T.PREV_R],y=l[p+T.PREV_G],S=l[p+T.PREV_B],A=l[p+T.PREV_A]):(v=l[(f=o.binarySearch(l,i,T.ENTRIES))+T.PREV_R],y=l[f+T.PREV_G],S=l[f+T.PREV_B],A=l[f+T.PREV_A],g=l[f],m=this.getCurvePercent(f/T.ENTRIES-1,1-(i-g)/(l[f+T.PREV_TIME]-g)),v+=(l[f+T.R]-v)*m,y+=(l[f+T.G]-y)*m,S+=(l[f+T.B]-S)*m,A+=(l[f+T.A]-A)*m),1==s?h.color.set(v,y,S,A):(u=h.color,r==e.setup&&u.setFromColor(h.data.color),u.add((v-u.r)*s,(y-u.g)*s,(S-u.b)*s,(A-u.a)*s))}}},T.ENTRIES=5,T.PREV_TIME=-5,T.PREV_R=-4,T.PREV_G=-3,T.PREV_B=-2,T.PREV_A=-1,T.R=1,T.G=2,T.B=3,T.A=4,T);function T(e){var n=b.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*T.ENTRIES),n}t.ColorTimeline=w;var C,M=(xe(I,C=h),I.prototype.getPropertyId=function(){return(s.twoColor<<24)+this.slotIndex},I.prototype.setFrame=function(t,e,n,i,a,s,r,o,c){t*=I.ENTRIES,this.frames[t]=e,this.frames[t+I.R]=n,this.frames[t+I.G]=i,this.frames[t+I.B]=a,this.frames[t+I.A]=s,this.frames[t+I.R2]=r,this.frames[t+I.G2]=o,this.frames[t+I.B2]=c},I.prototype.apply=function(t,n,i,a,s,r,c){var h=t.slots[this.slotIndex];if(h.bone.active){var l=this.frames;if(i<l[0])switch(r){case e.setup:return h.color.setFromColor(h.data.color),void h.darkColor.setFromColor(h.data.darkColor);case e.first:var u=h.color,d=h.darkColor,p=h.data.color,f=h.data.darkColor;u.add((p.r-u.r)*s,(p.g-u.g)*s,(p.b-u.b)*s,(p.a-u.a)*s),d.add((f.r-d.r)*s,(f.g-d.g)*s,(f.b-d.b)*s,0)}else{var g,m,v,y,S=0,A=0,x=0,E=0,b=0,w=0,T=0;i>=l[l.length-I.ENTRIES]?(S=l[(g=l.length)+I.PREV_R],A=l[g+I.PREV_G],x=l[g+I.PREV_B],E=l[g+I.PREV_A],b=l[g+I.PREV_R2],w=l[g+I.PREV_G2],T=l[g+I.PREV_B2]):(S=l[(m=o.binarySearch(l,i,I.ENTRIES))+I.PREV_R],A=l[m+I.PREV_G],x=l[m+I.PREV_B],E=l[m+I.PREV_A],b=l[m+I.PREV_R2],w=l[m+I.PREV_G2],T=l[m+I.PREV_B2],v=l[m],y=this.getCurvePercent(m/I.ENTRIES-1,1-(i-v)/(l[m+I.PREV_TIME]-v)),S+=(l[m+I.R]-S)*y,A+=(l[m+I.G]-A)*y,x+=(l[m+I.B]-x)*y,E+=(l[m+I.A]-E)*y,b+=(l[m+I.R2]-b)*y,w+=(l[m+I.G2]-w)*y,T+=(l[m+I.B2]-T)*y),1==s?(h.color.set(S,A,x,E),h.darkColor.set(b,w,T,1)):(u=h.color,d=h.darkColor,r==e.setup&&(u.setFromColor(h.data.color),d.setFromColor(h.data.darkColor)),u.add((S-u.r)*s,(A-u.g)*s,(x-u.b)*s,(E-u.a)*s),d.add((b-d.r)*s,(w-d.g)*s,(T-d.b)*s,0))}}},I.ENTRIES=8,I.PREV_TIME=-8,I.PREV_R=-7,I.PREV_G=-6,I.PREV_B=-5,I.PREV_A=-4,I.PREV_R2=-3,I.PREV_G2=-2,I.PREV_B2=-1,I.R=1,I.G=2,I.B=3,I.A=4,I.R2=5,I.G2=6,I.B2=7,I);function I(e){var n=C.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*I.ENTRIES),n}t.TwoColorTimeline=M;var P=(k.prototype.getPropertyId=function(){return(s.attachment<<24)+this.slotIndex},k.prototype.getFrameCount=function(){return this.frames.length},k.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},k.prototype.apply=function(t,n,a,s,r,c,h){var l,u,d,p=t.slots[this.slotIndex];p.bone.active&&(h!=i.mixOut?a<(l=this.frames)[0]?c!=e.setup&&c!=e.first||this.setAttachment(t,p,p.data.attachmentName):(0,u=a>=l[l.length-1]?l.length-1:o.binarySearch(l,a,1)-1,d=this.attachmentNames[u],t.slots[this.slotIndex].setAttachment(null==d?null:t.getAttachment(this.slotIndex,d))):c==e.setup&&this.setAttachment(t,p,p.data.attachmentName))},k.prototype.setAttachment=function(t,e,n){e.attachment=null==n?null:t.getAttachment(this.slotIndex,n)},k);function k(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}t.AttachmentTimeline=P;var R,_=null,O=(xe(D,R=h),D.prototype.getPropertyId=function(){return(s.deform<<27)+ +this.attachment.id+this.slotIndex},D.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.frameVertices[t]=n},D.prototype.apply=function(n,i,a,s,r,c,h){var l=n.slots[this.slotIndex];if(l.bone.active){var u=l.getAttachment();if(u instanceof t.VertexAttachment&&u.deformAttachment==this.attachment){var d=l.deform;0==d.length&&(c=e.setup);var p=this.frameVertices,f=p[0].length,g=this.frames;if(a<g[0]){var m=u;switch(c){case e.setup:return void(d.length=0);case e.first:if(1==r){d.length=0;break}var v=t.Utils.setArraySize(d,f);if(null==m.bones)for(var y=m.vertices,S=0;S<f;S++)v[S]+=(y[S]-v[S])*r;else for(r=1-r,S=0;S<f;S++)v[S]*=r}}else{var A=t.Utils.setArraySize(d,f);if(a>=g[g.length-1]){var x=p[g.length-1];if(1==r)if(c==e.add)if(null==(m=u).bones){y=m.vertices;for(var E=0;E<f;E++)A[E]+=x[E]-y[E]}else for(var b=0;b<f;b++)A[b]+=x[b];else t.Utils.arrayCopy(x,0,A,0,f);else switch(c){case e.setup:if(null==u.bones){y=u.vertices;for(var w=0;w<f;w++){var T=y[w];A[w]=T+(x[w]-T)*r}}else for(var C=0;C<f;C++)A[C]=x[C]*r;break;case e.first:case e.replace:for(var M=0;M<f;M++)A[M]+=(x[M]-A[M])*r;break;case e.add:if(null==(m=u).bones){y=m.vertices;for(var I=0;I<f;I++)A[I]+=(x[I]-y[I])*r}else for(var P=0;P<f;P++)A[P]+=x[P]*r}}else{var k=o.binarySearch(g,a),R=p[k-1],_=p[k],O=g[k],D=this.getCurvePercent(k-1,1-(a-O)/(g[k-1]-O));if(1==r)if(c==e.add)if(null==(m=u).bones){y=m.vertices;for(var B=0;B<f;B++){var L=R[B];A[B]+=L+(_[B]-L)*D-y[B]}}else for(var F=0;F<f;F++)L=R[F],A[F]+=L+(_[F]-L)*D;else for(var N=0;N<f;N++)L=R[N],A[N]=L+(_[N]-L)*D;else switch(c){case e.setup:if(null==u.bones){y=u.vertices;for(var G=0;G<f;G++)L=R[G],T=y[G],A[G]=T+(L+(_[G]-L)*D-T)*r}else for(var U=0;U<f;U++)L=R[U],A[U]=(L+(_[U]-L)*D)*r;break;case e.first:case e.replace:for(var V=0;V<f;V++)L=R[V],A[V]+=(L+(_[V]-L)*D-A[V])*r;break;case e.add:if(null==(m=u).bones){y=m.vertices;for(var Y=0;Y<f;Y++)L=R[Y],A[Y]+=(L+(_[Y]-L)*D-y[Y])*r}else for(var z=0;z<f;z++)L=R[z],A[z]+=(L+(_[z]-L)*D)*r}}}}}},D);function D(e){var n=R.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e),n.frameVertices=new Array(e),null==_&&(_=t.Utils.newFloatArray(64)),n}t.DeformTimeline=O;var B=(L.prototype.getPropertyId=function(){return s.event<<24},L.prototype.getFrameCount=function(){return this.frames.length},L.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},L.prototype.apply=function(t,e,n,i,a,s,r){if(null!=i){var c=this.frames,h=this.frames.length;if(n<e)this.apply(t,e,Number.MAX_VALUE,i,a,s,r),e=-1;else if(e>=c[h-1])return;if(!(n<c[0])){var l=0;if(e<c[0])l=0;else for(var u=c[l=o.binarySearch(c,e)];0<l&&c[l-1]==u;)l--;for(;l<h&&n>=c[l];l++)i.push(this.events[l])}}},L);function L(e){this.frames=t.Utils.newFloatArray(e),this.events=new Array(e)}t.EventTimeline=B;var F=(N.prototype.getPropertyId=function(){return s.drawOrder<<24},N.prototype.getFrameCount=function(){return this.frames.length},N.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.drawOrders[t]=n},N.prototype.apply=function(n,a,s,r,c,h,l){var u=n.drawOrder,d=n.slots;if(l!=i.mixOut){var p=this.frames;if(s<p[0])h!=e.setup&&h!=e.first||t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{var f=s>=p[p.length-1]?p.length-1:o.binarySearch(p,s)-1,g=this.drawOrders[f];if(null==g)t.Utils.arrayCopy(d,0,u,0,d.length);else for(var m=0,v=g.length;m<v;m++)u[m]=d[g[m]]}}else h==e.setup&&t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length)},N);function N(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}t.DrawOrderTimeline=F;var G,U=(xe(V,G=h),V.prototype.getPropertyId=function(){return(s.ikConstraint<<24)+this.ikConstraintIndex},V.prototype.setFrame=function(t,e,n,i,a,s,r){t*=V.ENTRIES,this.frames[t]=e,this.frames[t+V.MIX]=n,this.frames[t+V.SOFTNESS]=i,this.frames[t+V.BEND_DIRECTION]=a,this.frames[t+V.COMPRESS]=s?1:0,this.frames[t+V.STRETCH]=r?1:0},V.prototype.apply=function(t,n,a,s,r,c,h){var l,u,d,p,f,g=this.frames,m=t.ikConstraints[this.ikConstraintIndex];if(m.active)if(a<g[0])switch(c){case e.setup:return m.mix=m.data.mix,m.softness=m.data.softness,m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,void(m.stretch=m.data.stretch);case e.first:m.mix+=(m.data.mix-m.mix)*r,m.softness+=(m.data.softness-m.softness)*r,m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch}else a>=g[g.length-V.ENTRIES]?c==e.setup?(m.mix=m.data.mix+(g[g.length+V.PREV_MIX]-m.data.mix)*r,m.softness=m.data.softness+(g[g.length+V.PREV_SOFTNESS]-m.data.softness)*r,h==i.mixOut?(m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch):(m.bendDirection=g[g.length+V.PREV_BEND_DIRECTION],m.compress=0!=g[g.length+V.PREV_COMPRESS],m.stretch=0!=g[g.length+V.PREV_STRETCH])):(m.mix+=(g[g.length+V.PREV_MIX]-m.mix)*r,m.softness+=(g[g.length+V.PREV_SOFTNESS]-m.softness)*r,h==i.mixIn&&(m.bendDirection=g[g.length+V.PREV_BEND_DIRECTION],m.compress=0!=g[g.length+V.PREV_COMPRESS],m.stretch=0!=g[g.length+V.PREV_STRETCH])):(u=g[(l=o.binarySearch(g,a,V.ENTRIES))+V.PREV_MIX],d=g[l+V.PREV_SOFTNESS],p=g[l],f=this.getCurvePercent(l/V.ENTRIES-1,1-(a-p)/(g[l+V.PREV_TIME]-p)),c==e.setup?(m.mix=m.data.mix+(u+(g[l+V.MIX]-u)*f-m.data.mix)*r,m.softness=m.data.softness+(d+(g[l+V.SOFTNESS]-d)*f-m.data.softness)*r,h==i.mixOut?(m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch):(m.bendDirection=g[l+V.PREV_BEND_DIRECTION],m.compress=0!=g[l+V.PREV_COMPRESS],m.stretch=0!=g[l+V.PREV_STRETCH])):(m.mix+=(u+(g[l+V.MIX]-u)*f-m.mix)*r,m.softness+=(d+(g[l+V.SOFTNESS]-d)*f-m.softness)*r,h==i.mixIn&&(m.bendDirection=g[l+V.PREV_BEND_DIRECTION],m.compress=0!=g[l+V.PREV_COMPRESS],m.stretch=0!=g[l+V.PREV_STRETCH])))},V.ENTRIES=6,V.PREV_TIME=-6,V.PREV_MIX=-5,V.PREV_SOFTNESS=-4,V.PREV_BEND_DIRECTION=-3,V.PREV_COMPRESS=-2,V.PREV_STRETCH=-1,V.MIX=1,V.SOFTNESS=2,V.BEND_DIRECTION=3,V.COMPRESS=4,V.STRETCH=5,V);function V(e){var n=G.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*V.ENTRIES),n}t.IkConstraintTimeline=U;var Y,z=(xe(W,Y=h),W.prototype.getPropertyId=function(){return(s.transformConstraint<<24)+this.transformConstraintIndex},W.prototype.setFrame=function(t,e,n,i,a,s){t*=W.ENTRIES,this.frames[t]=e,this.frames[t+W.ROTATE]=n,this.frames[t+W.TRANSLATE]=i,this.frames[t+W.SCALE]=a,this.frames[t+W.SHEAR]=s},W.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(l.active)if(i<h[0]){var u=l.data;switch(r){case e.setup:return l.rotateMix=u.rotateMix,l.translateMix=u.translateMix,l.scaleMix=u.scaleMix,void(l.shearMix=u.shearMix);case e.first:l.rotateMix+=(u.rotateMix-l.rotateMix)*s,l.translateMix+=(u.translateMix-l.translateMix)*s,l.scaleMix+=(u.scaleMix-l.scaleMix)*s,l.shearMix+=(u.shearMix-l.shearMix)*s}}else{var d,p,f,g,m=0,v=0,y=0,S=0;i>=h[h.length-W.ENTRIES]?(m=h[(d=h.length)+W.PREV_ROTATE],v=h[d+W.PREV_TRANSLATE],y=h[d+W.PREV_SCALE],S=h[d+W.PREV_SHEAR]):(m=h[(p=o.binarySearch(h,i,W.ENTRIES))+W.PREV_ROTATE],v=h[p+W.PREV_TRANSLATE],y=h[p+W.PREV_SCALE],S=h[p+W.PREV_SHEAR],f=h[p],g=this.getCurvePercent(p/W.ENTRIES-1,1-(i-f)/(h[p+W.PREV_TIME]-f)),m+=(h[p+W.ROTATE]-m)*g,v+=(h[p+W.TRANSLATE]-v)*g,y+=(h[p+W.SCALE]-y)*g,S+=(h[p+W.SHEAR]-S)*g),r==e.setup?(u=l.data,l.rotateMix=u.rotateMix+(m-u.rotateMix)*s,l.translateMix=u.translateMix+(v-u.translateMix)*s,l.scaleMix=u.scaleMix+(y-u.scaleMix)*s,l.shearMix=u.shearMix+(S-u.shearMix)*s):(l.rotateMix+=(m-l.rotateMix)*s,l.translateMix+=(v-l.translateMix)*s,l.scaleMix+=(y-l.scaleMix)*s,l.shearMix+=(S-l.shearMix)*s)}},W.ENTRIES=5,W.PREV_TIME=-5,W.PREV_ROTATE=-4,W.PREV_TRANSLATE=-3,W.PREV_SCALE=-2,W.PREV_SHEAR=-1,W.ROTATE=1,W.TRANSLATE=2,W.SCALE=3,W.SHEAR=4,W);function W(e){var n=Y.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*W.ENTRIES),n}t.TransformConstraintTimeline=z;var H,X=(xe(K,H=h),K.prototype.getPropertyId=function(){return(s.pathConstraintPosition<<24)+this.pathConstraintIndex},K.prototype.setFrame=function(t,e,n){t*=K.ENTRIES,this.frames[t]=e,this.frames[t+K.VALUE]=n},K.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<h[0])switch(r){case e.setup:return void(l.position=l.data.position);case e.first:l.position+=(l.data.position-l.position)*s}else{var u,d,p,f=0;i>=h[h.length-K.ENTRIES]?f=h[h.length+K.PREV_VALUE]:(f=h[(u=o.binarySearch(h,i,K.ENTRIES))+K.PREV_VALUE],d=h[u],p=this.getCurvePercent(u/K.ENTRIES-1,1-(i-d)/(h[u+K.PREV_TIME]-d)),f+=(h[u+K.VALUE]-f)*p),r==e.setup?l.position=l.data.position+(f-l.data.position)*s:l.position+=(f-l.position)*s}},K.ENTRIES=2,K.PREV_TIME=-2,K.PREV_VALUE=-1,K.VALUE=1,K);function K(e){var n=H.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*K.ENTRIES),n}t.PathConstraintPositionTimeline=X;var j,q=(xe(Z,j=X),Z.prototype.getPropertyId=function(){return(s.pathConstraintSpacing<<24)+this.pathConstraintIndex},Z.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<h[0])switch(r){case e.setup:return void(l.spacing=l.data.spacing);case e.first:l.spacing+=(l.data.spacing-l.spacing)*s}else{var u,d,p,f=0;i>=h[h.length-Z.ENTRIES]?f=h[h.length+Z.PREV_VALUE]:(f=h[(u=o.binarySearch(h,i,Z.ENTRIES))+Z.PREV_VALUE],d=h[u],p=this.getCurvePercent(u/Z.ENTRIES-1,1-(i-d)/(h[u+Z.PREV_TIME]-d)),f+=(h[u+Z.VALUE]-f)*p),r==e.setup?l.spacing=l.data.spacing+(f-l.data.spacing)*s:l.spacing+=(f-l.spacing)*s}},Z);function Z(t){return j.call(this,t)||this}t.PathConstraintSpacingTimeline=q;var J,Q=(xe($,J=h),$.prototype.getPropertyId=function(){return(s.pathConstraintMix<<24)+this.pathConstraintIndex},$.prototype.setFrame=function(t,e,n,i){t*=$.ENTRIES,this.frames[t]=e,this.frames[t+$.ROTATE]=n,this.frames[t+$.TRANSLATE]=i},$.prototype.apply=function(t,n,i,a,s,r,c){var h=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<h[0])switch(r){case e.setup:return l.rotateMix=l.data.rotateMix,void(l.translateMix=l.data.translateMix);case e.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*s,l.translateMix+=(l.data.translateMix-l.translateMix)*s}else{var u,d,p,f=0,g=0;i>=h[h.length-$.ENTRIES]?(f=h[h.length+$.PREV_ROTATE],g=h[h.length+$.PREV_TRANSLATE]):(f=h[(u=o.binarySearch(h,i,$.ENTRIES))+$.PREV_ROTATE],g=h[u+$.PREV_TRANSLATE],d=h[u],p=this.getCurvePercent(u/$.ENTRIES-1,1-(i-d)/(h[u+$.PREV_TIME]-d)),f+=(h[u+$.ROTATE]-f)*p,g+=(h[u+$.TRANSLATE]-g)*p),r==e.setup?(l.rotateMix=l.data.rotateMix+(f-l.data.rotateMix)*s,l.translateMix=l.data.translateMix+(g-l.data.translateMix)*s):(l.rotateMix+=(f-l.rotateMix)*s,l.translateMix+=(g-l.translateMix)*s)}},$.ENTRIES=3,$.PREV_TIME=-3,$.PREV_ROTATE=-2,$.PREV_TRANSLATE=-1,$.ROTATE=1,$.TRANSLATE=2,$);function $(e){var n=J.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*$.ENTRIES),n}t.PathConstraintMixTimeline=Q}(Se=Se||{}),function(t){var e=(n.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,n=0,i=e.length;n<i;n++){var a=e[n];if(null!=a){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var s=t*a.timeScale;if(0<a.delay){if(a.delay-=s,0<a.delay)continue;s=-a.delay,a.delay=0}var r=a.next;if(null!=r){var o=a.trackLast-r.delay;if(0<=o){for(r.delay=0,r.trackTime+=0==a.timeScale?0:(o/a.timeScale+t)*r.timeScale,a.trackTime+=s,this.setCurrent(n,r,!0);null!=r.mixingFrom;)r.mixTime+=t,r=r.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&null==a.mixingFrom){e[n]=null,this.queue.end(a),this.disposeNext(a);continue}if(null!=a.mixingFrom&&this.updateMixingFrom(a,t)){var c=a.mixingFrom;for((a.mixingFrom=null)!=c&&(c.mixingTo=null);null!=c;)this.queue.end(c),c=c.mixingFrom}a.trackTime+=s}}this.queue.drain()},n.prototype.updateMixingFrom=function(t,e){var n=t.mixingFrom;if(null==n)return!0;var i=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,0<t.mixTime&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,null!=n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)},n.prototype.apply=function(e){if(null==e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var i=this.events,a=this.tracks,s=!1,r=0,o=a.length;r<o;r++){var c=a[r];if(!(null==c||0<c.delay)){s=!0;var h=0==r?t.MixBlend.first:c.mixBlend,l=c.alpha;null!=c.mixingFrom?l*=this.applyMixingFrom(c,e,h):c.trackTime>=c.trackEnd&&null==c.next&&(l=0);var u=c.animationLast,d=c.getAnimationTime(),p=c.animation.timelines.length,f=c.animation.timelines;if(0==r&&1==l||h==t.MixBlend.add)for(var g=0;g<p;g++){t.Utils.webkit602BugfixHelper(l,h);var m=f[g];m instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(m,e,d,h,!0):m.apply(e,u,d,i,l,h,t.MixDirection.mixIn)}else{var v=c.timelineMode,y=0==c.timelinesRotation.length;y&&t.Utils.setArraySize(c.timelinesRotation,p<<1,null);var S=c.timelinesRotation;for(g=0;g<p;g++){var A=f[g],x=v[g]==n.SUBSEQUENT?h:t.MixBlend.setup;A instanceof t.RotateTimeline?this.applyRotateTimeline(A,e,d,l,x,S,g<<1,y):A instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(A,e,d,h,!0):(t.Utils.webkit602BugfixHelper(l,h),A.apply(e,u,d,i,l,x,t.MixDirection.mixIn))}}this.queueEvents(c,d),i.length=0,c.nextAnimationLast=d,c.nextTrackLast=c.trackTime}}for(var E=this.unkeyedState+n.SETUP,b=e.slots,w=0,T=e.slots.length;w<T;w++){var C,M=b[w];M.attachmentState==E&&(C=M.data.attachmentName,M.attachment=null==C?null:e.getAttachment(M.data.index,C))}return this.unkeyedState+=2,this.queue.drain(),s},n.prototype.applyMixingFrom=function(e,i,a){var s=e.mixingFrom;null!=s.mixingFrom&&this.applyMixingFrom(s,i,a);var r=0;0==e.mixDuration?(r=1,a==t.MixBlend.first&&(a=t.MixBlend.setup)):(1<(r=e.mixTime/e.mixDuration)&&(r=1),a!=t.MixBlend.first&&(a=s.mixBlend));var o=r<s.eventThreshold?this.events:null,c=r<s.attachmentThreshold,h=r<s.drawOrderThreshold,l=s.animationLast,u=s.getAnimationTime(),d=s.animation.timelines.length,p=s.animation.timelines,f=s.alpha*e.interruptAlpha,g=f*(1-r);if(a==t.MixBlend.add)for(var m=0;m<d;m++)p[m].apply(i,l,u,o,g,a,t.MixDirection.mixOut);else{var v=s.timelineMode,y=s.timelineHoldMix,S=0==s.timelinesRotation.length;S&&t.Utils.setArraySize(s.timelinesRotation,d<<1,null);var A=s.timelinesRotation;for(m=s.totalAlpha=0;m<d;m++){var x=p[m],E=t.MixDirection.mixOut,b=void 0,w=0;switch(v[m]){case n.SUBSEQUENT:if(!h&&x instanceof t.DrawOrderTimeline)continue;b=a,w=g;break;case n.FIRST:b=t.MixBlend.setup,w=g;break;case n.HOLD_SUBSEQUENT:b=a,w=f;break;case n.HOLD_FIRST:b=t.MixBlend.setup,w=f;break;default:b=t.MixBlend.setup;var T=y[m];w=f*Math.max(0,1-T.mixTime/T.mixDuration)}s.totalAlpha+=w,x instanceof t.RotateTimeline?this.applyRotateTimeline(x,i,u,w,b,A,m<<1,S):x instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(x,i,u,b,c):(t.Utils.webkit602BugfixHelper(w,a),h&&x instanceof t.DrawOrderTimeline&&b==t.MixBlend.setup&&(E=t.MixDirection.mixIn),x.apply(i,l,u,o,w,b,E))}}return 0<e.mixDuration&&this.queueEvents(s,u),this.events.length=0,s.nextAnimationLast=u,s.nextTrackLast=s.trackTime,r},n.prototype.applyAttachmentTimeline=function(e,i,a,s,r){var o,c,h=i.slots[e.slotIndex];h.bone.active&&(a<(o=e.frames)[0]?s!=t.MixBlend.setup&&s!=t.MixBlend.first||this.setAttachment(i,h,h.data.attachmentName,r):(c=a>=o[o.length-1]?o.length-1:t.Animation.binarySearch(o,a)-1,this.setAttachment(i,h,e.attachmentNames[c],r)),h.attachmentState<=this.unkeyedState&&(h.attachmentState=this.unkeyedState+n.SETUP))},n.prototype.setAttachment=function(t,e,i,a){e.attachment=null==i?null:t.getAttachment(e.data.index,i),a&&(e.attachmentState=this.unkeyedState+n.CURRENT)},n.prototype.applyRotateTimeline=function(e,n,i,a,s,r,o,c){if(c&&(r[o]=0),1!=a){var h=e,l=h.frames,u=n.bones[h.boneIndex];if(u.active){var d=0,p=0;if(i<l[0])switch(s){case t.MixBlend.setup:u.rotation=u.data.rotation;default:return;case t.MixBlend.first:d=u.rotation,p=u.data.rotation}else{var f,g,m,v;d=s==t.MixBlend.setup?u.data.rotation:u.rotation;i>=l[l.length-t.RotateTimeline.ENTRIES]?p=u.data.rotation+l[l.length+t.RotateTimeline.PREV_ROTATION]:(g=l[(f=t.Animation.binarySearch(l,i,t.RotateTimeline.ENTRIES))+t.RotateTimeline.PREV_ROTATION],m=l[f],v=h.getCurvePercent((f>>1)-1,1-(i-m)/(l[f+t.RotateTimeline.PREV_TIME]-m)),p=l[f+t.RotateTimeline.ROTATION]-g,p=g+(p-=360*(16384-(16384.499999999996-p/360|0)))*v+u.data.rotation,p-=360*(16384-(16384.499999999996-p/360|0)))}var y,S,A,x,E=0,b=p-d;0==(b-=360*(16384-(16384.499999999996-b/360|0)))?E=r[o]:(y=0,S=c?(y=0,b):(y=r[o],r[o+1]),A=0<b,x=0<=y,t.MathUtils.signum(S)!=t.MathUtils.signum(b)&&Math.abs(S)<=90&&(180<Math.abs(y)&&(y+=360*t.MathUtils.signum(y)),x=A),E=b+y-y%360,x!=A&&(E+=360*t.MathUtils.signum(y)),r[o]=E),r[o+1]=b,d+=E*a,u.rotation=d-360*(16384-(16384.499999999996-d/360|0))}}else e.apply(n,0,i,null,1,s,t.MixDirection.mixIn)},n.prototype.queueEvents=function(t,e){for(var n=t.animationStart,i=t.animationEnd,a=i-n,s=t.trackLast%a,r=this.events,o=0,c=r.length;o<c;o++){var h=r[o];if(h.time<s)break;h.time>i||this.queue.event(t,h)}for((t.loop?0==a||s>t.trackTime%a:i<=e&&t.animationLast<i)&&this.queue.complete(t);o<c;o++)r[o].time<n||this.queue.event(t,r[o])},n.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},n.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var n=e;;){var i=n.mixingFrom;if(null==i)break;this.queue.end(i),n.mixingFrom=null,n.mixingTo=null,n=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},n.prototype.setCurrent=function(t,e,n){var i=this.expandToIndex(t);this.tracks[t]=e,null!=i&&(n&&this.queue.interrupt(i),((e.mixingFrom=i).mixingTo=e).mixTime=0,null!=i.mixingFrom&&0<i.mixDuration&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},n.prototype.setAnimation=function(t,e,n){var i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,n)},n.prototype.setAnimationWith=function(t,e,n){if(null==e)throw new Error("animation cannot be null.");var i=!0,a=this.expandToIndex(t);null!=a&&(-1==a.nextTrackLast?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,i=!1):this.disposeNext(a));var s=this.trackEntry(t,e,n,a);return this.setCurrent(t,s,i),this.queue.drain(),s},n.prototype.addAnimation=function(t,e,n,i){var a=this.data.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,n,i)},n.prototype.addAnimationWith=function(t,e,n,i){if(null==e)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(null!=a)for(;null!=a.next;)a=a.next;var s,r=this.trackEntry(t,e,n,a);return null==a?(this.setCurrent(t,r,!0),this.queue.drain()):(a.next=r,i<=0&&(0!=(s=a.animationEnd-a.animationStart)?(a.loop?i+=s*(1+(a.trackTime/s|0)):i+=Math.max(s,a.trackTime),i-=this.data.getMix(a.animation,e)):i=a.trackTime)),r.delay=i,r},n.prototype.setEmptyAnimation=function(t,e){var i=this.setAnimationWith(t,n.emptyAnimation,!1);return i.mixDuration=e,i.trackEnd=e,i},n.prototype.addEmptyAnimation=function(t,e,i){i<=0&&(i-=e);var a=this.addAnimationWith(t,n.emptyAnimation,!1,i);return a.mixDuration=e,a.trackEnd=e,a},n.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var n=0,i=this.tracks.length;n<i;n++){var a=this.tracks[n];null!=a&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},n.prototype.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(t.Utils.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)},n.prototype.trackEntry=function(e,n,i,a){var s=this.trackEntryPool.obtain();return s.trackIndex=e,s.animation=n,s.loop=i,s.holdPrevious=!1,s.eventThreshold=0,s.attachmentThreshold=0,s.drawOrderThreshold=0,s.animationStart=0,s.animationEnd=n.duration,s.animationLast=-1,s.nextAnimationLast=-1,s.delay=0,s.trackTime=0,s.trackLast=-1,s.nextTrackLast=-1,s.trackEnd=Number.MAX_VALUE,s.timeScale=1,s.alpha=1,s.interruptAlpha=1,s.mixTime=0,s.mixDuration=null==a?0:this.data.getMix(a.animation,n),s.mixBlend=t.MixBlend.replace,s},n.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},n.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=0,n=this.tracks.length;e<n;e++){var i=this.tracks[e];if(null!=i){for(;null!=i.mixingFrom;)i=i.mixingFrom;for(;null!=i.mixingFrom&&i.mixBlend==t.MixBlend.add||this.computeHold(i),null!=(i=i.mixingTo););}}},n.prototype.computeHold=function(e){var i=e.mixingTo,a=e.animation.timelines,s=e.animation.timelines.length,r=t.Utils.setArraySize(e.timelineMode,s);e.timelineHoldMix.length=0;var o=t.Utils.setArraySize(e.timelineHoldMix,s),c=this.propertyIDs;if(null!=i&&i.holdPrevious)for(var h=0;h<s;h++)r[h]=c.add(a[h].getPropertyId())?n.HOLD_FIRST:n.HOLD_SUBSEQUENT;else t:for(h=0;h<s;h++){var l=a[h],u=l.getPropertyId();if(c.add(u))if(null==i||l instanceof t.AttachmentTimeline||l instanceof t.DrawOrderTimeline||l instanceof t.EventTimeline||!i.animation.hasTimeline(u))r[h]=n.FIRST;else{for(var d=i.mixingTo;null!=d;d=d.mixingTo)if(!d.animation.hasTimeline(u)){if(0<e.mixDuration){r[h]=n.HOLD_MIX,o[h]=d;continue t}break}r[h]=n.HOLD_FIRST}else r[h]=n.SUBSEQUENT}},n.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},n.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},n.prototype.removeListener=function(t){var e,n,i=g()(e=this.listeners).call(e,t);0<=i&&vr()(n=this.listeners).call(n,i,1)},n.prototype.clearListeners=function(){this.listeners.length=0},n.prototype.clearListenerNotifications=function(){this.queue.clear()},n.emptyAnimation=new t.Animation("<empty>",[],0),n.SUBSEQUENT=0,n.FIRST=1,n.HOLD_SUBSEQUENT=2,n.HOLD_FIRST=3,n.HOLD_MIX=4,n.SETUP=1,n.CURRENT=2,n);function n(e){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new o(this),this.propertyIDs=new t.IntSet,this.animationsChanged=!1,this.trackEntryPool=new t.Pool((function(){return new i})),this.data=e}t.AnimationState=e;var i=(a.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},a.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},a.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},a.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},a.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},a);function a(){this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}t.TrackEntry=i;var s,r,o=(c.prototype.start=function(t){this.objects.push(s.start),this.objects.push(t),this.animState.animationsChanged=!0},c.prototype.interrupt=function(t){this.objects.push(s.interrupt),this.objects.push(t)},c.prototype.end=function(t){this.objects.push(s.end),this.objects.push(t),this.animState.animationsChanged=!0},c.prototype.dispose=function(t){this.objects.push(s.dispose),this.objects.push(t)},c.prototype.complete=function(t){this.objects.push(s.complete),this.objects.push(t)},c.prototype.event=function(t,e){this.objects.push(s.event),this.objects.push(t),this.objects.push(e)},c.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,n=0;n<t.length;n+=2){var i=t[n],a=t[n+1];switch(i){case s.start:null!=a.listener&&a.listener.start&&a.listener.start(a);for(var r=0;r<e.length;r++)e[r].start&&e[r].start(a);break;case s.interrupt:for(null!=a.listener&&a.listener.interrupt&&a.listener.interrupt(a),r=0;r<e.length;r++)e[r].interrupt&&e[r].interrupt(a);break;case s.end:for(null!=a.listener&&a.listener.end&&a.listener.end(a),r=0;r<e.length;r++)e[r].end&&e[r].end(a);case s.dispose:for(null!=a.listener&&a.listener.dispose&&a.listener.dispose(a),r=0;r<e.length;r++)e[r].dispose&&e[r].dispose(a);this.animState.trackEntryPool.free(a);break;case s.complete:for(null!=a.listener&&a.listener.complete&&a.listener.complete(a),r=0;r<e.length;r++)e[r].complete&&e[r].complete(a);break;case s.event:var o=t[2+n++];for(null!=a.listener&&a.listener.event&&a.listener.event(a,o),r=0;r<e.length;r++)e[r].event&&e[r].event(a,o)}}this.clear(),this.drainDisabled=!1}},c.prototype.clear=function(){this.objects.length=0},c);function c(t){this.objects=[],this.drainDisabled=!1,this.animState=t}t.EventQueue=o,(r=s=t.EventType||(t.EventType={}))[r.start=0]="start",r[r.interrupt=1]="interrupt",r[r.end=2]="end",r[r.dispose=3]="dispose",r[r.complete=4]="complete",r[r.event=5]="event";var h=(l.prototype.start=function(t){},l.prototype.interrupt=function(t){},l.prototype.end=function(t){},l.prototype.dispose=function(t){},l.prototype.complete=function(t){},l.prototype.event=function(t,e){},l);function l(){}t.AnimationStateAdapter=h}(Se=Se||{}),n=Se=Se||{},Ee.prototype.setMix=function(t,e,n){var i=this.skeletonData.findAnimation(t);if(null==i)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);this.setMixWith(i,a,n)},Ee.prototype.setMixWith=function(t,e,n){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=n},Ee.prototype.getMix=function(t,e){var n=t.name+"."+e.name,i=this.animationToMixTime[n];return void 0===i?this.defaultMix:i},i=Ee,n.AnimationStateData=i,a=Se=Se||{},be.prototype.downloadText=function(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType("text/html"),this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.open("GET",t,!0),i.onload=function(){200==i.status?e(i.responseText):n(i.status,i.responseText)},i.onerror=function(){n(i.status,i.responseText)},i.send()},be.prototype.downloadBinary=function(t,e,n){var i=new XMLHttpRequest;this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status?e(new Uint8Array(i.response)):n(i.status,i.responseText)},i.onerror=function(){n(i.status,i.responseText)},i.send()},be.prototype.setRawDataURI=function(t,e){this.rawDataUris[this.pathPrefix+t]=e},be.prototype.loadBinary=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,this.downloadBinary(t,(function(n){i.assets[t]=n,e&&e(t,n),i.toLoad--,i.loaded++}),(function(e,a){i.errors[t]="Couldn't load binary "+t+": status "+status+", "+a,n&&n(t,"Couldn't load binary "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.loadText=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(n){i.assets[t]=n,e&&e(t,n),i.toLoad--,i.loaded++}),(function(e,a){i.errors[t]="Couldn't load text "+t+": status "+status+", "+a,n&&n(t,"Couldn't load text "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.loadTexture=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var a=t=this.pathPrefix+t;this.toLoad++;var s=new Image;s.crossOrigin="anonymous",s.onload=function(n){var r=i.textureLoader(s);i.assets[a]=r,i.toLoad--,i.loaded++,e&&e(t,s)},s.onerror=function(e){i.errors[t]="Couldn't load image "+t,i.toLoad--,i.loaded++,n&&n(t,"Couldn't load image "+t)},this.rawDataUris[t]&&(t=this.rawDataUris[t]),s.src=t},be.prototype.loadTextureAtlas=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var s=0<=it()(t).call(t,"/")?t.substring(0,it()(t).call(t,"/")):"";t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(r){var o={count:0},c=new Array;try{new a.TextureAtlas(r,(function(t){c.push(""==s?t:s+"/"+t);var e=document.createElement("img");return e.width=16,e.height=16,new a.FakeTexture(e)}))}catch(l){var h=l;return i.errors[t]="Couldn't load texture atlas "+t+": "+h.message,n&&n(t,"Couldn't load texture atlas "+t+": "+h.message),i.toLoad--,void i.loaded++}for(var l=0,u=c;l<u.length;l++)!function(h){var l=!1;i.loadTexture(h,(function(h,u){if(o.count++,o.count==c.length)if(l)i.errors[t]="Couldn't load texture atlas page "+h+"} of atlas "+t,n&&n(t,"Couldn't load texture atlas page "+h+" of atlas "+t),i.toLoad--,i.loaded++;else try{var d=new a.TextureAtlas(r,(function(t){return i.get(""==s?t:s+"/"+t)}));i.assets[t]=d,e&&e(t,d),i.toLoad--,i.loaded++}catch(h){var p=h;i.errors[t]="Couldn't load texture atlas "+t+": "+p.message,n&&n(t,"Couldn't load texture atlas "+t+": "+p.message),i.toLoad--,i.loaded++}}),(function(e,a){l=!0,o.count++,o.count==c.length&&(i.errors[t]="Couldn't load texture atlas page "+e+"} of atlas "+t,n&&n(t,"Couldn't load texture atlas page "+e+" of atlas "+t),i.toLoad--,i.loaded++)}))}(u[l])}),(function(e,a){i.errors[t]="Couldn't load texture atlas "+t+": status "+status+", "+a,n&&n(t,"Couldn't load texture atlas "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.get=function(t){return t=this.pathPrefix+t,this.assets[t]},be.prototype.remove=function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},be.prototype.removeAll=function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}},be.prototype.isLoadingComplete=function(){return 0==this.toLoad},be.prototype.getToLoad=function(){return this.toLoad},be.prototype.getLoaded=function(){return this.loaded},be.prototype.dispose=function(){this.removeAll()},be.prototype.hasErrors=function(){return 0<Y()(this.errors).length},be.prototype.getErrors=function(){return this.errors},s=be,a.AssetManager=s,r=Se=Se||{},we.prototype.newRegionAttachment=function(t,e,n){var i=this.atlas.findRegion(n);if(null==i)throw new Error("Region not found in atlas: "+n+" (region attachment: "+e+")");i.renderObject=i;var a=new r.RegionAttachment(e);return a.setRegion(i),a},we.prototype.newMeshAttachment=function(t,e,n){var i=this.atlas.findRegion(n);if(null==i)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+e+")");i.renderObject=i;var a=new r.MeshAttachment(e);return a.region=i,a},we.prototype.newBoundingBoxAttachment=function(t,e){return new r.BoundingBoxAttachment(e)},we.prototype.newPathAttachment=function(t,e){return new r.PathAttachment(e)},we.prototype.newPointAttachment=function(t,e){return new r.PointAttachment(e)},we.prototype.newClippingAttachment=function(t,e){return new r.ClippingAttachment(e)},o=we,r.AtlasAttachmentLoader=o,(h=(c=Se=Se||{}).BlendMode||(c.BlendMode={}))[h.Normal=0]="Normal",h[h.Additive=1]="Additive",h[h.Multiply=2]="Multiply",h[h.Screen=3]="Screen",l=Se=Se||{},Te.prototype.isActive=function(){return this.active},Te.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},Te.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},Te.prototype.updateWorldTransformWith=function(t,e,n,i,a,s,r){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=i,this.ascaleY=a,this.ashearX=s,this.ashearY=r,this.appliedValid=!0;var o=this.parent;if(null==o){var c=this.skeleton,h=n+90+r,u=c.scaleX,d=c.scaleY;return this.a=l.MathUtils.cosDeg(n+s)*i*u,this.b=l.MathUtils.cosDeg(h)*a*u,this.c=l.MathUtils.sinDeg(n+s)*i*d,this.d=l.MathUtils.sinDeg(h)*a*d,this.worldX=t*u+c.x,void(this.worldY=e*d+c.y)}var p=o.a,f=o.b,g=o.c,m=o.d;switch(this.worldX=p*t+f*e+o.worldX,this.worldY=g*t+m*e+o.worldY,this.data.transformMode){case l.TransformMode.Normal:h=n+90+r;var v=l.MathUtils.cosDeg(n+s)*i,y=l.MathUtils.cosDeg(h)*a,S=l.MathUtils.sinDeg(n+s)*i,A=l.MathUtils.sinDeg(h)*a;return this.a=p*v+f*S,this.b=p*y+f*A,this.c=g*v+m*S,void(this.d=g*y+m*A);case l.TransformMode.OnlyTranslation:h=n+90+r,this.a=l.MathUtils.cosDeg(n+s)*i,this.b=l.MathUtils.cosDeg(h)*a,this.c=l.MathUtils.sinDeg(n+s)*i,this.d=l.MathUtils.sinDeg(h)*a;break;case l.TransformMode.NoRotationOrReflection:var x,E=n+s-(x=1e-4<(w=p*p+g*g)?(w=Math.abs(p*m-f*g)/w,p/=this.skeleton.scaleX,f=(g/=this.skeleton.scaleY)*w,m=p*w,Math.atan2(g,p)*l.MathUtils.radDeg):(g=p=0,90-Math.atan2(m,f)*l.MathUtils.radDeg)),b=n+r-x+90;v=l.MathUtils.cosDeg(E)*i,y=l.MathUtils.cosDeg(b)*a,S=l.MathUtils.sinDeg(E)*i,A=l.MathUtils.sinDeg(b)*a;this.a=p*v-f*S,this.b=p*y-f*A,this.c=g*v+m*S,this.d=g*y+m*A;break;case l.TransformMode.NoScale:case l.TransformMode.NoScaleOrReflection:var w,T=l.MathUtils.cosDeg(n),C=l.MathUtils.sinDeg(n),M=(p*T+f*C)/this.skeleton.scaleX,I=(g*T+m*C)/this.skeleton.scaleY;1e-5<(w=Math.sqrt(M*M+I*I))&&(w=1/w),M*=w,I*=w,w=Math.sqrt(M*M+I*I),this.data.transformMode==l.TransformMode.NoScale&&p*m-f*g<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(w=-w);var P=Math.PI/2+Math.atan2(I,M),k=Math.cos(P)*w,R=Math.sin(P)*w;v=l.MathUtils.cosDeg(s)*i,y=l.MathUtils.cosDeg(90+r)*a,S=l.MathUtils.sinDeg(s)*i,A=l.MathUtils.sinDeg(90+r)*a;this.a=M*v+k*S,this.b=M*y+k*A,this.c=I*v+R*S,this.d=I*y+R*A}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY},Te.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},Te.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*l.MathUtils.radDeg},Te.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*l.MathUtils.radDeg},Te.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},Te.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},Te.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent;if(null==t)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*l.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*l.MathUtils.radDeg);var e=t.a,n=t.b,i=t.c,a=t.d,s=1/(e*a-n*i),r=this.worldX-t.worldX,o=this.worldY-t.worldY;this.ax=r*a*s-o*n*s,this.ay=o*e*s-r*i*s;var c,h=s*a,u=s*e,d=s*n,p=s*i,f=h*this.a-d*this.c,g=h*this.b-d*this.d,m=u*this.c-p*this.a,v=u*this.d-p*this.b;this.ashearX=0,this.ascaleX=Math.sqrt(f*f+m*m),1e-4<this.ascaleX?(c=f*v-g*m,this.ascaleY=c/this.ascaleX,this.ashearY=Math.atan2(f*g+m*v,c)*l.MathUtils.radDeg,this.arotation=Math.atan2(m,f)*l.MathUtils.radDeg):(this.ascaleX=0,this.ascaleY=Math.sqrt(g*g+v*v),this.ashearY=0,this.arotation=90-Math.atan2(v,g)*l.MathUtils.radDeg)},Te.prototype.worldToLocal=function(t){var e=this.a,n=this.b,i=this.c,a=this.d,s=1/(e*a-n*i),r=t.x-this.worldX,o=t.y-this.worldY;return t.x=r*a*s-o*n*s,t.y=o*e*s-r*i*s,t},Te.prototype.localToWorld=function(t){var e=t.x,n=t.y;return t.x=e*this.a+n*this.b+this.worldX,t.y=e*this.c+n*this.d+this.worldY,t},Te.prototype.worldToLocalRotation=function(t){var e=l.MathUtils.sinDeg(t),n=l.MathUtils.cosDeg(t);return Math.atan2(this.a*e-this.c*n,this.d*n-this.b*e)*l.MathUtils.radDeg+this.rotation-this.shearX},Te.prototype.localToWorldRotation=function(t){t-=this.rotation-this.shearX;var e=l.MathUtils.sinDeg(t),n=l.MathUtils.cosDeg(t);return Math.atan2(n*this.c+e*this.d,n*this.a+e*this.b)*l.MathUtils.radDeg},Te.prototype.rotateWorld=function(t){var e=this.a,n=this.b,i=this.c,a=this.d,s=l.MathUtils.cosDeg(t),r=l.MathUtils.sinDeg(t);this.a=s*e-r*i,this.b=s*n-r*a,this.c=r*e+s*i,this.d=r*n+s*a,this.appliedValid=!1},u=Te,l.Bone=u,(d=Se=Se||{}).BoneData=function(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=p.Normal,this.skinRequired=!1,this.color=new d.Color,t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n},(f=p=d.TransformMode||(d.TransformMode={}))[f.Normal=0]="Normal",f[f.OnlyTranslation=1]="OnlyTranslation",f[f.NoRotationOrReflection=2]="NoRotationOrReflection",f[f.NoScale=3]="NoScale",f[f.NoScaleOrReflection=4]="NoScaleOrReflection",(Se||(Se={})).ConstraintData=function(t,e,n){this.name=t,this.order=e,this.skinRequired=n},(Se||(Se={})).Event=function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e},(Se||(Se={})).EventData=function(t){this.name=t},m=Se=Se||{},Ce.prototype.isActive=function(){return this.active},Ce.prototype.apply=function(){this.update()},Ce.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}},Ce.prototype.apply1=function(t,e,n,i,a,s,r){t.appliedValid||t.updateAppliedTransform();var o=t.parent,c=o.a,h=o.b,l=o.c,u=o.d,d=-t.ashearX-t.arotation,p=0,f=0;switch(t.data.transformMode){case m.TransformMode.OnlyTranslation:p=e-t.worldX,f=n-t.worldY;break;case m.TransformMode.NoRotationOrReflection:var g=Math.abs(c*u-h*l)/(c*c+l*l),v=c/t.skeleton.scaleX,y=l/t.skeleton.scaleY;h=-y*g*t.skeleton.scaleX,u=v*g*t.skeleton.scaleY;d+=Math.atan2(y,v)*m.MathUtils.radDeg;default:var S=e-o.worldX,A=n-o.worldY,x=c*u-h*l;p=(S*u-A*h)/x-t.ax,f=(A*c-S*l)/x-t.ay}d+=Math.atan2(f,p)*m.MathUtils.radDeg,t.ascaleX<0&&(d+=180),180<d?d-=360:d<-180&&(d+=360);var E=t.ascaleX,b=t.ascaleY;if(i||a){switch(t.data.transformMode){case m.TransformMode.NoScale:case m.TransformMode.NoScaleOrReflection:p=e-t.worldX,f=n-t.worldY}var w=t.data.length*E,T=Math.sqrt(p*p+f*f);(i&&T<w||a&&w<T&&1e-4<w)&&(E*=g=(T/w-1)*r+1,s&&(b*=g))}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*r,E,b,t.ashearX,t.ashearY)},Ce.prototype.apply2=function(t,e,n,i,a,s,r,o){if(0!=o){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var c,h=t.ax,l=t.ay,u=t.ascaleX,d=u,p=t.ascaleY,f=e.ascaleX,g=0,v=0;v=u<0?(u=-u,g=180,-1):(g=0,1);p<0&&(p=-p,v=-v),c=f<0?(f=-f,180):0;var y=e.ax,S=0,A=0,x=t.a,E=t.b,b=t.c,w=t.d,T=Math.abs(u-p)<=1e-4,C=T?(A=x*y+E*(S=e.ay)+t.worldX,b*y+w*S+t.worldY):(S=0,A=x*y+t.worldX,b*y+t.worldY),M=t.parent;x=M.a,E=M.b;b=M.c;var I,P=1/(x*(w=M.d)-E*b),k=A-M.worldX,R=C-M.worldY,_=(k*w-R*E)*P-h,O=(R*x-k*b)*P-l,D=Math.sqrt(_*_+O*O),B=e.data.length*f;if(D<1e-4)return this.apply1(t,n,i,!1,s,!1,o),void e.updateWorldTransformWith(y,S,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var L,F,N,G=((k=n-M.worldX)*w-(R=i-M.worldY)*E)*P-h,U=(R*x-k*b)*P-l,V=G*G+U*U;0!=r&&(r*=u*(f+1)/2,0<(F=(L=Math.sqrt(V))-D-B*u+r)&&(V=(G-=(N=(F-r*(1-(N=Math.min(1,F/(2*r))-1)*N))/L)*G)*G+(U-=N*U)*U));t:if(T){var Y=(V-D*D-(B*=u)*B)/(2*D*B);Y<-1?Y=-1:1<Y&&(Y=1,s&&(d*=(Math.sqrt(V)/(D+B)-1)*o+1)),I=Math.acos(Y)*a,x=D+B*Y,E=B*Math.sin(I),rt=Math.atan2(U*x-G*E,G*x+U*E)}else{var z=(x=u*B)*x,W=(E=p*B)*E,H=Math.atan2(U,G),X=-2*W*D,K=W-z;if(0<=(w=X*X-4*K*(b=W*D*D+z*V-z*W))){var j=Math.sqrt(w);X<0&&(j=-j);var q=(j=-(X+j)/2)/K,Z=b/j,J=Math.abs(q)<Math.abs(Z)?q:Z;if(J*J<=V){R=Math.sqrt(V-J*J)*a,rt=H-Math.atan2(R,J),I=Math.atan2(R/p,(J-D)/u);break t}}var Q=m.MathUtils.PI,$=D-x,tt=$*$,et=0,nt=0,it=D+x,at=it*it,st=0;-1<=(b=-x*D/(z-W))&&b<=1&&(b=Math.acos(b),(w=(k=x*Math.cos(b)+D)*k+(R=E*Math.sin(b))*R)<tt&&(Q=b,tt=w,$=k,et=R),at<w&&(nt=b,at=w,it=k,st=R)),I=V<=(tt+at)/2?(rt=H-Math.atan2(et*a,$),Q*a):(rt=H-Math.atan2(st*a,it),nt*a)}var rt,ot=Math.atan2(S,y)*v,ct=t.arotation;180<(rt=(rt-ot)*m.MathUtils.radDeg+g-ct)?rt-=360:rt<-180&&(rt+=360),t.updateWorldTransformWith(h,l,ct+rt*o,d,t.ascaleY,0,0),ct=e.arotation,180<(I=((I+ot)*m.MathUtils.radDeg-e.ashearX)*v+c-ct)?I-=360:I<-180&&(I+=360),e.updateWorldTransformWith(y,S,ct+I*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()},v=Ce,m.IkConstraint=v,y=Se=Se||{},S=y.ConstraintData,xe(Me,S),A=Me,y.IkConstraintData=A,x=Se=Se||{},Ie.prototype.isActive=function(){return this.active},Ie.prototype.apply=function(){this.update()},Ie.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof x.PathAttachment){var e=this.rotateMix,n=this.translateMix,i=0<e;if(0<n||i){var a=this.data,s=a.spacingMode==x.SpacingMode.Percent,r=a.rotateMode,o=r==x.RotateMode.Tangent,c=r==x.RotateMode.ChainScale,h=this.bones.length,l=o?h:h+1,u=this.bones,d=x.Utils.setArraySize(this.spaces,l),p=null,f=this.spacing;if(c||!s){c&&(p=x.Utils.setArraySize(this.lengths,h));for(var g=a.spacingMode==x.SpacingMode.Length,m=0,v=l-1;m<v;){var y,S,A=(M=u[m]).data.length;A<Ie.epsilon?(c&&(p[m]=0),d[++m]=0):s?(c&&(P=A*M.a,k=A*M.c,y=Math.sqrt(P*P+k*k),p[m]=y),d[++m]=f):(P=A*M.a,k=A*M.c,S=Math.sqrt(P*P+k*k),c&&(p[m]=S),d[++m]=(g?A+f:f)*S/A)}}else for(m=1;m<l;m++)d[m]=f;var E=this.computeWorldPositions(t,l,o,a.positionMode==x.PositionMode.Percent,s),b=E[0],w=E[1],T=a.offsetRotation,C=!1;0==T?C=r==x.RotateMode.Chain:(C=!1,T*=0<(I=this.target.bone).a*I.d-I.b*I.c?x.MathUtils.degRad:-x.MathUtils.degRad);m=0;for(var M,I=3;m<h;m++,I+=3){(M=u[m]).worldX+=(b-M.worldX)*n,M.worldY+=(w-M.worldY)*n;var P,k,R,_,O,D,B,L,F,N,G,U,V=(P=E[I])-b,Y=(k=E[I+1])-w;!c||0!=(R=p[m])&&(_=(Math.sqrt(V*V+Y*Y)/R-1)*e+1,M.a*=_,M.c*=_),b=P,w=k,i&&(O=M.a,D=M.b,B=M.c,L=M.d,N=F=U=0,U=o?E[I-1]:0==d[m+1]?E[I+2]:Math.atan2(Y,V),U-=Math.atan2(B,O),C?(F=Math.cos(U),N=Math.sin(U),b+=((G=M.data.length)*(F*O-N*B)-V)*e,w+=(G*(N*O+F*B)-Y)*e):U+=T,U>x.MathUtils.PI?U-=x.MathUtils.PI2:U<-x.MathUtils.PI&&(U+=x.MathUtils.PI2),U*=e,F=Math.cos(U),N=Math.sin(U),M.a=F*O-N*B,M.b=F*D-N*L,M.c=N*O+F*B,M.d=N*D+F*L),M.appliedValid=!1}}}},Ie.prototype.computeWorldPositions=function(t,e,n,i,a){var s=this.target,r=this.position,o=this.spaces,c=x.Utils.setArraySize(this.positions,3*e+2),h=null,l=t.closed,u=t.worldVerticesLength,d=u/6,p=Ie.NONE;if(!t.constantSpeed){var f=t.lengths,g=f[d-=l?1:2];if(i&&(r*=g),a)for(var m=1;m<e;m++)o[m]*=g;h=x.Utils.setArraySize(this.world,8);m=0;for(var v=0,y=0;m<e;m++,v+=3){var S=r+=W=o[m];if(l)(S%=g)<0&&(S+=g),y=0;else{if(S<0){p!=Ie.BEFORE&&(p=Ie.BEFORE,t.computeWorldVertices(s,2,4,h,0,2)),this.addBeforePosition(S,h,0,c,v);continue}if(g<S){p!=Ie.AFTER&&(p=Ie.AFTER,t.computeWorldVertices(s,u-6,4,h,0,2)),this.addAfterPosition(S-g,h,0,c,v);continue}}for(;;y++){var A=f[y];if(!(A<S)){0==y?S/=A:S=(S-(K=f[y-1]))/(A-K);break}}y!=p&&(p=y,l&&y==d?(t.computeWorldVertices(s,u-4,4,h,0,2),t.computeWorldVertices(s,0,4,h,4,2)):t.computeWorldVertices(s,6*y+2,8,h,0,2)),this.addCurvePosition(S,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],c,v,n||0<m&&0==W)}return c}l?(u+=2,h=x.Utils.setArraySize(this.world,u),t.computeWorldVertices(s,2,u-4,h,0,2),t.computeWorldVertices(s,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(d--,u-=4,h=x.Utils.setArraySize(this.world,u),t.computeWorldVertices(s,2,u,h,0,2));for(var E=x.Utils.setArraySize(this.curves,d),b=0,w=h[0],T=h[1],C=0,M=0,I=0,P=0,k=0,R=0,_=0,O=0,D=0,B=0,L=0,F=0,N=0,G=0,U=(m=0,2);m<d;m++,U+=6)C=h[U],M=h[U+1],I=h[U+2],P=h[U+3],L=2*(_=.1875*(w-2*C+I))+(D=.09375*(3*(C-I)-w+(k=h[U+4]))),F=2*(O=.1875*(T-2*M+P))+(B=.09375*(3*(M-P)-T+(R=h[U+5]))),N=.75*(C-w)+_+.16666667*D,G=.75*(M-T)+O+.16666667*B,b+=Math.sqrt(N*N+G*G),N+=L,G+=F,L+=D,F+=B,b+=Math.sqrt(N*N+G*G),N+=L,G+=F,b+=Math.sqrt(N*N+G*G),N+=L+D,G+=F+B,b+=Math.sqrt(N*N+G*G),E[m]=b,w=k,T=R;if(r*=i?b:b/t.lengths[d-1],a)for(m=1;m<e;m++)o[m]*=b;for(var V=this.segments,Y=0,z=(m=0,v=0,y=0,0);m<e;m++,v+=3){var W;S=r+=W=o[m];if(l)(S%=b)<0&&(S+=b),y=0;else{if(S<0){this.addBeforePosition(S,h,0,c,v);continue}if(b<S){this.addAfterPosition(S-b,h,u-4,c,v);continue}}for(;;y++){var H=E[y];if(!(H<S)){0==y?S/=H:S=(S-(K=E[y-1]))/(H-K);break}}if(y!=p){var X=6*(p=y);w=h[X],T=h[X+1],C=h[X+2],M=h[X+3],I=h[X+4],P=h[X+5],L=2*(_=.03*(w-2*C+I))+(D=.006*(3*(C-I)-w+(k=h[X+6]))),F=2*(O=.03*(T-2*M+P))+(B=.006*(3*(M-P)-T+(R=h[X+7]))),N=.3*(C-w)+_+.16666667*D,G=.3*(M-T)+O+.16666667*B,Y=Math.sqrt(N*N+G*G);for(V[0]=Y,X=1;X<8;X++)N+=L,G+=F,L+=D,F+=B,Y+=Math.sqrt(N*N+G*G),V[X]=Y;N+=L,G+=F,Y+=Math.sqrt(N*N+G*G),V[8]=Y,N+=L+D,G+=F+B,Y+=Math.sqrt(N*N+G*G),V[9]=Y,z=0}for(S*=Y;;z++){var K,j=V[z];if(!(j<S)){0==z?S/=j:S=z+(S-(K=V[z-1]))/(j-K);break}}this.addCurvePosition(.1*S,w,T,C,M,I,P,k,R,c,v,n||0<m&&0==W)}return c},Ie.prototype.addBeforePosition=function(t,e,n,i,a){var s=e[n],r=e[n+1],o=e[n+2]-s,c=e[n+3]-r,h=Math.atan2(c,o);i[a]=s+t*Math.cos(h),i[a+1]=r+t*Math.sin(h),i[a+2]=h},Ie.prototype.addAfterPosition=function(t,e,n,i,a){var s=e[n+2],r=e[n+3],o=s-e[n],c=r-e[n+1],h=Math.atan2(c,o);i[a]=s+t*Math.cos(h),i[a+1]=r+t*Math.sin(h),i[a+2]=h},Ie.prototype.addCurvePosition=function(t,e,n,i,a,s,r,o,c,h,l,u){if(0==t||isNaN(t))return h[l]=e,h[l+1]=n,void(h[l+2]=Math.atan2(a-n,i-e));var d=t*t,p=d*t,f=1-t,g=f*f,m=g*f,v=f*t,y=3*v,S=f*y,A=y*t,x=e*m+i*S+s*A+o*p,E=n*m+a*S+r*A+c*p;h[l]=x,h[l+1]=E,u&&(h[l+2]=t<.001?Math.atan2(a-n,i-e):Math.atan2(E-(n*g+a*v*2+r*d),x-(e*g+i*v*2+s*d)))},Ie.NONE=-1,Ie.BEFORE=-2,Ie.AFTER=-3,Ie.epsilon=1e-5,E=Ie,x.PathConstraint=E,b=Se=Se||{},w=b.ConstraintData,xe(Pe,w),I=Pe,b.PathConstraintData=I,(T=b.PositionMode||(b.PositionMode={}))[T.Fixed=0]="Fixed",T[T.Percent=1]="Percent",(C=b.SpacingMode||(b.SpacingMode={}))[C.Length=0]="Length",C[C.Fixed=1]="Fixed",C[C.Percent=2]="Percent",(M=b.RotateMode||(b.RotateMode={}))[M.Tangent=0]="Tangent",M[M.Chain=1]="Chain",M[M.ChainScale=2]="ChainScale",P=Se=Se||{},ke.prototype.loaded=function(){var t=0;for(var e in this.assets)t++;return t},k=ke,Re.prototype.queueAsset=function(t,e,n){var i=this.clientAssets[t];return null==i&&(i=new k(t),this.clientAssets[t]=i),null!==e&&(i.textureLoader=e),i.toLoad.push(n),this.queuedAssets[n]!==n&&(this.queuedAssets[n]=n,!0)},Re.prototype.loadText=function(t,e){var n,i=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((n=new XMLHttpRequest).overrideMimeType("text/html"),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200<=n.status&&n.status<300?i.rawAssets[e]=n.responseText:i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send())},Re.prototype.loadJson=function(t,e){var n,i=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((n=new XMLHttpRequest).overrideMimeType("text/html"),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200<=n.status&&n.status<300?i.rawAssets[e]=JSON.parse(n.responseText):i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send())},Re.prototype.loadTexture=function(t,e,n){var i,a=this;n=this.pathPrefix+n,this.queueAsset(t,e,n)&&("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document||"undefined"==typeof importScripts?((i=new Image).crossOrigin="anonymous",i.onload=function(t){a.rawAssets[n]=i},i.onerror=function(t){a.errors[n]="Couldn't load image "+n},i.src=n):fetch(n,{mode:"cors"}).then((function(t){return t.ok||(a.errors[n]="Couldn't load image "+n),t.blob()})).then((function(t){return createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(t){a.rawAssets[n]=t})))},Re.prototype.get=function(t,e){e=this.pathPrefix+e;var n=this.clientAssets[t];return null==n||n.assets[e]},Re.prototype.updateClientAssets=function(t){for(var e=!("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document)&&"undefined"!=typeof importScripts,n=0;n<t.toLoad.length;n++){var i=t.toLoad[n];if(null==t.assets[i]){var a=this.rawAssets[i];if(null==a)continue;e?a instanceof ImageBitmap?t.assets[i]=t.textureLoader(a):t.assets[i]=a:a instanceof HTMLImageElement?t.assets[i]=t.textureLoader(a):t.assets[i]=a}}},Re.prototype.isLoadingComplete=function(t){var e=this.clientAssets[t];return null==e||(this.updateClientAssets(e),e.toLoad.length==e.loaded())},Re.prototype.dispose=function(){},Re.prototype.hasErrors=function(){return 0<Y()(this.errors).length},Re.prototype.getErrors=function(){return this.errors},R=Re,P.SharedAssetManager=R,_=Se=Se||{},_e.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,n=t.length;e<n;e++)(a=t[e]).sorted=a.data.skinRequired,a.active=!a.sorted;if(null!=this.skin){var i=this.skin.bones;for(e=0,n=this.skin.bones.length;e<n;e++)for(var a=this.bones[i[e].index];a.sorted=!1,a.active=!0,null!=(a=a.parent););}var s=this.ikConstraints,r=this.transformConstraints,o=this.pathConstraints,c=s.length,h=r.length,l=o.length,u=c+h+l;t:for(e=0;e<u;e++){for(var d=0;d<c;d++)if((p=s[d]).data.order==e){this.sortIkConstraint(p);continue t}for(d=0;d<h;d++)if((p=r[d]).data.order==e){this.sortTransformConstraint(p);continue t}var p;for(d=0;d<l;d++)if((p=o[d]).data.order==e){this.sortPathConstraint(p);continue t}}for(e=0,n=t.length;e<n;e++)this.sortBone(t[e])},_e.prototype.sortIkConstraint=function(t){var e,n,i,a,s;t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&_.Utils.contains(this.skin.constraints,t.data,!0)),t.active&&(n=t.target,this.sortBone(n),a=(i=t.bones)[0],this.sortBone(a),1<i.length&&(s=i[i.length-1],-1<g()(e=this._updateCache).call(e,s)||this.updateCacheReset.push(s)),this._updateCache.push(t),this.sortReset(a.children),i[i.length-1].sorted=!0)},_e.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&_.Utils.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,n=e.data.index,i=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,i),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,i);for(var a=0,s=this.data.skins.length;a<s;a++)this.sortPathConstraintAttachment(this.data.skins[a],n,i);var r=e.getAttachment();r instanceof _.PathAttachment&&this.sortPathConstraintAttachmentWith(r,i);var o=t.bones,c=o.length;for(a=0;a<c;a++)this.sortBone(o[a]);for(this._updateCache.push(t),a=0;a<c;a++)this.sortReset(o[a].children);for(a=0;a<c;a++)o[a].sorted=!0}},_e.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&_.Utils.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,n=e.length;if(t.data.local)for(var i=0;i<n;i++){var a,s=e[i];this.sortBone(s.parent),-1<g()(a=this._updateCache).call(a,s)||this.updateCacheReset.push(s)}else for(i=0;i<n;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var r=0;r<n;r++)this.sortReset(e[r].children);for(r=0;r<n;r++)e[r].sorted=!0}},_e.prototype.sortPathConstraintAttachment=function(t,e,n){var i=t.attachments[e];if(i)for(var a in i)this.sortPathConstraintAttachmentWith(i[a],n)},_e.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof _.PathAttachment){var n=t.bones;if(null==n)this.sortBone(e);else for(var i=this.bones,a=0;a<n.length;)for(var s=n[a++],r=a+s;a<r;a++){var o=n[a];this.sortBone(i[o])}}},_e.prototype.sortBone=function(t){var e;t.sorted||(null!=(e=t.parent)&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t))},_e.prototype.sortReset=function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},_e.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,n=t.length;e<n;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}var a=this._updateCache;for(e=0,n=a.length;e<n;e++)a[e].update()},_e.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},_e.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,n=t.length;e<n;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(e=0,n=i.length;e<n;e++)(o=i[e]).mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;var a=this.transformConstraints;for(e=0,n=a.length;e<n;e++){var s=(o=a[e]).data;o.rotateMix=s.rotateMix,o.translateMix=s.translateMix,o.scaleMix=s.scaleMix,o.shearMix=s.shearMix}var r=this.pathConstraints;for(e=0,n=r.length;e<n;e++){var o;s=(o=r[e]).data;o.position=s.position,o.spacing=s.spacing,o.rotateMix=s.rotateMix,o.translateMix=s.translateMix}},_e.prototype.setSlotsToSetupPose=function(){var t=this.slots;_.Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,n=t.length;e<n;e++)t[e].setToSetupPose()},_e.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},_e.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},_e.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},_e.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},_e.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},_e.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},_e.prototype.setSkin=function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,n=0,i=e.length;n<i;n++){var a,s=e[n],r=s.data.attachmentName;null==r||null!=(a=t.getAttachment(n,r))&&s.setAttachment(a)}this.skin=t,this.updateCache()}},_e.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},_e.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var n=this.skin.getAttachment(t,e);if(null!=n)return n}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},_e.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var n=this.slots,i=0,a=n.length;i<a;i++){var s=n[i];if(s.data.name==t){var r=null;if(null!=e&&null==(r=this.getAttachment(i,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void s.setAttachment(r)}}throw new Error("Slot not found: "+t)},_e.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},_e.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},_e.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},_e.prototype.getBounds=function(t,e,n){if(void 0===n&&(n=new Array(2)),null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var i=this.drawOrder,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=0,h=i.length;c<h;c++){var l=i[c];if(l.bone.active){var u,d=0,p=null,f=l.getAttachment();if(f instanceof _.RegionAttachment?(d=8,p=_.Utils.setArraySize(n,d,0),f.computeWorldVertices(l.bone,p,0,2)):f instanceof _.MeshAttachment&&(d=(u=f).worldVerticesLength,p=_.Utils.setArraySize(n,d,0),u.computeWorldVertices(l,0,d,p,0,2)),null!=p)for(var g=0,m=p.length;g<m;g+=2){var v=p[g],y=p[g+1];a=Math.min(a,v),s=Math.min(s,y),r=Math.max(r,v),o=Math.max(o,y)}}}t.set(a,s),e.set(r-a,o-s)},_e.prototype.update=function(t){this.time+=t},O=_e,_.Skeleton=O,function(t){var e=(n.prototype.readSkeletonData=function(e){var a=this.scale,s=new t.SkeletonData;s.name="";var r=new i(e);if(s.hash=r.readString(),s.version=r.readString(),"3.8.75"==s.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");s.x=r.readFloat(),s.y=r.readFloat(),s.width=r.readFloat(),s.height=r.readFloat();var o=r.readBoolean();o&&(s.fps=r.readFloat(),s.imagesPath=r.readString(),s.audioPath=r.readString());for(var c=0,h=(c=r.readInt(!0),0);h<c;h++)r.strings.push(r.readString());for(c=r.readInt(!0),h=0;h<c;h++){var l=r.readString(),u=0==h?null:s.bones[r.readInt(!0)];(f=new t.BoneData(h,l,u)).rotation=r.readFloat(),f.x=r.readFloat()*a,f.y=r.readFloat()*a,f.scaleX=r.readFloat(),f.scaleY=r.readFloat(),f.shearX=r.readFloat(),f.shearY=r.readFloat(),f.length=r.readFloat()*a,f.transformMode=n.TransformModeValues[r.readInt(!0)],f.skinRequired=r.readBoolean(),o&&t.Color.rgba8888ToColor(f.color,r.readInt32()),s.bones.push(f)}for(c=r.readInt(!0),h=0;h<c;h++){var d=r.readString(),p=s.bones[r.readInt(!0)],f=new t.SlotData(h,d,p);t.Color.rgba8888ToColor(f.color,r.readInt32());var g=r.readInt32();-1!=g&&t.Color.rgb888ToColor(f.darkColor=new t.Color,g),f.attachmentName=r.readStringRef(),f.blendMode=n.BlendModeValues[r.readInt(!0)],s.slots.push(f)}c=r.readInt(!0);h=0;for(var m=void 0;h<c;h++){(f=new t.IkConstraintData(r.readString())).order=r.readInt(!0),f.skinRequired=r.readBoolean(),m=r.readInt(!0);for(var v=0;v<m;v++)f.bones.push(s.bones[r.readInt(!0)]);f.target=s.bones[r.readInt(!0)],f.mix=r.readFloat(),f.softness=r.readFloat()*a,f.bendDirection=r.readByte(),f.compress=r.readBoolean(),f.stretch=r.readBoolean(),f.uniform=r.readBoolean(),s.ikConstraints.push(f)}for(c=r.readInt(!0),m=void(h=0);h<c;h++){for((f=new t.TransformConstraintData(r.readString())).order=r.readInt(!0),f.skinRequired=r.readBoolean(),m=r.readInt(!0),v=0;v<m;v++)f.bones.push(s.bones[r.readInt(!0)]);f.target=s.bones[r.readInt(!0)],f.local=r.readBoolean(),f.relative=r.readBoolean(),f.offsetRotation=r.readFloat(),f.offsetX=r.readFloat()*a,f.offsetY=r.readFloat()*a,f.offsetScaleX=r.readFloat(),f.offsetScaleY=r.readFloat(),f.offsetShearY=r.readFloat(),f.rotateMix=r.readFloat(),f.translateMix=r.readFloat(),f.scaleMix=r.readFloat(),f.shearMix=r.readFloat(),s.transformConstraints.push(f)}for(c=r.readInt(!0),m=void(h=0);h<c;h++){for((f=new t.PathConstraintData(r.readString())).order=r.readInt(!0),f.skinRequired=r.readBoolean(),m=r.readInt(!0),v=0;v<m;v++)f.bones.push(s.bones[r.readInt(!0)]);f.target=s.slots[r.readInt(!0)],f.positionMode=n.PositionModeValues[r.readInt(!0)],f.spacingMode=n.SpacingModeValues[r.readInt(!0)],f.rotateMode=n.RotateModeValues[r.readInt(!0)],f.offsetRotation=r.readFloat(),f.position=r.readFloat(),f.positionMode==t.PositionMode.Fixed&&(f.position*=a),f.spacing=r.readFloat(),f.spacingMode!=t.SpacingMode.Length&&f.spacingMode!=t.SpacingMode.Fixed||(f.spacing*=a),f.rotateMix=r.readFloat(),f.translateMix=r.readFloat(),s.pathConstraints.push(f)}var y=this.readSkin(r,s,!0,o);for(null!=y&&(s.defaultSkin=y,s.skins.push(y)),h=s.skins.length,t.Utils.setArraySize(s.skins,c=h+r.readInt(!0));h<c;h++)s.skins[h]=this.readSkin(r,s,!1,o);for(c=this.linkedMeshes.length,h=0;h<c;h++){var S=this.linkedMeshes[h],A=null==S.skin?s.defaultSkin:s.findSkin(S.skin);if(null==A)throw new Error("Skin not found: "+S.skin);var x=A.getAttachment(S.slotIndex,S.parent);if(null==x)throw new Error("Parent mesh not found: "+S.parent);S.mesh.deformAttachment=S.inheritDeform?x:S.mesh,S.mesh.setParentMesh(x),S.mesh.updateUVs()}for(this.linkedMeshes.length=0,c=r.readInt(!0),h=0;h<c;h++)(f=new t.EventData(r.readStringRef())).intValue=r.readInt(!1),f.floatValue=r.readFloat(),f.stringValue=r.readString(),f.audioPath=r.readString(),null!=f.audioPath&&(f.volume=r.readFloat(),f.balance=r.readFloat()),s.events.push(f);for(c=r.readInt(!0),h=0;h<c;h++)s.animations.push(this.readAnimation(r,r.readString(),s));return s},n.prototype.readSkin=function(e,n,i,a){var s=null,r=0;if(i){if(0==(r=e.readInt(!0)))return null;s=new t.Skin("default")}else{(s=new t.Skin(e.readStringRef())).bones.length=e.readInt(!0);for(var o=0,c=s.bones.length;o<c;o++)s.bones[o]=n.bones[e.readInt(!0)];for(o=0,c=e.readInt(!0);o<c;o++)s.constraints.push(n.ikConstraints[e.readInt(!0)]);for(o=0,c=e.readInt(!0);o<c;o++)s.constraints.push(n.transformConstraints[e.readInt(!0)]);for(o=0,c=e.readInt(!0);o<c;o++)s.constraints.push(n.pathConstraints[e.readInt(!0)]);r=e.readInt(!0)}for(o=0;o<r;o++)for(var h=e.readInt(!0),l=0,u=e.readInt(!0);l<u;l++){var d=e.readStringRef(),p=this.readAttachment(e,n,s,h,d,a);null!=p&&s.setAttachment(h,d,p)}return s},n.prototype.readAttachment=function(e,i,a,r,o,c){var h=this.scale,l=e.readStringRef();null==l&&(l=o);var u=e.readByte();switch(n.AttachmentTypeValues[u]){case t.AttachmentType.Region:var d=e.readStringRef(),p=e.readFloat(),f=e.readFloat(),g=e.readFloat(),m=e.readFloat(),v=e.readFloat(),y=e.readFloat(),S=e.readFloat(),A=e.readInt32();null==d&&(d=l);var x=this.attachmentLoader.newRegionAttachment(a,l,d);return null==x?null:(x.path=d,x.x=f*h,x.y=g*h,x.scaleX=m,x.scaleY=v,x.rotation=p,x.width=y*h,x.height=S*h,t.Color.rgba8888ToColor(x.color,A),x.updateOffset(),x);case t.AttachmentType.BoundingBox:var E=e.readInt(!0),b=this.readVertices(e,E),w=(A=c?e.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(a,l));return null==w?null:(w.worldVerticesLength=E<<1,w.vertices=b.vertices,w.bones=b.bones,c&&t.Color.rgba8888ToColor(w.color,A),w);case t.AttachmentType.Mesh:d=e.readStringRef(),A=e.readInt32(),E=e.readInt(!0);var T=this.readFloatArray(e,E<<1,1),C=this.readShortArray(e),M=(b=this.readVertices(e,E),e.readInt(!0)),I=null;y=0,S=0;return c&&(I=this.readShortArray(e),y=e.readFloat(),S=e.readFloat()),null==d&&(d=l),null==(P=this.attachmentLoader.newMeshAttachment(a,l,d))?null:(P.path=d,t.Color.rgba8888ToColor(P.color,A),P.bones=b.bones,P.vertices=b.vertices,P.worldVerticesLength=E<<1,P.triangles=C,P.regionUVs=T,P.updateUVs(),P.hullLength=M<<1,c&&(P.edges=I,P.width=y*h,P.height=S*h),P);case t.AttachmentType.LinkedMesh:d=e.readStringRef(),A=e.readInt32();var P,k=e.readStringRef(),R=e.readStringRef(),_=e.readBoolean();y=0,S=0;return c&&(y=e.readFloat(),S=e.readFloat()),null==d&&(d=l),null==(P=this.attachmentLoader.newMeshAttachment(a,l,d))?null:(P.path=d,t.Color.rgba8888ToColor(P.color,A),c&&(P.width=y*h,P.height=S*h),this.linkedMeshes.push(new s(P,k,r,R,_)),P);case t.AttachmentType.Path:for(var O=e.readBoolean(),D=e.readBoolean(),B=(E=e.readInt(!0),b=this.readVertices(e,E),t.Utils.newArray(E/3,0)),L=0,F=B.length;L<F;L++)B[L]=e.readFloat()*h;return A=c?e.readInt32():0,null==(d=this.attachmentLoader.newPathAttachment(a,l))?null:(d.closed=O,d.constantSpeed=D,d.worldVerticesLength=E<<1,d.vertices=b.vertices,d.bones=b.bones,d.lengths=B,c&&t.Color.rgba8888ToColor(d.color,A),d);case t.AttachmentType.Point:p=e.readFloat(),f=e.readFloat(),g=e.readFloat(),A=c?e.readInt32():0;var N=this.attachmentLoader.newPointAttachment(a,l);return null==N?null:(N.x=f*h,N.y=g*h,N.rotation=p,c&&t.Color.rgba8888ToColor(N.color,A),N);case t.AttachmentType.Clipping:var G=e.readInt(!0),U=(E=e.readInt(!0),b=this.readVertices(e,E),A=c?e.readInt32():0,this.attachmentLoader.newClippingAttachment(a,l));return null==U?null:(U.endSlot=i.slots[G],U.worldVerticesLength=E<<1,U.vertices=b.vertices,U.bones=b.bones,c&&t.Color.rgba8888ToColor(U.color,A),U)}return null},n.prototype.readVertices=function(e,n){var i=n<<1,a=new r,s=this.scale;if(!e.readBoolean())return a.vertices=this.readFloatArray(e,i,s),a;for(var o=new Array,c=new Array,h=0;h<n;h++){var l=e.readInt(!0);c.push(l);for(var u=0;u<l;u++)c.push(e.readInt(!0)),o.push(e.readFloat()*s),o.push(e.readFloat()*s),o.push(e.readFloat())}return a.vertices=t.Utils.toFloatArray(o),a.bones=c,a},n.prototype.readFloatArray=function(t,e,n){var i=new Array(e);if(1==n)for(var a=0;a<e;a++)i[a]=t.readFloat();else for(a=0;a<e;a++)i[a]=t.readFloat()*n;return i},n.prototype.readShortArray=function(t){for(var e=t.readInt(!0),n=new Array(e),i=0;i<e;i++)n[i]=t.readShort();return n},n.prototype.readAnimation=function(e,i,a){for(var s=new Array,r=this.scale,o=0,c=new t.Color,h=new t.Color,l=0,u=e.readInt(!0);l<u;l++)for(var d=e.readInt(!0),p=0,f=e.readInt(!0);p<f;p++){var g=e.readByte(),m=e.readInt(!0);switch(g){case n.SLOT_ATTACHMENT:(A=new t.AttachmentTimeline(m)).slotIndex=d;for(var v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readStringRef());s.push(A),o=Math.max(o,A.frames[m-1]);break;case n.SLOT_COLOR:for((A=new t.ColorTimeline(m)).slotIndex=d,v=0;v<m;v++){var y=e.readFloat();t.Color.rgba8888ToColor(c,e.readInt32()),A.setFrame(v,y,c.r,c.g,c.b,c.a),v<m-1&&this.readCurve(e,v,A)}s.push(A),o=Math.max(o,A.frames[(m-1)*t.ColorTimeline.ENTRIES]);break;case n.SLOT_TWO_COLOR:for((A=new t.TwoColorTimeline(m)).slotIndex=d,v=0;v<m;v++)y=e.readFloat(),t.Color.rgba8888ToColor(c,e.readInt32()),t.Color.rgb888ToColor(h,e.readInt32()),A.setFrame(v,y,c.r,c.g,c.b,c.a,h.r,h.g,h.b),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.TwoColorTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var S=e.readInt(!0);for(p=0,f=e.readInt(!0);p<f;p++)switch(g=e.readByte(),m=e.readInt(!0),g){case n.BONE_ROTATE:for((A=new t.RotateTimeline(m)).boneIndex=S,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.RotateTimeline.ENTRIES]);break;case n.BONE_TRANSLATE:case n.BONE_SCALE:case n.BONE_SHEAR:var A=void 0,x=1;for(g==n.BONE_SCALE?A=new t.ScaleTimeline(m):g==n.BONE_SHEAR?A=new t.ShearTimeline(m):(A=new t.TranslateTimeline(m),x=r),A.boneIndex=S,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()*x,e.readFloat()*x),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.TranslateTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var E=e.readInt(!0);m=e.readInt(!0);for((A=new t.IkConstraintTimeline(m)).ikConstraintIndex=E,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat()*r,e.readByte(),e.readBoolean(),e.readBoolean()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.IkConstraintTimeline.ENTRIES])}for(l=0,u=e.readInt(!0);l<u;l++){for(E=e.readInt(!0),m=e.readInt(!0),(A=new t.TransformConstraintTimeline(m)).transformConstraintIndex=E,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.TransformConstraintTimeline.ENTRIES])}for(l=0,u=e.readInt(!0);l<u;l++){E=e.readInt(!0);var b=a.pathConstraints[E];for(p=0,f=e.readInt(!0);p<f;p++)switch(g=e.readByte(),m=e.readInt(!0),g){case n.PATH_POSITION:case n.PATH_SPACING:A=void 0,x=1;for(g==n.PATH_SPACING?(A=new t.PathConstraintSpacingTimeline(m),b.spacingMode!=t.SpacingMode.Length&&b.spacingMode!=t.SpacingMode.Fixed||(x=r)):(A=new t.PathConstraintPositionTimeline(m),b.positionMode==t.PositionMode.Fixed&&(x=r)),A.pathConstraintIndex=E,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()*x),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.PathConstraintPositionTimeline.ENTRIES]);break;case n.PATH_MIX:for((A=new t.PathConstraintMixTimeline(m)).pathConstraintIndex=E,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.PathConstraintMixTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var w=a.skins[e.readInt(!0)];for(p=0,f=e.readInt(!0);p<f;p++){d=e.readInt(!0);for(var T=0,C=e.readInt(!0);T<C;T++){var M=w.getAttachment(d,e.readStringRef()),I=null!=M.bones,P=M.vertices,k=I?P.length/3*2:P.length;m=e.readInt(!0);for((A=new t.DeformTimeline(m)).slotIndex=d,A.attachment=M,v=0;v<m;v++){y=e.readFloat();var R=void 0,_=e.readInt(!0);if(0==_)R=I?t.Utils.newFloatArray(k):P;else{R=t.Utils.newFloatArray(k);var O=e.readInt(!0);if(_+=O,1==r)for(var D=O;D<_;D++)R[D]=e.readFloat();else for(D=O;D<_;D++)R[D]=e.readFloat()*r;if(!I){D=0;for(var B=R.length;D<B;D++)R[D]+=P[D]}}A.setFrame(v,y,R),v<m-1&&this.readCurve(e,v,A)}s.push(A),o=Math.max(o,A.frames[m-1])}}}var L=e.readInt(!0);if(0<L){A=new t.DrawOrderTimeline(L);var F=a.slots.length;for(l=0;l<L;l++){y=e.readFloat();var N=e.readInt(!0),G=t.Utils.newArray(F,0);for(p=F-1;0<=p;p--)G[p]=-1;var U=t.Utils.newArray(F-N,0),V=0,Y=0;for(p=0;p<N;p++){for(d=e.readInt(!0);V!=d;)U[Y++]=V++;G[V+e.readInt(!0)]=V++}for(;V<F;)U[Y++]=V++;for(p=F-1;0<=p;p--)-1==G[p]&&(G[p]=U[--Y]);A.setFrame(l,y,G)}s.push(A),o=Math.max(o,A.frames[L-1])}var z=e.readInt(!0);if(0<z){for(A=new t.EventTimeline(z),l=0;l<z;l++){y=e.readFloat();var W=a.events[e.readInt(!0)],H=new t.Event(y,W);H.intValue=e.readInt(!1),H.floatValue=e.readFloat(),H.stringValue=e.readBoolean()?e.readString():W.stringValue,null!=H.data.audioPath&&(H.volume=e.readFloat(),H.balance=e.readFloat()),A.setFrame(l,H)}s.push(A),o=Math.max(o,A.frames[z-1])}return new t.Animation(i,s,o)},n.prototype.readCurve=function(t,e,i){switch(t.readByte()){case n.CURVE_STEPPED:i.setStepped(e);break;case n.CURVE_BEZIER:this.setCurve(i,e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}},n.prototype.setCurve=function(t,e,n,i,a,s){t.setCurve(e,n,i,a,s)},n.AttachmentTypeValues=[0,1,2,3,4,5,6],n.TransformModeValues=[t.TransformMode.Normal,t.TransformMode.OnlyTranslation,t.TransformMode.NoRotationOrReflection,t.TransformMode.NoScale,t.TransformMode.NoScaleOrReflection],n.PositionModeValues=[t.PositionMode.Fixed,t.PositionMode.Percent],n.SpacingModeValues=[t.SpacingMode.Length,t.SpacingMode.Fixed,t.SpacingMode.Percent],n.RotateModeValues=[t.RotateMode.Tangent,t.RotateMode.Chain,t.RotateMode.ChainScale],n.BlendModeValues=[t.BlendMode.Normal,t.BlendMode.Additive,t.BlendMode.Multiply,t.BlendMode.Screen],n.BONE_ROTATE=0,n.BONE_TRANSLATE=1,n.BONE_SCALE=2,n.BONE_SHEAR=3,n.SLOT_ATTACHMENT=0,n.SLOT_COLOR=1,n.SLOT_TWO_COLOR=2,n.PATH_POSITION=0,n.PATH_SPACING=1,n.PATH_MIX=2,n.CURVE_LINEAR=0,n.CURVE_STEPPED=1,n.CURVE_BEZIER=2,n);function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}t.SkeletonBinary=e;var i=(a.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},a.prototype.readShort=function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t},a.prototype.readInt32=function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t},a.prototype.readInt=function(t){var e=this.readByte(),n=127&e;return 0!=(128&e)&&(n|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(n|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(n|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(n|=(127&this.readByte())<<28)))),t?n:n>>>1^-(1&n)},a.prototype.readStringRef=function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]},a.prototype.readString=function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",n=0;n<t;){var i=this.readByte();switch(i>>4){case 12:case 13:e+=String.fromCharCode((31&i)<<6|63&this.readByte()),n+=2;break;case 14:e+=String.fromCharCode((15&i)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:e+=String.fromCharCode(i),n++}}return e},a.prototype.readFloat=function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t},a.prototype.readBoolean=function(){return 0!=this.readByte()},a);function a(t,e,n,i){void 0===e&&(e=new Array),void 0===n&&(n=0),void 0===i&&(i=new DataView(t.buffer)),this.strings=e,this.index=n,this.buffer=i}var s=function(t,e,n,i,a){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=a},r=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.bones=t,this.vertices=e}}(Se=Se||{}),D=Se=Se||{},Oe.prototype.update=function(t,e){if(null==t)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,i=this.polygons,a=this.polygonPool,s=t.slots,r=s.length;n.length=0,a.freeAll(i);for(var o=i.length=0;o<r;o++){var c,h,l,u=s[o];u.bone.active&&(c=u.getAttachment())instanceof D.BoundingBoxAttachment&&(h=c,n.push(h),(l=a.obtain()).length!=h.worldVerticesLength&&(l=D.Utils.newFloatArray(h.worldVerticesLength)),i.push(l),h.computeWorldVertices(u,0,h.worldVerticesLength,l,0,2))}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},Oe.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.polygons,s=0,r=a.length;s<r;s++)for(var o=a[s],c=o,h=0,l=o.length;h<l;h+=2){var u=c[h],d=c[h+1];t=Math.min(t,u),e=Math.min(e,d),n=Math.max(n,u),i=Math.max(i,d)}this.minX=t,this.minY=e,this.maxX=n,this.maxY=i},Oe.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},Oe.prototype.aabbIntersectsSegment=function(t,e,n,i){var a=this.minX,s=this.minY,r=this.maxX,o=this.maxY;if(t<=a&&n<=a||e<=s&&i<=s||r<=t&&r<=n||o<=e&&o<=i)return!1;var c=(i-e)/(n-t),h=c*(a-t)+e;if(s<h&&h<o)return!0;if(s<(h=c*(r-t)+e)&&h<o)return!0;var l=(s-e)/c+t;return a<l&&l<r||a<(l=(o-e)/c+t)&&l<r},Oe.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},Oe.prototype.containsPoint=function(t,e){for(var n=this.polygons,i=0,a=n.length;i<a;i++)if(this.containsPointPolygon(n[i],t,e))return this.boundingBoxes[i];return null},Oe.prototype.containsPointPolygon=function(t,e,n){for(var i=t,a=t.length,s=a-2,r=!1,o=0;o<a;o+=2){var c,h=i[o+1],l=i[s+1];!(h<n&&n<=l||l<n&&n<=h)||(c=i[o])+(n-h)/(l-h)*(i[s]-c)<e&&(r=!r),s=o}return r},Oe.prototype.intersectsSegment=function(t,e,n,i){for(var a=this.polygons,s=0,r=a.length;s<r;s++)if(this.intersectsSegmentPolygon(a[s],t,e,n,i))return this.boundingBoxes[s];return null},Oe.prototype.intersectsSegmentPolygon=function(t,e,n,i,a){for(var s=t,r=t.length,o=e-i,c=n-a,h=e*a-n*i,l=s[r-2],u=s[r-1],d=0;d<r;d+=2){var p=s[d],f=s[d+1],g=l*f-u*p,m=l-p,v=u-f,y=o*v-c*m,S=(h*m-o*g)/y;if((l<=S&&S<=p||p<=S&&S<=l)&&(e<=S&&S<=i||i<=S&&S<=e)){var A=(h*v-c*g)/y;if((u<=A&&A<=f||f<=A&&A<=u)&&(n<=A&&A<=a||a<=A&&A<=n))return!0}l=p,u=f}return!1},Oe.prototype.getPolygon=function(t){var e;if(null==t)throw new Error("boundingBox cannot be null.");var n=g()(e=this.boundingBoxes).call(e,t);return-1==n?null:this.polygons[n]},Oe.prototype.getWidth=function(){return this.maxX-this.minX},Oe.prototype.getHeight=function(){return this.maxY-this.minY},B=Oe,D.SkeletonBounds=B,L=Se=Se||{},De.prototype.clipStart=function(t,e){if(null!=this.clipAttachment)return 0;var n=(this.clipAttachment=e).worldVerticesLength,i=L.Utils.setArraySize(this.clippingPolygon,n);e.computeWorldVertices(t,0,n,i,0,2);var a=this.clippingPolygon;De.makeClockwise(a);for(var s=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a)),r=0,o=s.length;r<o;r++){var c=s[r];De.makeClockwise(c),c.push(c[0]),c.push(c[1])}return s.length},De.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},De.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},De.prototype.isClipping=function(){return null!=this.clipAttachment},De.prototype.clipTriangles=function(t,e,n,i,a,s,r,o){var c=this.clipOutput,h=this.clippedVertices,l=this.clippedTriangles,u=this.clippingPolygons,d=this.clippingPolygons.length,p=o?12:8,f=0;h.length=0;t:for(var g=l.length=0;g<i;g+=3)for(var m=n[g]<<1,v=t[m],y=t[1+m],S=a[m],A=a[1+m],x=t[m=n[g+1]<<1],E=t[1+m],b=a[m],w=a[1+m],T=t[m=n[g+2]<<1],C=t[1+m],M=a[m],I=a[1+m],P=0;P<d;P++){var k=h.length;if(!this.clip(v,y,x,E,T,C,u[P],c)){(U=L.Utils.setArraySize(h,k+3*p))[k]=v,U[k+1]=y,U[k+2]=s.r,U[k+3]=s.g,U[k+4]=s.b,U[k+5]=s.a,o?(U[k+6]=S,U[k+7]=A,U[k+8]=r.r,U[k+9]=r.g,U[k+10]=r.b,U[k+11]=r.a,U[k+12]=x,U[k+13]=E,U[k+14]=s.r,U[k+15]=s.g,U[k+16]=s.b,U[k+17]=s.a,U[k+18]=b,U[k+19]=w,U[k+20]=r.r,U[k+21]=r.g,U[k+22]=r.b,U[k+23]=r.a,U[k+24]=T,U[k+25]=C,U[k+26]=s.r,U[k+27]=s.g,U[k+28]=s.b,U[k+29]=s.a,U[k+30]=M,U[k+31]=I,U[k+32]=r.r,U[k+33]=r.g,U[k+34]=r.b,U[k+35]=r.a):(U[k+6]=S,U[k+7]=A,U[k+8]=x,U[k+9]=E,U[k+10]=s.r,U[k+11]=s.g,U[k+12]=s.b,U[k+13]=s.a,U[k+14]=b,U[k+15]=w,U[k+16]=T,U[k+17]=C,U[k+18]=s.r,U[k+19]=s.g,U[k+20]=s.b,U[k+21]=s.a,U[k+22]=M,U[k+23]=I),k=l.length,(q=L.Utils.setArraySize(l,k+3))[k]=f,q[k+1]=f+1,q[k+2]=f+2,f+=3;continue t}var R=c.length;if(0!=R){for(var _=E-C,O=T-x,D=v-T,B=C-y,F=1/(_*D+O*(y-C)),N=R>>1,G=this.clipOutput,U=L.Utils.setArraySize(h,k+N*p),V=0;V<R;V+=2){var Y=G[V],z=G[V+1];U[k]=Y,U[k+1]=z,U[k+2]=s.r,U[k+3]=s.g,U[k+4]=s.b,U[k+5]=s.a;var W=Y-T,H=z-C,X=(_*W+O*H)*F,K=(B*W+D*H)*F,j=1-X-K;U[k+6]=S*X+b*K+M*j,U[k+7]=A*X+w*K+I*j,o&&(U[k+8]=r.r,U[k+9]=r.g,U[k+10]=r.b,U[k+11]=r.a),k+=p}k=l.length;var q=L.Utils.setArraySize(l,k+3*(N-2));for(N--,V=1;V<N;V++)q[k]=f,q[k+1]=f+V,q[k+2]=f+V+1,k+=3;f+=1+N}}},De.prototype.clip=function(t,e,n,i,a,s,r,o){var c=o,h=!1,l=null;2<=r.length%4?(l=o,o=this.scratch):l=this.scratch,l.length=0,l.push(t),l.push(e),l.push(n),l.push(i),l.push(a),l.push(s),l.push(t),l.push(e),o.length=0;for(var u=r,d=r.length-4,p=0;;p+=2){for(var f=u[p],g=u[p+1],m=u[p+2],v=u[p+3],y=f-m,S=g-v,A=l,x=l.length-2,E=o.length,b=0;b<x;b+=2){var w=A[b],T=A[b+1],C=A[b+2],M=A[b+3],I=0<y*(M-v)-S*(C-m);if(0<y*(T-v)-S*(w-m)){if(I){o.push(C),o.push(M);continue}var P,k,R,_=(P=M-T)*(m-f)-(k=C-w)*(v-g);1e-6<Math.abs(_)?(R=(k*(g-T)-P*(f-w))/_,o.push(f+(m-f)*R),o.push(g+(v-g)*R)):(o.push(f),o.push(g))}else I&&(_=(P=M-T)*(m-f)-(k=C-w)*(v-g),1e-6<Math.abs(_)?(R=(k*(g-T)-P*(f-w))/_,o.push(f+(m-f)*R),o.push(g+(v-g)*R)):(o.push(f),o.push(g)),o.push(C),o.push(M));h=!0}if(E==o.length)return!(c.length=0);if(o.push(o[0]),o.push(o[1]),p==d)break;var O=o;(o=l).length=0,l=O}if(c!=o){p=c.length=0;for(var D=o.length-2;p<D;p++)c[p]=o[p]}else c.length=c.length-2;return h},De.makeClockwise=function(t){for(var e,n,i,a=t,s=t.length,r=a[s-2]*a[1]-a[0]*a[s-1],o=0,c=s-3;o<c;o+=2)e=a[o],n=a[o+1],i=a[o+2],r+=e*a[o+3]-i*n;if(!(r<0)){o=0;var h=s-2;for(c=s>>1;o<c;o+=2){var l=a[o],u=a[o+1],d=h-o;a[o]=a[d],a[o+1]=a[1+d],a[d]=l,a[1+d]=u}}},F=De,L.SkeletonClipping=F,N=Se=Se||{},Be.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},Be.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},Be.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},G=Be,N.SkeletonData=G,function(t){var e=(n.prototype.readSkeletonData=function(e){var i=this.scale,a=new t.SkeletonData,s="string"==typeof e?JSON.parse(e):e,r=s.skeleton;if(null!=r){if(a.hash=r.hash,a.version=r.spine,"3.8.75"==a.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");a.x=r.x,a.y=r.y,a.width=r.width,a.height=r.height,a.fps=r.fps,a.imagesPath=r.images}if(s.bones)for(var o=0;o<s.bones.length;o++){var c=s.bones[o],h=null,l=this.getValue(c,"parent",null);if(null!=l&&null==(h=a.findBone(l)))throw new Error("Parent bone not found: "+l);(f=new t.BoneData(a.bones.length,c.name,h)).length=this.getValue(c,"length",0)*i,f.x=this.getValue(c,"x",0)*i,f.y=this.getValue(c,"y",0)*i,f.rotation=this.getValue(c,"rotation",0),f.scaleX=this.getValue(c,"scaleX",1),f.scaleY=this.getValue(c,"scaleY",1),f.shearX=this.getValue(c,"shearX",0),f.shearY=this.getValue(c,"shearY",0),f.transformMode=n.transformModeFromString(this.getValue(c,"transform","normal")),f.skinRequired=this.getValue(c,"skin",!1),a.bones.push(f)}if(s.slots)for(o=0;o<s.slots.length;o++){var u=(C=s.slots[o]).name,d=C.bone,p=a.findBone(d);if(null==p)throw new Error("Slot bone not found: "+d);var f=new t.SlotData(a.slots.length,u,p),g=this.getValue(C,"color",null);null!=g&&f.color.setFromString(g);var m=this.getValue(C,"dark",null);null!=m&&(f.darkColor=new t.Color(1,1,1,1),f.darkColor.setFromString(m)),f.attachmentName=this.getValue(C,"attachment",null),f.blendMode=n.blendModeFromString(this.getValue(C,"blend","normal")),a.slots.push(f)}if(s.ik)for(o=0;o<s.ik.length;o++){var v=s.ik[o];(f=new t.IkConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1);for(var y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(E=a.findBone(d)))throw new Error("IK bone not found: "+d);f.bones.push(E)}var S=v.target;if(f.target=a.findBone(S),null==f.target)throw new Error("IK target bone not found: "+S);f.mix=this.getValue(v,"mix",1),f.softness=this.getValue(v,"softness",0)*i,f.bendDirection=this.getValue(v,"bendPositive",!0)?1:-1,f.compress=this.getValue(v,"compress",!1),f.stretch=this.getValue(v,"stretch",!1),f.uniform=this.getValue(v,"uniform",!1),a.ikConstraints.push(f)}if(s.transform)for(o=0;o<s.transform.length;o++){for(v=s.transform[o],(f=new t.TransformConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1),y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(E=a.findBone(d)))throw new Error("Transform constraint bone not found: "+d);f.bones.push(E)}if(S=v.target,f.target=a.findBone(S),null==f.target)throw new Error("Transform constraint target bone not found: "+S);f.local=this.getValue(v,"local",!1),f.relative=this.getValue(v,"relative",!1),f.offsetRotation=this.getValue(v,"rotation",0),f.offsetX=this.getValue(v,"x",0)*i,f.offsetY=this.getValue(v,"y",0)*i,f.offsetScaleX=this.getValue(v,"scaleX",0),f.offsetScaleY=this.getValue(v,"scaleY",0),f.offsetShearY=this.getValue(v,"shearY",0),f.rotateMix=this.getValue(v,"rotateMix",1),f.translateMix=this.getValue(v,"translateMix",1),f.scaleMix=this.getValue(v,"scaleMix",1),f.shearMix=this.getValue(v,"shearMix",1),a.transformConstraints.push(f)}if(s.path)for(o=0;o<s.path.length;o++){for(v=s.path[o],(f=new t.PathConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1),y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(E=a.findBone(d)))throw new Error("Transform constraint bone not found: "+d);f.bones.push(E)}if(S=v.target,f.target=a.findSlot(S),null==f.target)throw new Error("Path target slot not found: "+S);f.positionMode=n.positionModeFromString(this.getValue(v,"positionMode","percent")),f.spacingMode=n.spacingModeFromString(this.getValue(v,"spacingMode","length")),f.rotateMode=n.rotateModeFromString(this.getValue(v,"rotateMode","tangent")),f.offsetRotation=this.getValue(v,"rotation",0),f.position=this.getValue(v,"position",0),f.positionMode==t.PositionMode.Fixed&&(f.position*=i),f.spacing=this.getValue(v,"spacing",0),f.spacingMode!=t.SpacingMode.Length&&f.spacingMode!=t.SpacingMode.Fixed||(f.spacing*=i),f.rotateMix=this.getValue(v,"rotateMix",1),f.translateMix=this.getValue(v,"translateMix",1),a.pathConstraints.push(f)}if(s.skins)for(o=0;o<s.skins.length;o++){var A=s.skins[o],x=new t.Skin(A.name);if(A.bones)for(var E,b=0;b<A.bones.length;b++){if(null==(E=a.findBone(A.bones[b])))throw new Error("Skin bone not found: "+A.bones[o]);x.bones.push(E)}if(A.ik)for(b=0;b<A.ik.length;b++){if(null==(w=a.findIkConstraint(A.ik[b])))throw new Error("Skin IK constraint not found: "+A.ik[o]);x.constraints.push(w)}if(A.transform)for(b=0;b<A.transform.length;b++){if(null==(w=a.findTransformConstraint(A.transform[b])))throw new Error("Skin transform constraint not found: "+A.transform[o]);x.constraints.push(w)}if(A.path){var w;for(b=0;b<A.path.length;b++){if(null==(w=a.findPathConstraint(A.path[b])))throw new Error("Skin path constraint not found: "+A.path[o]);x.constraints.push(w)}}for(var u in A.attachments){var T=a.findSlot(u);if(null==T)throw new Error("Slot not found: "+u);var C=A.attachments[u];for(var M in C){var I=this.readAttachment(C[M],x,T.index,M,a);null!=I&&x.setAttachment(T.index,M,I)}}a.skins.push(x),"default"==x.name&&(a.defaultSkin=x)}o=0;for(var P=this.linkedMeshes.length;o<P;o++){var k=this.linkedMeshes[o];if(null==(x=null==k.skin?a.defaultSkin:a.findSkin(k.skin)))throw new Error("Skin not found: "+k.skin);var R=x.getAttachment(k.slotIndex,k.parent);if(null==R)throw new Error("Parent mesh not found: "+k.parent);k.mesh.deformAttachment=k.inheritDeform?R:k.mesh,k.mesh.setParentMesh(R),k.mesh.updateUVs()}if(this.linkedMeshes.length=0,s.events)for(var _ in s.events){var O=s.events[_];(f=new t.EventData(_)).intValue=this.getValue(O,"int",0),f.floatValue=this.getValue(O,"float",0),f.stringValue=this.getValue(O,"string",""),f.audioPath=this.getValue(O,"audio",null),null!=f.audioPath&&(f.volume=this.getValue(O,"volume",1),f.balance=this.getValue(O,"balance",0)),a.events.push(f)}if(s.animations)for(var D in s.animations){var B=s.animations[D];this.readAnimation(B,D,a)}return a},n.prototype.readAttachment=function(e,n,a,s,r){var o=this.scale;switch(s=this.getValue(e,"name",s),this.getValue(e,"type","region")){case"region":var c=this.getValue(e,"path",s),h=this.attachmentLoader.newRegionAttachment(n,s,c);return null==h?null:(h.path=c,h.x=this.getValue(e,"x",0)*o,h.y=this.getValue(e,"y",0)*o,h.scaleX=this.getValue(e,"scaleX",1),h.scaleY=this.getValue(e,"scaleY",1),h.rotation=this.getValue(e,"rotation",0),h.width=e.width*o,h.height=e.height*o,null!=(x=this.getValue(e,"color",null))&&h.color.setFromString(x),h.updateOffset(),h);case"boundingbox":var l=this.attachmentLoader.newBoundingBoxAttachment(n,s);return null==l?null:(this.readVertices(e,l,e.vertexCount<<1),null!=(x=this.getValue(e,"color",null))&&l.color.setFromString(x),l);case"mesh":case"linkedmesh":c=this.getValue(e,"path",s);var u=this.attachmentLoader.newMeshAttachment(n,s,c);if(null==u)return null;u.path=c,null!=(x=this.getValue(e,"color",null))&&u.color.setFromString(x),u.width=this.getValue(e,"width",0)*o,u.height=this.getValue(e,"height",0)*o;var d=this.getValue(e,"parent",null);if(null!=d)return this.linkedMeshes.push(new i(u,this.getValue(e,"skin",null),a,d,this.getValue(e,"deform",!0))),u;var p=e.uvs;return this.readVertices(e,u,p.length),u.triangles=e.triangles,u.regionUVs=p,u.updateUVs(),u.edges=this.getValue(e,"edges",null),u.hullLength=2*this.getValue(e,"hull",0),u;case"path":if(null==(c=this.attachmentLoader.newPathAttachment(n,s)))return null;c.closed=this.getValue(e,"closed",!1),c.constantSpeed=this.getValue(e,"constantSpeed",!0);var f=e.vertexCount;this.readVertices(e,c,f<<1);for(var g=t.Utils.newArray(f/3,0),m=0;m<e.lengths.length;m++)g[m]=e.lengths[m]*o;return c.lengths=g,null!=(x=this.getValue(e,"color",null))&&c.color.setFromString(x),c;case"point":var v=this.attachmentLoader.newPointAttachment(n,s);return null==v?null:(v.x=this.getValue(e,"x",0)*o,v.y=this.getValue(e,"y",0)*o,v.rotation=this.getValue(e,"rotation",0),null!=(x=this.getValue(e,"color",null))&&v.color.setFromString(x),v);case"clipping":var y=this.attachmentLoader.newClippingAttachment(n,s);if(null==y)return null;var S=this.getValue(e,"end",null);if(null!=S){var A=r.findSlot(S);if(null==A)throw new Error("Clipping end slot not found: "+S);y.endSlot=A}var x;f=e.vertexCount;return this.readVertices(e,y,f<<1),null!=(x=this.getValue(e,"color",null))&&y.color.setFromString(x),y}return null},n.prototype.readVertices=function(e,n,i){var a=this.scale;n.worldVerticesLength=i;var s=e.vertices;if(i!=s.length){for(var r=new Array,o=new Array,c=0,h=s.length;c<h;){var l=s[c++];o.push(l);for(var u=c+4*l;c<u;c+=4)o.push(s[c]),r.push(s[c+1]*a),r.push(s[c+2]*a),r.push(s[c+3])}n.bones=o,n.vertices=t.Utils.toFloatArray(r)}else{var d=t.Utils.toFloatArray(s);if(1!=a)for(c=0,h=s.length;c<h;c++)d[c]*=a;n.vertices=d}},n.prototype.readAnimation=function(e,n,i){var a=this.scale,s=new Array,r=0;if(e.slots)for(var o in e.slots){var c=e.slots[o];if(-1==($=i.findSlotIndex(o)))throw new Error("Slot not found: "+o);for(var h in c){var l=c[h];if("attachment"==h){(x=new t.AttachmentTimeline(l.length)).slotIndex=$;for(var u=0,d=0;d<l.length;d++){var p=l[d];x.setFrame(u++,this.getValue(p,"time",0),p.name)}s.push(x),r=Math.max(r,x.frames[x.getFrameCount()-1])}else if("color"==h){for((x=new t.ColorTimeline(l.length)).slotIndex=$,d=u=0;d<l.length;d++){p=l[d];var f=new t.Color;f.setFromString(p.color),x.setFrame(u,this.getValue(p,"time",0),f.r,f.g,f.b,f.a),this.readCurve(p,x,u),u++}s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if("twoColor"!=h)throw new Error("Invalid timeline type for a slot: "+h+" ("+o+")");for((x=new t.TwoColorTimeline(l.length)).slotIndex=$,d=u=0;d<l.length;d++){p=l[d];var m=new t.Color,v=new t.Color;m.setFromString(p.light),v.setFromString(p.dark),x.setFrame(u,this.getValue(p,"time",0),m.r,m.g,m.b,m.a,v.r,v.g,v.b),this.readCurve(p,x,u),u++}s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.TwoColorTimeline.ENTRIES])}}}if(e.bones)for(var y in e.bones){var S=e.bones[y],A=i.findBoneIndex(y);if(-1==A)throw new Error("Bone not found: "+y);for(var h in S)if(l=S[h],"rotate"===h){for((x=new t.RotateTimeline(l.length)).boneIndex=A,d=u=0;d<l.length;d++)p=l[d],x.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"angle",0)),this.readCurve(p,x,u),u++;s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.RotateTimeline.ENTRIES])}else{if("translate"!==h&&"scale"!==h&&"shear"!==h)throw new Error("Invalid timeline type for a bone: "+h+" ("+y+")");var x=null,E=1,b=0;for("scale"===h?(x=new t.ScaleTimeline(l.length),b=1):"shear"===h?x=new t.ShearTimeline(l.length):(x=new t.TranslateTimeline(l.length),E=a),x.boneIndex=A,d=u=0;d<l.length;d++){p=l[d];var w=this.getValue(p,"x",b),T=this.getValue(p,"y",b);x.setFrame(u,this.getValue(p,"time",0),w*E,T*E),this.readCurve(p,x,u),u++}s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.TranslateTimeline.ENTRIES])}}if(e.ik)for(var C in e.ik){var M=e.ik[C],I=i.findIkConstraint(C);for((x=new t.IkConstraintTimeline(M.length)).ikConstraintIndex=g()(P=i.ikConstraints).call(P,I),d=u=0;d<M.length;d++){var P;p=M[d],x.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"mix",1),this.getValue(p,"softness",0)*a,this.getValue(p,"bendPositive",!0)?1:-1,this.getValue(p,"compress",!1),this.getValue(p,"stretch",!1)),this.readCurve(p,x,u),u++}s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.IkConstraintTimeline.ENTRIES])}if(e.transform)for(var C in e.transform){for(M=e.transform[C],I=i.findTransformConstraint(C),(x=new t.TransformConstraintTimeline(M.length)).transformConstraintIndex=g()(k=i.transformConstraints).call(k,I),d=u=0;d<M.length;d++){var k;p=M[d],x.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1),this.getValue(p,"scaleMix",1),this.getValue(p,"shearMix",1)),this.readCurve(p,x,u),u++}s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.TransformConstraintTimeline.ENTRIES])}if(e.path)for(var C in e.path){M=e.path[C];var R=i.findPathConstraintIndex(C);if(-1==R)throw new Error("Path constraint not found: "+C);var _=i.pathConstraints[R];for(var h in M)if(l=M[h],"position"===h||"spacing"===h){x=null,E=1;for("spacing"===h?(x=new t.PathConstraintSpacingTimeline(l.length),_.spacingMode!=t.SpacingMode.Length&&_.spacingMode!=t.SpacingMode.Fixed||(E=a)):(x=new t.PathConstraintPositionTimeline(l.length),_.positionMode==t.PositionMode.Fixed&&(E=a)),x.pathConstraintIndex=R,d=u=0;d<l.length;d++)p=l[d],x.setFrame(u,this.getValue(p,"time",0),this.getValue(p,h,0)*E),this.readCurve(p,x,u),u++;s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===h){for((x=new t.PathConstraintMixTimeline(l.length)).pathConstraintIndex=R,d=u=0;d<l.length;d++)p=l[d],x.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1)),this.readCurve(p,x,u),u++;s.push(x),r=Math.max(r,x.frames[(x.getFrameCount()-1)*t.PathConstraintMixTimeline.ENTRIES])}}if(e.deform)for(var O in e.deform){var D=e.deform[O],B=i.findSkin(O);if(null==B)throw new Error("Skin not found: "+O);for(var o in D){if(c=D[o],-1==($=i.findSlotIndex(o)))throw new Error("Slot not found: "+c.name);for(var h in c){l=c[h];var L=B.getAttachment($,h);if(null==L)throw new Error("Deform attachment not found: "+l.name);var F=null!=L.bones,N=L.vertices,G=F?N.length/3*2:N.length;(x=new t.DeformTimeline(l.length)).slotIndex=$,x.attachment=L;u=0;for(var U=0;U<l.length;U++){p=l[U];var V=void 0,Y=this.getValue(p,"vertices",null);if(null==Y)V=F?t.Utils.newFloatArray(G):N;else{V=t.Utils.newFloatArray(G);var z=this.getValue(p,"offset",0);if(t.Utils.arrayCopy(Y,0,V,z,Y.length),1!=a)for(var W=(d=z)+Y.length;d<W;d++)V[d]*=a;if(!F)for(d=0;d<G;d++)V[d]+=N[d]}x.setFrame(u,this.getValue(p,"time",0),V),this.readCurve(p,x,u),u++}s.push(x),r=Math.max(r,x.frames[x.getFrameCount()-1])}}}var H=e.drawOrder;if(null==H&&(H=e.draworder),null!=H){x=new t.DrawOrderTimeline(H.length);var X=i.slots.length;for(u=0,U=0;U<H.length;U++){var K=H[U],j=null,q=this.getValue(K,"offsets",null);if(null!=q){j=t.Utils.newArray(X,-1);var Z=t.Utils.newArray(X-q.length,0),J=0,Q=0;for(d=0;d<q.length;d++){var $,tt=q[d];if(-1==($=i.findSlotIndex(tt.slot)))throw new Error("Slot not found: "+tt.slot);for(;J!=$;)Z[Q++]=J++;j[J+tt.offset]=J++}for(;J<X;)Z[Q++]=J++;for(d=X-1;0<=d;d--)-1==j[d]&&(j[d]=Z[--Q])}x.setFrame(u++,this.getValue(K,"time",0),j)}s.push(x),r=Math.max(r,x.frames[x.getFrameCount()-1])}if(e.events){for(x=new t.EventTimeline(e.events.length),d=u=0;d<e.events.length;d++){var et=e.events[d],nt=i.findEvent(et.name);if(null==nt)throw new Error("Event not found: "+et.name);var it=new t.Event(t.Utils.toSinglePrecision(this.getValue(et,"time",0)),nt);it.intValue=this.getValue(et,"int",nt.intValue),it.floatValue=this.getValue(et,"float",nt.floatValue),it.stringValue=this.getValue(et,"string",nt.stringValue),null!=it.data.audioPath&&(it.volume=this.getValue(et,"volume",1),it.balance=this.getValue(et,"balance",0)),x.setFrame(u++,it)}s.push(x),r=Math.max(r,x.frames[x.getFrameCount()-1])}if(isNaN(r))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new t.Animation(n,s,r))},n.prototype.readCurve=function(t,e,n){var i;t.hasOwnProperty("curve")&&("stepped"==t.curve?e.setStepped(n):(i=t.curve,e.setCurve(n,i,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))))},n.prototype.getValue=function(t,e,n){return void 0!==t[e]?t[e]:n},n.blendModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.BlendMode.Normal;if("additive"==e)return t.BlendMode.Additive;if("multiply"==e)return t.BlendMode.Multiply;if("screen"==e)return t.BlendMode.Screen;throw new Error("Unknown blend mode: "+e)},n.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},n.spacingModeFromString=function(e){if("length"==(e=e.toLowerCase()))return t.SpacingMode.Length;if("fixed"==e)return t.SpacingMode.Fixed;if("percent"==e)return t.SpacingMode.Percent;throw new Error("Unknown position mode: "+e)},n.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},n.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},n);function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}t.SkeletonJson=e;var i=function(t,e,n,i,a){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=a}}(Se=Se||{}),function(t){var e=function(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n};t.SkinEntry=e;var n=(i.prototype.setAttachment=function(t,e,n){if(null==n)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=n},i.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var n=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==n){i=!0;break}i||this.bones.push(n)}for(e=0;e<t.constraints.length;e++){var s=t.constraints[e];for(i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){i=!0;break}i||this.constraints.push(s)}var r=t.getAttachments();for(e=0;e<r.length;e++){var o=r[e];this.setAttachment(o.slotIndex,o.name,o.attachment)}},i.prototype.copySkin=function(e){for(var n=0;n<e.bones.length;n++){for(var i=e.bones[n],a=!1,s=0;s<this.bones.length;s++)if(this.bones[s]==i){a=!0;break}a||this.bones.push(i)}for(n=0;n<e.constraints.length;n++){var r=e.constraints[n];for(a=!1,s=0;s<this.constraints.length;s++)if(this.constraints[s]==r){a=!0;break}a||this.constraints.push(r)}var o=e.getAttachments();for(n=0;n<o.length;n++){var c=o[n];null!=c.attachment&&(c.attachment instanceof t.MeshAttachment?c.attachment=c.attachment.newLinkedMesh():c.attachment=c.attachment.copy(),this.setAttachment(c.slotIndex,c.name,c.attachment))}},i.prototype.getAttachment=function(t,e){var n=this.attachments[t];return n?n[e]:null},i.prototype.removeAttachment=function(t,e){var n=this.attachments[t];n&&(n[e]=null)},i.prototype.getAttachments=function(){for(var t=new Array,n=0;n<this.attachments.length;n++){var i=this.attachments[n];if(i)for(var a in i){var s=i[a];s&&t.push(new e(n,a,s))}}return t},i.prototype.getAttachmentsForSlot=function(t,n){var i=this.attachments[t];if(i)for(var a in i){var s=i[a];s&&n.push(new e(t,a,s))}},i.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},i.prototype.attachAll=function(t,e){for(var n=0,i=0;i<t.slots.length;i++){var a=t.slots[i],s=a.getAttachment();if(s&&n<e.attachments.length){var r=e.attachments[n];for(var o in r)if(s==r[o]){var c=this.getAttachment(n,o);null!=c&&a.setAttachment(c);break}}n++}},i);function i(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==t)throw new Error("name cannot be null.");this.name=t}t.Skin=n}(Se=Se||{}),U=Se=Se||{},Le.prototype.getSkeleton=function(){return this.bone.skeleton},Le.prototype.getAttachment=function(){return this.attachment},Le.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},Le.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},Le.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},Le.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},V=Le,U.Slot=V,(z=Se=Se||{}).SlotData=function(t,e,n){if(this.color=new z.Color(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n},function(t){var e,n,i,a,s=(r.prototype.getImage=function(){return this._image},r.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return e.Nearest;case"linear":return e.Linear;case"mipmap":return e.MipMap;case"mipmapnearestnearest":return e.MipMapNearestNearest;case"mipmaplinearnearest":return e.MipMapLinearNearest;case"mipmapnearestlinear":return e.MipMapNearestLinear;case"mipmaplinearlinear":return e.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},r.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return i.MirroredRepeat;case"clamptoedge":return i.ClampToEdge;case"repeat":return i.Repeat;default:throw new Error("Unknown texture wrap "+t)}},r);function r(t){this._image=t}t.Texture=s,(n=e=t.TextureFilter||(t.TextureFilter={}))[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",(a=i=t.TextureWrap||(t.TextureWrap={}))[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat",t.TextureRegion=function(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0};var o,c=(xe(h,o=s),h.prototype.setFilters=function(t,e){},h.prototype.setWraps=function(t,e){},h.prototype.dispose=function(){},h);function h(){return null!==o&&o.apply(this,arguments)||this}t.FakeTexture=c}(Se=Se||{}),function(t){var e=(n.prototype.load=function(e,n){if(null==n)throw new Error("textureLoader cannot be null.");for(var a=new i(e),r=new Array(4),c=null;;){var h,l,u,d,p,f,g,m=a.readLine();if(null==m)break;0==(m=rf()(m).call(m)).length?c=null:c?((h=new o).name=m,h.page=c,"true"==(l=a.readValue()).toLocaleLowerCase()?h.degrees=90:"false"==l.toLocaleLowerCase()?h.degrees=0:h.degrees=xR()(l),h.rotate=90==h.degrees,a.readTuple(r),u=ob()(r[0]),d=ob()(r[1]),a.readTuple(r),p=ob()(r[0]),f=ob()(r[1]),h.u=u/c.width,h.v=d/c.height,h.rotate?(h.u2=(u+f)/c.width,h.v2=(d+p)/c.height):(h.u2=(u+p)/c.width,h.v2=(d+f)/c.height),h.x=u,h.y=d,h.width=Math.abs(p),h.height=Math.abs(f),4==a.readTuple(r)&&4==a.readTuple(r)&&a.readTuple(r),h.originalWidth=ob()(r[0]),h.originalHeight=ob()(r[1]),a.readTuple(r),h.offsetX=ob()(r[0]),h.offsetY=ob()(r[1]),h.index=ob()(a.readValue()),h.texture=c.texture,this.regions.push(h)):((c=new s).name=m,2==a.readTuple(r)&&(c.width=ob()(r[0]),c.height=ob()(r[1]),a.readTuple(r)),a.readTuple(r),c.minFilter=t.Texture.filterFromString(r[0]),c.magFilter=t.Texture.filterFromString(r[1]),g=a.readValue(),c.uWrap=t.TextureWrap.ClampToEdge,c.vWrap=t.TextureWrap.ClampToEdge,"x"==g?c.uWrap=t.TextureWrap.Repeat:"y"==g?c.vWrap=t.TextureWrap.Repeat:"xy"==g&&(c.uWrap=c.vWrap=t.TextureWrap.Repeat),c.texture=n(m),c.texture.setFilters(c.minFilter,c.magFilter),c.texture.setWraps(c.uWrap,c.vWrap),c.width=c.texture.getImage().width,c.height=c.texture.getImage().height,this.pages.push(c))}},n.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},n.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()},n);function n(t,e){this.pages=new Array,this.regions=new Array,this.load(t,e)}t.TextureAtlas=e;var i=(a.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},a.prototype.readValue=function(){var t,e=this.readLine(),n=g()(e).call(e,":");if(-1==n)throw new Error("Invalid line: "+e);return rf()(t=e.substring(n+1)).call(t)},a.prototype.readTuple=function(t){var e,n=this.readLine(),i=g()(n).call(n,":");if(-1==i)throw new Error("Invalid line: "+n);for(var a=0,s=i+1;a<3;a++){var r,o=g()(n).call(n,",",s);if(-1==o)break;t[a]=rf()(r=n.substr(s,o-s)).call(r),s=o+1}return t[a]=rf()(e=n.substring(s)).call(e),a+1},a);function a(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}var s=function(){};t.TextureAtlasPage=s;var r,o=(r=t.TextureRegion,xe(c,r),c);function c(){return null!==r&&r.apply(this,arguments)||this}t.TextureAtlasRegion=o}(Se=Se||{}),W=Se=Se||{},Fe.prototype.isActive=function(){return this.active},Fe.prototype.apply=function(){this.update()},Fe.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},Fe.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target,s=a.a,r=a.b,o=a.c,c=a.d,h=0<s*c-r*o?W.MathUtils.degRad:-W.MathUtils.degRad,l=this.data.offsetRotation*h,u=this.data.offsetShearY*h,d=this.bones,p=0,f=d.length;p<f;p++){var g,m,v,y,S,A,x,E,b,w,T,C=d[p],M=!1;0!=t&&(g=C.a,x=C.b,m=C.c,E=C.d,(w=Math.atan2(o,s)-Math.atan2(m,g)+l)>W.MathUtils.PI?w-=W.MathUtils.PI2:w<-W.MathUtils.PI&&(w+=W.MathUtils.PI2),w*=t,v=Math.cos(w),y=Math.sin(w),C.a=v*g-y*m,C.b=v*x-y*E,C.c=y*g+v*m,C.d=y*x+v*E,M=!0),0!=e&&(S=this.temp,a.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),C.worldX+=(S.x-C.worldX)*e,C.worldY+=(S.y-C.worldY)*e,M=!0),0<n&&(T=Math.sqrt(C.a*C.a+C.c*C.c),A=Math.sqrt(s*s+o*o),1e-5<T&&(T=(T+(A-T+this.data.offsetScaleX)*n)/T),C.a*=T,C.c*=T,T=Math.sqrt(C.b*C.b+C.d*C.d),A=Math.sqrt(r*r+c*c),1e-5<T&&(T=(T+(A-T+this.data.offsetScaleY)*n)/T),C.b*=T,C.d*=T,M=!0),0<i&&(x=C.b,E=C.d,b=Math.atan2(E,x),(w=Math.atan2(c,r)-Math.atan2(o,s)-(b-Math.atan2(C.c,C.a)))>W.MathUtils.PI?w-=W.MathUtils.PI2:w<-W.MathUtils.PI&&(w+=W.MathUtils.PI2),w=b+(w+u)*i,T=Math.sqrt(x*x+E*E),C.b=Math.cos(w)*T,C.d=Math.sin(w)*T,M=!0),M&&(C.appliedValid=!1)}},Fe.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target,s=a.a,r=a.b,o=a.c,c=a.d,h=0<s*c-r*o?W.MathUtils.degRad:-W.MathUtils.degRad,l=this.data.offsetRotation*h,u=this.data.offsetShearY*h,d=this.bones,p=0,f=d.length;p<f;p++){var g,m,v,y,S,A,x,E,b,w=d[p],T=!1;0!=t&&(g=w.a,x=w.b,m=w.c,E=w.d,(A=Math.atan2(o,s)+l)>W.MathUtils.PI?A-=W.MathUtils.PI2:A<-W.MathUtils.PI&&(A+=W.MathUtils.PI2),A*=t,v=Math.cos(A),y=Math.sin(A),w.a=v*g-y*m,w.b=v*x-y*E,w.c=y*g+v*m,w.d=y*x+v*E,T=!0),0!=e&&(S=this.temp,a.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),w.worldX+=S.x*e,w.worldY+=S.y*e,T=!0),0<n&&(b=(Math.sqrt(s*s+o*o)-1+this.data.offsetScaleX)*n+1,w.a*=b,w.c*=b,b=(Math.sqrt(r*r+c*c)-1+this.data.offsetScaleY)*n+1,w.b*=b,w.d*=b,T=!0),0<i&&((A=Math.atan2(c,r)-Math.atan2(o,s))>W.MathUtils.PI?A-=W.MathUtils.PI2:A<-W.MathUtils.PI&&(A+=W.MathUtils.PI2),x=w.b,E=w.d,A=Math.atan2(E,x)+(A-W.MathUtils.PI/2+u)*i,b=Math.sqrt(x*x+E*E),w.b=Math.cos(A)*b,w.d=Math.sin(A)*b,T=!0),T&&(w.appliedValid=!1)}},Fe.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,r=0,o=s.length;r<o;r++){var c=s[r];c.appliedValid||c.updateAppliedTransform();var h=c.arotation;0!=t&&(f=a.arotation-h+this.data.offsetRotation,h+=(f-=360*(16384-(16384.499999999996-f/360|0)))*t);var l=c.ax,u=c.ay;0!=e&&(l+=(a.ax-l+this.data.offsetX)*e,u+=(a.ay-u+this.data.offsetY)*e);var d=c.ascaleX,p=c.ascaleY;0!=n&&(1e-5<d&&(d=(d+(a.ascaleX-d+this.data.offsetScaleX)*n)/d),1e-5<p&&(p=(p+(a.ascaleY-p+this.data.offsetScaleY)*n)/p));var f,g=c.ashearY;0!=i&&(f=a.ashearY-g+this.data.offsetShearY,f-=360*(16384-(16384.499999999996-f/360|0)),c.shearY+=f*i),c.updateWorldTransformWith(l,u,h,d,p,c.ashearX,g)}},Fe.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,r=0,o=s.length;r<o;r++){var c=s[r];c.appliedValid||c.updateAppliedTransform();var h=c.arotation;0!=t&&(h+=(a.arotation+this.data.offsetRotation)*t);var l=c.ax,u=c.ay;0!=e&&(l+=(a.ax+this.data.offsetX)*e,u+=(a.ay+this.data.offsetY)*e);var d=c.ascaleX,p=c.ascaleY;0!=n&&(1e-5<d&&(d*=(a.ascaleX-1+this.data.offsetScaleX)*n+1),1e-5<p&&(p*=(a.ascaleY-1+this.data.offsetScaleY)*n+1));var f=c.ashearY;0!=i&&(f+=(a.ashearY+this.data.offsetShearY)*i),c.updateWorldTransformWith(l,u,h,d,p,c.ashearX,f)}},H=Fe,W.TransformConstraint=H,X=Se=Se||{},K=X.ConstraintData,xe(Ne,K),j=Ne,X.TransformConstraintData=j,q=Se=Se||{},Ge.prototype.triangulate=function(t){for(var e=t,n=t.length>>1,i=this.indicesArray,a=i.length=0;a<n;a++)i[a]=a;for(var s=this.isConcaveArray,r=(a=s.length=0,n);a<r;++a)s[a]=Ge.isConcave(a,n,e,i);var o=this.triangles;for(o.length=0;3<n;){for(var c=n-1,h=(a=0,1);;){t:if(!s[a]){for(var l=i[c]<<1,u=i[a]<<1,d=i[h]<<1,p=e[l],f=e[1+l],g=e[u],m=e[1+u],v=e[d],y=e[1+d],S=(h+1)%n;S!=c;S=(S+1)%n)if(s[S]){var A=i[S]<<1,x=e[A],E=e[1+A];if(Ge.positiveArea(v,y,p,f,x,E)&&Ge.positiveArea(p,f,g,m,x,E)&&Ge.positiveArea(g,m,v,y,x,E))break t}break}if(0==h){do{if(!s[a])break;a--}while(0<a);break}c=a,h=((a=h)+1)%n}o.push(i[(n+a-1)%n]),o.push(i[a]),o.push(i[(a+1)%n]),vr()(i).call(i,a,1),vr()(s).call(s,a,1);var b=(--n+a-1)%n,w=a==n?0:a;s[b]=Ge.isConcave(b,n,e,i),s[w]=Ge.isConcave(w,n,e,i)}return 3==n&&(o.push(i[2]),o.push(i[0]),o.push(i[1])),o},Ge.prototype.decompose=function(t,e){var n=t,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;var a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;var s=this.polygonIndicesPool.obtain();s.length=0;for(var r=this.polygonPool.obtain(),o=-1,c=r.length=0,h=0,l=e.length;h<l;h+=3){var u=e[h]<<1,d=e[h+1]<<1,p=e[h+2]<<1,f=n[u],g=n[1+u],m=n[d],v=n[1+d],y=n[p],S=n[1+p],A=!1;o==u&&(x=r.length-4,M=Ge.winding(r[x],r[x+1],r[x+2],r[x+3],y,S),I=Ge.winding(y,S,r[0],r[1],r[2],r[3]),M==c&&I==c&&(r.push(y),r.push(S),s.push(p),A=!0)),A||(0<r.length?(i.push(r),a.push(s)):(this.polygonPool.free(r),this.polygonIndicesPool.free(s)),(r=this.polygonPool.obtain()).length=0,r.push(f),r.push(g),r.push(m),r.push(v),r.push(y),r.push(S),(s=this.polygonIndicesPool.obtain()).length=0,s.push(u),s.push(d),s.push(p),c=Ge.winding(f,g,m,v,y,S),o=u)}for(0<r.length&&(i.push(r),a.push(s)),h=0,l=i.length;h<l;h++)if(0!=(s=a[h]).length)for(var x,E,b,w,T,C,M,I,P=s[0],k=s[s.length-1],R=(r=i[h])[x=r.length-4],_=r[x+1],O=r[x+2],D=r[x+3],B=r[0],L=r[1],F=r[2],N=r[3],G=Ge.winding(R,_,O,D,B,L),U=0;U<l;U++)U!=h&&3==(E=a[U]).length&&(b=E[0],w=E[1],T=E[2],y=(C=i[U])[C.length-2],S=C[C.length-1],b==P&&w==k&&(M=Ge.winding(R,_,O,D,y,S),I=Ge.winding(y,S,B,L,F,N),M==G&&I==G&&(C.length=0,E.length=0,r.push(y),r.push(S),s.push(T),R=O,_=D,O=y,D=S,U=0)));for(h=i.length-1;0<=h;h--)0==(r=i[h]).length&&(vr()(i).call(i,h,1),this.polygonPool.free(r),s=a[h],vr()(a).call(a,h,1),this.polygonIndicesPool.free(s));return i},Ge.isConcave=function(t,e,n,i){var a=i[(e+t-1)%e]<<1,s=i[t]<<1,r=i[(t+1)%e]<<1;return!this.positiveArea(n[a],n[1+a],n[s],n[1+s],n[r],n[1+r])},Ge.positiveArea=function(t,e,n,i,a,s){return 0<=t*(s-i)+n*(e-s)+a*(i-e)},Ge.winding=function(t,e,n,i,a,s){var r=n-t,o=i-e;return 0<=a*o-s*r+r*e-t*o?1:-1},Z=Ge,q.Triangulator=Z,function(t){var e=(n.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},n.prototype.contains=function(t){return null!=this.array[0|t]},n.prototype.remove=function(t){this.array[0|t]=void 0},n.prototype.clear=function(){this.array.length=0},n);function n(){this.array=new Array}t.IntSet=e;var i=(a.prototype.set=function(t,e,n,i){return this.r=t,this.g=e,this.b=n,this.a=i,this.clamp(),this},a.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},a.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=ob()(t.substr(0,2),16)/255,this.g=ob()(t.substr(2,2),16)/255,this.b=ob()(t.substr(4,2),16)/255,this.a=(8!=t.length?255:ob()(t.substr(6,2),16))/255,this},a.prototype.add=function(t,e,n,i){return this.r+=t,this.g+=e,this.b+=n,this.a+=i,this.clamp(),this},a.prototype.clamp=function(){return this.r<0?this.r=0:1<this.r&&(this.r=1),this.g<0?this.g=0:1<this.g&&(this.g=1),this.b<0?this.b=0:1<this.b&&(this.b=1),this.a<0?this.a=0:1<this.a&&(this.a=1),this},a.rgba8888ToColor=function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255},a.rgb888ToColor=function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255},a.WHITE=new a(1,1,1,1),a.RED=new a(1,0,0,1),a.GREEN=new a(0,1,0,1),a.BLUE=new a(0,0,1,1),a.MAGENTA=new a(1,0,1,1),a);function a(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.r=t,this.g=e,this.b=n,this.a=i}t.Color=i;var s=(r.clamp=function(t,e,n){return t<e?e:n<t?n:t},r.cosDeg=function(t){return Math.cos(t*r.degRad)},r.sinDeg=function(t){return Math.sin(t*r.degRad)},r.signum=function(t){return 0<t?1:t<0?-1:0},r.toInt=function(t){return 0<t?Math.floor(t):Math.ceil(t)},r.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},r.randomTriangular=function(t,e){return r.randomTriangularWith(t,e,.5*(t+e))},r.randomTriangularWith=function(t,e,n){var i=Math.random(),a=e-t;return i<=(n-t)/a?t+Math.sqrt(i*a*(n-t)):e-Math.sqrt((1-i)*a*(e-n))},r.PI2=2*(r.PI=3.1415927),r.radDeg=r.radiansToDegrees=180/r.PI,r.degRad=r.degreesToRadians=r.PI/180,r);function r(){}t.MathUtils=s;var o=(c.prototype.apply=function(t,e,n){return t+(e-t)*this.applyInternal(n)},c);function c(){}t.Interpolation=o;var h,l=(xe(u,h=o),u.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},u);function u(t){var e=h.call(this)||this;return e.power=2,e.power=t,e}t.Pow=l;var d,p=(xe(f,d=l),f.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},f);function f(t){return d.call(this,t)||this}t.PowOut=p;var g=(m.arrayCopy=function(t,e,n,i,a){for(var s=e,r=i;s<e+a;s++,r++)n[r]=t[s]},m.setArraySize=function(t,e,n){void 0===n&&(n=0);var i=t.length;if(i==e)return t;if(i<(t.length=e))for(var a=i;a<e;a++)t[a]=n;return t},m.ensureArrayCapacity=function(t,e,n){return void 0===n&&(n=0),t.length>=e?t:m.setArraySize(t,e,n)},m.newArray=function(t,e){for(var n=new Array(t),i=0;i<t;i++)n[i]=e;return n},m.newFloatArray=function(t){if(m.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=0;return e},m.newShortArray=function(t){if(m.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=0;return e},m.toFloatArray=function(t){return m.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t},m.toSinglePrecision=function(t){return m.SUPPORTS_TYPED_ARRAYS?TR()(t):t},m.webkit602BugfixHelper=function(t,e){},m.contains=function(t,e,n){void 0===n&&(n=!0);for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},m.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,m);function m(){}t.Utils=g;var v=(y.logBones=function(t){for(var e=0;e<t.bones.length;e++){var n=t.bones[e];console.log(n.data.name+", "+n.a+", "+n.b+", "+n.c+", "+n.d+", "+n.worldX+", "+n.worldY)}},y);function y(){}t.DebugUtils=v;var S=(A.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},A.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},A.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)this.free(t[e])},A.prototype.clear=function(){this.items.length=0},A);function A(t){this.items=new Array,this.instantiator=t}t.Pool=S;var x=(E.prototype.set=function(t,e){return this.x=t,this.y=e,this},E.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},E.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},E);function E(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}t.Vector2=x;var b=(w.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},w);function w(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}t.TimeKeeper=b;var T=(C.prototype.hasEnoughData=function(){return this.addedValues>=MR()(this).length},C.prototype.addValue=function(t){this.addedValues<MR()(this).length&&this.addedValues++,MR()(this)[this.lastValue++]=t,this.lastValue>MR()(this).length-1&&(this.lastValue=0),this.dirty=!0},C.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<MR()(this).length;e++)t+=MR()(this)[e];this.mean=t/MR()(this).length,this.dirty=!1}return this.mean}return 0},C);function C(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}t.WindowedMean=T}(Se=Se||{}),TR()||(Math.fround=(J=new Float32Array(1),function(t){return J[0]=t,J[0]})),function(t){function e(t){if(null==t)throw new Error("name cannot be null.");this.name=t}t.Attachment=e;var n,i=(xe(a,n=e),a.prototype.computeWorldVertices=function(t,e,n,i,a,s){n=a+(n>>1)*s;var r=t.bone.skeleton,o=t.deform,c=this.vertices,h=this.bones;if(null!=h){for(var l=0,u=0,d=0;d<e;d+=2)l+=(m=h[l])+1,u+=m;var p=r.bones;if(0==o.length)for(E=a,b=3*u;E<n;E+=s){var f=0,g=0,m=h[l++];for(m+=l;l<m;l++,b+=3){var v=p[h[l]],y=c[b],S=c[b+1],A=c[b+2];f+=(y*v.a+S*v.b+v.worldX)*A,g+=(y*v.c+S*v.d+v.worldY)*A}i[E]=f,i[E+1]=g}else for(var x=o,E=a,b=3*u,w=u<<1;E<n;E+=s){for(g=f=0,m=h[l++],m+=l;l<m;l++,b+=3,w+=2)v=p[h[l]],y=c[b]+x[w],S=c[b+1]+x[w+1],A=c[b+2],f+=(y*v.a+S*v.b+v.worldX)*A,g+=(y*v.c+S*v.d+v.worldY)*A;i[E]=f,i[E+1]=g}}else{0<o.length&&(c=o);var T=(v=t.bone).worldX,C=v.worldY,M=v.a,I=(b=v.b,v.c),P=v.d,k=e;for(E=a;E<n;k+=2,E+=s){y=c[k],S=c[k+1];i[E]=y*M+S*b+T,i[E+1]=y*I+S*P+C}}},a.prototype.copyTo=function(e){null!=this.bones?(e.bones=new Array(this.bones.length),t.Utils.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,null!=this.vertices?(e.vertices=t.Utils.newFloatArray(this.vertices.length),t.Utils.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)):e.vertices=null,e.worldVerticesLength=this.worldVerticesLength,e.deformAttachment=this.deformAttachment},a.nextID=0,a);function a(t){var e=n.call(this,t)||this;return e.id=(65535&a.nextID++)<<11,e.worldVerticesLength=0,e.deformAttachment=e}t.VertexAttachment=i}(Se=Se||{}),($=(Q=Se=Se||{}).AttachmentType||(Q.AttachmentType={}))[$.Region=0]="Region",$[$.BoundingBox=1]="BoundingBox",$[$.Mesh=2]="Mesh",$[$.LinkedMesh=3]="LinkedMesh",$[$.Path=4]="Path",$[$.Point=5]="Point",$[$.Clipping=6]="Clipping",tt=Se=Se||{},et=tt.VertexAttachment,xe(Ue,et),Ue.prototype.copy=function(){var t=new Ue(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t},nt=Ue,tt.BoundingBoxAttachment=nt,at=Se=Se||{},st=at.VertexAttachment,xe(Ve,st),Ve.prototype.copy=function(){var t=new Ve(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t},rt=Ve,at.ClippingAttachment=rt,ot=Se=Se||{},ct=ot.VertexAttachment,xe(Ye,ct),Ye.prototype.updateUVs=function(){var t=this.regionUVs;null!=this.uvs&&this.uvs.length==t.length||(this.uvs=ot.Utils.newFloatArray(t.length));var e=this.uvs,n=this.uvs.length,i=this.region.u,a=this.region.v,s=0,r=0;if(this.region instanceof ot.TextureAtlasRegion){var o=this.region,c=o.texture.getImage().width,h=o.texture.getImage().height;switch(o.degrees){case 90:i-=(o.originalHeight-o.offsetY-o.height)/c,a-=(o.originalWidth-o.offsetX-o.width)/h,s=o.originalHeight/c,r=o.originalWidth/h;for(var l=0;l<n;l+=2)e[l]=i+t[l+1]*s,e[l+1]=a+(1-t[l])*r;return;case 180:for(i-=(o.originalWidth-o.offsetX-o.width)/c,a-=o.offsetY/h,s=o.originalWidth/c,r=o.originalHeight/h,l=0;l<n;l+=2)e[l]=i+(1-t[l])*s,e[l+1]=a+(1-t[l+1])*r;return;case 270:for(i-=o.offsetY/c,a-=o.offsetX/h,s=o.originalHeight/c,r=o.originalWidth/h,l=0;l<n;l+=2)e[l]=i+(1-t[l+1])*s,e[l+1]=a+t[l]*r;return}i-=o.offsetX/c,a-=(o.originalHeight-o.offsetY-o.height)/h,s=o.originalWidth/c,r=o.originalHeight/h}else null==this.region?(i=a=0,s=r=1):(s=this.region.u2-i,r=this.region.v2-a);for(l=0;l<n;l+=2)e[l]=i+t[l]*s,e[l+1]=a+t[l+1]*r},Ye.prototype.getParentMesh=function(){return this.parentMesh},Ye.prototype.setParentMesh=function(t){null!=(this.parentMesh=t)&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},Ye.prototype.copy=function(){if(null!=this.parentMesh)return this.newLinkedMesh();var t=new Ye(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),ot.Utils.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),ot.Utils.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),ot.Utils.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),ot.Utils.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t},Ye.prototype.newLinkedMesh=function(){var t=new Ye(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t},ht=Ye,ot.MeshAttachment=ht,lt=Se=Se||{},ut=lt.VertexAttachment,xe(ze,ut),ze.prototype.copy=function(){var t=new ze(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),lt.Utils.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t},dt=ze,lt.PathAttachment=dt,pt=Se=Se||{},ft=pt.VertexAttachment,xe(We,ft),We.prototype.computeWorldPosition=function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e},We.prototype.computeWorldRotation=function(t){var e=pt.MathUtils.cosDeg(this.rotation),n=pt.MathUtils.sinDeg(this.rotation),i=e*t.a+n*t.b,a=e*t.c+n*t.d;return Math.atan2(a,i)*pt.MathUtils.radDeg},We.prototype.copy=function(){var t=new We(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t},gt=We,pt.PointAttachment=gt,mt=Se=Se||{},vt=mt.Attachment,xe(He,vt),He.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,i=-this.height/2*this.scaleY+this.region.offsetY*e,a=n+this.region.width*t,s=i+this.region.height*e,r=this.rotation*Math.PI/180,o=Math.cos(r),c=Math.sin(r),h=n*o+this.x,l=n*c,u=i*o+this.y,d=i*c,p=a*o+this.x,f=a*c,g=s*o+this.y,m=s*c,v=this.offset;v[He.OX1]=h-d,v[He.OY1]=u+l,v[He.OX2]=h-m,v[He.OY2]=g+l,v[He.OX3]=p-m,v[He.OY3]=g+f,v[He.OX4]=p-d,v[He.OY4]=u+f},He.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},He.prototype.computeWorldVertices=function(t,e,n,i){var a=this.offset,s=t.worldX,r=t.worldY,o=t.a,c=t.b,h=t.c,l=t.d,u=a[He.OX1],d=a[He.OY1];e[n]=u*o+d*c+s,e[n+1]=u*h+d*l+r,n+=i,u=a[He.OX2],d=a[He.OY2],e[n]=u*o+d*c+s,e[n+1]=u*h+d*l+r,n+=i,u=a[He.OX3],d=a[He.OY3],e[n]=u*o+d*c+s,e[n+1]=u*h+d*l+r,n+=i,u=a[He.OX4],d=a[He.OY4],e[n]=u*o+d*c+s,e[n+1]=u*h+d*l+r},He.prototype.copy=function(){var t=new He(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,mt.Utils.arrayCopy(this.uvs,0,t.uvs,0,8),mt.Utils.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t},He.OX1=0,He.OY1=1,He.OX2=2,He.OY2=3,He.OX3=4,He.OY3=5,He.OX4=6,He.OY4=7,He.X1=0,He.Y1=1,He.C1R=2,He.C1G=3,He.C1B=4,He.C1A=5,He.U1=6,He.V1=7,He.X2=8,He.Y2=9,He.C2R=10,He.C2G=11,He.C2B=12,He.C2A=13,He.U2=14,He.V2=15,He.X3=16,He.Y3=17,He.C3R=18,He.C3G=19,He.C3B=20,He.C3A=21,He.U3=22,He.V3=23,He.X4=24,He.Y4=25,He.C4R=26,He.C4G=27,He.C4B=28,He.C4A=29,He.U4=30,He.V4=31,yt=He,mt.RegionAttachment=yt,St=Se=Se||{},Xe.prototype.begin=function(t){},Xe.prototype.transform=function(t,e,n,i){t.x+=St.MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=St.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},Xe.prototype.end=function(){},At=Xe,St.JitterEffect=At,xt=Se=Se||{},Ke.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},Ke.prototype.transform=function(t,e,n,i){var a,s,r,o=this.angle*xt.MathUtils.degreesToRadians,c=t.x-this.worldX,h=t.y-this.worldY,l=Math.sqrt(c*c+h*h);l<this.radius&&(a=Ke.interpolation.apply(0,o,(this.radius-l)/this.radius),s=Math.cos(a),r=Math.sin(a),t.x=s*c-r*h+this.worldX,t.y=r*c+s*h+this.worldY)},Ke.prototype.end=function(){},Ke.interpolation=new xt.PowOut(2),Et=Ke,xt.SwirlEffect=Et,wt=(bt=Se=Se||{}).canvas||(bt.canvas={}),Tt=bt.AssetManager,xe(je,Tt),Ct=je,wt.AssetManager=Ct,It=(Mt=Se=Se||{}).canvas||(Mt.canvas={}),Pt=Mt.Texture,xe(qe,Pt),qe.prototype.setFilters=function(t,e){},qe.prototype.setWraps=function(t,e){},qe.prototype.dispose=function(){},kt=qe,It.CanvasTexture=kt,_t=(Rt=Se=Se||{}).canvas||(Rt.canvas={}),Ze.prototype.draw=function(t){this.triangleRendering?this.drawTriangles(t):this.drawImages(t)},Ze.prototype.drawImages=function(t){var e=this.ctx,n=t.drawOrder;this.debugRendering&&(e.strokeStyle="green"),e.save();for(var i=0,a=n.length;i<a;i++){var s,r,o,c,h,l,u,d,p,f,g,m,v,y,S,A=n[i];A.bone.active&&(c=o=r=null,(s=A.getAttachment())instanceof Rt.RegionAttachment&&(c=(o=(r=s).region).texture.getImage(),h=A.bone.skeleton.color,l=A.color,u=r.color,d=h.a*l.a*u.a,(p=this.tempColor).set(h.r*l.r*u.r,h.g*l.g*u.g,h.b*l.b*u.b,d),f=s,g=A.bone,y=o.width,S=o.height,e.save(),e.transform(g.a,g.c,g.b,g.d,g.worldX,g.worldY),e.translate(s.offset[0],s.offset[1]),e.rotate(s.rotation*Math.PI/180),m=f.width/y,e.scale(m*s.scaleX,m*s.scaleY),e.translate(y/2,S/2),s.region.rotate&&(v=y,y=S,S=v,e.rotate(-Math.PI/2)),e.scale(1,-1),e.translate(-y/2,-S/2),1==p.r&&1==p.g&&1==p.b&&1==p.a||(e.globalAlpha=p.a),e.drawImage(c,o.x,o.y,y,S,0,0,y,S),this.debugRendering&&e.strokeRect(0,0,y,S),e.restore()))}e.restore()},Ze.prototype.drawTriangles=function(t){for(var e=null,n=this.vertices,i=null,a=t.drawOrder,s=0,r=a.length;s<r;s++){var o=a[s],c=o.getAttachment(),h=null;if(c instanceof Rt.RegionAttachment){var l=c;n=this.computeRegionVertices(o,l,!1),i=Ze.QUAD_TRIANGLES,h=l.region.texture.getImage()}else{if(!(c instanceof Rt.MeshAttachment))continue;var u=c;n=this.computeMeshVertices(o,u,!1),i=u.triangles,h=u.region.renderObject.texture.getImage()}if(null!=h){var d=o.data.blendMode;d!=e&&(e=d);var p=o.bone.skeleton.color,f=o.color,g=c.color,m=p.a*f.a*g.a,v=this.tempColor;v.set(p.r*f.r*g.r,p.g*f.g*g.g,p.b*f.b*g.b,m);var y=this.ctx;1==v.r&&1==v.g&&1==v.b&&1==v.a||(y.globalAlpha=v.a);for(var S=0;S<i.length;S+=3){var A=8*i[S],x=8*i[S+1],E=8*i[S+2],b=n[A],w=n[1+A],T=n[6+A],C=n[7+A],M=n[x],I=n[1+x],P=n[6+x],k=n[7+x],R=n[E],_=n[1+E],O=n[6+E],D=n[7+E];this.drawTriangle(h,b,w,T,C,M,I,P,k,R,_,O,D),this.debugRendering&&(y.strokeStyle="green",y.beginPath(),y.moveTo(b,w),y.lineTo(M,I),y.lineTo(R,_),y.lineTo(b,w),y.stroke())}}}this.ctx.globalAlpha=1},Ze.prototype.drawTriangle=function(t,e,n,i,a,s,r,o,c,h,l,u,d){var p=this.ctx;i*=t.width,a*=t.height,o*=t.width,c*=t.height,u*=t.width,d*=t.height,p.beginPath(),p.moveTo(e,n),p.lineTo(s,r),p.lineTo(h,l),p.closePath();var f=1/((o-=i)*(d-=a)-(u-=i)*(c-=a)),g=(d*(s-=e)-c*(h-=e))*f,m=(d*(r-=n)-c*(l-=n))*f,v=(o*h-u*s)*f,y=(o*l-u*r)*f,S=e-g*i-v*a,A=n-m*i-y*a;p.save(),p.transform(g,m,v,y,S,A),p.clip(),p.drawImage(t,0,0),p.restore()},Ze.prototype.computeRegionVertices=function(t,e,n){var i=t.bone.skeleton.color,a=t.color,s=e.color,r=i.a*a.a*s.a,o=n?r:1,c=this.tempColor;c.set(i.r*a.r*s.r*o,i.g*a.g*s.g*o,i.b*a.b*s.b*o,r),e.computeWorldVertices(t.bone,this.vertices,0,Ze.VERTEX_SIZE);var h=this.vertices,l=e.uvs;return h[Rt.RegionAttachment.C1R]=c.r,h[Rt.RegionAttachment.C1G]=c.g,h[Rt.RegionAttachment.C1B]=c.b,h[Rt.RegionAttachment.C1A]=c.a,h[Rt.RegionAttachment.U1]=l[0],h[Rt.RegionAttachment.V1]=l[1],h[Rt.RegionAttachment.C2R]=c.r,h[Rt.RegionAttachment.C2G]=c.g,h[Rt.RegionAttachment.C2B]=c.b,h[Rt.RegionAttachment.C2A]=c.a,h[Rt.RegionAttachment.U2]=l[2],h[Rt.RegionAttachment.V2]=l[3],h[Rt.RegionAttachment.C3R]=c.r,h[Rt.RegionAttachment.C3G]=c.g,h[Rt.RegionAttachment.C3B]=c.b,h[Rt.RegionAttachment.C3A]=c.a,h[Rt.RegionAttachment.U3]=l[4],h[Rt.RegionAttachment.V3]=l[5],h[Rt.RegionAttachment.C4R]=c.r,h[Rt.RegionAttachment.C4G]=c.g,h[Rt.RegionAttachment.C4B]=c.b,h[Rt.RegionAttachment.C4A]=c.a,h[Rt.RegionAttachment.U4]=l[6],h[Rt.RegionAttachment.V4]=l[7],h},Ze.prototype.computeMeshVertices=function(t,e,n){var i=t.bone.skeleton.color,a=t.color,s=e.color,r=i.a*a.a*s.a,o=n?r:1,c=this.tempColor;c.set(i.r*a.r*s.r*o,i.g*a.g*s.g*o,i.b*a.b*s.b*o,r);var h=e.worldVerticesLength/2;this.vertices.length<e.worldVerticesLength&&(this.vertices=Rt.Utils.newFloatArray(e.worldVerticesLength));var l=this.vertices;e.computeWorldVertices(t,0,e.worldVerticesLength,l,0,Ze.VERTEX_SIZE);for(var u=e.uvs,d=0,p=h,f=0,g=2;d<p;d++)l[g++]=c.r,l[g++]=c.g,l[g++]=c.b,l[g++]=c.a,l[g++]=u[f++],l[g++]=u[f++],g+=2;return l},Ze.QUAD_TRIANGLES=[0,1,2,2,3,0],Ze.VERTEX_SIZE=8,Ot=Ze,_t.SkeletonRenderer=Ot,Bt=(Dt=Se=Se||{}).webgl||(Dt.webgl={}),Lt=Dt.AssetManager,xe(Je,Lt),Ft=Je,Bt.AssetManager=Ft,Nt=Se=Se||{},Gt=Nt.webgl||(Nt.webgl={}),Qe.prototype.update=function(){var t=this.projection,e=this.view,n=this.projectionView,i=this.inverseProjectionView,a=this.zoom,s=this.viewportWidth,r=this.viewportHeight;t.ortho(a*(-s/2),a*(s/2),a*(-r/2),a*(r/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),n.set(MR()(t)),n.multiply(e),i.set(MR()(n)).invert()},Qe.prototype.screenToWorld=function(t,e,n){var i=t.x,a=n-t.y-1,s=this.tmp;return s.x=2*i/e-1,s.y=2*a/n-1,s.z=2*t.z-1,s.project(this.inverseProjectionView),t.set(s.x,s.y,s.z),t},Qe.prototype.setViewport=function(t,e){this.viewportWidth=t,this.viewportHeight=e},Ut=Qe,Gt.OrthoCamera=Ut,Vt=Se=Se||{},Yt=Vt.webgl||(Vt.webgl={}),zt=Vt.Texture,xe($e,zt),$e.prototype.setFilters=function(t,e){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,$e.validateMagFilter(e))},$e.validateMagFilter=function(t){switch(t){case Vt.TextureFilter.MipMap:case Vt.TextureFilter.MipMapLinearLinear:case Vt.TextureFilter.MipMapLinearNearest:case Vt.TextureFilter.MipMapNearestLinear:case Vt.TextureFilter.MipMapNearestNearest:return Vt.TextureFilter.Linear;default:return t}},$e.prototype.setWraps=function(t,e){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e)},$e.prototype.update=function(t){var e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),$e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)},$e.prototype.restore=function(){this.texture=null,this.update(this.useMipMaps)},$e.prototype.bind=function(t){void 0===t&&(t=0);var e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},$e.prototype.unbind=function(){var t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)},$e.prototype.dispose=function(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)},$e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1,Wt=$e,Yt.GLTexture=Wt,function(t){t.M00=0,t.M01=4,t.M02=8,t.M03=12,t.M10=1,t.M11=5,t.M12=9,t.M13=13,t.M20=2,t.M21=6,t.M22=10,t.M23=14,t.M30=3,t.M31=7,t.M32=11,t.M33=15;var e=(n.prototype.set=function(t){return MR()(this).set(t),this},n.prototype.transpose=function(){var e=this.temp,n=MR()(this);return e[t.M00]=n[t.M00],e[t.M01]=n[t.M10],e[t.M02]=n[t.M20],e[t.M03]=n[t.M30],e[t.M10]=n[t.M01],e[t.M11]=n[t.M11],e[t.M12]=n[t.M21],e[t.M13]=n[t.M31],e[t.M20]=n[t.M02],e[t.M21]=n[t.M12],e[t.M22]=n[t.M22],e[t.M23]=n[t.M32],e[t.M30]=n[t.M03],e[t.M31]=n[t.M13],e[t.M32]=n[t.M23],e[t.M33]=n[t.M33],this.set(e)},n.prototype.identity=function(){var e=MR()(this);return e[t.M00]=1,e[t.M01]=0,e[t.M02]=0,e[t.M03]=0,e[t.M10]=0,e[t.M11]=1,e[t.M12]=0,e[t.M13]=0,e[t.M20]=0,e[t.M21]=0,e[t.M22]=1,e[t.M23]=0,e[t.M30]=0,e[t.M31]=0,e[t.M32]=0,e[t.M33]=1,this},n.prototype.invert=function(){var e=MR()(this),n=this.temp,i=e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33];if(0==i)throw new Error("non-invertible matrix");var a=1/i;return n[t.M00]=e[t.M12]*e[t.M23]*e[t.M31]-e[t.M13]*e[t.M22]*e[t.M31]+e[t.M13]*e[t.M21]*e[t.M32]-e[t.M11]*e[t.M23]*e[t.M32]-e[t.M12]*e[t.M21]*e[t.M33]+e[t.M11]*e[t.M22]*e[t.M33],n[t.M01]=e[t.M03]*e[t.M22]*e[t.M31]-e[t.M02]*e[t.M23]*e[t.M31]-e[t.M03]*e[t.M21]*e[t.M32]+e[t.M01]*e[t.M23]*e[t.M32]+e[t.M02]*e[t.M21]*e[t.M33]-e[t.M01]*e[t.M22]*e[t.M33],n[t.M02]=e[t.M02]*e[t.M13]*e[t.M31]-e[t.M03]*e[t.M12]*e[t.M31]+e[t.M03]*e[t.M11]*e[t.M32]-e[t.M01]*e[t.M13]*e[t.M32]-e[t.M02]*e[t.M11]*e[t.M33]+e[t.M01]*e[t.M12]*e[t.M33],n[t.M03]=e[t.M03]*e[t.M12]*e[t.M21]-e[t.M02]*e[t.M13]*e[t.M21]-e[t.M03]*e[t.M11]*e[t.M22]+e[t.M01]*e[t.M13]*e[t.M22]+e[t.M02]*e[t.M11]*e[t.M23]-e[t.M01]*e[t.M12]*e[t.M23],n[t.M10]=e[t.M13]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M20]*e[t.M32]+e[t.M10]*e[t.M23]*e[t.M32]+e[t.M12]*e[t.M20]*e[t.M33]-e[t.M10]*e[t.M22]*e[t.M33],n[t.M11]=e[t.M02]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M22]*e[t.M30]+e[t.M03]*e[t.M20]*e[t.M32]-e[t.M00]*e[t.M23]*e[t.M32]-e[t.M02]*e[t.M20]*e[t.M33]+e[t.M00]*e[t.M22]*e[t.M33],n[t.M12]=e[t.M03]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M10]*e[t.M32]+e[t.M00]*e[t.M13]*e[t.M32]+e[t.M02]*e[t.M10]*e[t.M33]-e[t.M00]*e[t.M12]*e[t.M33],n[t.M13]=e[t.M02]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M12]*e[t.M20]+e[t.M03]*e[t.M10]*e[t.M22]-e[t.M00]*e[t.M13]*e[t.M22]-e[t.M02]*e[t.M10]*e[t.M23]+e[t.M00]*e[t.M12]*e[t.M23],n[t.M20]=e[t.M11]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M21]*e[t.M30]+e[t.M13]*e[t.M20]*e[t.M31]-e[t.M10]*e[t.M23]*e[t.M31]-e[t.M11]*e[t.M20]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M33],n[t.M21]=e[t.M03]*e[t.M21]*e[t.M30]-e[t.M01]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M20]*e[t.M31]+e[t.M00]*e[t.M23]*e[t.M31]+e[t.M01]*e[t.M20]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M33],n[t.M22]=e[t.M01]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M11]*e[t.M30]+e[t.M03]*e[t.M10]*e[t.M31]-e[t.M00]*e[t.M13]*e[t.M31]-e[t.M01]*e[t.M10]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M33],n[t.M23]=e[t.M03]*e[t.M11]*e[t.M20]-e[t.M01]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M10]*e[t.M21]+e[t.M00]*e[t.M13]*e[t.M21]+e[t.M01]*e[t.M10]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M23],n[t.M30]=e[t.M12]*e[t.M21]*e[t.M30]-e[t.M11]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M20]*e[t.M31]+e[t.M10]*e[t.M22]*e[t.M31]+e[t.M11]*e[t.M20]*e[t.M32]-e[t.M10]*e[t.M21]*e[t.M32],n[t.M31]=e[t.M01]*e[t.M22]*e[t.M30]-e[t.M02]*e[t.M21]*e[t.M30]+e[t.M02]*e[t.M20]*e[t.M31]-e[t.M00]*e[t.M22]*e[t.M31]-e[t.M01]*e[t.M20]*e[t.M32]+e[t.M00]*e[t.M21]*e[t.M32],n[t.M32]=e[t.M02]*e[t.M11]*e[t.M30]-e[t.M01]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M10]*e[t.M31]+e[t.M00]*e[t.M12]*e[t.M31]+e[t.M01]*e[t.M10]*e[t.M32]-e[t.M00]*e[t.M11]*e[t.M32],n[t.M33]=e[t.M01]*e[t.M12]*e[t.M20]-e[t.M02]*e[t.M11]*e[t.M20]+e[t.M02]*e[t.M10]*e[t.M21]-e[t.M00]*e[t.M12]*e[t.M21]-e[t.M01]*e[t.M10]*e[t.M22]+e[t.M00]*e[t.M11]*e[t.M22],e[t.M00]=n[t.M00]*a,e[t.M01]=n[t.M01]*a,e[t.M02]=n[t.M02]*a,e[t.M03]=n[t.M03]*a,e[t.M10]=n[t.M10]*a,e[t.M11]=n[t.M11]*a,e[t.M12]=n[t.M12]*a,e[t.M13]=n[t.M13]*a,e[t.M20]=n[t.M20]*a,e[t.M21]=n[t.M21]*a,e[t.M22]=n[t.M22]*a,e[t.M23]=n[t.M23]*a,e[t.M30]=n[t.M30]*a,e[t.M31]=n[t.M31]*a,e[t.M32]=n[t.M32]*a,e[t.M33]=n[t.M33]*a,this},n.prototype.determinant=function(){var e=MR()(this);return e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33]},n.prototype.translate=function(e,n,i){var a=MR()(this);return a[t.M03]+=e,a[t.M13]+=n,a[t.M23]+=i,this},n.prototype.copy=function(){return(new n).set(MR()(this))},n.prototype.projection=function(e,n,i,a){this.identity();var s=1/Math.tan(i*(Math.PI/180)/2),r=(n+e)/(e-n),o=2*n*e/(e-n),c=MR()(this);return c[t.M00]=s/a,c[t.M10]=0,c[t.M20]=0,c[t.M30]=0,c[t.M01]=0,c[t.M11]=s,c[t.M21]=0,c[t.M31]=0,c[t.M02]=0,c[t.M12]=0,c[t.M22]=r,c[t.M32]=-1,c[t.M03]=0,c[t.M13]=0,c[t.M23]=o,c[t.M33]=0,this},n.prototype.ortho2d=function(t,e,n,i){return this.ortho(t,t+n,e,e+i,0,1)},n.prototype.ortho=function(e,n,i,a,s,r){this.identity();var o=2/(n-e),c=2/(a-i),h=-2/(r-s),l=-(n+e)/(n-e),u=-(a+i)/(a-i),d=-(r+s)/(r-s),p=MR()(this);return p[t.M00]=o,p[t.M10]=0,p[t.M20]=0,p[t.M30]=0,p[t.M01]=0,p[t.M11]=c,p[t.M21]=0,p[t.M31]=0,p[t.M02]=0,p[t.M12]=0,p[t.M22]=h,p[t.M32]=0,p[t.M03]=l,p[t.M13]=u,p[t.M23]=d,p[t.M33]=1,this},n.prototype.multiply=function(e){var n=this.temp,i=MR()(this),a=MR()(e);return n[t.M00]=i[t.M00]*a[t.M00]+i[t.M01]*a[t.M10]+i[t.M02]*a[t.M20]+i[t.M03]*a[t.M30],n[t.M01]=i[t.M00]*a[t.M01]+i[t.M01]*a[t.M11]+i[t.M02]*a[t.M21]+i[t.M03]*a[t.M31],n[t.M02]=i[t.M00]*a[t.M02]+i[t.M01]*a[t.M12]+i[t.M02]*a[t.M22]+i[t.M03]*a[t.M32],n[t.M03]=i[t.M00]*a[t.M03]+i[t.M01]*a[t.M13]+i[t.M02]*a[t.M23]+i[t.M03]*a[t.M33],n[t.M10]=i[t.M10]*a[t.M00]+i[t.M11]*a[t.M10]+i[t.M12]*a[t.M20]+i[t.M13]*a[t.M30],n[t.M11]=i[t.M10]*a[t.M01]+i[t.M11]*a[t.M11]+i[t.M12]*a[t.M21]+i[t.M13]*a[t.M31],n[t.M12]=i[t.M10]*a[t.M02]+i[t.M11]*a[t.M12]+i[t.M12]*a[t.M22]+i[t.M13]*a[t.M32],n[t.M13]=i[t.M10]*a[t.M03]+i[t.M11]*a[t.M13]+i[t.M12]*a[t.M23]+i[t.M13]*a[t.M33],n[t.M20]=i[t.M20]*a[t.M00]+i[t.M21]*a[t.M10]+i[t.M22]*a[t.M20]+i[t.M23]*a[t.M30],n[t.M21]=i[t.M20]*a[t.M01]+i[t.M21]*a[t.M11]+i[t.M22]*a[t.M21]+i[t.M23]*a[t.M31],n[t.M22]=i[t.M20]*a[t.M02]+i[t.M21]*a[t.M12]+i[t.M22]*a[t.M22]+i[t.M23]*a[t.M32],n[t.M23]=i[t.M20]*a[t.M03]+i[t.M21]*a[t.M13]+i[t.M22]*a[t.M23]+i[t.M23]*a[t.M33],n[t.M30]=i[t.M30]*a[t.M00]+i[t.M31]*a[t.M10]+i[t.M32]*a[t.M20]+i[t.M33]*a[t.M30],n[t.M31]=i[t.M30]*a[t.M01]+i[t.M31]*a[t.M11]+i[t.M32]*a[t.M21]+i[t.M33]*a[t.M31],n[t.M32]=i[t.M30]*a[t.M02]+i[t.M31]*a[t.M12]+i[t.M32]*a[t.M22]+i[t.M33]*a[t.M32],n[t.M33]=i[t.M30]*a[t.M03]+i[t.M31]*a[t.M13]+i[t.M32]*a[t.M23]+i[t.M33]*a[t.M33],this.set(this.temp)},n.prototype.multiplyLeft=function(e){var n=this.temp,i=MR()(this),a=MR()(e);return n[t.M00]=a[t.M00]*i[t.M00]+a[t.M01]*i[t.M10]+a[t.M02]*i[t.M20]+a[t.M03]*i[t.M30],n[t.M01]=a[t.M00]*i[t.M01]+a[t.M01]*i[t.M11]+a[t.M02]*i[t.M21]+a[t.M03]*i[t.M31],n[t.M02]=a[t.M00]*i[t.M02]+a[t.M01]*i[t.M12]+a[t.M02]*i[t.M22]+a[t.M03]*i[t.M32],n[t.M03]=a[t.M00]*i[t.M03]+a[t.M01]*i[t.M13]+a[t.M02]*i[t.M23]+a[t.M03]*i[t.M33],n[t.M10]=a[t.M10]*i[t.M00]+a[t.M11]*i[t.M10]+a[t.M12]*i[t.M20]+a[t.M13]*i[t.M30],n[t.M11]=a[t.M10]*i[t.M01]+a[t.M11]*i[t.M11]+a[t.M12]*i[t.M21]+a[t.M13]*i[t.M31],n[t.M12]=a[t.M10]*i[t.M02]+a[t.M11]*i[t.M12]+a[t.M12]*i[t.M22]+a[t.M13]*i[t.M32],n[t.M13]=a[t.M10]*i[t.M03]+a[t.M11]*i[t.M13]+a[t.M12]*i[t.M23]+a[t.M13]*i[t.M33],n[t.M20]=a[t.M20]*i[t.M00]+a[t.M21]*i[t.M10]+a[t.M22]*i[t.M20]+a[t.M23]*i[t.M30],n[t.M21]=a[t.M20]*i[t.M01]+a[t.M21]*i[t.M11]+a[t.M22]*i[t.M21]+a[t.M23]*i[t.M31],n[t.M22]=a[t.M20]*i[t.M02]+a[t.M21]*i[t.M12]+a[t.M22]*i[t.M22]+a[t.M23]*i[t.M32],n[t.M23]=a[t.M20]*i[t.M03]+a[t.M21]*i[t.M13]+a[t.M22]*i[t.M23]+a[t.M23]*i[t.M33],n[t.M30]=a[t.M30]*i[t.M00]+a[t.M31]*i[t.M10]+a[t.M32]*i[t.M20]+a[t.M33]*i[t.M30],n[t.M31]=a[t.M30]*i[t.M01]+a[t.M31]*i[t.M11]+a[t.M32]*i[t.M21]+a[t.M33]*i[t.M31],n[t.M32]=a[t.M30]*i[t.M02]+a[t.M31]*i[t.M12]+a[t.M32]*i[t.M22]+a[t.M33]*i[t.M32],n[t.M33]=a[t.M30]*i[t.M03]+a[t.M31]*i[t.M13]+a[t.M32]*i[t.M23]+a[t.M33]*i[t.M33],this.set(this.temp)},n.prototype.lookAt=function(e,i,a){n.initTemps();var s=n.xAxis,r=n.yAxis,o=n.zAxis;o.setFrom(i).normalize(),s.setFrom(i).normalize(),s.cross(a).normalize(),r.setFrom(s).cross(o).normalize(),this.identity();var c=MR()(this);return c[t.M00]=s.x,c[t.M01]=s.y,c[t.M02]=s.z,c[t.M10]=r.x,c[t.M11]=r.y,c[t.M12]=r.z,c[t.M20]=-o.x,c[t.M21]=-o.y,c[t.M22]=-o.z,n.tmpMatrix.identity(),MR()(n.tmpMatrix)[t.M03]=-e.x,MR()(n.tmpMatrix)[t.M13]=-e.y,MR()(n.tmpMatrix)[t.M23]=-e.z,this.multiply(n.tmpMatrix),this},n.initTemps=function(){null===n.xAxis&&(n.xAxis=new t.Vector3),null===n.yAxis&&(n.yAxis=new t.Vector3),null===n.zAxis&&(n.zAxis=new t.Vector3)},n.xAxis=null,n.yAxis=null,n.zAxis=null,n.tmpMatrix=new n,n);function n(){this.temp=new Float32Array(16),this.values=new Float32Array(16);var e=MR()(this);e[t.M00]=1,e[t.M11]=1,e[t.M22]=1,e[t.M33]=1}t.Matrix4=e}((Ht=Se=Se||{}).webgl||(Ht.webgl={})),function(t){var e=(n.prototype.getAttributes=function(){return this.attributes},n.prototype.maxVertices=function(){return this.vertices.length/this.elementsPerVertex},n.prototype.numVertices=function(){return this.verticesLength/this.elementsPerVertex},n.prototype.setVerticesLength=function(t){this.dirtyVertices=!0,this.verticesLength=t},n.prototype.getVertices=function(){return this.vertices},n.prototype.maxIndices=function(){return this.indices.length},n.prototype.numIndices=function(){return this.indicesLength},n.prototype.setIndicesLength=function(t){this.dirtyIndices=!0,this.indicesLength=t},n.prototype.getIndices=function(){return this.indices},n.prototype.getVertexSizeInFloats=function(){for(var t=0,e=0;e<this.attributes.length;e++)t+=this.attributes[e].numElements;return t},n.prototype.setVertices=function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length},n.prototype.setIndices=function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length},n.prototype.draw=function(t,e){this.drawWithOffset(t,e,0,0<this.indicesLength?this.indicesLength:this.verticesLength/this.elementsPerVertex)},n.prototype.drawWithOffset=function(t,e,n,i){var a=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),0<this.indicesLength?a.drawElements(e,i,a.UNSIGNED_SHORT,2*n):a.drawArrays(e,n,i),this.unbind(t)},n.prototype.bind=function(t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var n=0,i=0;i<this.attributes.length;i++){var a=this.attributes[i],s=t.getAttributeLocation(a.name);e.enableVertexAttribArray(s),e.vertexAttribPointer(s,a.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*n),n+=a.numElements}0<this.indicesLength&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},n.prototype.unbind=function(t){for(var e=this.context.gl,n=0;n<this.attributes.length;n++){var i=this.attributes[n],a=t.getAttributeLocation(i.name);e.disableVertexAttribArray(a)}e.bindBuffer(e.ARRAY_BUFFER,null),0<this.indicesLength&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)},n.prototype.update=function(){var t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)},n.prototype.restore=function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()},n.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)},n);function n(e,n,i,a){this.attributes=n,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e instanceof t.ManagedWebGLRenderingContext?e:new t.ManagedWebGLRenderingContext(e);for(var s=this.elementsPerVertex=0;s<n.length;s++)this.elementsPerVertex+=n[s].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(a),this.context.addRestorable(this)}function i(t,e,n){this.name=t,this.type=e,this.numElements=n}t.Mesh=e,t.VertexAttribute=i;var a,s=(xe(r,a=i),r);function r(){return a.call(this,t.Shader.POSITION,v.Float,2)||this}t.Position2Attribute=s;var o,c=(xe(h,o=i),h);function h(){return o.call(this,t.Shader.POSITION,v.Float,3)||this}t.Position3Attribute=c;var l,u=(xe(d,l=i),d);function d(e){return void 0===e&&(e=0),l.call(this,t.Shader.TEXCOORDS+(0==e?"":e),v.Float,2)||this}t.TexCoordAttribute=u;var p,f=(xe(g,p=i),g);function g(){return p.call(this,t.Shader.COLOR,v.Float,4)||this}t.ColorAttribute=f;var m,v,y,S=(xe(A,m=i),A);function A(){return m.call(this,t.Shader.COLOR2,v.Float,4)||this}t.Color2Attribute=S,(y=v=t.VertexAttributeType||(t.VertexAttributeType={}))[y.Float=0]="Float"}((Xt=Se=Se||{}).webgl||(Xt.webgl={})),Kt=Se=Se||{},jt=Kt.webgl||(Kt.webgl={}),tn.prototype.begin=function(t){var e=this.context.gl;if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0,e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)},tn.prototype.setBlendMode=function(t,e){var n=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend))},tn.prototype.draw=function(t,e,n){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var i=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);for(var a=this.mesh.getIndices(),s=this.indicesLength,r=0;r<n.length;s++,r++)a[s]=n[r]+i;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)},tn.prototype.flush=function(){var t=this.context.gl;0!=this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,t.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)},tn.prototype.end=function(){var t=this.context.gl;if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(0<this.verticesLength||0<this.indicesLength)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1,t.disable(t.BLEND)},tn.prototype.getDrawCalls=function(){return this.drawCalls},tn.prototype.dispose=function(){this.mesh.dispose()},qt=tn,jt.PolygonBatcher=qt,Zt=Se=Se||{},Jt=Zt.webgl||(Zt.webgl={}),en.prototype.begin=function(){this.camera.update(),this.enableRenderer(this.batcher)},en.prototype.drawSkeleton=function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=-1),void 0===i&&(i=-1),this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,n,i)},en.prototype.drawSkeletonDebug=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,n)},en.prototype.drawTexture=function(t,e,n,i,a,s){void 0===s&&(s=null),this.enableRenderer(this.batcher),null===s&&(s=this.WHITE);var r=this.QUAD,o=0;r[o++]=e,r[o++]=n,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=0,r[o++]=1,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e+i,r[o++]=n,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=1,r[o++]=1,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e+i,r[o++]=n+a,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=1,r[o++]=0,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e,r[o++]=n+a,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=0,r[o++]=0,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),this.batcher.draw(t,r,this.QUAD_TRIANGLES)},en.prototype.drawTextureUV=function(t,e,n,i,a,s,r,o,c,h){void 0===h&&(h=null),this.enableRenderer(this.batcher),null===h&&(h=this.WHITE);var l=this.QUAD,u=0;l[u++]=e,l[u++]=n,l[u++]=h.r,l[u++]=h.g,l[u++]=h.b,l[u++]=h.a,l[u++]=s,l[u++]=r,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e+i,l[u++]=n,l[u++]=h.r,l[u++]=h.g,l[u++]=h.b,l[u++]=h.a,l[u++]=o,l[u++]=r,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e+i,l[u++]=n+a,l[u++]=h.r,l[u++]=h.g,l[u++]=h.b,l[u++]=h.a,l[u++]=o,l[u++]=c,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e,l[u++]=n+a,l[u++]=h.r,l[u++]=h.g,l[u++]=h.b,l[u++]=h.a,l[u++]=s,l[u++]=c,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),this.batcher.draw(t,l,this.QUAD_TRIANGLES)},en.prototype.drawTextureRotated=function(t,e,n,i,a,s,r,o,c,h){void 0===c&&(c=null),void 0===h&&(h=!1),this.enableRenderer(this.batcher),null===c&&(c=this.WHITE);var l,u,d=this.QUAD,p=e+s,f=n+r,g=-s,m=-r,v=i-s,y=a-r,S=g,A=m,x=g,E=y,b=v,w=y,T=v,C=m,M=0,I=0,P=0,k=0,R=0,_=0,O=0,D=0;k=0!=o?(P=(R=(l=Zt.MathUtils.cosDeg(o))*b-(u=Zt.MathUtils.sinDeg(o))*w)+((M=l*S-u*A)-(O=l*x-u*E)),(_=u*b+l*w)+((I=u*S+l*A)-(D=u*x+l*E))):(M=S,I=A,O=x,D=E,R=b,_=w,P=T,C),M+=p,I+=f,P+=p,k+=f,R+=p,_+=f,O+=p,D+=f;var B=0;d[B++]=M,d[B++]=I,d[B++]=c.r,d[B++]=c.g,d[B++]=c.b,d[B++]=c.a,d[B++]=0,d[B++]=1,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),d[B++]=P,d[B++]=k,d[B++]=c.r,d[B++]=c.g,d[B++]=c.b,d[B++]=c.a,d[B++]=1,d[B++]=1,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),d[B++]=R,d[B++]=_,d[B++]=c.r,d[B++]=c.g,d[B++]=c.b,d[B++]=c.a,d[B++]=1,d[B++]=0,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),d[B++]=O,d[B++]=D,d[B++]=c.r,d[B++]=c.g,d[B++]=c.b,d[B++]=c.a,d[B++]=0,d[B++]=0,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),this.batcher.draw(t,d,this.QUAD_TRIANGLES)},en.prototype.drawRegion=function(t,e,n,i,a,s,r){void 0===s&&(s=null),void 0===r&&(r=!1),this.enableRenderer(this.batcher),null===s&&(s=this.WHITE);var o=this.QUAD,c=0;o[c++]=e,o[c++]=n,o[c++]=s.r,o[c++]=s.g,o[c++]=s.b,o[c++]=s.a,o[c++]=t.u,o[c++]=t.v2,this.twoColorTint&&(o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0),o[c++]=e+i,o[c++]=n,o[c++]=s.r,o[c++]=s.g,o[c++]=s.b,o[c++]=s.a,o[c++]=t.u2,o[c++]=t.v2,this.twoColorTint&&(o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0),o[c++]=e+i,o[c++]=n+a,o[c++]=s.r,o[c++]=s.g,o[c++]=s.b,o[c++]=s.a,o[c++]=t.u2,o[c++]=t.v,this.twoColorTint&&(o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0),o[c++]=e,o[c++]=n+a,o[c++]=s.r,o[c++]=s.g,o[c++]=s.b,o[c++]=s.a,o[c++]=t.u,o[c++]=t.v,this.twoColorTint&&(o[c++]=0,o[c++]=0,o[c++]=0,o[c++]=0),this.batcher.draw(t.texture,o,this.QUAD_TRIANGLES)},en.prototype.line=function(t,e,n,i,a,s){void 0===a&&(a=null),void 0===s&&(s=null),this.enableRenderer(this.shapes),this.shapes.line(t,e,n,i,a)},en.prototype.triangle=function(t,e,n,i,a,s,r,o,c,h){void 0===o&&(o=null),void 0===c&&(c=null),void 0===h&&(h=null),this.enableRenderer(this.shapes),this.shapes.triangle(t,e,n,i,a,s,r,o,c,h)},en.prototype.quad=function(t,e,n,i,a,s,r,o,c,h,l,u,d){void 0===h&&(h=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===d&&(d=null),this.enableRenderer(this.shapes),this.shapes.quad(t,e,n,i,a,s,r,o,c,h,l,u,d)},en.prototype.rect=function(t,e,n,i,a,s){void 0===s&&(s=null),this.enableRenderer(this.shapes),this.shapes.rect(t,e,n,i,a,s)},en.prototype.rectLine=function(t,e,n,i,a,s,r){void 0===r&&(r=null),this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,n,i,a,s,r)},en.prototype.polygon=function(t,e,n,i){void 0===i&&(i=null),this.enableRenderer(this.shapes),this.shapes.polygon(t,e,n,i)},en.prototype.circle=function(t,e,n,i,a,s){void 0===a&&(a=null),void 0===s&&(s=0),this.enableRenderer(this.shapes),this.shapes.circle(t,e,n,i,a,s)},en.prototype.curve=function(t,e,n,i,a,s,r,o,c,h){void 0===h&&(h=null),this.enableRenderer(this.shapes),this.shapes.curve(t,e,n,i,a,s,r,o,c,h)},en.prototype.end=function(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null},en.prototype.resize=function(t){var e,n,i,a,s,r=this.canvas,o=r.clientWidth,c=r.clientHeight;r.width==o&&r.height==c||(r.width=o,r.height=c),this.context.gl.viewport(0,0,r.width,r.height),t===Qt.Stretch||(t===Qt.Expand?this.camera.setViewport(o,c):t===Qt.Fit&&(e=r.width,n=r.height,i=this.camera.viewportWidth,s=(a=this.camera.viewportHeight)/i<n/e?i/e:a/n,this.camera.viewportWidth=e*s,this.camera.viewportHeight=n*s)),this.camera.update()},en.prototype.enableRenderer=function(t){this.activeRenderer!==t&&(this.end(),t instanceof Jt.PolygonBatcher?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Jt.Shader.MVP_MATRIX,MR()(this.camera.projectionView)),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof Jt.ShapeRenderer?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Jt.Shader.MVP_MATRIX,MR()(this.camera.projectionView)),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)},en.prototype.dispose=function(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()},te=en,Jt.SceneRenderer=te,($t=Qt=Jt.ResizeMode||(Jt.ResizeMode={}))[$t.Stretch=0]="Stretch",$t[$t.Expand=1]="Expand",$t[$t.Fit=2]="Fit",ee=Se=Se||{},ne=ee.webgl||(ee.webgl={}),nn.prototype.getProgram=function(){return this.program},nn.prototype.getVertexShader=function(){return this.vertexShader},nn.prototype.getFragmentShader=function(){return this.fragmentShader},nn.prototype.getVertexShaderSource=function(){return this.vsSource},nn.prototype.getFragmentSource=function(){return this.fsSource},nn.prototype.compile=function(){var t=this.context.gl;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}},nn.prototype.compileShader=function(t,e){var n=this.context.gl,i=n.createShader(t);if(n.shaderSource(i,e),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var a="Couldn't compile shader: "+n.getShaderInfoLog(i);if(n.deleteShader(i),!n.isContextLost())throw new Error(a)}return i},nn.prototype.compileProgram=function(t,e){var n=this.context.gl,i=n.createProgram();if(n.attachShader(i,t),n.attachShader(i,e),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS)){var a="Couldn't compile shader program: "+n.getProgramInfoLog(i);if(n.deleteProgram(i),!n.isContextLost())throw new Error(a)}return i},nn.prototype.restore=function(){this.compile()},nn.prototype.bind=function(){this.context.gl.useProgram(this.program)},nn.prototype.unbind=function(){this.context.gl.useProgram(null)},nn.prototype.setUniformi=function(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)},nn.prototype.setUniformf=function(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)},nn.prototype.setUniform2f=function(t,e,n){this.context.gl.uniform2f(this.getUniformLocation(t),e,n)},nn.prototype.setUniform3f=function(t,e,n,i){this.context.gl.uniform3f(this.getUniformLocation(t),e,n,i)},nn.prototype.setUniform4f=function(t,e,n,i,a){this.context.gl.uniform4f(this.getUniformLocation(t),e,n,i,a)},nn.prototype.setUniform2x2f=function(t,e){var n=this.context.gl;this.tmp2x2.set(e),n.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)},nn.prototype.setUniform3x3f=function(t,e){var n=this.context.gl;this.tmp3x3.set(e),n.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)},nn.prototype.setUniform4x4f=function(t,e){var n=this.context.gl;this.tmp4x4.set(e),n.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)},nn.prototype.getUniformLocation=function(t){var e=this.context.gl,n=e.getUniformLocation(this.program,t);if(!n&&!e.isContextLost())throw new Error("Couldn't find location for uniform "+t);return n},nn.prototype.getAttributeLocation=function(t){var e=this.context.gl,n=e.getAttribLocation(this.program,t);if(-1==n&&!e.isContextLost())throw new Error("Couldn't find location for attribute "+t);return n},nn.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)},nn.newColoredTextured=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tattribute vec2 "+nn.TEXCOORDS+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = "+nn.COLOR+";\n\t\t\t\t\tv_texCoords = "+nn.TEXCOORDS+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n\t\t\t\t}\n\t\t\t")},nn.newTwoColoredTextured=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tattribute vec4 "+nn.COLOR2+";\n\t\t\t\tattribute vec2 "+nn.TEXCOORDS+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_light;\n\t\t\t\tvarying vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_light = "+nn.COLOR+";\n\t\t\t\t\tv_dark = "+nn.COLOR2+";\n\t\t\t\t\tv_texCoords = "+nn.TEXCOORDS+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_light;\n\t\t\t\tvarying LOWP vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\t\t\t\t\tgl_FragColor.a = texColor.a * v_light.a;\n\t\t\t\t\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n\t\t\t\t}\n\t\t\t")},nn.newColored=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = "+nn.COLOR+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color;\n\t\t\t\t}\n\t\t\t")},nn.MVP_MATRIX="u_projTrans",nn.POSITION="a_position",nn.COLOR="a_color",nn.COLOR2="a_color2",nn.TEXCOORDS="a_texCoords",nn.SAMPLER="u_texture",ie=nn,ne.Shader=ie,ae=Se=Se||{},se=ae.webgl||(ae.webgl={}),an.prototype.begin=function(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;var e=this.context.gl;e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)},an.prototype.setBlendMode=function(t,e){var n=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend))},an.prototype.setColor=function(t){this.color.setFromColor(t)},an.prototype.setColorWith=function(t,e,n,i){this.color.set(t,e,n,i)},an.prototype.point=function(t,e,n){void 0===n&&(n=null),this.check(re.Point,1),null===n&&(n=this.color),this.vertex(t,e,n)},an.prototype.line=function(t,e,n,i,a){void 0===a&&(a=null),this.check(re.Line,2),this.mesh.getVertices(),this.vertexIndex,null===a&&(a=this.color),this.vertex(t,e,a),this.vertex(n,i,a)},an.prototype.triangle=function(t,e,n,i,a,s,r,o,c,h){void 0===o&&(o=null),void 0===c&&(c=null),void 0===h&&(h=null),this.check(t?re.Filled:re.Line,3),this.mesh.getVertices(),this.vertexIndex,null===o&&(o=this.color),null===c&&(c=this.color),null===h&&(h=this.color),t?(this.vertex(e,n,o),this.vertex(i,a,c),this.vertex(s,r,h)):(this.vertex(e,n,o),this.vertex(i,a,c),this.vertex(i,a,o),this.vertex(s,r,c),this.vertex(s,r,o),this.vertex(e,n,c))},an.prototype.quad=function(t,e,n,i,a,s,r,o,c,h,l,u,d){void 0===h&&(h=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===d&&(d=null),this.check(t?re.Filled:re.Line,3),this.mesh.getVertices(),this.vertexIndex,null===h&&(h=this.color),null===l&&(l=this.color),null===u&&(u=this.color),null===d&&(d=this.color),t?(this.vertex(e,n,h),this.vertex(i,a,l),this.vertex(s,r,u),this.vertex(s,r,u)):(this.vertex(e,n,h),this.vertex(i,a,l),this.vertex(i,a,l),this.vertex(s,r,u),this.vertex(s,r,u),this.vertex(o,c,d)),this.vertex(o,c,d),this.vertex(e,n,h)},an.prototype.rect=function(t,e,n,i,a,s){void 0===s&&(s=null),this.quad(t,e,n,e+i,n,e+i,n+a,e,n+a,s,s,s,s)},an.prototype.rectLine=function(t,e,n,i,a,s,r){void 0===r&&(r=null),this.check(t?re.Filled:re.Line,8),null===r&&(r=this.color);var o=this.tmp.set(a-n,e-i);o.normalize(),s*=.5;var c=o.x*s,h=o.y*s;t?(this.vertex(e+c,n+h,r),this.vertex(e-c,n-h,r),this.vertex(i+c,a+h,r),this.vertex(i-c,a-h,r),this.vertex(i+c,a+h,r)):(this.vertex(e+c,n+h,r),this.vertex(e-c,n-h,r),this.vertex(i+c,a+h,r),this.vertex(i-c,a-h,r),this.vertex(i+c,a+h,r),this.vertex(e+c,n+h,r),this.vertex(i-c,a-h,r)),this.vertex(e-c,n-h,r)},an.prototype.x=function(t,e,n){this.line(t-n,e-n,t+n,e+n),this.line(t-n,e+n,t+n,e-n)},an.prototype.polygon=function(t,e,n,i){if(void 0===i&&(i=null),n<3)throw new Error("Polygon must contain at least 3 vertices");this.check(re.Line,2*n),null===i&&(i=this.color),this.mesh.getVertices(),this.vertexIndex,n<<=1;for(var a=t[e<<=1],s=t[e+1],r=e+n,o=e,c=e+n-2;o<c;o+=2){var h=t[o],l=t[o+1],u=0,d=r<=o+2?(u=a,s):(u=t[o+2],t[o+3]);this.vertex(h,l,i),this.vertex(u,d,i)}},an.prototype.circle=function(t,e,n,i,a,s){if(void 0===a&&(a=null),void 0===s&&(s=0),0===s&&(s=Math.max(1,6*ae.MathUtils.cbrt(i)|0)),s<=0)throw new Error("segments must be > 0.");null===a&&(a=this.color);var r=2*ae.MathUtils.PI/s,o=Math.cos(r),c=Math.sin(r),h=i,l=0;if(t){for(this.check(re.Filled,3*s+3),s--,d=0;d<s;d++){this.vertex(e,n,a),this.vertex(e+h,n+l,a);var u=h;h=o*h-c*l,l=c*u+o*l,this.vertex(e+h,n+l,a)}this.vertex(e,n,a),this.vertex(e+h,n+l,a)}else{this.check(re.Line,2*s+2);for(var d=0;d<s;d++){this.vertex(e+h,n+l,a);var p=h;h=o*h-c*l,l=c*p+o*l;this.vertex(e+h,n+l,a)}this.vertex(e+h,n+l,a)}h=i,l=0,this.vertex(e+h,n+l,a)},an.prototype.curve=function(t,e,n,i,a,s,r,o,c,h){void 0===h&&(h=null),this.check(re.Line,2*c+2),null===h&&(h=this.color);for(var l=1/c,u=l*l,d=l*l*l,p=3*l,f=3*u,g=6*u,m=6*d,v=t-2*n+a,y=e-2*i+s,S=3*(n-a)-t+r,A=3*(i-s)-e+o,x=t,E=e,b=(n-t)*p+v*f+S*d,w=(i-e)*p+y*f+A*d,T=v*g+S*m,C=y*g+A*m,M=S*m,I=A*m;0<c--;)this.vertex(x,E,h),x+=b,E+=w,b+=T,w+=C,T+=M,C+=I,this.vertex(x,E,h);this.vertex(x,E,h),this.vertex(r,o,h)},an.prototype.vertex=function(t,e,n){var i=this.vertexIndex,a=this.mesh.getVertices();a[i++]=t,a[i++]=e,a[i++]=n.r,a[i++]=n.g,a[i++]=n.b,a[i++]=n.a,this.vertexIndex=i},an.prototype.end=function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush(),this.context.gl.disable(this.context.gl.BLEND),this.isDrawing=!1},an.prototype.flush=function(){0!=this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)},an.prototype.check=function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t},an.prototype.dispose=function(){this.mesh.dispose()},ce=an,se.ShapeRenderer=ce,(oe=re=se.ShapeType||(se.ShapeType={}))[oe.Point=0]="Point",oe[oe.Line=1]="Line",oe[oe.Filled=4]="Filled",he=Se=Se||{},le=he.webgl||(he.webgl={}),sn.prototype.draw=function(t,e,n){void 0===n&&(n=null);var i=e.x,a=e.y,s=this.context.gl,r=this.premultipliedAlpha?s.ONE:s.SRC_ALPHA;t.setBlendMode(r,s.ONE_MINUS_SRC_ALPHA);var o=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(var c=0,h=o.length;c<h;c++){var l=o[c];n&&-1<g()(n).call(n,l.data.name)||null!=l.parent&&(b=i+l.data.length*l.a+l.worldX,w=a+l.data.length*l.c+l.worldY,t.rectLine(!0,i+l.worldX,a+l.worldY,b,w,this.boneWidth*this.scale))}this.drawSkeletonXY&&t.x(i,a,4*this.scale)}if(this.drawRegionAttachments)for(t.setColor(this.attachmentLineColor),c=0,h=(U=e.slots).length;c<h;c++)(Y=(V=U[c]).getAttachment())instanceof he.RegionAttachment&&(d=this.vertices,Y.computeWorldVertices(V.bone,d,0,2),t.line(d[0],d[1],d[2],d[3]),t.line(d[2],d[3],d[4],d[5]),t.line(d[4],d[5],d[6],d[7]),t.line(d[6],d[7],d[0],d[1]));if(this.drawMeshHull||this.drawMeshTriangles)for(c=0,h=(U=e.slots).length;c<h;c++)if((V=U[c]).bone.active&&(Y=V.getAttachment())instanceof he.MeshAttachment){var u=Y,d=this.vertices;u.computeWorldVertices(V,0,u.worldVerticesLength,d,0,2);var p=u.triangles,f=u.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(var m=0,v=p.length;m<v;m+=3){var y=2*p[m],S=2*p[m+1],A=2*p[m+2];t.triangle(!1,d[y],d[1+y],d[S],d[1+S],d[A],d[1+A])}}if(this.drawMeshHull&&0<f){t.setColor(this.attachmentLineColor);var x=d[(f=2*(f>>1))-2],E=d[f-1];for(m=0,v=f;m<v;m+=2){var b=d[m],w=d[m+1];t.line(b,w,x,E),x=b,E=w}}}if(this.drawBoundingBoxes){var T=this.bounds;T.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,T.minX,T.minY,T.getWidth(),T.getHeight());var C=T.polygons,M=T.boundingBoxes;for(c=0,h=C.length;c<h;c++){var I=C[c];t.setColor(M[c].color),t.polygon(I,0,I.length)}}if(this.drawPaths)for(c=0,h=(U=e.slots).length;c<h;c++)if((V=U[c]).bone.active&&(Y=V.getAttachment())instanceof he.PathAttachment){var P=Y,k=(v=P.worldVerticesLength,this.temp=he.Utils.setArraySize(this.temp,v,0));P.computeWorldVertices(V,0,v,k,0,2);var R=this.pathColor,_=k[2],O=k[3],D=0,B=0;for(P.closed&&(t.setColor(R),L=k[0],F=k[1],N=k[v-2],G=k[v-1],D=k[v-4],B=k[v-3],t.curve(_,O,L,F,N,G,D,B,32),t.setColor(sn.LIGHT_GRAY),t.line(_,O,L,F),t.line(D,B,N,G)),v-=4,m=4;m<v;m+=6){var L=k[m],F=k[m+1],N=k[m+2],G=k[m+3];D=k[m+4],B=k[m+5],t.setColor(R),t.curve(_,O,L,F,N,G,D,B,32),t.setColor(sn.LIGHT_GRAY),t.line(_,O,L,F),t.line(D,B,N,G),_=D,O=B}}if(this.drawBones)for(t.setColor(this.boneOriginColor),c=0,h=o.length;c<h;c++)l=o[c],n&&-1<g()(n).call(n,l.data.name)||t.circle(!0,i+l.worldX,a+l.worldY,3*this.scale,sn.GREEN,8);if(this.drawClipping){var U=e.slots;t.setColor(this.clipColor);var V,Y;for(c=0,h=U.length;c<h;c++)if((V=U[c]).bone.active&&(Y=V.getAttachment())instanceof he.ClippingAttachment){var z=Y;v=z.worldVerticesLength,k=this.temp=he.Utils.setArraySize(this.temp,v,0);z.computeWorldVertices(V,0,v,k,0,2);for(var W=0,H=k.length;W<H;W+=2)b=k[W],w=k[W+1],D=k[(W+2)%k.length],B=k[(W+3)%k.length],t.line(b,w,D,B)}}},sn.prototype.dispose=function(){},sn.LIGHT_GRAY=new he.Color(192/255,192/255,192/255,1),sn.GREEN=new he.Color(0,1,0,1),ue=sn,le.SkeletonDebugRenderer=ue,de=Se=Se||{},pe=de.webgl||(de.webgl={}),fe=function(t,e,n){this.vertices=t,this.numVertices=e,this.numFloats=n},rn.prototype.draw=function(t,e,n,i){void 0===n&&(n=-1),void 0===i&&(i=-1);var a=this.clipper,s=this.premultipliedAlpha,r=this.twoColorTint,o=null,c=this.temp,h=this.temp2,l=this.temp3,u=this.temp4,d=this.renderable,p=null,f=null,g=e.drawOrder,m=null,v=e.color,y=r?12:8,S=!1;-1==n&&(S=!0);for(var A=0,x=g.length;A<x;A++){var E=a.isClipping()?2:y,b=g[A];if(b.bone.active)if(0<=n&&n==b.data.index&&(S=!0),S){0<=i&&i==b.data.index&&(S=!1);var w=b.getAttachment(),T=null;if(w instanceof de.RegionAttachment){var C=w;d.vertices=this.vertices,d.numVertices=4,d.numFloats=E<<2,C.computeWorldVertices(b.bone,d.vertices,0,E),f=rn.QUAD_TRIANGLES,p=C.uvs,T=C.region.renderObject.texture,m=C.color}else{if(!(w instanceof de.MeshAttachment)){if(w instanceof de.ClippingAttachment){a.clipStart(b,w);continue}a.clipEndWithSlot(b);continue}var M=w;d.vertices=this.vertices,d.numVertices=M.worldVerticesLength>>1,d.numFloats=d.numVertices*E,d.numFloats>d.vertices.length&&(d.vertices=this.vertices=de.Utils.newFloatArray(d.numFloats)),M.computeWorldVertices(b,0,M.worldVerticesLength,d.vertices,0,E),f=M.triangles,T=M.region.renderObject.texture,p=M.uvs,m=M.color}if(null!=T){var I=b.color,P=this.tempColor;P.r=v.r*I.r*m.r,P.g=v.g*I.g*m.g,P.b=v.b*I.b*m.b,P.a=v.a*I.a*m.a,s&&(P.r*=P.a,P.g*=P.a,P.b*=P.a);var k=this.tempColor2;null==b.darkColor?k.set(0,0,0,1):(s?(k.r=b.darkColor.r*P.a,k.g=b.darkColor.g*P.a,k.b=b.darkColor.b*P.a):k.setFromColor(b.darkColor),k.a=s?1:0);var R=b.data.blendMode;if(R!=o&&(o=R,t.setBlendMode(pe.WebGLBlendModeConverter.getSourceGLBlendMode(o,s),pe.WebGLBlendModeConverter.getDestGLBlendMode(o))),a.isClipping()){a.clipTriangles(d.vertices,d.numFloats,f,f.length,p,P,k,r);var _=new Float32Array(a.clippedVertices),O=a.clippedTriangles;if(null!=this.vertexEffect){var D=this.vertexEffect,B=_;if(r)for(var L=0,F=_.length;L<F;L+=y)c.x=B[L],c.y=B[L+1],l.set(B[L+2],B[L+3],B[L+4],B[L+5]),h.x=B[L+6],h.y=B[L+7],u.set(B[L+8],B[L+9],B[L+10],B[L+11]),D.transform(c,h,l,u),B[L]=c.x,B[L+1]=c.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=h.x,B[L+7]=h.y,B[L+8]=u.r,B[L+9]=u.g,B[L+10]=u.b,B[L+11]=u.a;else{L=0;for(var N=_.length;L<N;L+=y)c.x=B[L],c.y=B[L+1],l.set(B[L+2],B[L+3],B[L+4],B[L+5]),h.x=B[L+6],h.y=B[L+7],u.set(0,0,0,0),D.transform(c,h,l,u),B[L]=c.x,B[L+1]=c.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=h.x,B[L+7]=h.y}}t.draw(T,_,O)}else{if(B=d.vertices,null!=this.vertexEffect)if(D=this.vertexEffect,r){L=0;for(var G=0,U=d.numFloats;L<U;L+=y,G+=2)c.x=B[L],c.y=B[L+1],h.x=p[G],h.y=p[G+1],l.setFromColor(P),u.setFromColor(k),D.transform(c,h,l,u),B[L]=c.x,B[L+1]=c.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=h.x,B[L+7]=h.y,B[L+8]=u.r,B[L+9]=u.g,B[L+10]=u.b,B[L+11]=u.a}else{L=0,G=0;for(var V=d.numFloats;L<V;L+=y,G+=2)c.x=B[L],c.y=B[L+1],h.x=p[G],h.y=p[G+1],l.setFromColor(P),u.set(0,0,0,0),D.transform(c,h,l,u),B[L]=c.x,B[L+1]=c.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=h.x,B[L+7]=h.y}else if(r){L=2,G=0;for(var Y=d.numFloats;L<Y;L+=y,G+=2)B[L]=P.r,B[L+1]=P.g,B[L+2]=P.b,B[L+3]=P.a,B[L+4]=p[G],B[L+5]=p[G+1],B[L+6]=k.r,B[L+7]=k.g,B[L+8]=k.b,B[L+9]=k.a}else{L=2,G=0;for(var z=d.numFloats;L<z;L+=y,G+=2)B[L]=P.r,B[L+1]=P.g,B[L+2]=P.b,B[L+3]=P.a,B[L+4]=p[G],B[L+5]=p[G+1]}var W=d.vertices.subarray(0,d.numFloats);t.draw(T,W,f)}}a.clipEndWithSlot(b)}else a.clipEndWithSlot(b);else a.clipEndWithSlot(b)}a.clipEnd()},rn.QUAD_TRIANGLES=[0,1,2,2,3,0],ge=rn,pe.SkeletonRenderer=ge,me=Se=Se||{},ve=me.webgl||(me.webgl={}),on.prototype.setFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},on.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},on.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},on.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},on.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},on.prototype.normalize=function(){var t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this},on.prototype.cross=function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},on.prototype.multiply=function(t){var e=MR()(t);return this.set(this.x*e[ve.M00]+this.y*e[ve.M01]+this.z*e[ve.M02]+e[ve.M03],this.x*e[ve.M10]+this.y*e[ve.M11]+this.z*e[ve.M12]+e[ve.M13],this.x*e[ve.M20]+this.y*e[ve.M21]+this.z*e[ve.M22]+e[ve.M23])},on.prototype.project=function(t){var e=MR()(t),n=1/(this.x*e[ve.M30]+this.y*e[ve.M31]+this.z*e[ve.M32]+e[ve.M33]);return this.set((this.x*e[ve.M00]+this.y*e[ve.M01]+this.z*e[ve.M02]+e[ve.M03])*n,(this.x*e[ve.M10]+this.y*e[ve.M11]+this.z*e[ve.M12]+e[ve.M13])*n,(this.x*e[ve.M20]+this.y*e[ve.M21]+this.z*e[ve.M22]+e[ve.M23])*n)},on.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},on.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},on.prototype.distance=function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z;return Math.sqrt(e*e+n*n+i*i)},ye=on,ve.Vector3=ye,function(t){var e=(n.prototype.setupCanvas=function(t,e){var n=this;this.gl=t.getContext("webgl2",e)||t.getContext("webgl",e),(this.canvas=t).addEventListener("webglcontextlost",(function(t){t&&t.preventDefault()})),t.addEventListener("webglcontextrestored",(function(t){for(var e=0,i=n.restorables.length;e<i;e++)n.restorables[e].restore()}))},n.prototype.addRestorable=function(t){this.restorables.push(t)},n.prototype.removeRestorable=function(t){var e,n,i=g()(e=this.restorables).call(e,t);-1<i&&vr()(n=this.restorables).call(n,i,1)},n);function n(t,e){void 0===e&&(e={alpha:"true"}),this.restorables=new Array,t instanceof HTMLCanvasElement||t instanceof EventTarget?this.setupCanvas(t,e):(this.gl=t,this.canvas=this.gl.canvas)}t.ManagedWebGLRenderingContext=e;var i=(a.getDestGLBlendMode=function(t){switch(t){case Ae.BlendMode.Normal:return a.ONE_MINUS_SRC_ALPHA;case Ae.BlendMode.Additive:return a.ONE;case Ae.BlendMode.Multiply:case Ae.BlendMode.Screen:return a.ONE_MINUS_SRC_ALPHA;default:throw new Error("Unknown blend mode: "+t)}},a.getSourceGLBlendMode=function(t,e){switch(void 0===e&&(e=!1),t){case Ae.BlendMode.Normal:case Ae.BlendMode.Additive:return e?a.ONE:a.SRC_ALPHA;case Ae.BlendMode.Multiply:return a.DST_COLOR;case Ae.BlendMode.Screen:return a.ONE;default:throw new Error("Unknown blend mode: "+t)}},a.ZERO=0,a.ONE=1,a.SRC_COLOR=768,a.ONE_MINUS_SRC_COLOR=769,a.SRC_ALPHA=770,a.ONE_MINUS_SRC_ALPHA=771,a.DST_ALPHA=772,a.ONE_MINUS_DST_ALPHA=773,a.DST_COLOR=774,a);function a(){}t.WebGLBlendModeConverter=i}((Ae=Se=Se||{}).webgl||(Ae.webgl={})),t.exports=Se}).call(window)},function(t,e,n){var i=n(0),a=n(11),s=n(204),r=n(7),o=n(218),c=n(219),h=n(220),l=new i({Extends:c,initialize:function(t,e,n,i,s,l,u){var d,p,f,g=[],m=t.cacheManager.custom.spine;if(r(e)){var v=e;for(e=a(v,"key"),p=new o(t,{key:e,url:a(v,"jsonURL"),extension:a(v,"jsonExtension","json"),xhrSettings:a(v,"jsonXhrSettings")}),i=a(v,"atlasURL"),s=a(v,"preMultipliedAlpha"),Array.isArray(i)||(i=[i]),d=0;d<i.length;d++)(f=new h(t,{key:e+"!"+d,url:i[d],extension:a(v,"atlasExtension","atlas"),xhrSettings:a(v,"atlasXhrSettings")})).cache=m,g.push(f)}else for(p=new o(t,e,n,l),Array.isArray(i)||(i=[i]),d=0;d<i.length;d++)(f=new h(t,e+"!"+d,i[d],u)).cache=m,g.push(f);g.unshift(p),c.call(this,t,"spine",e,g),this.config.preMultipliedAlpha=s},onFileComplete:function(t){var e;if(-1!==g()(e=this.files).call(e,t)&&(this.pending--,"text"===t.type)){for(var n=t.data.split("\n"),i=[],r=0;r<n.length;r++){var o=n[r];""===rf()(o).call(o)&&r<n.length-1&&(o=n[r+1],i.push(o))}var c=this.config,h=this.loader,l=h.baseURL,u=h.path,d=h.prefix,p=a(c,"baseURL",this.baseURL),f=a(c,"path",t.src.match(/^.*\//))[0],m=a(c,"prefix",this.prefix),v=a(c,"textureXhrSettings");h.setBaseURL(p),h.setPath(f),h.setPrefix(m);for(var y=0;y<i.length;y++){var S=i[y],A=new s(h,S,S,v);h.keyExists(A)||(this.addToMultiFile(A),h.addFile(A))}h.setBaseURL(l),h.setPath(u),h.setPrefix(d)}},addToCache:function(){if(this.isReadyToProcess()){var t;this.files[0].addToCache();for(var e="",n="",i=!!this.config.preMultipliedAlpha,a=this.loader.textureManager,s=1;s<this.files.length;s++){var r,o,c,h,l,u=this.files[s];"text"===u.type?(e=u.key.replace(/![\d]$/,""),t=u.cache,n=et()(n).call(n,u.data)):(h=g()(r=c=rf()(o=u.key).call(o)).call(r,"!"),l=c.substr(h+1),a.exists(l)||a.addImage(l,u.data)),u.pendingDestroy()}t.add(e,{preMultipliedAlpha:i,data:n,prefix:this.prefix}),this.complete=!0}}});t.exports=l},function(t,e,n){var i=n(0),a=n(15),s=n(21),r=n(22),o=n(11),c=n(7),h=new i({Extends:s,initialize:function t(e,n,i,a,r){var h,l,u="png";c(n)&&(n=o(l=n,"key"),i=o(l,"url"),h=o(l,"normalMap"),a=o(l,"xhrSettings"),u=o(l,"extension",u),r=o(l,"frameConfig")),Array.isArray(i)&&(h=i[1],i=i[0]);var d,p={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:i,xhrSettings:a,config:r};s.call(this,e,p),h&&((d=new t(e,this.key,h,a,r)).type="normalMap",this.setLink(d),e.addFile(d))},onProcess:function(){this.state=a.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){s.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(t.data),t.onProcessError()},s.createObjectURL(this.data,this.xhrLoader.response,"image/png")},addToCache:function(){var t,e=this.linkFile;e&&e.state===a.FILE_COMPLETE?(t="image"===this.type?this.cache.addImage(this.key,this.data,e.data):this.cache.addImage(e.key,e.data,this.data),this.pendingDestroy(t),e.pendingDestroy(t)):e||(t=this.cache.addImage(this.key,this.data),this.pendingDestroy(t))}});r.register("image",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new h(this,t[i]));else this.addFile(new h(this,t,e,n));return this})),t.exports=h},function(t,e,n){t.exports={ADD:n(206),COMPLETE:n(207),FILE_COMPLETE:n(208),FILE_KEY_COMPLETE:n(209),FILE_LOAD_ERROR:n(210),FILE_LOAD:n(211),FILE_PROGRESS:n(212),POST_PROCESS:n(213),PROGRESS:n(214),START:n(215)}},function(t,e){t.exports="addfile"},function(t,e){t.exports="complete"},function(t,e){t.exports="filecomplete"},function(t,e){t.exports="filecomplete-"},function(t,e){t.exports="loaderror"},function(t,e){t.exports="load"},function(t,e){t.exports="fileprogress"},function(t,e){t.exports="postprocess"},function(t,e){t.exports="progress"},function(t,e){t.exports="start"},function(t,e){t.exports=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}},function(t,e,n){var i=n(45);t.exports=function(t,e){var n=i(e,t.xhrSettings),a=new XMLHttpRequest;if(a.open("GET",t.src,n.async,n.user,n.password),a.responseType=t.xhrSettings.responseType,a.timeout=n.timeout,n.headers)for(var s in n.headers)a.setRequestHeader(s,n.headers[s]);return n.header&&n.headerValue&&a.setRequestHeader(n.header,n.headerValue),n.requestedWith&&a.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&a.overrideMimeType(n.overrideMimeType),n.withCredentials&&(a.withCredentials=!0),a.onload=t.onLoad.bind(t,a),a.onerror=t.onError.bind(t,a),a.onprogress=t.onProgress.bind(t),a.send(),a}},function(t,e,n){var i=n(0),a=n(15),s=n(21),r=n(22),o=n(11),c=n(10),h=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,r){var l,u="json";h(e)&&(e=o(l=e,"key"),n=o(l,"url"),i=o(l,"xhrSettings"),u=o(l,"extension",u),r=o(l,"dataKey",r));var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:e,url:n,xhrSettings:i,config:r};s.call(this,t,d),h(n)&&(this.data=r?c(n,r):n,this.state=a.FILE_POPULATED)},onProcess:function(){if(this.state!==a.FILE_POPULATED){this.state=a.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw console.warn("Invalid JSON: "+this.key),this.onProcessError(),t}var e=this.config;this.data="string"==typeof e?c(t,e,t):t}this.onProcessComplete()}});r.register("json",(function(t,e,n,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)this.addFile(new l(this,t[a]));else this.addFile(new l(this,t,e,i,n));return this})),t.exports=l},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){var a=[];i.forEach((function(t){t&&a.push(t)})),this.loader=t,this.type=e,this.key=n,this.multiKeyIndex=t.multiKeyIndex++,this.files=a,this.complete=!1,this.pending=a.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var s=0;s<a.length;s++)a[s].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),(t.multiFile=this).pending++,this.complete=!1,this},onFileComplete:function(t){var e;-1!==g()(e=this.files).call(e,t)&&this.pending--},onFileFailed:function(t){var e;-1!==g()(e=this.files).call(e,t)&&this.failed++}});t.exports=i},function(t,e,n){var i=n(0),a=n(15),s=n(21),r=n(22),o=n(11),c=n(7),h=new i({Extends:s,initialize:function(t,e,n,i){var a,r="text",h="txt",l=t.cacheManager.text;c(e)&&(e=o(a=e,"key"),n=o(a,"url"),i=o(a,"xhrSettings"),h=o(a,"extension",h),r=o(a,"type",r),l=o(a,"cache",l));var u={type:r,cache:l,extension:h,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=a.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});r.register("text",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new h(this,t[i]));else this.addFile(new h(this,t,e,n));return this})),t.exports=h},function(t,e,n){var i=n(28),a=n(3),s=n(0),r=n(47),o=n(48),c=n(49),h=n(50),l=n(51),u=n(52),d=n(8),p=n(19),f=n(53),g=n(9),m=n(243),v=n(250),y=new s({Extends:f,Mixins:[r,o,c,h,l,u,v],initialize:function(t,e,n,i,a,s,r){f.call(this,t,"Spine"),this.plugin=e,this.skeleton=null,this.skeletonData=null,this.state=null,this.stateData=null,this.root=null,this.bounds=null,this.drawDebug=!1,this.timeScale=1,this.displayOriginX=0,this.displayOriginY=0,this.preMultipliedAlpha=!1,this.blendMode=-1,this.setPosition(n,i),a&&this.setSkeleton(a,s,r)},willRender:function(t,e){var n,i,a=!this.skeleton||!(15!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id);return e||a||!this.parentContainer||(i=(n=this.plugin).sceneRenderer,n.gl&&i.batcher.isDrawing&&(i.end(),n.renderer.pipelines.rebind())),a},setAlpha:function(t,e){var n;return void 0===t&&(t=1),e?(n=this.findSlot(e))&&(n.color.a=a(t,0,1)):this.alpha=t,this},alpha:{get:function(){return this.skeleton.color.a},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.a=e),0===e?this.renderFlags&=-3:this.renderFlags|=2}},red:{get:function(){return this.skeleton.color.r},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.r=e)}},green:{get:function(){return this.skeleton.color.g},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.g=e)}},blue:{get:function(){return this.skeleton.color.b},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.b=e)}},setColor:function(t,e){void 0===t&&(t=16777215);var n,i=(t>>16&255)/255,a=(t>>8&255)/255,s=(255&t)/255,r=16777215<t?(t>>>24)/255:null,o=this.skeleton;return!e||(n=this.findSlot(e))&&(o=n),o.color.r=i,o.color.g=a,o.color.b=s,null!==r&&(o.color.a=r),this},setSkeletonFromJSON:function(t,e,n,i){return this.setSkeleton(t,e,n,i)},setSkeleton:function(t,e,n,i){this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications());var a=this.plugin.createSkeleton(t,i);this.skeletonData=a.skeletonData,this.preMultipliedAlpha=a.preMultipliedAlpha;var s=a.skeleton;return s.setSkin(),s.setToSetupPose(),this.skeleton=s,a=this.plugin.createAnimationState(s),this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications()),this.state=a.state,this.stateData=a.stateData,this.state.addListener({event:this.onEvent.bind(this),complete:this.onComplete.bind(this),start:this.onStart.bind(this),end:this.onEnd.bind(this),dispose:this.onDispose.bind(this),interrupted:this.onInterrupted.bind(this)}),e&&this.setAnimation(0,e,n),this.root=this.getRootBone(),this.root&&(this.root.rotation=g(d(this.rotation))+90),this.state.apply(s),s.updateCache(),this.updateSize()},onComplete:function(t){this.emit(m.COMPLETE,t)},onDispose:function(t){this.emit(m.DISPOSE,t)},onEnd:function(t){this.emit(m.END,t)},onEvent:function(t,e){this.emit(m.EVENT,t,e)},onInterrupted:function(t){this.emit(m.INTERRUPTED,t)},onStart:function(t){this.emit(m.START,t)},refresh:function(){return this.root&&(this.root.rotation=g(d(this.rotation))+90),this.updateSize(),this.skeleton.updateCache(),this},setSize:function(t,e,n,i){var a=this.skeleton;return void 0===t&&(t=a.data.width),void 0===e&&(e=a.data.height),void 0===n&&(n=0),void 0===i&&(i=0),this.width=t,this.height=e,this.displayOriginX=a.x-n,this.displayOriginY=a.y-i,this},setOffset:function(t,e){var n=this.skeleton;return void 0===t&&(t=0),void 0===e&&(e=0),this.displayOriginX=n.x-t,this.displayOriginY=n.y-e,this},updateSize:function(){var t=this.skeleton,e=this.plugin.renderer.height,n=this.scaleX,i=this.scaleY;t.x=this.x,t.y=e-this.y,t.scaleX=1,t.scaleY=1,t.updateWorldTransform();var a=this.getBounds();return this.width=a.size.x,this.height=a.size.y,this.displayOriginX=this.x-a.offset.x,this.displayOriginY=this.y-(e-(this.height+a.offset.y)),t.scaleX=n,t.scaleY=i,t.updateWorldTransform(),this},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this.refresh()}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,this.refresh()}},getBoneList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.bones.length;n++)t.push(e.bones[n].name);return t},getSkinList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.skins.length;n++)t.push(e.skins[n].name);return t},getSlotList:function(){for(var t=[],e=this.skeleton,n=0;n<e.slots.length;n++)t.push(e.slots[n].data.name);return t},getAnimationList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.animations.length;n++)t.push(e.animations[n].name);return t},getCurrentAnimation:function(t){void 0===t&&(t=0);var e=this.state.getCurrent(t);if(e)return e.animation},play:function(t,e,n){return this.setAnimation(0,t,e,n),this},setAnimation:function(t,e,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),i&&this.state){var a=this.state.getCurrent(t);if(a&&a.animation.name===e&&!a.isComplete())return}if(this.findAnimation(e))return this.state.setAnimation(t,e,n)},addAnimation:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i=0),this.state.addAnimation(t,e,n,i)},setEmptyAnimation:function(t,e){return this.state.setEmptyAnimation(t,e)},clearTrack:function(t){return this.state.clearTrack(t),this},clearTracks:function(){return this.state.clearTracks(),this},setSkinByName:function(t){var e=this.skeleton;return e.setSkinByName(t),e.setSlotsToSetupPose(),this.state.apply(e),this},setSkin:function(t){var e=this.skeleton;return e.setSkin(t),e.setSlotsToSetupPose(),this.state.apply(e),this},setMix:function(t,e,n){return this.stateData.setMix(t,e,n),this},getAttachment:function(t,e){return this.skeleton.getAttachment(t,e)},getAttachmentByName:function(t,e){return this.skeleton.getAttachmentByName(t,e)},setAttachment:function(t,e){if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length)for(var n=0;n<t.length;n++)this.skeleton.setAttachment(t[n],e[n]);else this.skeleton.setAttachment(t,e);return this},setToSetupPose:function(){return this.skeleton.setToSetupPose(),this},setSlotsToSetupPose:function(){return this.skeleton.setSlotsToSetupPose(),this},setBonesToSetupPose:function(){return this.skeleton.setBonesToSetupPose(),this},getRootBone:function(){return this.skeleton.getRootBone()},angleBoneToXY:function(t,e,n,s,r,o){void 0===s&&(s=0),void 0===r&&(r=0),void 0===o&&(o=360);var c=this.plugin.renderer.height,h=d(i(t.worldX,c-t.worldY,e,n)+p(s));return t.rotation=a(g(h),r,o),this},findBone:function(t){return this.skeleton.findBone(t)},findBoneIndex:function(t){return this.skeleton.findBoneIndex(t)},findSlot:function(t){return this.skeleton.findSlot(t)},findSlotIndex:function(t){return this.skeleton.findSlotIndex(t)},findSkin:function(t){return this.skeletonData.findSkin(t)},findEvent:function(t){return this.skeletonData.findEvent(t)},findAnimation:function(t){return this.skeletonData.findAnimation(t)},findIkConstraint:function(t){return this.skeletonData.findIkConstraint(t)},findTransformConstraint:function(t){return this.skeletonData.findTransformConstraint(t)},findPathConstraint:function(t){return this.skeletonData.findPathConstraint(t)},findPathConstraintIndex:function(t){return this.skeletonData.findPathConstraintIndex(t)},getBounds:function(){return this.plugin.getBounds(this.skeleton)},preUpdate:function(t,e){var n=this.skeleton;this.state.update(e/1e3*this.timeScale),this.state.apply(n)},preDestroy:function(){this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications()),this.plugin=null,this.skeleton=null,this.skeletonData=null,this.state=null,this.stateData=null}});t.exports=y},function(t,e,n){var i=n(0),a=n(223),s=new i({initialize:function(t,e){this.parent=t,(this.events=e)||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(a.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var n=[],i=0;i<t.length;i++)n.push(e[t[i]]);return n}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var n in this.list)this.list.hasOwnProperty(n)&&n.match(t)&&(e[n]=this.list[n]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var n in t)this.setValue(n,t[n]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var n=this.get(t);return void 0===n&&(n=0),this.set(t,n+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,e){return this._frozen||(this.has(t)?MR()(this)[t]=e:(i=(n=this).list,s=this.events,r=this.parent,oR()(MR()(this),t,{enumerable:!0,configurable:!0,get:function(){return i[t]},set:function(e){var o;n._frozen||(o=i[t],i[t]=e,s.emit(a.CHANGE_DATA,r,t,e,o),s.emit(a.CHANGE_DATA_KEY+t,r,e,o))}}),i[t]=e,s.emit(a.SET_DATA,r,t,e))),this;var n,i,s,r},each:function(t,e){for(var n=[this.parent,null,void 0],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var a in this.list)n[1]=a,n[2]=this.list[a],t.apply(e,n);return this},merge:function(t,e){for(var n in void 0===e&&(e=!0),t)t.hasOwnProperty(n)&&(e||!e&&!this.has(n))&&this.setValue(n,t[n]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){var e;return this.has(t)&&(e=this.list[t],delete this.list[t],delete MR()(this)[t],this.events.emit(a.REMOVE_DATA,this.parent,t,e)),this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete MR()(this)[t],this.events.emit(a.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete MR()(this)[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(a.CHANGE_DATA),this.events.off(a.SET_DATA),this.events.off(a.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});t.exports=s},function(t,e,n){t.exports={CHANGE_DATA:n(224),CHANGE_DATA_KEY:n(225),DESTROY:n(226),REMOVE_DATA:n(227),SET_DATA:n(228)}},function(t,e){t.exports="changedata"},function(t,e){t.exports="changedata-"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedata"},function(t,e){t.exports="setdata"},function(t,e,n){var i=Object.prototype.hasOwnProperty,a="~";function s(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function c(t,e,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var r=new o(n,i||t,s),c=a?a+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],r]:t._events[c].push(r):(t._events[c]=r,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function l(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(a=!1)),l.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(a?r()(e).call(e,1):e);return PR()?et()(n).call(n,PR()(t)):n},l.prototype.listeners=function(t){var e=a?a+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,r=new Array(s);i<s;i++)r[i]=n[i].fn;return r},l.prototype.listenerCount=function(t){var e=a?a+t:t,n=this._events[e];return n?n.fn?1:n.length:0},l.prototype.emit=function(t,e,n,i,s,r){var o=a?a+t:t;if(!this._events[o])return!1;var c,h=this._events[o],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,i),!0;case 5:return h.fn.call(h.context,e,n,i,s),!0;case 6:return h.fn.call(h.context,e,n,i,s,r),!0}for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];h.fn.apply(h.context,c)}else for(var u,d=h.length,p=0;p<d;p++)switch(h[p].once&&this.removeListener(t,h[p].fn,void 0,!0),l){case 1:h[p].fn.call(h[p].context);break;case 2:h[p].fn.call(h[p].context,e);break;case 3:h[p].fn.call(h[p].context,e,n);break;case 4:h[p].fn.call(h[p].context,e,n,i);break;default:if(!c)for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];h[p].fn.apply(h[p].context,c)}return!0},l.prototype.on=function(t,e,n){return c(this,t,e,n,!1)},l.prototype.once=function(t,e,n){return c(this,t,e,n,!0)},l.prototype.removeListener=function(t,e,n,i){var s=a?a+t:t;if(!this._events[s])return this;if(!e)return h(this,s),this;var r=this._events[s];if(r.fn)r.fn!==e||i&&!r.once||n&&r.context!==n||h(this,s);else{for(var o=0,c=[],l=r.length;o<l;o++)(r[o].fn!==e||i&&!r[o].once||n&&r[o].context!==n)&&c.push(r[o]);c.length?this._events[s]=1===c.length?c[0]:c:h(this,s)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&h(this,e)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=a,l.EventEmitter=l,t.exports=l},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="complete"},function(t,e){t.exports="created"},function(t,e){t.exports="error"},function(t,e){t.exports="loop"},function(t,e){t.exports="play"},function(t,e){t.exports="seeked"},function(t,e){t.exports="seeking"},function(t,e){t.exports="stop"},function(t,e){t.exports="timeout"},function(t,e){t.exports="unlocked"},function(t,e,n){t.exports={COMPLETE:n(244),DISPOSE:n(245),END:n(246),EVENT:n(247),INTERRUPTED:n(248),START:n(249)}},function(t,e){t.exports="complete"},function(t,e){t.exports="dispose"},function(t,e){t.exports="end"},function(t,e){t.exports="event"},function(t,e){t.exports="interrupted"},function(t,e){t.exports="start"},function(t,e,n){var i=n(1),a=n(1),s=n(1);i=n(251),s=n(252),a=n(253);t.exports={renderWebGL:i,renderCanvas:a,renderDirect:s}},function(t,e,n){var i=n(3),a=n(8),s=n(56),r=n(9),o=n(6);t.exports=function(t,e,n,c,h){var l=e.plugin,u=e.skeleton,d=l.sceneRenderer;t.newType&&(t.pipelines.clear(),d.begin());var p=e.scrollFactorX,f=e.scrollFactorY,g=u.color.a;h&&(e.scrollFactorX=h.scrollFactorX,e.scrollFactorY=h.scrollFactorY,u.color.a=i(g*h.alpha,0,1)),n.addToRenderList(e);var m,v,y=s(e,n,c).calc,S=t.height;u.x=y.tx,u.y=S-y.ty,u.scaleX=y.scaleX,u.scaleY=y.scaleY,e.scaleX<0?(u.scaleX*=-1,e.root.rotation=o(r(y.rotationNormalized)-180,0,360)):e.root.rotation=o(r(a(y.rotationNormalized))+90,0,360),e.scaleY<0&&(u.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*r(y.rotationNormalized):e.root.rotation+=2*r(y.rotationNormalized)),u.updateWorldTransform(),d.drawSkeleton(u,e.preMultipliedAlpha),h&&(e.scrollFactorX=p,e.scrollFactorY=f,u.color.a=g),(l.drawDebug||e.drawDebug)&&(m=u.x,v=u.y,u.x=0,u.y=0,d.drawSkeletonDebug(u,e.preMultipliedAlpha),u.x=m,u.y=v),t.nextTypeMatch||(d.end(),t.pipelines.rebind())}},function(t,e,n){var i=n(3),a=n(8),s=n(56),r=n(9),o=n(6);t.exports=function(t,e,n,c,h){var l=e.plugin,u=e.skeleton,d=l.sceneRenderer;t.pipelines.clear(),d.begin();var p=e.scrollFactorX,f=e.scrollFactorY,g=u.color.a;h&&(e.scrollFactorX=h.scrollFactorX,e.scrollFactorY=h.scrollFactorY,u.color.a=i(g*h.alpha,0,1)),n.addToRenderList(e);var m,v,y=s(e,n,c).calc,S=t.height;u.x=y.tx,u.y=S-y.ty,u.scaleX=y.scaleX,u.scaleY=y.scaleY,e.scaleX<0?(u.scaleX*=-1,e.root.rotation=o(r(y.rotationNormalized)-180,0,360)):e.root.rotation=o(r(a(y.rotationNormalized))+90,0,360),e.scaleY<0&&(u.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*r(y.rotationNormalized):e.root.rotation+=2*r(y.rotationNormalized)),u.updateWorldTransform(),d.drawSkeleton(u,e.preMultipliedAlpha),h&&(e.scrollFactorX=p,e.scrollFactorY=f,u.color.a=g),(l.drawDebug||e.drawDebug)&&(m=u.x,v=u.y,u.x=0,u.y=0,d.drawSkeletonDebug(u,e.preMultipliedAlpha),u.x=m,u.y=v),d.end(),t.pipelines.rebind()}},function(t,e,n){var i=n(8),a=n(9),s=n(6);t.exports=function(t,e,n,r){var o=t.currentContext,c=e.plugin,h=e.skeleton,l=c.skeletonRenderer,u=t._tempMatrix1,d=t._tempMatrix2,p=t._tempMatrix3;n.addToRenderList(e),d.applyITRS(e.x,e.y,e.rotation,Math.abs(e.scaleX),Math.abs(e.scaleY)),u.copyFrom(n.matrix),r?(u.multiplyWithOffset(r,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),d.e=e.x,d.f=e.y):(d.e-=n.scrollX*e.scrollFactorX,d.f-=n.scrollY*e.scrollFactorY),u.multiply(d,p),h.x=p.tx,h.y=p.ty,h.scaleX=p.scaleX,h.scaleY=-1*p.scaleY,e.scaleX<0?(h.scaleX*=-1,e.root.rotation=a(p.rotationNormalized)):e.root.rotation=s(a(i(p.rotationNormalized))+90,0,360),e.scaleY<0&&(h.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*a(p.rotationNormalized):e.root.rotation+=2*a(p.rotationNormalized)),n.renderToTexture&&(h.y=p.ty,h.scaleY*=-1),h.updateWorldTransform(),l.ctx=o,l.debugRendering=c.drawDebug||e.drawDebug,o.save(),l.draw(h),o.restore()}},function(t,e,n){var i=n(0),a=n(255),s=n(347),r=new i({Extends:a,Mixins:[s],initialize:function(t,e,n,i,s){a.call(this,t,n,i,s),this.type="Spine",this.plugin=e},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[],this._displayList=null,this.plugin=null}});t.exports=r},function(t,e,n){var i=n(256),a=n(17),s=n(0),o=n(293),c=n(55),h=n(53),l=n(25),u=n(343),d=n(346),p=n(2),f=new s({Extends:h,Mixins:[o.AlphaSingle,o.BlendMode,o.ComputedSize,o.Depth,o.Mask,o.Pipeline,o.Transform,o.Visible,u],initialize:function(t,e,n,i){h.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new o.TransformMatrix,this.tempTransformMatrix=new o.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPipeline(),this.setPosition(e,n),this.clearAlpha(),this.setBlendMode(a.SKIP_CHECK),i&&this.add(i)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){var e;if(void 0===t&&(t=new l),t.setTo(this.x,this.y,0,0),this.parentContainer&&(e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y),t.setTo(e.x,e.y,0,0)),0<this.list.length){var n=this.list,i=new l,a=!1;t.setEmpty();for(var s=0;s<n.length;s++){var r=n[s];r.getBounds&&(r.getBounds(i),a?d(i,t,t):(t.setTo(i.x,i.y,i.width,i.height),a=!0))}}return t},addHandler:function(t){t.once(c.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.removeFromDisplayList(),t.parentContainer=this)},removeHandler:function(t){t.off(c.DESTROY,this.remove),this.exclusive&&(t.parentContainer=null,t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new p),this.parentContainer?this.parentContainer.pointToContainer(t,e):e=new p(t.x,t.y);var n=this.tempTransformMatrix;return n.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),n.invert(),n.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(t){return i.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return i.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){var e;return g()(e=this.list).call(e,t)},sort:function(t,e){return t&&(void 0===e&&(e=function(e,n){return e[t]-n[t]}),i.StableSort(this.list,e)),this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,a){return i.GetFirst(this.list,t,e,n,a)},getAll:function(t,e,n,a){return i.GetAll(this.list,t,e,n,a)},count:function(t,e,n,a){return i.CountAllMatching(this.list,t,e,n,a)},swap:function(t,e){return i.Swap(this.list,t,e),this},moveTo:function(t,e){return i.MoveTo(this.list,t,e),this},remove:function(t,e){var n=i.Remove(this.list,t,this.removeHandler,this);if(e&&n){Array.isArray(n)||(n=[n]);for(var a=0;a<n.length;a++)n[a].destroy()}return this},removeAt:function(t,e){var n=i.RemoveAt(this.list,t,this.removeHandler,this);return e&&n&&n.destroy(),this},removeBetween:function(t,e,n){var a=i.RemoveBetween(this.list,t,e,this.removeHandler,this);if(n)for(var s=0;s<a.length;s++)a[s].destroy();return this},removeAll:function(t){var e=i.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(t)for(var n=0;n<e.length;n++)e[n].destroy();return this},bringToTop:function(t){return i.BringToTop(this.list,t),this},sendToBack:function(t){return i.SendToBack(this.list,t),this},moveUp:function(t){return i.MoveUp(this.list,t),this},moveDown:function(t){return i.MoveDown(this.list,t),this},reverse:function(){var t;return vR()(t=this.list).call(t),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e,n){return i.Replace(this.list,t,e)&&(this.addHandler(e),this.removeHandler(t),n&&t.destroy()),this},exists:function(t){var e;return-1<g()(e=this.list).call(e,t)},setAll:function(t,e,n,a){return i.SetAll(this.list,t,e,n,a),this},each:function(t,e){for(var n=[null],i=r()(o=this.list).call(o),a=i.length,s=2;s<arguments.length;s++){var o;n.push(arguments[s])}for(s=0;s<a;s++)n[0]=i[s],t.apply(e,n);return this},iterate:function(t,e){for(var n=[null],i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n);return this},setScrollFactor:function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=!1),this.scrollFactorX=t,this.scrollFactorY=e,n&&(i.SetAll(this.list,"scrollFactorX",t),i.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}},last:{get:function(){return 0<this.list.length?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return 0<this.position?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[]}});t.exports=f},function(t,e,n){t.exports={Matrix:n(257),Add:n(266),AddAt:n(267),BringToTop:n(268),CountAllMatching:n(269),Each:n(270),EachInRange:n(271),FindClosestInSorted:n(272),GetAll:n(273),GetFirst:n(274),GetRandom:n(275),MoveDown:n(276),MoveTo:n(277),MoveUp:n(278),NumberArray:n(279),NumberArrayStep:n(280),QuickSelect:n(281),Range:n(282),Remove:n(283),RemoveAt:n(284),RemoveBetween:n(285),RemoveRandomElement:n(286),Replace:n(287),RotateLeft:n(58),RotateRight:n(59),SafeRange:n(5),SendToBack:n(288),SetAll:n(289),Shuffle:n(60),SortByDigits:n(290),SpliceOne:n(12),StableSort:n(291),Swap:n(292)}},function(t,e,n){t.exports={CheckMatrix:n(24),MatrixToString:n(258),ReverseColumns:n(260),ReverseRows:n(261),Rotate180:n(262),RotateLeft:n(263),RotateMatrix:n(16),RotateRight:n(264),Translate:n(265),TransposeMatrix:n(57)}},function(t,e,n){var i=n(259),a=n(24);t.exports=function(t){var e="";if(!a(t))return e;for(var n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++){var r=t[n][s].toString();e+="undefined"!==r?i(r,2):"?",s<t[n].length-1&&(e+=" |")}if(n<t.length-1){e+="\n";for(var o=0;o<t[n].length;o++)e+="---",o<t[n].length-1&&(e+="+");e+="\n"}}return e}},function(t,e){t.exports=function(t,e,n,i){var a;if(void 0===e&&(e=0),void 0===n&&(n=" "),void 0===i&&(i=3),e+1>=(t=t.toString()).length)switch(i){case 1:t=new Array(e+1-t.length).join(n)+t;break;case 3:var s=Math.ceil((a=e-t.length)/2);t=new Array(a-s+1).join(n)+t+new Array(s+1).join(n);break;default:t+=new Array(e+1-t.length).join(n)}return t}},function(t,e){t.exports=function(t){return vR()(t).call(t)}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++){var n;vR()(n=t[e]).call(n)}return t}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,180)}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,90)}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,-90)}},function(t,e,n){var i=n(58),a=n(59);t.exports=function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),0!==n&&(n<0?i(t,Math.abs(n)):a(t,n)),0!==e)for(var s=0;s<t.length;s++){var r=t[s];e<0?i(r,Math.abs(e)):a(r,e)}return t}},function(t,e){t.exports=function(t,e,n,i,a){if(void 0===a&&(a=t),0<n){var s=n-t.length;if(s<=0)return null}if(!Array.isArray(e))return-1===g()(t).call(t,e)?(t.push(e),i&&i.call(a,e),e):null;for(var r=e.length-1;0<=r;)-1!==g()(t).call(t,e[r])&&vr()(e).call(e,r,1),r--;if(0===(r=e.length))return null;0<n&&s<r&&(vr()(e).call(e,s),r=s);for(var o=0;o<r;o++){var c=e[o];t.push(c),i&&i.call(a,c)}return e}},function(t,e){t.exports=function(t,e,n,i,a,s){if(void 0===n&&(n=0),void 0===s&&(s=t),0<i){var r=i-t.length;if(r<=0)return null}if(!Array.isArray(e))return-1===g()(t).call(t,e)?(vr()(t).call(t,n,0,e),a&&a.call(s,e),e):null;for(var o=e.length-1;0<=o;)-1!==g()(t).call(t,e[o])&&e.pop(),o--;if(0===(o=e.length))return null;0<i&&r<o&&(vr()(e).call(e,r),o=r);for(var c=o-1;0<=c;c--){var h=e[c];vr()(t).call(t,n,0,h),a&&a.call(s,h)}return e}},function(t,e){t.exports=function(t,e){var n=g()(t).call(t,e);return-1!==n&&n<t.length&&(vr()(t).call(t,n,1),t.push(e)),e}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){void 0===a&&(a=0),void 0===s&&(s=t.length);var r=0;if(i(t,a,s))for(var o=a;o<s;o++)t[o][e]===n&&r++;return r}},function(t,e){t.exports=function(t,e,n){for(var i=[null],a=3;a<arguments.length;a++)i.push(arguments[a]);for(a=0;a<t.length;a++)i[0]=t[a],e.apply(n,i);return t}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===a&&(a=0),void 0===s&&(s=t.length),i(t,a,s)){for(var r=[null],o=5;o<arguments.length;o++)r.push(arguments[o]);for(o=a;o<s;o++)r[0]=t[o],e.apply(n,r)}return t}},function(t,e){t.exports=function(t,e,n){if(!e.length)return NaN;if(1===e.length)return e[0];var i,a,s=1;if(n){if(t<e[0][n])return e[0];for(;e[s][n]<t;)s++}else for(;e[s]<t;)s++;return s>e.length&&(s=e.length),n?(i=e[s-1][n],(a=e[s][n])-t<=t-i?e[s]:e[s-1]):(i=e[s-1],(a=e[s])-t<=t-i?a:i)}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){void 0===a&&(a=0),void 0===s&&(s=t.length);var r=[];if(i(t,a,s))for(var o=a;o<s;o++){var c=t[o];(!e||e&&void 0===n&&c.hasOwnProperty(e)||e&&void 0!==n&&c[e]===n)&&r.push(c)}return r}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===a&&(a=0),void 0===s&&(s=t.length),i(t,a,s))for(var r=a;r<s;r++){var o=t[r];if(!e||e&&void 0===n&&o.hasOwnProperty(e)||e&&void 0!==n&&o[e]===n)return o}return null}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i=e+Math.floor(Math.random()*n);return void 0===t[i]?null:t[i]}},function(t,e){t.exports=function(t,e){var n,i,a=g()(t).call(t,e);return 0<a&&(n=t[a-1],i=g()(t).call(t,n),t[a]=n,t[i]=e),t}},function(t,e){t.exports=function(t,e,n){var i=g()(t).call(t,e);if(-1===i||n<0||n>=t.length)throw new Error("Supplied index out of bounds");return i!==n&&(vr()(t).call(t,i,1),vr()(t).call(t,n,0,e)),e}},function(t,e){t.exports=function(t,e){var n,i,a=g()(t).call(t,e);return-1!==a&&a<t.length-1&&(n=t[a+1],i=g()(t).call(t,n),t[a]=n,t[i]=e),t}},function(t,e){t.exports=function(t,e,n,i){var a,s=[],r=!1;if((n||i)&&(r=!0,n=n||"",i=i||""),e<t)for(a=t;e<=a;a--)r?s.push(n+a.toString()+i):s.push(a);else for(a=t;a<=e;a++)r?s.push(n+a.toString()+i):s.push(a);return s}},function(t,e,n){var i=n(40);t.exports=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=1),null===e&&(e=t,t=0);for(var a=[],s=Math.max(i((e-t)/(n||1)),0),r=0;r<s;r++)a.push(t),t+=n;return a}},function(t,e){function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:e<t?1:0}t.exports=function t(e,a,s,r,o){for(void 0===s&&(s=0),void 0===r&&(r=e.length-1),void 0===o&&(o=i);s<r;){var c,h,l,u,d;600<r-s&&(c=r-s+1,h=a-s+1,l=Math.log(c),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(c-u)/c)*(h-c/2<0?-1:1),t(e,a,Math.max(s,Math.floor(a-h*u/c+d)),Math.min(r,Math.floor(a+(c-h)*u/c+d)),o));var p=e[a],f=s,g=r;for(n(e,s,a),0<o(e[r],p)&&n(e,s,r);f<g;){for(n(e,f,g),f++,g--;o(e[f],p)<0;)f++;for(;0<o(e[g],p);)g--}0===o(e[s],p)?n(e,s,g):n(e,++g,r),g<=a&&(s=g+1),a<=g&&(r=g-1)}}},function(t,e,n){var i=n(10),a=n(60);t.exports=function(t,e,n){var s,r=i(n,"max",0),o=i(n,"qty",1),c=i(n,"random",!1),h=i(n,"randomB",!1),l=i(n,"repeat",0),u=i(n,"yoyo",!1),d=[];h&&a(e),-1===l&&(l=0===r?0:(s=t.length*e.length*o,u&&(s*=2),Math.ceil(r/s)));for(var p=0;p<=l;p++){var f=function(t,e,n){for(var i=[],a=0;a<t.length;a++)for(var s=0;s<e.length;s++)for(var r=0;r<n;r++)i.push({a:t[a],b:e[s]});return i}(t,e,o);c&&a(f),d=et()(d).call(d,f),u&&(vR()(f).call(f),d=et()(d).call(d,f))}return r&&vr()(d).call(d,r),d}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,a){if(void 0===a&&(a=t),!Array.isArray(e))return-1!==(o=g()(t).call(t,e))?(i(t,o),n&&n.call(a,e),e):null;for(var s=e.length-1,r=[];0<=s;){var o,c=e[s];-1!==(o=g()(t).call(t,c))&&(i(t,o),r.push(c),n&&n.call(a,c)),s--}return r}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,a){if(void 0===a&&(a=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var s=i(t,e);return n&&n.call(a,s),s}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===s&&(s=t),i(t,e,n)){var r=n-e,o=vr()(t).call(t,e,r);if(a)for(var c=0;c<o.length;c++){var h=o[c];a.call(s,h)}return o}return[]}},function(t,e,n){var i=n(12);t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var a=e+Math.floor(Math.random()*n);return i(t,a)}},function(t,e){t.exports=function(t,e,n){var i=g()(t).call(t,e),a=g()(t).call(t,n);return-1!==i&&-1===a&&(t[i]=n,!0)}},function(t,e){t.exports=function(t,e){var n=g()(t).call(t,e);return-1!==n&&0<n&&(vr()(t).call(t,n,1),t.unshift(e)),e}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===a&&(a=0),void 0===s&&(s=t.length),i(t,a,s))for(var r=a;r<s;r++){var o=t[r];o.hasOwnProperty(e)&&(o[e]=n)}return t}},function(t,e){t.exports=function(t){var e=/\D/g;return Na()(t).call(t,(function(t,n){return ob()(t.replace(e,""),10)-ob()(n.replace(e,""),10)})),t}},function(t,e){function n(t,e){return String(t).localeCompare(e)}function i(t,e,n,i){for(var a,s,r,o,c=t.length,h=0,l=2*n,u=0;u<c;u+=l)for(s=(a=u+n)+n,c<a&&(a=c),c<s&&(s=c),r=u,o=a;;)if(r<a&&o<s)e(t[r],t[o])<=0?i[h++]=t[r++]:i[h++]=t[o++];else if(r<a)i[h++]=t[r++];else{if(!(o<s))break;i[h++]=t[o++]}}t.exports=function(t,e){void 0===e&&(e=n);var a=function(t,e){var n=t.length;if(n<=1)return t;for(var a=new Array(n),s=1;s<n;s*=2){i(t,e,s,a);var r=t;t=a,a=r}return t}(t,e);return a!==t&&i(a,null,t.length,t),t}},function(t,e){t.exports=function(t,e,n){if(e!==n){var i=g()(t).call(t,e),a=g()(t).call(t,n);if(i<0||a<0)throw new Error("Supplied items must be elements of the same array");return t[i]=n,t[a]=e,t}}},function(t,e,n){t.exports={Alpha:n(294),AlphaSingle:n(295),BlendMode:n(296),ComputedSize:n(47),Crop:n(297),Depth:n(48),Flip:n(49),GetBounds:n(298),Mask:n(307),Origin:n(332),PathFollower:n(333),Pipeline:n(336),ScrollFactor:n(50),Size:n(339),Texture:n(340),TextureCrop:n(341),Tint:n(342),ToJSON:n(54),Transform:n(51),TransformMatrix:n(23),Visible:n(52)}},function(t,e,n){var i=n(3),a={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,n,a){return void 0===t&&(t=1),void 0===e?this.alpha=t:(this._alphaTL=i(t,0,1),this._alphaTR=i(e,0,1),this._alphaBL=i(n,0,1),this._alphaBR=i(a,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,0===(this._alphaBR=e)?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=i(t,0,1);0!==(this._alphaTL=e)&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=i(t,0,1);0!==(this._alphaTR=e)&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=i(t,0,1);0!==(this._alphaBL=e)&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=i(t,0,1);0!==(this._alphaBR=e)&&(this.renderFlags|=2)}}};t.exports=a},function(t,e,n){var i=n(3),a={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);0===(this._alpha=e)?this.renderFlags&=-3:this.renderFlags|=2}}};t.exports=a},function(t,e,n){var i=n(17),a={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){"string"==typeof t&&(t=i[t]),-1<=(t|=0)&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};t.exports=a},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e,n){var i=n(25),a=n(39),s=n(2),r={prepareBoundsOutput:function(t,e){return void 0===e&&(e=!1),0!==this.rotation&&a(t,this.x,this.y,this.rotation),e&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t){return void 0===t&&(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,t},getTopLeft:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){var e,n,a,s,r,o,c,h,l;return void 0===t&&(t=new i),this.parentContainer?(l=this.parentContainer.getBoundsTransformMatrix(),this.getTopLeft(t),l.transformPoint(t.x,t.y,t),e=t.x,n=t.y,this.getTopRight(t),l.transformPoint(t.x,t.y,t),a=t.x,s=t.y,this.getBottomLeft(t),l.transformPoint(t.x,t.y,t),r=t.x,o=t.y,this.getBottomRight(t),l.transformPoint(t.x,t.y,t)):(this.getTopLeft(t),e=t.x,n=t.y,this.getTopRight(t),a=t.x,s=t.y,this.getBottomLeft(t),r=t.x,o=t.y,this.getBottomRight(t)),c=t.x,h=t.y,t.x=Math.min(e,a,r,c),t.y=Math.min(n,s,o,h),t.width=Math.max(e,a,r,c)-t.x,t.height=Math.max(n,s,o,h)-t.y,t}};t.exports=r},function(t,e){t.exports=function(t,e,n){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}},function(t,e,n){var i=n(61),a=n(62);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&0<n&&(e=a(t)/n);for(var r=0;r<e;r++){var o=r/e;s.push(i(t,o))}return s}},function(t,e,n){var i=n(0),a=n(302),s=n(303),r=n(26),o=n(305),c=n(2),h=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=r.LINE,this.x1=t,this.y1=e,this.x2=n,this.y2=i},getPoint:function(t,e){return a(this,t,e)},getPoints:function(t,e,n){return s(this,t,e,n)},getRandomPoint:function(t){return o(this,t)},setTo:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this},getPointA:function(t){return void 0===t&&(t=new c),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new c),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});t.exports=h},function(t,e,n){var i=n(13);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}},function(t,e,n){var i=n(304),a=n(13);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&0<n&&(e=i(t)/n);for(var r=t.x1,o=t.y1,c=t.x2,h=t.y2,l=0;l<e;l++){var u=l/e,d=r+(c-r)*u,p=o+(h-o)*u;s.push(new a(d,p))}return s}},function(t,e){t.exports=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}},function(t,e,n){var i=n(13);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}},function(t,e,n){var i=n(13);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e}},function(t,e,n){var i=n(308),a=n(331),s={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t){return void 0===t&&(this.texture||this.shader)&&(t=this),new i(this.scene,t)},createGeometryMask:function(t){return void 0===t&&"Graphics"===this.type&&(t=this),new a(this.scene,t)}};t.exports=s},function(t,e,n){var i=n(0),a=n(309),s=n(326),r=new i({initialize:function(t,e){var n=t.sys.renderer;this.renderer=n,this.bitmapMask=e,this.maskTexture=null,this.mainTexture=null,this.dirty=!0,this.mainFramebuffer=null,this.maskFramebuffer=null,this.invertAlpha=!1,this.isStencil=!1,this.createMask(),t.sys.game.events.on(a.CONTEXT_RESTORED,this.createMask,this),n&&n.on(s.RESIZE,this.createMask,this)},createMask:function(){var t,e,n,i,a,s,r=this.renderer;r&&r.gl&&(this.mainTexture&&this.clearMask(),t=r.width,e=r.height,n=0==(t&t-1)&&0==(e&e-1),i=r.gl,a=n?i.REPEAT:i.CLAMP_TO_EDGE,s=i.LINEAR,this.mainTexture=r.createTexture2D(0,s,s,a,a,i.RGBA,null,t,e),this.maskTexture=r.createTexture2D(0,s,s,a,a,i.RGBA,null,t,e),this.mainFramebuffer=r.createFramebuffer(t,e,this.mainTexture,!0),this.maskFramebuffer=r.createFramebuffer(t,e,this.maskTexture,!0))},clearMask:function(){var t=this.renderer;t&&t.gl&&this.mainTexture&&(t.deleteTexture(this.mainTexture),t.deleteTexture(this.maskTexture),t.deleteFramebuffer(this.mainFramebuffer),t.deleteFramebuffer(this.maskFramebuffer),this.mainTexture=null,this.maskTexture=null,this.mainFramebuffer=null,this.maskFramebuffer=null)},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,n){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,n)},postRenderWebGL:function(t,e){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.clearMask(),this.renderer&&this.renderer.off(s.RESIZE,this.createMask,this),this.bitmapMask=null,this.prevFramebuffer=null,this.renderer=null}});t.exports=r},function(t,e,n){t.exports={BLUR:n(310),BOOT:n(311),CONTEXT_LOST:n(312),CONTEXT_RESTORED:n(313),DESTROY:n(314),FOCUS:n(315),HIDDEN:n(316),PAUSE:n(317),POST_RENDER:n(318),POST_STEP:n(319),PRE_RENDER:n(320),PRE_STEP:n(321),READY:n(322),RESUME:n(323),STEP:n(324),VISIBLE:n(325)}},function(t,e){t.exports="blur"},function(t,e){t.exports="boot"},function(t,e){t.exports="contextlost"},function(t,e){t.exports="contextrestored"},function(t,e){t.exports="destroy"},function(t,e){t.exports="focus"},function(t,e){t.exports="hidden"},function(t,e){t.exports="pause"},function(t,e){t.exports="postrender"},function(t,e){t.exports="poststep"},function(t,e){t.exports="prerender"},function(t,e){t.exports="prestep"},function(t,e){t.exports="ready"},function(t,e){t.exports="resume"},function(t,e){t.exports="step"},function(t,e){t.exports="visible"},function(t,e,n){t.exports={POST_RENDER:n(327),PRE_RENDER:n(328),RENDER:n(329),RESIZE:n(330)}},function(t,e){t.exports="postrender"},function(t,e){t.exports="prerender"},function(t,e){t.exports="render"},function(t,e){t.exports="resize"},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,n){var i=t.gl;t.flush(),0===t.maskStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:n}),this.applyStencil(t,n,!0),t.maskCount++},applyStencil:function(t,e,n){var i=t.gl,a=this.geometryMask,s=t.maskCount;i.colorMask(!1,!1,!1,!1),n?(i.stencilFunc(i.EQUAL,s,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,s+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),a.renderWebGL(t,a,e),t.flush(),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),n?this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s+1,255):i.stencilFunc(i.EQUAL,s+1,255):this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s,255):i.stencilFunc(i.EQUAL,s,255)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var n,i=t.currentMask;0===t.maskStack.length?(i.mask=null,e.disable(e.STENCIL_TEST)):((n=t.maskStack[t.maskStack.length-1]).mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(i.mask=n.mask,i.camera=n.camera):i.mask=null)},preRenderCanvas:function(t,e,n){var i=this.geometryMask;t.currentContext.save(),i.renderCanvas(t,i,n,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=i},function(t,e){t.exports={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}},function(t,e,n){var i=n(19),a=n(334),s=n(10),r=n(335),o=n(2),c={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:r.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var n=this.pathTween;return n&&n.isPlaying()&&n.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(t,e){void 0===t&&(t={}),void 0===e&&(e=0);var n=this.pathTween;n&&n.isPlaying()&&n.stop(),"number"==typeof t&&(t={duration:t}),t.from=s(t,"from",0),t.to=s(t,"to",1);var c=a(t,"positionOnPath",!1);this.rotateToPath=a(t,"rotateToPath",!1),this.pathRotationOffset=s(t,"rotationOffset",0);var h,l=s(t,"startAt",e);return l&&(t.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var n=e.ease(e.progress);e.current=e.start+(e.end-e.start)*n,e.target[e.key]=e.current}),this.pathOffset||(this.pathOffset=new o(this.x,this.y)),this.pathVector||(this.pathVector=new o),this.pathDelta||(this.pathDelta=new o),this.pathDelta.reset(),this.pathTween=this.scene.sys.tweens.addCounter(t),this.path.getStartPoint(this.pathOffset),c&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=r.PLAYING_FORWARD,this.rotateToPath&&(h=this.path.getPoint(.1),this.rotation=Math.atan2(h.y-this.y,h.x-this.x)+i(this.pathRotationOffset)),this.pathConfig=t,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var t=this.pathTween;if(t){var e=t.data[0],n=this.pathDelta,a=this.pathVector;if(n.copy(a).negate(),e.state===r.COMPLETE)return this.path.getPoint(1,a),n.add(a),a.add(this.pathOffset),void this.setPosition(a.x,a.y);if(e.state!==r.PLAYING_FORWARD&&e.state!==r.PLAYING_BACKWARD)return;this.path.getPoint(t.getValue(),a),n.add(a),a.add(this.pathOffset);var s=this.x,o=this.y;this.setPosition(a.x,a.y);var c=this.x-s,h=this.y-o;if(0==c&&0==h)return;if(e.state!==this._prevDirection)return void(this._prevDirection=e.state);this.rotateToPath&&(this.rotation=Math.atan2(h,c)+i(this.pathRotationOffset))}}};t.exports=c},function(t,e){t.exports=function(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}},function(t,e){t.exports={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26}},function(t,e,n){var i=n(337),a=n(338),s=n(12),r={defaultPipeline:null,pipeline:null,hasPostPipeline:!1,postPipelines:null,pipelineData:null,initPipeline:function(t){void 0===t&&(t=a.MULTI_PIPELINE);var e=this.scene.sys.renderer;if(!e)return!1;var n=e.pipelines;if(this.postPipelines=[],this.pipelineData={},n){var i=n.get(t);if(i)return this.defaultPipeline=i,this.pipeline=i,!0}return!1},setPipeline:function(t,e,n){var a=this.scene.sys.renderer;if(!a)return this;var s,r=a.pipelines;return r&&((s=r.get(t))&&(this.pipeline=s),e&&(this.pipelineData=n?i(e):e)),this},setPostPipeline:function(t,e,n){var a=this.scene.sys.renderer;if(!a)return this;var s=a.pipelines;if(s){Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var o=s.getPostPipeline(t[r],this);o&&this.postPipelines.push(o)}e&&(this.pipelineData=n?i(e):e)}return this.hasPostPipeline=0<this.postPipelines.length,this},setPipelineData:function(t,e){var n=this.pipelineData;return void 0===e?delete n[t]:n[t]=e,this},getPostPipeline:function(t){for(var e=this.postPipelines,n=[],i=0;i<e.length;i++){var a=e[i];("string"==typeof t&&a.name===t||a instanceof t)&&n.push(a)}return 1===n.length?n[0]:n},resetPipeline:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.pipeline=this.defaultPipeline,t&&(this.postPipelines=[],this.hasPostPipeline=!1),e&&(this.pipelineData={}),null!==this.pipeline},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,n=0;n<e.length;n++)e[n].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.pipelineData={})},removePostPipeline:function(t){for(var e=this.postPipelines,n=e.length-1;0<=n;n--){var i=e[n];("string"==typeof t&&i.name===t||"string"!=typeof t&&i instanceof t)&&(i.destroy(),s(e,n))}return this.hasPostPipeline=0<this.postPipelines.length,this},getPipelineName:function(){return this.pipeline.name}};t.exports=r},function(t,e){t.exports=function t(e){var n,i,a;if("object"!=typeof e||null===e)return e;for(a in n=Array.isArray(e)?[]:{},e)i=e[a],n[a]=t(i);return n}},function(t,e){t.exports={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline"}},function(t,e){var n={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){return void 0===t&&(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};t.exports=n},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){t.exports={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,n,i){return void 0===t&&(t=16777215),void 0===e&&(i=n=e=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=n,this.tintBottomRight=i,this.tintFill=!1,this},setTintFill:function(t,e,n,i){return this.setTint(t,e,n,i),this.tintFill=!0,this},tint:{set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}},function(t,e,n){var i=n(1),a=n(1);i=n(344),a=n(345);t.exports={renderWebGL:i,renderCanvas:a}},function(t,e){t.exports=function(t,e,n,i){var a=e.list,s=a.length;if(0!==s){n.addToRenderList(e);var r=e.localTransform;i?(r.loadIdentity(),r.multiply(i),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=-1!==e.blendMode;o||t.setBlendMode(0);for(var c=e.alpha,h=e.scrollFactorX,l=e.scrollFactorY,u=0;u<s;u++){var d,p,f,g,m,v,y,S,A=a[u];A.willRender(n)&&(g=void 0!==A.alphaTopLeft?(d=A.alphaTopLeft,p=A.alphaTopRight,f=A.alphaBottomLeft,A.alphaBottomRight):f=p=d=A.alpha,m=A.scrollFactorX,v=A.scrollFactorY,o||A.blendMode===t.currentBlendMode||t.setBlendMode(A.blendMode),(y=A.mask)&&y.preRenderWebGL(t,A,n),(S=A.type)!==t.currentType&&(t.newType=!0,t.currentType=S),t.nextTypeMatch=u<s-1&&a[u+1].type===t.currentType,A.setScrollFactor(m*h,v*l),A.setAlpha(d*c,p*c,f*c,g*c),A.renderWebGL(t,A,n,r),A.setAlpha(d,p,f,g),A.setScrollFactor(m,v),y&&y.postRenderWebGL(t,n),t.newType=!1)}t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i){var a=e.list;if(0!==a.length){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var r=-1!==e.blendMode;r||t.setBlendMode(0);var o=e._alpha,c=e.scrollFactorX,h=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var l=0;l<a.length;l++){var u,d,p,f=a[l];f.willRender(n)&&(u=f.alpha,d=f.scrollFactorX,p=f.scrollFactorY,r||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode),f.setScrollFactor(d*c,p*h),f.setAlpha(u*o),f.renderCanvas(t,f,n,s),f.setAlpha(u),f.setScrollFactor(d,p))}e.mask&&e.mask.postRenderCanvas(t)}}},function(t,e,n){var i=n(25);t.exports=function(t,e,n){void 0===n&&(n=new i);var a=Math.min(t.x,e.x),s=Math.min(t.y,e.y),r=Math.max(t.right,e.right)-a,o=Math.max(t.bottom,e.bottom)-s;return n.setTo(a,s,r,o)}},function(t,e,n){var i=n(1),a=n(1);i=n(348),a=n(349);t.exports={renderWebGL:i,renderCanvas:a}},function(t,e){t.exports=function(t,e,n,i){var a=e.plugin.sceneRenderer,s=e.list;if(0!==s.length){n.addToRenderList(e);var r=e.localTransform;i?(r.loadIdentity(),r.multiply(i),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.newType&&(t.pipelines.clear(),a.begin());var o=t.nextTypeMatch;t.nextTypeMatch=!0,t.newType=!1;for(var c=0;c<s.length;c++){var h,l=s[c];l.willRender(n,e)&&((h=l.mask)&&(a.end(),t.pipelines.rebind(),h.preRenderWebGL(t,l,n),t.pipelines.clear(),a.begin()),l.renderWebGL(t,l,n,r,e),h&&(a.end(),t.pipelines.rebind(),h.postRenderWebGL(t,n),t.pipelines.clear(),a.begin()))}(t.nextTypeMatch=o)||(a.end(),t.pipelines.rebind())}else a.batcher.isDrawing&&t.finalType&&(a.end(),t.pipelines.rebind())}},function(t,e){t.exports=function(t,e,n,i){var a=e.list;if(0!==a.length){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var r=-1!==e.blendMode;r||t.setBlendMode(0);var o=e._alpha,c=e.scrollFactorX,h=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var l=0;l<a.length;l++){var u,d,p,f=a[l];f.willRender(n)&&(u=f.alpha,d=f.scrollFactorX,p=f.scrollFactorY,r||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode),f.setScrollFactor(d*c,p*h),f.setAlpha(u*o),f.renderCanvas(t,f,n,s),f.setAlpha(u),f.setScrollFactor(d,p))}e.mask&&e.mask.postRenderCanvas(t)}}}]);var kR=["Enable"],RR=function(t){function e(e){return t.call(this,e)||this}(0,Kt.default)(e,t);var i=e.prototype;return i.boot=function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),e.next=6,this.addDevPlugins();case 6:this.addScenes(),this.addDevScenes(),this.initAds(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initUtils(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.handleShowAdWhenStartGame(),this.initAdaptivePerformance();case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.start=function(){t.prototype.start.call(this)},i.updateFps=function(t){void 0===t&&(t=60),this.getFps()!==t&&this.setFps(t)},i.getFps=function(){return this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf?this.scene.game.loop.raf.fps:5},i.setFps=function(t){this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf&&"function"===typeof this.scene.game.loop.raf.updateFps&&this.scene.game.loop.raf.updateFps(t)},i.addExtraGameObjectMethods=function(){var t=new Qt(this);t.addKillRevive(),t.addDrawDebugBox(),t.addSetWorldSize(),t.addSetWorldSizeForContainer(),t.addGetWorldPosition(),t.addHighQuality()},i.addExtraFBInstantFunctions=function(){var t=new Zt.default(this.facebook);this.facebook.shareAsync=t.shareAsync,this.facebook.inviteAsync=t.inviteAsync,this.facebook.switchAsync=t.switchAsync,this.facebook.chooseAsync=t.chooseAsync,this.facebook.createAsync=t.createAsync,this.facebook.sendMessage=t.sendMessage,this.facebook.getContextID=t.getContextID,this.facebook.getPlayerToken=t.getPlayerToken,this.facebook.matchPlayerAsync=t.matchPlayerAsync,this.facebook.getContextPlayers=t.getContextPlayers,this.facebook.setLoadingProgress=t.setLoadingProgress,this.facebook.attemptToAddShortcut=t.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=t.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=t.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=t.getRewardedVideoAsync,this.facebook.getInterstitialAdAsync=t.getInterstitialAdAsync,this.facebook.setLoadingProgress=t.setLoadingProgress,this.facebook.getLocale=t.getLocale,this.facebook.postSessionScoreAsync=t.postSessionScoreAsync,t.injectTournament(),this.facebook.progressLoading=new sR(this)},i.addPlugins=function(){this.plugins.install("Storage",Cs,!0,"storage"),this.plugins.install("AdsManager",ue,!0,"ads"),this.plugins.install("AuthManager",Ie,!0,"auth"),this.plugins.install("AudioManager",ye,!0,"audio"),this.plugins.install("WorldManager",Ds,!0,"world"),this.plugins.install("PlayerManager",Hn,!0,"player"),this.plugins.install("ProfileManager",$n,!0,"profile"),this.plugins.install("AnalyticsManager",fe,!0,"analytics"),this.plugins.install("LanguageManager",eR,!0,"lang"),this.plugins.install("AdaptivePerformance",Gk,!0,"performance"),this.plugins.installScenePlugin("textStyler",_s,"textStyler"),this.plugins.installScenePlugin("ScreenManager",oi,"screen"),this.plugins.installScenePlugin("FrameCapture",Re,"frameCapture"),this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.lang=this.plugins.get("LanguageManager"),this.performance=this.plugins.get("AdaptivePerformance")},i.addDevPlugins=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,i,a,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(GameCore.Utils.Valid.isDebugger()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Promise.all([n.e(7),n.e(716)]).then(n.bind(n,562));case 4:return e=t.sent.default,t.next=7,Promise.all([n.e(498),n.e(114),n.e(227)]).then(n.bind(n,563));case 7:return i=t.sent.default,t.next=10,n.e(315).then(n.bind(n,564));case 10:return a=t.sent.default,t.next=13,Promise.all([n.e(498),n.e(516)]).then(n.bind(n,565));case 13:s=t.sent.default,this.plugins.install("Console",e,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("ParticleEditor",s,!0,"particle-editor"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.particleEditor=this.plugins.get("ParticleEditor");case 22:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.addScenes=function(){this.scene.add(ar.SceneKeys.BOOT_SCENE,fr,!0),this.scene.add(ar.SceneKeys.LOAD_SCENE,sb,!1),this.scene.add(ar.SceneKeys.GAME_SCENE,Ox,!1),this.scene.add(ar.SceneKeys.LEVEL_SCENE,Dk,!1),this.scene.add(ar.SceneKeys.JOURNEY_SCENE,UP,!1),this.scene.add(ar.SceneKeys.DASHBOARD_SCENE,cT,!1),this.scene.add(ar.SceneKeys.GLOBAL_SCENE,tE,!1)},i.addDevScenes=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(GameCore.Utils.Valid.isDebugger()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.e(817).then(n.bind(n,567));case 4:return e=t.sent.default,t.next=7,n.e(161).then(n.bind(n,568));case 7:i=t.sent.default,this.scene.add(ar.SceneKeys.TEST_SCENE,e,!1),this.scene.add(ar.SceneKeys.ANIMATIONS_SCENE,i,!1);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.initAds=function(){var t=GameCore.Configs.Ads;Vk.setGame(this);var e=t.Mockup.Enable?Jk:Vk,n=(0,Tt.default)({},t.InterstitialAdOptions);n.showWhenStartGame&&(n.secondsFirstTime=0),this.ads.configure(e,{enabled:t.Enabled,interstitialPID:t.InterstitialPlacementId,rewardedVideoPID:t.VideoRewardsPlacementId,interstitialAdOptions:n,bannerAdOptions:t.BannerAdOptions})},i.initWorld=function(){var t=GameCore.Configs.Game;this.world.configure({width:375,height:667,ratio:320/518}),this.world.resize(t.ForcePixelRatio)},i.initStorage=function(){var t=new ir(this);this.storage.setInitiator(t)},i.initLanguage=function(){var t=this.facebook.getLocale();this.lang.configure({locale:t,upperCaseText:!0})},i.initUtils=function(){this.handlePauseAudio()},i.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},i.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var t=GameCore.Configs.Debugger,e=t.ShowInspector,n=t.ShowMonitoring;(e||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},i.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},i.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},i.initAdaptivePerformance=function(){var t=GameCore.Configs.Performance,e=t.Enable,n=(0,Ht.default)(t,kR);if(e){var i=this.world.getPixelRatio();this.performance.configure((0,Tt.default)({pixelRatio:i},n)),this.performance.active()}},i.handlePauseAudio=function(){var t=this;this.sound.pauseOnBlur=!1,document.addEventListener("visibilitychange",(function(){document.hidden?t.audio.pauseMusic():t.audio.playMusic()}))},i.removeUnusedPipelines=function(){var t=this.renderer;if(t instanceof Phaser.Renderer.WebGL.WebGLRenderer){var e=t.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(t){var n;null==(n=e.get(t))||n.destroy(),e.remove(t)}))}},i.handleShowAdWhenStartGame=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ads.showBannerAdAsync().catch(Wt.sendException),GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,this.audio.stopMusic(),this.audio.muteAll(),t.next=9,this.ads.preloadInterstitialAdAsync();case 9:return t.next=11,this.ads.showInterstitialAdAsync();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),(0,Wt.sendException)(t.t0);case 16:return t.prev=16,this.audio.unmuteAll(),this.audio.playMusic(),t.finish(16);case 20:case"end":return t.stop()}}),t,this,[[4,13,16,20]])})));return function(){return t.apply(this,arguments)}}(),e}(Phaser.Game),_R=RR,OR=GameCore.Configs.Debugger.ShowInspector,DR={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},audio:{noAudio:!1,disableWebAudio:!1},input:{gamepad:!1,keyboard:OR,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,fps:{},render:{pixelArt:!1,antialias:!0,antialiasGL:!0,transparent:!0,desynchronized:!1,powerPreference:"low-power",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};window.GameCore=zt,(0,Wt.initSentry)();var BR=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval(BR),clearInterval(window.__fbInstantLoadingTimer),GameSDK.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var t=new _R(DR);window.game=t}catch(e){(0,Wt.sendException)(e)}}())}),50)},254:function(t,e,n){"use strict";n.r(e);var i=n(122),a=function(){function t(t,e,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=t,this.name=e,this.photo=n||i.default.AVATAR.FILE,this.locale=a||"en_US"}return t.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},t}();e.default=a},111:function(t,e,n){"use strict";n.r(e),n.d(e,{sleepAsync:function(){return o},checkIsToday:function(){return c},formatDateHMS:function(){return h},getDateDMY:function(){return l},convertHMS:function(){return u}});var i=n(46),a=n.n(i),s=n(38),r=n.n(s),o=function(t){return new(a())((function(e){return setTimeout(e,t)}))},c=function(t){var e=new Date(t),n=new Date;return e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear()},h=function(t,e){void 0===e&&(e=!0);var n=new Date(t).toISOString();return e?r()(n).call(n,11,-5):r()(n).call(n,14,-5)},l=function(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,i=""+e,a=""+n;return e<10&&(i="0"+e),n<10&&(a="0"+n),i+"/"+a+"/"+t.getFullYear()},u=function(t){var e=t/1e3,n=Math.floor(e/3600),i=Math.floor((e-3600*n)/60);return{hours:n,minutes:i,seconds:Math.floor(e-3600*n-60*i)}}},28:function(t,e,n){"use strict";n.r(e),n.d(e,{initSentry:function(){return a},addBreadcrumbSentry:function(){return s},setSentryUser:function(){return r},sendExceptionWithScope:function(){return c},sendException:function(){return h}});n(325),n(164),n(96),n(32);var i=!1,a=function(){var t=setInterval((function(){window.Sentry&&(clearInterval(t),console.warn({isSentryEnabled:i}))}),100)},s=function(t,e){window.Sentry&&window.Sentry.addBreadcrumb({category:t,message:e})},r=function(t){window.Sentry&&window.Sentry.setUser(t)},o=function(t){console.error(t)},c=function(t,e){t&&window.Sentry.withScope((function(n){n.setExtras(e),o(t)}))},h=function(t){t&&o(t)}},445:function(t,e,n){"use strict";n.r(e),n.d(e,{getImageScale:function(){return i}});var i=function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[216],(function(){return e(573),e(572),e(556),e(531)}));t.O()}]);