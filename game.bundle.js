(self.webpackChunkgame_core=self.webpackChunkgame_core||[]).push([[757],{557:function(){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var i=atob(this.toDataURL(e,n).split(",")[1]),a=i.length,s=a>>2,r=new Uint8Array(a),o=new Uint32Array(r.buffer,0,s),h=0,c=0;h<s;h++)o[h]=i.charCodeAt(c++)|i.charCodeAt(c++)<<8|i.charCodeAt(c++)<<16|i.charCodeAt(c++)<<24;for(var l=3&a;l--;)r[c]=i.charCodeAt(c++);t(new Blob([r],{type:e||"image/png"}))}})},443:function(t,e,n){"use strict";n.r(e),n.d(e,{FacebookTournament:function(){return u}});var i=n(9),a=n(141),s=n.n(a),r=n(8),o=n.n(r),h=n(52),c=n(252),l=n(142),u=function(){function t(){}var e=t.prototype;return e.createAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.createAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.shareAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.shareAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.joinAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.joinAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postScoreAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.postScoreAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getTournamentsAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.tournament.getTournamentsAsync();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}(),d=function(){function t(t){var e=this;this.facebook=void 0,this.isCalledSubscribeBot=!1,this.isCalledCreateShortcut=!1,this.requestTournamentAsync=function(){var t=(0,i.default)(o().mark((function t(n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.facebook.getTournamentAsync();case 3:return t.next=5,e.facebook.tournament.shareAsync({score:n});case 5:t.next=12;break;case 7:return t.prev=7,t.t0=t.catch(0),i=GameSDK.player.getName(),t.next=12,e.facebook.tournament.createAsync({initialScore:n,config:{tournamentTitle:i+"'s Tournament"}});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),this.facebook=t}var e=t.prototype;return e.switchAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 2:return t.next=4,GameSDK.context.switchAsync(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.chooseAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return t.next=5,GameSDK.context.chooseAsync({filters:["INCLUDE_EXISTING_CHALLENGES"],minSize:2,maxSize:2});case 5:case 15:return t.abrupt("return",GameSDK.context.getID());case 8:if(t.prev=8,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=16;break}t.t1=t.t0.code,t.next="USER_INPUT"===t.t1?14:"SAME_CONTEXT"===t.t1?15:16;break;case 14:return t.abrupt("return",!1);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),e.createAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 3:return t.next=5,GameSDK.context.createAsync(""+e);case 5:case 15:return t.abrupt("return",GameSDK.context.getID());case 8:if(t.prev=8,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=16;break}t.t1=t.t0.code,t.next="USER_INPUT"===t.t1?14:"SAME_CONTEXT"===t.t1?15:16;break;case 14:return t.abrupt("return",!1);case 16:return t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),e.getPlayerToken=function(){var t=(0,i.default)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.getSignedPlayerInfoAsync();case 2:return e=t.sent,t.abrupt("return",e.getSignature());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getContextPlayers=function(){var t=(0,i.default)(o().mark((function t(e){var n,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,GameSDK.context.getPlayersAsync();case 3:return n=t.sent,i=[],n.forEach((function(t){var n=t.getID();if(n!==e){var a=t.getName();if(a){var s=t.getPhoto();i.push(new c.default(n,a,s).toObject())}}})),t.abrupt("return",GameCore.Utils.Array.unique(i));case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",[]);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e.shareAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.shareAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.sendMessage=function(){var t=(0,i.default)(o().mark((function t(e){var n,i,a,s,r,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.data,i=e.image,a=e.template,s=e.cta,r=e.text,h={data:n,image:i,action:"CUSTOM",template:a,cta:s,text:r,strategy:"IMMEDIATE",notification:"PUSH"},t.next=4,GameSDK.updateAsync(h);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.inviteAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.inviteAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.postSessionScoreAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.postSessionScoreAsync(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getRewardedVideoAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getRewardedVideoAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getInterstitialAdAsync=function(){var t=(0,i.default)(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getInterstitialAdAsync(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getContextID=function(){return GameSDK.context.getID()},e.attemptToAddShortcut=function(){var t=(0,i.default)(o().mark((function t(){var e,n,i,a,r,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCalledCreateShortcut){t.next=2;break}return t.abrupt("return",!1);case 2:if(t.prev=2,"ANDROID"!==GameSDK.getPlatform()){t.next=6;break}return t.abrupt("return",!1);case 6:return t.next=8,GameSDK.player.getDataAsync(["lastCallCreateShortcut"]);case 8:if(n=t.sent,!(i=n.lastCallCreateShortcut)||!(0,l.checkIsToday)(+i)){t.next=12;break}return t.abrupt("return",!1);case 12:if(a=Date.now(),GameSDK.player.setDataAsync({lastCallCreateShortcut:a}),s()(e=GameSDK.getSupportedAPIs()).call(e,"canCreateShortcutAsync")){t.next=17;break}return t.abrupt("return",!1);case 17:return t.next=19,GameSDK.canCreateShortcutAsync();case 19:if(!t.sent){t.next=37;break}return r=h.AnalyticsEvents.SHORTCUT_CREATE,c=h.AnalyticsEvents.SHORTCUT_CREATE_POPUP,this.isCalledCreateShortcut=!0,window.game.analytics.event(c),t.prev=24,t.next=27,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 27:return t.next=29,GameSDK.createShortcutAsync();case 29:return window.game.analytics.event(r,{success:!0}),t.abrupt("return",!0);case 33:return t.prev=33,t.t0=t.catch(24),window.game.analytics.event(r,{success:!1}),t.abrupt("return",!1);case 37:return t.abrupt("return",!1);case 40:return t.prev=40,t.t1=t.catch(2),t.abrupt("return",!1);case 43:case"end":return t.stop()}}),t,this,[[2,40],[24,33]])})));return function(){return t.apply(this,arguments)}}(),e.attemptToSubscribeBot=function(){var t=(0,i.default)(o().mark((function t(){var e,n,i,a,r,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isCalledSubscribeBot){t.next=2;break}return t.abrupt("return",!1);case 2:if(t.prev=2,s()(e=GameSDK.getSupportedAPIs()).call(e,"player.canSubscribeBotAsync")){t.next=6;break}return t.abrupt("return",!1);case 6:return t.next=8,GameSDK.player.canSubscribeBotAsync();case 8:if(!t.sent){t.next=34;break}return t.next=12,GameSDK.player.getDataAsync(["lastCallSubscribeBot"]);case 12:if(n=t.sent,!(i=n.lastCallSubscribeBot)||!(0,l.checkIsToday)(+i)){t.next=16;break}return t.abrupt("return",!1);case 16:return a=Date.now(),GameSDK.player.setDataAsync({lastCallSubscribeBot:a}),r=h.AnalyticsEvents.BOT_SUBSCRIBE,c=h.AnalyticsEvents.BOT_SUBSCRIBE_POPUP,this.isCalledSubscribeBot=!0,window.game.analytics.event(c),t.prev=21,t.next=24,GameCore.Utils.Valid.isValueChangeAsync(window.__fbGameReady,!0);case 24:return t.next=26,GameSDK.player.subscribeBotAsync();case 26:return window.game.analytics.event(r,{success:!0}),t.abrupt("return",!0);case 30:return t.prev=30,t.t0=t.catch(21),window.game.analytics.event(r,{success:!1}),t.abrupt("return",!1);case 34:return t.abrupt("return",!1);case 37:return t.prev=37,t.t1=t.catch(2),t.abrupt("return",!1);case 40:case"end":return t.stop()}}),t,this,[[2,37],[21,30]])})));return function(){return t.apply(this,arguments)}}(),e.matchPlayerAsync=function(){var t=(0,i.default)(o().mark((function t(e,n,i){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s()(a=GameSDK.getSupportedAPIs()).call(a,"checkCanPlayerMatchAsync")){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,GameSDK.checkCanPlayerMatchAsync();case 6:if(t.sent){t.next=9;break}return t.abrupt("return",!1);case 9:return t.next=11,GameSDK.matchPlayerAsync(e,n,i);case 11:return t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n,i){return t.apply(this,arguments)}}(),e.setLoadingProgress=function(t){GameSDK.setLoadingProgress(t)},e.getLocale=function(){return GameSDK.getLocale()||"en"},e.injectTournament=function(){var t=(0,i.default)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!GameCore.Configs.Tournament.UseMock){t.next=8;break}return t.next=4,n.e(357).then(n.bind(n,569));case 4:e=t.sent.default,this.facebook.tournament=new e,t.next=9;break;case 8:this.facebook.tournament=new u;case 9:this.facebook.getTournamentAsync=this.getTournamentAsync,this.facebook.requestTournamentAsync=this.requestTournamentAsync;case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getTournamentAsync=function(){var t=(0,i.default)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.getTournamentAsync();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}();e.default=d},52:function(t,e,n){"use strict";n.r(e),n.d(e,{AnalyticsEvents:function(){return i}});var i={BUTTON_CLICK:"button_click",SCREEN_OPEN:"screen_open",LOAD_START:"load_start",LOAD_COMPLETE:"load_complete",APP_READY:"app_ready",TUTORIAL_BEGIN:"tutorial_begin",TUTORIAL_STEP:"tutorial_step",TUTORIAL_COMPLETE:"tutorial_complete",MATCH_START:"match_start",MATCH_RESCUE:"match_rescue",MATCH_END:"match_end",LEVEL_START:"level_start",LEVEL_RESCUE:"level_rescue",LEVEL_END:"level_end",SHARE:"share",MESSAGE:"message",INVITE:"invite",SHORTCUT_CREATE:"shortcut_create",SHORTCUT_CREATE_POPUP:"shortcut_create_popup",BOT_SUBSCRIBE:"bot_subscribe",BOT_SUBSCRIBE_POPUP:"bot_subscribe_popup",AD_SHOW:"ad_show",AD_SHOW_FAILED:"ad_show_failed",NEW_USER:"new_user",AD_IMPRESSION:"ad_impression",JOIN_GROUP:"join_group",TOURNAMENT_SHARE:"tournament_share",TOURNAMENT_CREATE:"tournament_create",TOURNAMENT_POST_SCORE:"tournament_post_score"}},62:function(t,e,n){"use strict";n.r(e);var i=n(118),a=function(){function t(t,e){if(this.scene=void 0,this.config=void 0,this.isStarted=void 0,this.tween=void 0,!(e.targets.length<1)){this.buildConfig(t,e);var n=this.config.targets[0].scene;n&&(this.scene=n,this.isStarted=!1,this.tween=n.tweens.create(this.config))}}var e=t.prototype;return e.buildConfig=function(t,e){this.config=(0,i.merge)(t,e)},e.play=function(){this.tween&&(this.isStarted&&this.tween.hasStarted?this.restart():(this.tween.play(),this.isStarted=!0))},e.restart=function(){var t;null==(t=this.tween)||t.restart()},e.stop=function(){var t;null==(t=this.tween)||t.stop()},e.remove=function(){var t;null==(t=this.tween)||t.remove()},e.next=function(t){return this.tween?(this.tween.off(Phaser.Tweens.Events.TWEEN_COMPLETE,t),this.tween.once(Phaser.Tweens.Events.TWEEN_COMPLETE,t),this.tween):null},t}();e.default=a},464:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),s=n(62),r={targets:[],repeat:-1,yoyo:!0,duration:33,ease:Phaser.Math.Easing.Sine.InOut,props:{x:5}},o=function(t){function e(e){var n,a,s;return(s=t.call(this,r,e)||this).posX=void 0,s.handleSwitchPosition=function(){var t;s.posX=-s.posX,null==(t=s.tween)||t.updateTo("x",-s.posX)},null!=(n=s.config)&&n.props?(s.posX=s.config.props.x,null==(a=s.tween)||a.on(Phaser.Tweens.Events.TWEEN_REPEAT,s.handleSwitchPosition),s):(0,i.default)(s)}return(0,a.default)(e,t),e}(s.default);e.default=o},458:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(62),s={targets:[],duration:400,ease:n(309).default,props:{scale:"-=0.1"}},r=function(t){function e(e){return t.call(this,s,e)||this}return(0,i.default)(e,t),e}(a.default);e.default=r},482:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(62),s={targets:[],duration:400,ease:n(309).default,props:{scale:"+=0.1"}},r=function(t){function e(e){return t.call(this,s,e)||this}return(0,i.default)(e,t),e}(a.default);e.default=r},309:function(t,e,n){"use strict";n.r(e);var i=n(325),a=n.n(i)()(.48,1.57,.6,.83);e.default=a},11:function(t,e,n){"use strict";n.r(e);var i=n(109),a=n(4),s=n(0),r=n(52),o=n(458),h=n(35),c=n(26),l=n(28),u=function(t){function e(e,n,i,s,r,l){var u;return void 0===l&&(l=!1),(u=t.call(this,e)||this).useSound=!0,u.isClicked=!1,u.scaleUp=-1,u.scaleDown=-1,u.button=void 0,u.upAnimation=void 0,u.downAnimation=void 0,u.isUsePixelPerfect=!1,u.hitArea=void 0,u.hitZone=void 0,u.scaleDownPress=void 0,u.parentName=void 0,u.handelObjectDestroy=function(){u.scene&&u.scene.events.off(Phaser.Scenes.Events.SLEEP,u.handleSceneSleep)},u.handleSceneSleep=function(){u.scene&&u.scene.tweens.killTweensOf((0,a.default)(u))},u.handlePointerDown=function(){var t,e;u.isClicked||null!=(t=u.upAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(u.isClicked=!0,u.runDownAnimation())},u.handleOnClick=function(t){return function(){var e,n,i,a;u.isClicked&&(null!=(e=u.upAnimation)&&null!=(n=e.tween)&&n.isPlaying()||(u.isClicked=!1,u.runUpAnimation(),null==(i=u.upAnimation)||null==(a=i.tween)||a.once(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){u.logButtonEvent(),u.addDebugData(),u.processCallback(t)}))))}},u.handlePointerOut=function(){var t,e;u.isClicked&&(null!=(t=u.upAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(u.isClicked=!1,u.runUpAnimation()))},u.runDownAnimation=function(){var t;-1===u.scaleDown&&(u.scaleUp=u.scale,u.scaleDown=u.scaleDownPress),u.useSound&&u.scene.audio.playSound(c.default.BUTTON_CLICK),null==(t=u.downAnimation)||t.remove(),u.downAnimation=new o.default({targets:[(0,a.default)(u)],duration:150,props:{scale:u.scaleDown},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.downAnimation.play()},u.runUpAnimation=function(){var t;-1!==u.scaleUp&&(null==(t=u.upAnimation)||t.remove(),u.upAnimation=new o.default({targets:[(0,a.default)(u)],duration:150,props:{scale:u.scaleUp},onUpdate:function(){u.hitZone.scale=1/u.scale}}),u.upAnimation.play())},u.isUsePixelPerfect=l,u.setDepth(h.default.BUTTON),u.createButton(n,i,s,r),u.updateSize(),u.listenEvents(),u.scene.add.existing((0,a.default)(u)),u}(0,s.default)(e,t);var n=e.prototype;return n.listenEvents=function(){this.scene.events.on(Phaser.Scenes.Events.SLEEP,this.handleSceneSleep),this.once(Phaser.GameObjects.Events.DESTROY,this.handelObjectDestroy)},n.processCallback=function(t){var e,n,i;null==(e=this.upAnimation)||e.stop(),null==(n=this.downAnimation)||n.stop(),null==(i=this.scene)||i.tweens.killTweensOf(this),-1!==this.scaleUp&&this.setScale(this.scaleUp),t()},n.setDisabled=function(t){var e,n;t?(this.setAlpha(.5),null==(e=this.hitArea)||e.disableInteractive()):(this.setAlpha(1),null==(n=this.hitArea)||n.setInteractive())},n.createButton=function(t,e,n,i){this.button=this.scene.add.image(0,0,t,e),n&&i&&this.button.setWorldSize(n,i),this.scaleDownPress=this.scale-.1;var a=this.button,s=a.displayWidth,r=a.displayHeight;this.hitZone=this.scene.make.zone({displayWidth:s,displayHeight:r}),this.add([this.button,this.hitZone])},n.updateSize=function(){var t=this.button,e=t.width,n=t.height,i=e/100*10,a=n/100*10,s=i<10?i:10,r=a<10?a:10;this.setSize(e+s,n+r),this.hitZone.setSize(e+s,n+r)},n.addDebugData=function(){var t=this.getParentName(),e=this.name;(0,l.addBreadcrumbSentry)("ui-click",t+":"+e)},n.logButtonEvent=function(){var t=this.getParentName(),e=this.name;this.scene.analytics.event(r.AnalyticsEvents.BUTTON_CLICK,{button_name:e,screen_name:t})},n.getParentName=function(){if(this.parentName)return this.parentName;for(var t=this.parentContainer;t;){if(t instanceof GameCore.Screen){var e=t;return this.parentName=e.getScreenName(),this.parentName}t=t.parentContainer}return this.parentName=this.scene.getSceneName(),this.parentName},(0,i.default)(e,[{key:"onClick",set:function(t){this.isUsePixelPerfect?(this.hitArea=this.button,this.hitArea.setInteractive({useHandCursor:!0,pixelPerfect:!0})):(this.hitArea=this.hitZone,this.updateSize(),this.hitArea.setInteractive({useHandCursor:!0})),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.handlePointerDown),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_UP,this.handleOnClick(t)),this.hitArea.on(Phaser.Input.Events.GAMEOBJECT_POINTER_OUT,this.handlePointerOut)}},{key:"isUsePixelPerFect",get:function(){return this.isUsePixelPerfect}}]),e}(Phaser.GameObjects.Container);e.default=u},465:function(t,e,n){"use strict";n.r(e);var i=n(10),a=n(109),s=n(4),r=n(0),o=n(45),h=n.n(o),c=n(243),l=n.n(c),u=n(85),d=n.n(u),p=n(30),f=n.n(p),g=n(48),m=n.n(g),v=n(161),y=n.n(v),S=n(140),A=n.n(S),E=n(253),x=n.n(E),b=n(35),T=n(440);function w(t,e){var n="undefined"!==typeof A()&&x()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return M(t,e);var i=m()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return y()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return M(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var C=function(t){function e(e,n){var a,r;(r=t.call(this,e)||this).config=void 0,r.isEnable=void 0,r.maxHeight=void 0,r.isScrolling=void 0,r.boundTop=void 0,r.boundBottom=void 0,r.maskGraphics=void 0,r.objects=void 0,r._value=0,r.velocity=0,r.isScrollingSmooth=void 0,r.lastScrollY=void 0,r.isScrollingBack=void 0,r.scrollingBackTo=void 0,r.lastScrollYCount=0,r.hitArea=void 0,r.onScrollEvents=[],r.update=function(t,e){r.isScrollingSmooth&&r.velocity&&r.scrollingSmooth(e),r.isScrollingBack&&r.scrollingBack(e)},r.checkReachBound=function(){return r.isReachTop()||r.isReachBottom()},r.onMouseScroll=(0,T.debounce)((function(t,e,n){if(r.isEnable){var i;if(r.isScrolling=!0,r.checkReachBound())return r.lastScrollY=h()(i=r.lastScrollY).call(i,(function(){return 0})),void(r.isScrolling=!1);r.stopScrollingBack(),r.startScrollSmooth(-n*r.scrollSmooth/15)}}),100,{isImmediate:!0,maxWait:100}),r.onTouchScroll=function(t){if(r.isEnable){r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack(),r.isScrolling=!0;var e=r.scene.game.world.getZoomRatio(),n=t.position,i=t.prevPosition,a=(n.y-i.y)/e,s=r.height*r.maxScrollOver,o=1;if(r.lastScrollY[++r.lastScrollYCount%r.lastScrollY.length]=a,r.isReachTop()&&a>=0){var h=(s-(r.value-r.marginTop))/s;o=Math.min(o,h)}if(r.isReachBottom()&&a<=0){var c=(s-(-r.maxHeight-r.value))/s;o=Math.min(o,c)}var l=a*o,u=r.maxScrollOver*r.height;r.value+l>r.marginTop+u?r.value=r.marginTop+u:r.value+l<-r.maxHeight-u?r.value=-r.maxHeight-u:r.value+=l,r.callOnScrollEvents(r.value,l)}},r.onTouchDown=function(){r.isEnable&&(r.velocity&&r.stopScrollSmooth(),r.stopScrollingBack())},r.onTouchEnd=function(){var t,e;if(r.isReachTop()&&(r.startScrollingBack(r.marginTop),r.stopScrollSmooth()),r.isReachBottom()&&(r.startScrollingBack(-r.maxHeight),r.stopScrollSmooth()),r.isScrolling){var n=l()(t=r.lastScrollY).call(t,(function(t,e){return t+e}))/r.lastScrollY.length;r.startScrollSmooth(n*r.scrollSmooth),r.lastScrollY=h()(e=r.lastScrollY).call(e,(function(){return 0}))}},r.config=(0,i.default)({marginTop:0,marginBottom:0,acceleration:1400,maxScrollOver:.15,scrollSmooth:40,scrollingBackRate:5,useMask:!0},n);var o=n.width,c=n.height;return r.isEnable=!1,r.maxHeight=0,r.lastScrollY=d()(a=new Array(3)).call(a,0),r.setSize(o,c),r.createGroup(),r.createInput(),r.createEvents(),r.scene.add.existing((0,s.default)(r)),r}(0,r.default)(e,t);var n=e.prototype;return n.onScroll=function(t){this.onScrollEvents.push(t)},n.gotoTop=function(){this.value=this.config.marginTop},n.reset=function(){this.maxHeight=0,this.isScrolling=!1,this.isScrollingBack=!1,this.isScrollingSmooth=!1,this.gotoTop(),this.setEnable(!1)},n.createDebug=function(){this.drawDebugBox(16711680,.8)},n.setEnable=function(t){this.isEnable=t,t?this.setInteractive({draggable:!0,useHandCursor:!0}):this.disableInteractive()},n.addItem=function(t){this.addAt(t),this.objects.add(t);var e=t.y+t.height+this.marginBottom-this.height/2;this.maxHeight=Math.max(this.maxHeight,e,0),this.updateObjectVisible()},n.addItems=function(t){var e=this;this.addAt(t),this.objects.addMultiple(t);var n=h()(t).call(t,(function(t){return t.y+t.height+e.marginBottom-e.height/2}));this.maxHeight=Math.max(this.maxHeight,Math.max.apply(Math,n),0),this.updateObjectVisible()},n.clearItem=function(){this.objects.clear(!0,!0),this.reset()},n.getChildren=function(){var t;return f()(t=this.objects.getChildren()).call(t,(function(t){return t.active}))},n.createBound=function(t,e,n,i){this.boundTop=this.scene.make.image({key:t,frame:e}),this.boundBottom=this.scene.make.image({key:t,frame:e}),i&&(this.boundTop.setTint(i),this.boundBottom.setTint(i)),this.boundTop.setAlpha(0,0,0,0),this.boundBottom.setAlpha(0,0,0,0),this.boundTop.setDepth(b.default.PRIORITY),this.boundBottom.setDepth(b.default.PRIORITY);var a=this.width,s=n,r=this.getWorldPosition(),o=r.x,h=r.y;this.boundTop.setDisplaySize(a,s),this.boundBottom.setDisplaySize(a,s),this.boundTop.setY(-this.displayHeight/2+s/2+h-this.y-1),this.boundBottom.setY(this.displayHeight/2-s/2+h-this.y+1),this.boundTop.setX(o-this.x),this.boundBottom.setX(o-this.x),this.add([this.boundTop,this.boundBottom])},n.createMask=function(){var t;null==(t=this.maskGraphics)||t.destroy(),this.maskGraphics=this.scene.make.graphics({fillStyle:{color:255,alpha:1},visible:!0}),this.maskGraphics.setName("MaskGraphics");var e=this.width,n=this.height;this.maskGraphics.fillRoundedRect(0-e/2,0-n/2,e,n,0),this.config.useMask&&this.setMask(this.maskGraphics.createGeometryMask()),this.scene.events.off(Phaser.Scenes.Events.UPDATE,this.updateMask,this),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.updateMask,this)},n.updateMask=function(){var t=this.getWorldPosition(),e=t.x,n=t.y;this.maskGraphics.setPosition(e,n)},n.createGroup=function(){this.objects=this.scene.make.group({})},n.updateObject=function(t){this.objects.incY(t),this.updateObjectVisible()},n.updateObjectVisible=function(){for(var t=this.objects.getChildren(),e=0;e<t.length;e++){var n=t[e];n.y+n.height<-this.height/2||n.y-n.height>this.height/2?n.setVisible(!1):n.setVisible(!0)}},n.createInput=function(){this.setInteractive({draggable:!0,useHandCursor:!0}),this.on(Phaser.Input.Events.POINTER_WHEEL,this.onMouseScroll),this.on(Phaser.Input.Events.GAMEOBJECT_DRAG,this.onTouchScroll),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,this.onTouchDown),this.scene.input.on(Phaser.Input.Events.POINTER_UP,this.onTouchEnd,this)},n.createEvents=function(){this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update)},n.callOnScrollEvents=function(t,e){for(var n,i=w(this.onScrollEvents);!(n=i()).done;){(0,n.value)(this,t,e)}},n.scrollingBack=function(t){var e=(this.scrollingBackTo-this.value)*t*this.scrollingBackRate/1e3;this.value+=e,Math.abs(this.scrollingBackTo-this.value)<.5&&(this.value=this.scrollingBackTo,this.stopScrollingBack()),this.callOnScrollEvents(this.value,e)},n.startScrollingBack=function(t){this.isScrollingBack=!0,this.scrollingBackTo=t},n.stopScrollingBack=function(){this.isScrollingBack=!1},n.scrollingSmooth=function(t){var e=this.velocity*t/1e3;this.value+=e;var n=Math.abs(this.velocity)/this.velocity;this.velocity-=n*this.acceleration*t/1e3,Math.abs(this.velocity)<this.acceleration*t/1e3&&this.stopScrollSmooth(),this.isReachTop()&&(this.startScrollingBack(this.marginTop),this.stopScrollSmooth()),this.isReachBottom()&&(this.startScrollingBack(-this.maxHeight),this.stopScrollSmooth()),this.callOnScrollEvents(this.value,e)},n.startScrollSmooth=function(t){this.isScrollingSmooth=!0,t&&(t*this.velocity>0?this.velocity+=t:this.velocity=t)},n.stopScrollSmooth=function(){this.isScrollingSmooth=!1,this.isScrolling=!1,this.velocity=0},n.isReachTop=function(){return this.value>this.marginTop},n.isReachBottom=function(){return-this.value>this.maxHeight},(0,a.default)(e,[{key:"marginTop",get:function(){return this.config.marginTop}},{key:"marginBottom",get:function(){return this.config.marginBottom}},{key:"acceleration",get:function(){return this.config.acceleration}},{key:"maxScrollOver",get:function(){return this.config.maxScrollOver}},{key:"scrollSmooth",get:function(){return this.config.scrollSmooth}},{key:"scrollingBackRate",get:function(){return this.config.scrollingBackRate}},{key:"value",get:function(){return this._value},set:function(t){var e=t-this._value;this._value=t,this.updateObject(e)}}]),e}(Phaser.GameObjects.Container);e.default=C},70:function(t,e,n){"use strict";n.r(e);var i=n(1).default.EFFECTS,a=i.KEY,s=i.FRAME,r={CONFETTI_HEXAGON:{KEY:"confetti-hexagon-animation",TEXTURE:a,PREFIX:s.FX_CONFETTI_HEXAGON,FRAME_RATE:8,END:5,ZERO_PAD:0},CONFETTI_STAR_X:{KEY:"confetti-star-x",TEXTURE:a,PREFIX:s.ANIMATION_STAR_X,FRAME_RATE:4,END:4,ZERO_PAD:0},CONFETTI_STAR_Y:{KEY:"confetti-star-y",TEXTURE:a,PREFIX:s.ANIMATION_STAR_Y,FRAME_RATE:4,END:4,ZERO_PAD:0},RIBBON_A:{KEY:"animation-ribbon-a",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_A,FRAME_RATE:16,END:3,ZERO_PAD:0},RIBBON_B:{KEY:"animation-ribbon-b",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_B,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_C:{KEY:"animation-ribbon-c",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_C,FRAME_RATE:16,END:4,ZERO_PAD:0},RIBBON_D:{KEY:"animation-ribbon-d",TEXTURE:a,PREFIX:s.PREFIX_ANIMATION_RIBBON_CONFETTI_D,FRAME_RATE:16,END:4,ZERO_PAD:0}};e.default=r},35:function(t,e,n){"use strict";n.r(e);e.default={BACKGROUND:1,FIREWORKS:5,ITEM:10,LOGO:15,BUTTON:20,TILE:25,TEXT:30,ENCOURAGING:31,EFFECT:32,MESSAGE:33,POPUP:999,PRIORITY:80,DEBUG:90,DICE:99,PIECE:99,ON_TOP:1e4}},246:function(t,e,n){"use strict";n.r(e);e.default={min:18,max:60}},16:function(t,e,n){"use strict";n.r(e);e.default={PRIMARY:{KEY:"font-main",TEXTURE:"./assets/fonts/primary.png",DATA:"./assets/fonts/primary.fnt"},PRIMARY_LIGHT:{KEY:"font-main-light",TEXTURE:"./assets/fonts/primary-light.png",DATA:"./assets/fonts/primary-light.fnt"},NUMBER_LIGHT:{KEY:"number-light",TEXTURE:"./assets/fonts/number-light.png",DATA:"./assets/fonts/number-light.xml"},NUMBER_DARK:{KEY:"number-dark",TEXTURE:"./assets/fonts/number-dark.png",DATA:"./assets/fonts/number-dark.xml"},FONT_FAMILY:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',FONT_FAMILY_ARIAL:"Arial"}},119:function(t,e,n){"use strict";n.r(e);var i={AVATAR:{KEY:"avatar",FILE:"./assets/images/others/avatar.png",CONFIG:{}},ICON_EARTH:{KEY:"icon-earth",FILE:"./assets/images/others/icon-earth.png",CONFIG:{}},BACKGROUND:{KEY:"background",FILE:"./assets/images/"+(0,n(444).getImageScale)()+"x/bg.jpg",CONFIG:{}}};e.default=i},1:function(t,e,n){"use strict";n.r(e);var i=n(10),a=(0,n(444).getImageScale)(),s={TUTORIAL:{KEY:"tutorial-resources",TEXTURE:"./assets/textures/"+a+"x/tutorial-resources.png",JSON:"./assets/textures/"+a+"x/tutorial-resources.json",FRAME:{HAND:"hand",BLANK:"blank",BUTTON_BROWN:"brown"}},DEFAULT:{KEY:"default-resources",TEXTURE:"./assets/textures/"+a+"x/default-resources.png",JSON:"./assets/textures/"+a+"x/default-resources.json",URL:"./assets/textures/"+a+"x/",FRAME:{BLANK:"blank",LOGO:"logo",TEXT_LOADING:"loading",BORDER_BOTTOM_PANEL:"border-bottom-panel",BOTTOM_PANEL:"bottom-panel",BOTTOM_LINE:"bottom-line",GLARE:"glare",TITLE_YOUR_SCORE:"title-your-score",BG_YOUR_SCORE:"bg-your-score",LEAF:"leaf",BEST_SCORE_FRAME:"best-score-frame",BEST_SCORE_FRAME_LONG:"best-score-frame-long",FOOTER:"footer",SCORE_PANEL:"score-panel",SCORE_PANEL_DARK:"score-panel-dark",BG_PROGRESS_CIRCLE:"bg-progress-circle",BG_TEXT_TARGET_PANEL:"text-target-panel",WOOD_PANEL:"wood-panel",BG_STREAK:"bg-streak",BG_COMBO:"bg-combo",LEVEL_PLAYED:"bg/level-played",LEVEL_PLAYING:"bg/level-playing",LEVEL_LOCKED:"bg/level-locked",BG_DARK:"bg/bg-dark",BG_TOP:"bg/bg-top",BG_MIDDLE:"bg/bg-middle",BG_BOTTOM:"bg/bg-bottom",PRELOADER:"preloader/dual-ring",LEADERBOARD_TAB_ON:"leaderboards/tab-on",LEADERBOARD_TAB_OFF:"leaderboards/tab-off",LEADERBOARD_BG_TOP:"leaderboards/bg-top",LEADERBOARD_BG_MIDDLE:"leaderboards/bg-middle",LEADERBOARD_BG_BOTTOM:"leaderboards/bg-bottom",LEADERBOARD_BG_ITEM:"leaderboards/bg-item",LEADERBOARD_BORDER_LEFT:"leaderboards/border-left",LEADERBOARD_BORDER_RIGHT:"leaderboards/border-right",PREFIX_LEADERBOARD_BG_ITEM:"leaderboards/bg-item-",PREFIX_LEADERBOARD_BG_ITEM_0:"leaderboards/bg-item-0",AVATAR_BORDER:"avatar/border",AVATAR_BORDER_BIG:"avatar/border-big",AVATAR_BORDER_CHALLENGE:"avatar/border-challenge",AVATAR_BACKGROUND:"avatar/background",POPUP_TOP:"popup/top",POPUP_TOP_DARK:"popup/top-dark",POPUP_MID:"popup/middle",POPUP_BOTTOM:"popup/bottom",POPUP_CONTENT_BACKGROUND:"popup/background",POPUP_SCORE_PANEL:"popup/score-panel",ICON_ADS:"icons/flat-ad",ICON_CUP_GOLD:"icons/cup-gold",ICON_CUP_SILVER:"icons/cup-silver",ICON_CUP_COPPER:"icons/cup-bronze",ICON_SOUND:"icons/sound",ICON_VIBRATE:"icons/vibrate",ICON_MUSIC:"icons/music",ICON_RANK:"icons/rank",ICON_PLAY:"icons/play",ICON_I_PLAY:"icons/i-play",ICON_PLAY_GREEN:"icons/play-green",ICON_SHARE:"icons/share",ICON_INVITE:"icons/invite",ICON_FLAG:"icons/milestone",ICON_BROWN_JOURNEY:"icons/brown-journey",ICON_WHITE_JOURNEY:"icons/white-journey",ICON_SWORD:"icons/sword",ICON_SWORD_BLUE:"icons/sword-blue",ICON_SETTING:"icons/setting",ICON_REPLAY:"icons/replay",ICON_RETRY:"icons/retry",ICON_HOME:"icons/home",ICON_BACK:"icons/back",ICON_BATTLE:"icons/battle",ICON_CUP:"icons/cup",ICON_SHARE_BLUE:"icons/share-blue",ICON_CROWN:"icons/crown",ICON_CROWN_BIG:"icons/crown-big",ICON_STAR:"icons/star",ICON_PLUS:"icons/plus",ICON_CHECK:"icons/check",BUTTON_CLOSE:"buttons/close",BUTTON_RED:"buttons/red",BUTTON_BLUE:"buttons/blue",BUTTON_BLUE_SMALL:"buttons/blue-small",BUTTON_BLUE_MEDIUM:"buttons/blue-medium",BUTTON_GREEN:"buttons/green",BUTTON_GREEN_BIG:"buttons/green-big",BUTTON_DARK_BLUE:"buttons/dark-blue",BUTTON_DARK_BLUE_BIG:"buttons/dark-blue-big",BUTTON_BROWN:"buttons/brown",BUTTON_GREEN_LARGE:"buttons/green-large",BUTTON_PLAY:"buttons/play",BUTTON_RANDOM:"buttons/random",BUTTON_CHALLENGE_LIGHT:"buttons/challenge_light",BUTTON_SHARE_DARK:"buttons/share",BUTTON_MINOR:"buttons/minor",BUTTON_CIRCLE:"buttons/circle-button",BUTTON_TOGGLE_OFF:"buttons/toggle-off",BUTTON_TOGGLE_ON:"buttons/toggle-on",BUTTON_DARK_BLUE_SMALL:"buttons/dark-blue-small",NO_THANK_TEXT:"texts/no-thank",TEXT_SECOND_CHANGE:"texts/second-chance",TEXT_VS:"texts/vs",TEXT_LOSE:"texts/lose",TEXT_WIN:"texts/win",TEXT_DRAW:"texts/draw",TEXT_CONTINUE:"texts/continue",TEXT_LEADER_BOARD:"texts/leader-board",TEXT_WORLD:"texts/world",TEXT_WORLD_DISABLE:"texts/world-disable",TEXT_FRIENDS:"texts/friends",TEXT_FRIENDS_DISABLE:"texts/friends-disable",TEXT_PLAY_WITH:"texts/play-with",TEXT_PLAY_WITH_BLUE:"texts/play-with-blue",TEXT_JOURNEY:"texts/text-journey",TEXT_SETTING:"texts/setting",TEXT_OFF:"texts/off",TEXT_ON:"texts/on",TEXT_REPLAY:"texts/replay",TEXT_YOUR_SCORE:"texts/your-score",TEXT_WAITING_OPPONENT:"texts/waiting-for-opponent",TEXT_SINGLE:"texts/play-single",TEXT_RETRY:"texts/text-retry",TEXT_LEVEL_FAIL:"texts/level-failed",TEXT_CONGRATULATION:"texts/congratulations",TEXT_NEXT_LEVEL:"texts/text-next-level",TEXT_SHARE_BLUE:"texts/text-share",TEXT_CLOSE_BLUE:"texts/text-close",TEXT_PLAY:"texts/play",TEXT_MISSION:"texts/mission",TEXT_NEXT_MILESTONE:"texts/next-milestone",TEXT_FIRST_MILESTONE:"texts/first-milestone",TEXT_COLLECT:"texts/collect",TEXT_YES:"texts/yes",TEXT_NO:"texts/no",TEXT_TUTORIAL:"texts/text-tutorial",TEXT_NEW_BEST:"texts/new-best",TEXT_INVITE_FRIENDS:"texts/invite-friends",TEXT_KEEP_PLAYING:"texts/keep-playing",TEXT_OUT_OF_LIVE:"texts/out-of-live",TEXT_REFILL_LIVES:"texts/refill-lives",LIVES_HEART:"lives/heart",LIVES_TIME_BLOCK:"lives/time-block",LIVES_TIME_BLOCK_2:"lives/time-block-2"}},EFFECTS:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/effects-resources.png",JSON:"./assets/textures/"+a+"x/effects-resources.json",FRAME:{BLANK:"blank",GLOW_CIRCLE:"glow-circle",GLARE_CROSS:"glare-cross",DUST:"dust",DUST_YELLOW:"dust-yellow",FX_STAR:"star",FX_STAR_YELLOW:"star-yellow",FX_CONFETTI_SMALL_1:"confetti/small-1",FX_CONFETTI_SMALL_2:"confetti/small-2",FX_CONFETTI_SMALL_3:"confetti/small-3",FX_CONFETTI_SMALL_4:"confetti/small-4",FX_CONFETTI_HEXAGON:"confetti/hexagon-",FX_CONFETTI_RIBBON:"ribbon",TEXT_COOL:"text/text_cool",TEXT_EXCELLENT:"text/text_excellent",TEXT_GOOD:"text/text_good",FX_COMET:"comet",FX_SPARK:"spark",FX_CIRCLE:"circle",FX_CIRCLE_LIGHT:"circle-light",FX_GLOW_LIGHT:"glow-light",FX_GLOW_SMALL:"glow-small",FX_STAR_WHITE:"star-white",FX_FIREWORKS_SMALL:"fireworks/small",FX_FIREWORKS_BIG_0:"fireworks/big-explosive-0",FX_FIREWORKS_BIG_1:"fireworks/big-explosive-1",FX_FIREWORKS_SOAR_LINE:"fireworks/soar-line",FX_FIREWORKS_SOAR_CIRCLE:"fireworks/soar-circle",PREFIX_ANIMATION_RIBBON_CONFETTI_A:"ribbon/falling-confetti/confetti-a/confetti-a-",PREFIX_ANIMATION_RIBBON_CONFETTI_B:"ribbon/falling-confetti/confetti-b/confetti-b-",PREFIX_ANIMATION_RIBBON_CONFETTI_C:"ribbon/falling-confetti/confetti-c/confetti-c-",PREFIX_ANIMATION_RIBBON_CONFETTI_D:"ribbon/falling-confetti/confetti-d/confetti-d-",ANIMATION_STAR_X:"star-x/star-",ANIMATION_STAR_Y:"star-y/star-"}},ANIMATION_SCENE:{KEY:"effects-resources",PATH:"./assets/textures/"+a+"x/",JSON:"./assets/textures/"+a+"x/animation-scene-resources.json",FRAME:{BLANK:"blank",COIN:"coins/coin",COIN_SMALL:"coins/coin-small",COIN_SMALL_GREY:"coins/coin-small-grey",FX_SPARK_YELLOW:"yellow-spark",FX_CONFETTI_RIBBON:"ribbon/ribbon"}},GAMEPLAY:{KEY:"gameplay-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-resources.json",FRAME:{BLANK:"blank",BG_SCORE:"bg-score",BG_MAIN_SCORE:"bg-main-score",BOARD:"board",VIOLET_GLOW:"violet-glow",MASK:"mask",FLAG:"flag",DUST:"dust",CUP_GLARE:"cup-glare",HAND:"hand",AVATAR_BORDER:"avatars/border",AVATAR_BACKGROUND:"avatars/background",ICON_SETTING:"icons/setting",ICON_CUP:"icons/cup",ICON_CHECK:"icons/check",ICON_STAR:"icons/star",ICON_STAR_1:"icons/star-1",ICON_HOME:"icons/home",ICON_ADD_FRIEND:"icons/add-friends",ICON_BATTLE:"icons/battle",TEXT_NEXT_LEVEL:"text/next-level",BUTTON_WOOD_SMALL:"buttons/wood-small",BUTTON_SKIP:"buttons/button-skip",PROGRESS_BG_LEFT:"progress/bg-left",PROGRESS_BG_MID:"progress/bg-mid",PROGRESS_BG_RIGHT:"progress/bg-right",PROGRESS_BAR_LEFT:"progress/bar-left",PROGRESS_BAR_MID:"progress/bar-mid",PROGRESS_BAR_RIGHT:"progress/bar-right",PROGRESS_BAR_RIGHT_WHITE:"progress/bar-right-white"}},GAMEPLAY_32:{KEY:"gameplay-32-resources",TEXTURE:"./assets/textures/"+a+"x/gameplay-32-resources.png",JSON:"./assets/textures/"+a+"x/gameplay-32-resources.json",FRAME:{GEM:"gem/gem",GEM_LIGHT:"gem/gem_light",GEM_SILVER:"gem/gem_silver",GEM_TRANSPARENT:"gem/gem_transparent",GEM_WHITE:"gem/gem_white",GEM_GLARE:"gem/gem_glare",GEM_HIGHT_LIGHT:"gem/gem_highlight",GEM_DIAMOND_10:"gem/diamond/diamond-10",GEM_DIAMOND_11:"gem/diamond/diamond-11",GEM_DIAMOND_12:"gem/diamond/diamond-12",GEM_DIAMOND_13:"gem/diamond/diamond-13",GEM_DIAMOND_14:"gem/diamond/diamond-14",GEM_DIAMOND_15:"gem/diamond/diamond-15",GEM_DIAMOND_10_LIGHT:"gem/diamond/diamond-10_light",GEM_DIAMOND_11_LIGHT:"gem/diamond/diamond-11_light",GEM_DIAMOND_12_LIGHT:"gem/diamond/diamond-12_light",GEM_DIAMOND_13_LIGHT:"gem/diamond/diamond-13_light",GEM_DIAMOND_14_LIGHT:"gem/diamond/diamond-14_light",GEM_DIAMOND_15_LIGHT:"gem/diamond/diamond-15_light",GEM_RUBY_20:"gem/ruby/ruby-20",GEM_SAPPHIRE_30:"gem/sapphire/sapphire-30",BLOCK_GRADIENT_PREFIX:"gem/block_gradient/block_color"}},DEMO_SPINE:{KEY:"demo-spine",jsonPATH:"./assets/spines/demo/demo.json",atlasPATH:"./assets/spines/demo/demo.atlas"}};GameCore.Utils.Valid.isDebugger()&&(s.EFFECTS.FRAME=(0,i.default)({},s.ANIMATION_SCENE.FRAME,s.EFFECTS.FRAME)),e.default=s},39:function(t,e,n){"use strict";n.r(e),n.d(e,{SceneKeys:function(){return r},SceneEvents:function(){return o},SceneDepth:function(){return i}});var i,a=n(140),s=n.n(a),r={BOOT_SCENE:"BOOT_SCENE",LOAD_SCENE:"LOAD_SCENE",GAME_SCENE:"GAME_SCENE",GLOBAL_SCENE:"GLOBAL_SCENE",DASHBOARD_SCENE:"DASHBOARD_SCENE",GAME_OVER_SCENE:"GAME_OVER_SCENE",LEADERBOARD_SCENE:"LEADERBOARD_SCENE",JOURNEY_SCENE:"JOURNEY_SCENE",LEVEL_SCENE:"LEVEL_SCENE",TEST_SCENE:"TEST_SCENE",ANIMATIONS_SCENE:"ANIMATIONS_SCENE"},o={SWITCH:s()("SWITCH"),LAUNCH:s()("LAUNCH"),RUN:s()("RUN")};!function(t){t[t.SCENE=0]="SCENE",t[t.POPUP=1]="POPUP"}(i||(i={}))},26:function(t,e,n){"use strict";n.r(e);e.default={BUTTON_CLICK:"button_click",CONGRATULATION:"congratulation",DAILY_REWARD:"daily_reward",GAME_OVER_SCENE:"game_over_scene",GAME_OVER:"game_over",POPUP_OFF:"popup_off",POPUP_SHOW:"popup_show",SCORE_COUNT:"score_count",PIECE_PICK:"piece_pick",PIECE_DROP:"piece_drop",PIECE_INVALID_MOVE:"piece_invalid_move",BOARD_GAME_OVER:"board_end",RESCUE_TIME:"rescue_timer",EAT_BLOCK:"eat_block",GOOD:"good",COOL:"cool",EXCELLENT:"excellent",SCORE_REACHED:"reach_score",TARGET_REACHED:"reach_goal",WAIT_OPPONENT:"wait_opponent",WIN:"win",LOSE:"lose",DRAW:"draw",FIREWORKS_BIG:"fireworks_big",FIREWORKS_SOAR:"fireworks_soar",FIREWORKS_SMALL:"fireworks_small"}},471:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),s=n(1),r=n(118),o=s.default.EFFECTS,h=o.KEY,c=o.FRAME,l=function(t){function e(e,n){var a;return(a=t.call(this,e,h,c.BLANK)||this).config=void 0,a.emitter=void 0,a.config=n||{},a.scene.add.existing((0,i.default)(a)),a}(0,a.default)(e,t);var n=e.prototype;return n.createEmitters=function(){var t=c.FX_CONFETTI_SMALL_1,e=c.FX_CONFETTI_SMALL_2,n=c.FX_CONFETTI_SMALL_3,i=c.FX_CONFETTI_SMALL_4,a=1/this.scene.world.getPixelRatio(),s={on:!1,particleBringToTop:!0,frame:[t,e,n,i],tint:[14223402,1021804,5420529,16702052],timeScale:1,frequency:300,maxParticles:120,gravityY:-10,speedX:{min:-100,max:100},speedY:{min:80,max:250},alpha:{start:1,end:.8},rotate:{start:0,end:1080},scale:{min:.8*a,max:2*a},angle:{min:20,max:160},lifespan:{min:8e3,max:12e3}},o=(0,r.merge)(s,this.config);this.emitter=this.createEmitter(o)},n.run=function(t,e,n){this.stop(),this.emitter.setQuantity(t),this.emitter.setPosition(e,n),this.emitter.start()},n.explode=function(t,e,n){this.emitter||this.createEmitters(),this.emitter.explode(t,e,n)},n.stop=function(){var t,e,n;null==(t=this.emitter)||t.killAll(),null==(e=this.emitter)||e.stop(),null==(n=this.emitter)||n.remove(),this.createEmitters()},e}(Phaser.GameObjects.Particles.ParticleEmitterManager);e.default=l},469:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ut}});var i=n(10),a=n(4),s=n(0),r=n(1),o=n(70),h=o.default.RIBBON_A,c=h.KEY,l=h.TEXTURE,u=h.FRAME_RATE,d=h.END,p=h.PREFIX,f=h.ZERO_PAD,g=function(t){function e(e){var n={repeat:-1,frameRate:u,frames:e.generateFrameNames(l,{prefix:p,end:d,zeroPad:f,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,c,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),m=o.default.RIBBON_B,v=m.KEY,y=m.TEXTURE,S=m.FRAME_RATE,A=m.END,E=m.PREFIX,x=m.ZERO_PAD,b=function(t){function e(e){var n={repeat:-1,frameRate:S,frames:e.generateFrameNames(y,{prefix:E,end:A,zeroPad:x,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,v,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),T=o.default.RIBBON_C,w=T.KEY,M=T.TEXTURE,C=T.FRAME_RATE,P=T.END,I=T.PREFIX,k=T.ZERO_PAD,R=function(t){function e(e){var n={repeat:-1,frameRate:C,frames:e.generateFrameNames(M,{prefix:I,end:P,zeroPad:k,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,w,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),O=o.default.RIBBON_D,_=O.KEY,D=O.TEXTURE,B=O.FRAME_RATE,L=O.END,F=O.PREFIX,N=O.ZERO_PAD,G=function(t){function e(e){var n={repeat:-1,frameRate:B,frames:e.generateFrameNames(D,{prefix:F,end:L,zeroPad:N,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,_,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),U=o.default.CONFETTI_STAR_X,V=U.KEY,Y=U.TEXTURE,z=U.FRAME_RATE,H=U.END,W=U.PREFIX,X=U.ZERO_PAD,K=function(t){function e(e){var n={repeat:-1,frameRate:z,frames:e.generateFrameNames(Y,{prefix:W,end:H,zeroPad:X,start:1}),yoyo:!0,showOnStart:!0};return t.call(this,e,V,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),j=o.default.CONFETTI_STAR_Y,q=j.KEY,Z=j.TEXTURE,J=j.FRAME_RATE,Q=j.END,$=j.PREFIX,tt=j.ZERO_PAD,et=function(t){function e(e){var n={repeat:-1,frameRate:J,frames:e.generateFrameNames(Z,{prefix:$,end:Q,zeroPad:tt,start:1}),showOnStart:!0};return t.call(this,e,q,n)||this}return(0,s.default)(e,t),e}(Phaser.Animations.Animation),nt=n(45),it=n.n(nt),at=n(85),st=n.n(at),rt=function(t){function e(e){var n,i,a;(a=t.call(this,e)||this).scene=void 0,a.ribbon=void 0,a.graphics=void 0,a.colorUse=void 0,a.lastChange=void 0,a.currentFrame=void 0,a.isYoyo=void 0,a.isGravityChanged=void 0,a.points=void 0,a.scene=e.manager.scene;var s=a.emitter.manager,r=s.x,o=s.y;return a.points=it()(n=st()(i=new Array(10)).call(i,null)).call(n,(function(){return{x:a.x+r,y:a.y+o}})),a.isYoyo=!1,a.isGravityChanged=!1,a.lastChange=0,a.currentFrame=-1,a.createGraphics(),a.randomRibbonUsedWhenFall(),a}(0,s.default)(e,t);var n=e.prototype;return n.randomRibbonUsedWhenFall=function(){switch(Phaser.Math.Between(0,3)){default:this.ribbon=this.scene.anims.get(o.default.RIBBON_A.KEY);break;case 1:this.ribbon=this.scene.anims.get(o.default.RIBBON_B.KEY);break;case 2:this.ribbon=this.scene.anims.get(o.default.RIBBON_C.KEY);break;case 3:this.ribbon=this.scene.anims.get(o.default.RIBBON_D.KEY)}},n.setRibbonPosition=function(t,e){var n;it()(n=this.points).call(n,(function(n){n.x=t,n.y=e}))},n.createGraphics=function(){var t=[8443204,2928867,12013036,16376097,15285798];this.colorUse=t[Phaser.Math.Between(0,t.length-1)],this.graphics=this.scene.add.graphics({lineStyle:{width:3,color:this.colorUse}});var e=this.emitter.manager,n=e.x,i=e.y,a=e.depth;this.graphics.setDepth(a),this.graphics.setPosition(n,i)},n.update=function(e,n,i){var a=t.prototype.update.call(this,e,n,i);return this.updateFrames(e),this.updatePoints(),this.updateGraphics(),this.updateGravity(),this.updateVelocity(),this.updateColor(),a},n.updateFrames=function(t){this.lastChange+=t,this.lastChange>=this.ribbon.msPerFrame&&(this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1),this.currentFrame>=this.ribbon.frames.length&&(this.isYoyo=!0,this.currentFrame-=1),this.frame=this.ribbon.frames[this.currentFrame].frame,this.lastChange-=this.ribbon.msPerFrame)},n.updatePoints=function(){this.graphics.visible&&(this.points.shift(),this.points.push({x:this.x,y:this.y}))},n.updateGraphics=function(){this.graphics.visible&&(this.graphics.clear(),this.graphics.strokePoints(this.points))},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.graphics.destroy(),this.emitter.setVisible(!0),this.emitter.setGravityY(45))},n.updateVelocity=function(){this.graphics.visible&&(this.lifeCurrent>this.life-1800?this.velocityX+=Phaser.Math.Between(-12,12):this.velocityX>0?this.velocityX+=Phaser.Math.Between(-10,6):this.velocityX+=Phaser.Math.Between(-6,10))},n.updateColor=function(){this.graphics.visible||(this.tint=this.colorUse)},e}(Phaser.GameObjects.Particles.Particle),ot=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.isYoyo=void 0,n.isGravityChanged=void 0,n.lastChange=void 0,n.currentFrame=void 0,n.star=void 0,n.starX=void 0,n.starY=void 0,n.isYoyo=!1,n.isGravityChanged=!1,n.lastChange=0,n.currentFrame=-1,n.scene=e.manager.scene,n.starX=n.scene.anims.get(o.default.CONFETTI_STAR_X.KEY),n.starY=n.scene.anims.get(o.default.CONFETTI_STAR_Y.KEY),n.star=n.starX,n}(0,s.default)(e,t);var n=e.prototype;return n.update=function(e,n,i){var a=t.prototype.update.call(this,e,n,i);return this.updateGravity(),this.updateVelocity(),this.updateFrameRate(),this.updateFrames(e),a},n.updateGravity=function(){this.lifeCurrent>this.life-2e3||this.isGravityChanged||(this.isGravityChanged=!0,this.emitter.setGravityY(15),this.emitter.setSpeedX(0))},n.updateVelocity=function(){this.lifeCurrent>this.life-2e3||(this.velocityX>0?this.velocityX+=Phaser.Math.Between(-6,3):this.velocityX+=Phaser.Math.Between(-3,6))},n.updateFrames=function(t){if(this.lastChange+=t,this.lastChange>=this.star.msPerFrame){var e=Phaser.Math.RND.between(0,1);this.star=e>0?this.starX:this.starY,this.isYoyo?this.currentFrame--:this.currentFrame++,this.currentFrame<0&&(this.isYoyo=!1,this.currentFrame=1,this.emitter.setAlpha(1)),this.currentFrame>=this.star.frames.length&&(this.isYoyo=!0,this.currentFrame-=1,this.emitter.setAlpha(.8)),this.frame=this.star.frames[this.currentFrame].frame,this.lastChange-=this.star.msPerFrame}},n.updateFrameRate=function(){this.lifeCurrent<this.life-2e3?this.star.msPerFrame=150:this.star.msPerFrame=Phaser.Math.RND.between(300,600)},e}(Phaser.GameObjects.Particles.Particle),ht=r.default.EFFECTS,ct=ht.KEY,lt=ht.FRAME,ut=function(t){function e(e){var n;return(n=t.call(this,e,ct,lt.BLANK)||this).emitterConfetti=void 0,n.emitterRibbons=void 0,n.ribbonConfig=void 0,n.confettiConfig=void 0,n.width=void 0,n.height=void 0,n.emitterRibbons=[],n.emitterConfetti=[],n.createConfigs(),n.createAnimations(),n.scene.add.existing((0,a.default)(n)),n}(0,s.default)(e,t);var n=e.prototype;return n.createConfigs=function(){var t=1/this.scene.world.getPixelRatio();this.ribbonConfig={on:!1,visible:!1,timeScale:1.5,frame:lt.BLANK,particleBringToTop:!0,speedY:{min:-480,max:-560},gravityY:290,lifespan:{min:4e3,max:6e3},rotate:{start:0,end:1800,random:!0},scale:{min:.6*t,max:t},particleClass:rt},this.confettiConfig={on:!1,delay:200,timeScale:2,tint:[8443204,2928867,12013036,16376097,15285798],particleBringToTop:!0,frame:lt.PREFIX_ANIMATION_RIBBON_CONFETTI_A+"1",speedY:{min:-460,max:-580},gravityY:280,lifespan:{min:5e3,max:8e3},rotate:{start:0,end:1080},scale:{min:.6*t,max:t},particleClass:ot}},n.createAnimations=function(){if(!this.scene.anims.get(o.default.CONFETTI_STAR_X.KEY)){var t=new K(this.scene.anims);this.scene.anims.add(o.default.CONFETTI_STAR_X.KEY,t)}if(!this.scene.anims.get(o.default.CONFETTI_STAR_Y.KEY)){var e=new et(this.scene.anims);this.scene.anims.add(o.default.CONFETTI_STAR_Y.KEY,e)}if(!this.scene.anims.get(o.default.RIBBON_A.KEY)){var n=new g(this.scene.anims);this.scene.anims.add(o.default.RIBBON_A.KEY,n)}if(!this.scene.anims.get(o.default.RIBBON_B.KEY)){var i=new b(this.scene.anims);this.scene.anims.add(o.default.RIBBON_B.KEY,i)}if(!this.scene.anims.get(o.default.RIBBON_C.KEY)){var a=new R(this.scene.anims);this.scene.anims.add(o.default.RIBBON_C.KEY,a)}if(!this.scene.anims.get(o.default.RIBBON_D.KEY)){var s=new G(this.scene.anims);this.scene.anims.add(o.default.RIBBON_D.KEY,s)}},n.run=function(t,e,n,i){this.setPosition(t,e),this.width=n,this.height=i,this.createEmitters(),this.emitterConfetti.forEach((function(t){t.emitParticle(25)})),this.emitterRibbons.forEach((function(t){t.emitParticle(20)}))},n.stop=function(){this.emitterConfetti.forEach((function(t){t.killAll()})),this.emitterRibbons.forEach((function(t){t.killAll()})),this.kill()},n.createEmitters=function(){this.emitterRibbons=[],this.emitterConfetti=[],this.createConfettiLeftEmitter(),this.createConfettiRightEmitter(),this.createRibbonLeftEmitter(),this.createRibbonRightEmitter()},n.createConfettiLeftEmitter=function(){var t=(0,i.default)({},this.confettiConfig,{speedX:{min:5,max:90}}),e=this.createEmitter(t);this.emitterConfetti.push(e)},n.createConfettiRightEmitter=function(){var t=this.width,e=(0,i.default)({},this.confettiConfig,{x:t,speedX:{min:-5,max:-90}}),n=this.createEmitter(e);this.emitterConfetti.push(n)},n.createRibbonLeftEmitter=function(){var t=(0,i.default)({},this.ribbonConfig,{speedX:{min:20,max:80},emitCallback:function(t){t.setRibbonPosition(0,0)}}),e=this.createEmitter(t);this.emitterRibbons.push(e)},n.createRibbonRightEmitter=function(){var t=this.width,e=(0,i.default)({},this.ribbonConfig,{x:t,speedX:{min:-20,max:-80},emitCallback:function(e){e.setRibbonPosition(t,0)}}),n=this.createEmitter(e);this.emitterRibbons.push(n)},e}(Phaser.GameObjects.Particles.ParticleEmitterManager)},470:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(0),s=n(1).default.EFFECTS,r=s.KEY,o=s.FRAME,h=function(t){function e(e){var n;return(n=t.call(this,e,r,o.FX_STAR_YELLOW)||this).emitZone=void 0,n.emitter=void 0,n.createEmitZone(),n.scene.add.existing((0,i.default)(n)),n}(0,a.default)(e,t);var n=e.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var t=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({on:!1,frame:o.FX_STAR_YELLOW,emitZone:{source:this.emitZone,type:"random"},timeScale:1,frequency:500,alpha:{start:1,end:0,ease:Phaser.Math.Easing.Expo.Out},scale:{start:1*t,end:0,ease:Phaser.Math.Easing.Expo.Out},lifespan:{min:800,max:1500}})},n.run=function(t,e,n,i,a){this.stop(),this.reset(),this.emitZone.setSize(i,a),this.emitZone.setPosition(e-i/2,n-a/2),this.emitter.setQuantity(t),this.emitter.start()},n.stop=function(){var t,e;null==(t=this.emitter)||t.killAll(),null==(e=this.emitter)||e.stop()},n.reset=function(){this.createEmitters()},e}(Phaser.GameObjects.Particles.ParticleEmitterManager);e.default=h},143:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var i=n(0),a=n(30),s=n.n(a),r=n(52),o=function(t){function e(e,n,i){var a;return(a=t.call(this,e,0,0,n,i)||this).setOrigin(0,0),a}return(0,i.default)(e,t),e}(Phaser.GameObjects.Zone),h=n(246),c=n(39),l=function(t){function e(){var e;return(e=t.call(this,{visible:!1})||this).unsubscribeList=void 0,e.gameZone=void 0,e.background=void 0,e.handleOpenScene=function(){e.logPageviewOnOpen(),e.logEventOpen(),e.scaleGame()},e.removeStateChange=function(){e.unsubscribeList.forEach((function(t){return t()}))},e}(0,i.default)(e,t);var n=e.prototype;return n.create=function(){var t=this;this.events.on("wake",this.handleOpenScene),this.events.on("resume",this.handleOpenScene),this.events.on("create",this.handleOpenScene),this.createGameZone();var e=GameCore.Configs.Game;this.events.on(Phaser.Scenes.Events.UPDATE,(function(){e.AutoDropFps&&t.autoUpdateFPS()}))},n.scaleGame=function(){var t=this.getCamera("main"),e=this.world.getZoomRatio(),n=this.world.getWorldSize(),i=n.width,a=n.height;t.setZoom(e),t.centerOn(i/2,a/2)},n.createGameZone=function(){var t=this.world.getWorldSize(),e=t.width,n=t.height;this.gameZone=new o(this,e,n)},n.autoUpdateFPS=function(){this.allowUpdateFPS()&&(this.tweenPlaying()||this.particlePlaying()?this.game.updateFps(h.default.max):this.game.updateFps(h.default.min))},n.allowUpdateFPS=function(){return this.scene.key===c.SceneKeys.GAME_SCENE||this.scene.key===c.SceneKeys.JOURNEY_SCENE},n.tweenPlaying=function(){for(var t=this.tweens.getAllTweens(),e=0;e<t.length;e++)if(t[e].isPlaying())return!0;return!1},n.particlePlaying=function(){var t=this.getAllParticles();if(!t)return!0;var e=!1;return t.forEach((function(t){t.emitters.list.forEach((function(t){t.alive&&t.alive.length>0&&(e=!0)}))})),e},n.getAllParticles=function(){if(this.input.enabled&&this.scene.isActive()&&!this.scene.isPaused()){var t=this.children.list;return!t||t.length<=0?[]:s()(t).call(t,(function(t){return"ParticleEmitterManager"===t.type}))}},n.getCamera=function(t){return"main"===t?this.cameras.main:this.cameras.getCamera(t)},n.createMask=function(t){void 0===t&&(t=1),this.getCamera("main").setBackgroundColor("rgba(0, 0, 0, "+t+")")},n.fontSize=function(t){return t/2.4},n.createBackground=function(t,e,n,i){try{this.background?(this.background.setTexture(t),e&&this.background.setFrame(e)):this.background=this.make.image({key:t,frame:e}),this.background.setName(t);var a=this.gameZone,s=a.displayWidth,r=a.displayHeight;this.background.setDisplaySize(s,r),GameCore.Utils.Valid.isNumber(n)&&this.background.setAlpha(n),GameCore.Utils.Valid.isNumber(i)&&this.background.setTint(i),Phaser.Display.Align.In.Center(this.background,this.gameZone)}catch(o){}},n.handleStateChange=function(t){var e=this;this.unsubscribeList=[],t.forEach((function(t){var n=t.selector,i=t.callback,a=e.storage.watch(n,i);e.unsubscribeList.push(a)})),this.events.once("sleep",this.removeStateChange),this.events.once("destroy",this.removeStateChange),this.events.once("shutdown",this.removeStateChange)},n.logPageviewOnOpen=function(){this.analytics.pageview(this.scene.key)},n.logEventOpen=function(){this.analytics.event(r.AnalyticsEvents.SCREEN_OPEN,{screen_name:this.getSceneName()})},n.getSceneName=function(){return GameCore.Utils.String.toUpperCamelCase(this.scene.key.toLowerCase())},e}(Phaser.Scene)},531:function(t,e,n){"use strict";n.r(e);n(292);var i=n(161),a=n.n(i),s=n(48),r=n.n(s),o=function(t,e){return void 0===e&&(e=1),a()({length:Math.ceil(t.length/e)},(function(n,i){return r()(t).call(t,i*e,i*e+e)}))},h=n(30),c=n.n(h),l=n(141),u=n.n(l),d=function(t,e){return c()(t).call(t,(function(t){return!u()(e).call(e,t)}))},p=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}},f=n(31),g=n.n(f),m=function(t,e,n){return g()(n).call(n,t)===e&&null!==t&&void 0!==t},v=function(t){return c()(t).call(t,m)},y={chunk:o,difference:d,shuffle:p,unique:v},S=n(85),A=n.n(S),E=n(251),x=n.n(E),b=x()((function(t,e){if("string"===typeof t){var n=e[t.toLowerCase()];if("string"===typeof n)return n}return"?"})),T=x()((function(t){for(var e=null,n=[],i=/:([A-Z0-9?]+)/gm;null!==(e=i.exec(t));)n.push(e[1]);return n})),w=x()((function(t){for(var e=null,n=[],i=/([0-9]+[A-Z?]{1}|[A-Z?]{1})/gm;null!==(e=i.exec(t));){var a=e[0];if(a.length>=2){var s,o=a.length,h=r()(a).call(a,0,o-1),c=a[o-1],l=A()(s=new Array(+h)).call(s,c);n.push.apply(n,l)}else n.push(a)}return n})),M=function(t,e){var n=t,i=GameCore.Utils.Object.invert(e),a={},s=0,r=0;return T(n).forEach((function(t){s=0,r++,a[r]||(a[r]={}),w(t).forEach((function(t){s++,a[r][s]=b(t,i)}))})),a},C=x()((function(t,e){var n=e[t];return"string"===typeof n?""+n.toUpperCase():"?"})),P=function t(e,n,i){void 0===i&&(i=!1);var a="";if(!GameCore.Utils.Valid.isObject(e))return a;var s="",o=1;for(var h in e)if(GameCore.Utils.Object.hasOwn(e,h)){var c=e[h];if(GameCore.Utils.Valid.isObject(c))a+=":"+t(c,n,!0);else if(GameCore.Utils.Valid.isString(c)){var l=C(c,n);l===s?(o++,a=r()(a).call(a,0,-2)):o=1,a+=""+o+l,s=l}}return a=a.replace(/1([A-Z])/g,"$1")},I=function(t){try{return atob(t)}catch(e){return""}},k={decodeMap:M,encodeMap:P,hashToString:I,stringToHash:function(t){try{return btoa(t)}catch(e){return""}}},R=function(t){try{return JSON.parse(t)}catch(e){return null}},O=n(95),_=n.n(O),D=function(t){try{return _()(t,null,0)}catch(e){return""}},B=function(t){return R(D(t))},L={clone:B,decode:R,encode:D},F=function(t){var e="object"===typeof t||"function"===typeof t,n=Array.isArray(t);return null!==t&&e&&!n},N=function(t){return void 0===t||null===t},G=function t(e){if(!F(e))return e;for(var n in e){N(e[n])&&delete e[n];var i=e[n];F(i)&&(e[n]=t(i))}return e},U=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},V=n(32),Y=n.n(V),z=function(t){var e={};return Y()(t).forEach((function(n){if(U(t,n)){var i=t[n];"string"===typeof i&&(e[i]=n)}})),e},H=function(t,e){if(!Array.isArray(t))return{};var n={};return t.forEach((function(t){if(U(t,e)){var i=t[e];"string"===typeof i&&(n[i]=t)}})),n},W={clear:G,hasOwn:U,invert:z,keyBy:H},X=function(t){return t?t[0].toUpperCase()+r()(t).call(t,1):t},K=function(t){var e=0;if(0==t.length)return e;for(var n=0;n<t.length;n++){e=(e<<5)-e+t.charCodeAt(n),e&=e}return e},j=n(243),q=n.n(j),Z=function(t){var e;return q()(e=Y()(t)).call(e,(function(e,n){var i=t[n];return void 0!==i&&e.push(n+"="+i),e}),[]).join("&")},J=function(t){void 0===t&&(t="0x");for(var e=t,n=0;n<6;n++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},Q=function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789*#%&!",i="",a=t;void 0!=e&&(a-=e.length,i+=e);for(var s=0;s<a;s++){var r=Math.floor(Math.random()*n.length);i+=n.charAt(r)}return i},$=function(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[\u0111\u0110]/g,(function(t){return"\u0111"===t?"d":"D"}))},tt=n(25),et=n.n(tt),nt=n(322),it=n.n(nt),at=function(t,e){var n,i=t.split(" "),a=(i.length<=1?et()(n=[]).call(n,i):[i[0],i.pop()]).join(" "),s=it()(a).call(a," ")||0,r=s>=0?s:e;return(a.length>e?a.substring(0,r):a).substring(0,e)},st=n(341),rt=n.n(st),ot=function(t){void 0===t&&(t=16);var e=function(e){return Math.floor(e).toString(t)};return e(Date.now()/1e3)+rt()(" ").call(" ",t).replace(/./g,(function(){return e(Math.random()*t)}))},ht={capitalize:X,hashCode:K,params:Z,toCamelCase:function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}));return e.substr(0,1).toLowerCase()+e.substr(1)},toUpperCamelCase:function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}));return e.substr(0,1).toUpperCase()+e.substr(1)},randomColor:J,random:Q,removeDiacritics:$,getShortName:at,generateObjectId:ot},ct=function(t){return"boolean"===typeof t},lt=function(){return false},ut=function(t){return"function"===typeof t},dt=function(t){return"number"===typeof t},pt=function(t){var e;return g()(e=["string","number","symbol"]).call(e,typeof t)>-1},ft=function(t){return"string"===typeof t},gt=n(44),mt=n.n(gt),vt=function(t,e,n){var i=n||{},a=i.timeout,s=void 0===a?1e3:a,r=i.checkInterval,o=void 0===r?100:r;return new(mt())((function(n){var i=setInterval((function(){("function"===typeof t?t():t)===("function"===typeof e?e():e)&&(clearInterval(i),n(!0))}),o);s>0&&setTimeout((function(){clearInterval(i),n(!1)}),s)}))},yt=function(t){var e=t.scene,n=t.key,i=t.newKey,a=e.textures.get(n).getSourceImage();if(!a)return!1;var s=Math.min(a.width,a.height);i||e.textures.removeKey(n);var r=e.textures.createCanvas(i||n,s,s),o=r.context;return o.beginPath(),o.arc(s/2,s/2,s/2,0,2*Math.PI,!1),o.clip(),r.draw((a.width-s)/2,(a.height-s)/2,a),!0},St=function(t){var e=t.scene,n=t.key,i=t.newKey,a=t.radius,s=t.width,r=t.height,o=e.textures.get(n).getSourceImage();if(!o)return!1;s||(s=o.width),r||(r=o.height),i||e.textures.removeKey(n);var h=e.textures.createCanvas(i||n,s,r),c=h.context,l=Math.min(s,r)/100*a/2;return c.beginPath(),c.moveTo(0+l,0),c.lineTo(0+s-l,0),c.quadraticCurveTo(0+s,0,0+s,0+l),c.lineTo(0+s,0+r-l),c.quadraticCurveTo(0+s,0+r,0+s-l,0+r),c.lineTo(0+l,0+r),c.quadraticCurveTo(0,0+r,0,0+r-l),c.lineTo(0,0+l),c.quadraticCurveTo(0,0,0+l,0),c.closePath(),c.clip(),h.draw(0,0,o),!0},At=function(t){if(g()(t).call(t,".")<0)return t;for(var e=t.length-1;e>=0;e--){if("."==t[e])return t.substring(0,e);if("0"!=t[e])return t.substring(0,e+1)}return t},Et=function(t,e){var n=e||{},i=n.fractionalDigits,a=void 0===i?0:i,s=n.startAbbreviate,r=void 0===s?1e3:s,o=n.abbreviateStep,h=void 0===o?3:o,c=n.maxLength,l=void 0===c?-1:c,u=n.removeLastZero,d=void 0===u||u,p=n.suffixes,f=void 0===p?["","k","m","b","t","q"]:p,g=-1===l?99999999:l;if(t>=r){var m=Math.floor(t/Math.pow(10,h)),v=Math.floor((m.toString().length-1)/h)+1,y=(t/Math.pow(Math.pow(10,h),v)).toFixed(a),S=g-f[v].length,A=y.substring(0,S);return(d?At(A):A)+f[v]}var E=t.toFixed(a),x=g-f[0].length,b=E.substring(0,x);return d?At(b):b+f[0]},xt=function(t,e,n){void 0===n&&(n="0");for(var i=t.toString(),a=0;a<e-i.length;a++)i=n+i;return i},bt=function(t,e,n){void 0===n&&(n="0");for(var i=t.toString(),a=0;a<e-i.length;a++)i+=n;return i},Tt={Array:y,Hash:k,Json:L,Object:W,String:ht,Valid:{isBoolean:ct,isDebugger:lt,isFunction:ut,isNumber:dt,isObject:F,isPropertyKey:pt,isString:ft,isValueChangeAsync:vt},Image:{drawCircle:yt,drawBorder:St},Number:{toAbbreviatedString:Et,padStart:xt,padEnd:bt},Device:{isDesktop:function(){var t=navigator.userAgent;return/Windows|Mac OS/i.test(t)},isMobile:function(){var t=navigator.userAgent;return/Android|iP[ao]d|iPhone/i.test(t)},isAndroid:function(){return"ANDROID"===FBInstant.getPlatform()},isIOS:function(){return"IOS"===FBInstant.getPlatform()},isMobileWeb:function(){return"MOBILE_WEB"===FBInstant.getPlatform()},pixelRatio:function(){return Math.round(window.devicePixelRatio)||1}}},wt=n(10),Mt=n(118),Ct={AppId:"1012305065987428",ApiHost:"https://fbig-singleplay-apps.citigo.site",OtherHost:"https://fbig-leaderboards.citigo.site",PlayerDataStoreUsingApi:!1,LeadersBoard:{LeaderboardId:"61a0bde67c386b3ef39de708",UseMock:!1,Limit:10},Ads:{Enabled:!0,Mockup:{Enable:!1},InterstitialAdOptions:{showWhenStartGame:!1,secondsFirstTime:0,secondsBetweenAds:60},BannerAdOptions:[]},Match:{MaxRescueCount:0}},Pt={ENV:"production",LeadersBoard:{Prefix:"leaderboards"},Debugger:{ShowConsole:!1,ShowInspector:!1,ShowMonitoring:!1},Statistics:{Enable:!1,ShowFPSInGame:!1,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1}},It={ENV:"development",AppId:"405221927720733",ApiHost:"https://fbig-singleplay-apps-dev.sunstudio.io",OtherHost:"https://leaderboards-dev.sunstudio.io",PlayerDataStoreUsingApi:!0,PlayerMock:{id:"",signature:""},OpponentMock:{id:"",signature:""},MatchMockFailRate:5,Gameplay:{StartLevel:1,StartScore:0,StartDiamonds:0,DefaultDiamondsForNewUser:300,LevelDifficultRate:{FromUnder30:1.07,FromUnder35:1.05,FromUnder45:1.05,FromUnder200:1.1},StartAdAtLevel:2,GiftTime:10800,AwardDiamonds:100,FreeItems:!1,DelayStart:2e3,DelayLevelUp:1800,DelayFinishGame:500,EnableVibrate:!0,VibrateValue:[0,0,119,199,279,359,439],Progress:{BonusScore:5e3,Milestone:3},MaxGemInPiece:2,RatePieceContainGem:10},Tutorial:{ForceUseTutorial:!1,NumberOfTutorial:{FirstMove:3,TargetScore:1,CurrentScore:1,ColorfulGem:1,ItemPaint:1,ItemHammer:1,ItemShuffle:1}},PlayerDataStore:"playerData",Game:{ForcePixelRatio:0,AutoDropFps:!1},Debugger:{ShowInspector:!0,ShowMonitoring:!0,ShowConsole:!1,Expanded:!0,AutoRefresh:!0,InspectorAutoUpdate:!0,Opacity:.8},Statistics:{Enable:!1,DisplayMode:0,FPS:!0,MS:!0,MB:!0,Opacity:.8,ShowFPSInGame:!0,ShowMemoryInGame:!1},ParticleEditor:{Enable:!1,Opacity:.8,Expanded:!0},Match:{MaxRescueCount:1,RescueGamePopupTimeout:10,DelayNoThank:1e3,ContinueSingleMatchEnabled:!1,SingleMatchStore:"singleMatch",JourneyMatchStore:"journeyMatch",LivesStore:"lives",LocalSingleMatchDefault:{_id:"12345678890",status:"open",playerId:"",score:0,level:1,startedAt:0,updateAt:0,finishAt:0,data:{}},Levels:[100,500,1e3,1500,2e3,3e3,4e3,5e3,6e3,7500,9e3,11500,13e3,15e3,17e3,19e3,21e3,23e3,25e3,1e5],PieceRandoms:{maxPiece:200,measureError:.5}},DailyRewards:{MaxDays:6,MockTime:0,CheckInterrupt:!0},DailyTasks:{Duration:86400},Tournament:{UseMock:!1,ForcePlay:!1,UseLeaderboard:!1,TournamentContextIds:[]},LeadersBoard:{Name:null,UseMock:!1,Prefix:"leaderboards",LeaderboardId:"61811128f28777ad0ed05787",Limit:50},LanguageSupport:{en:"en"},EnableEffectSceneTransition:!0,DefaultTheme:"default",ThemeSupport:{default:"default"},Ads:{Enabled:!0,InterstitialPlacementId:"",VideoRewardsPlacementId:"",BannerPlacementId:"",BannerReloadPeriod:60,Mockup:{Enable:!1,ErrorRate:5,GiphyApiKey:""},InterstitialAdOptions:{showWhenStartGame:!1,secondsFirstTime:90,secondsBetweenAds:180},BannerAdOptions:[]},Network:{MaximumRequest:6,Timeout:15e3,Retries:3},Analytics:{GameAnalytics:{key:"",secret:"",consoleLog:!1},GoogleAnalytics:{consoleLog:!1},FacebookAnalytics:{prefix:"fba",consoleLog:!1}},MagnetItem:{key:"magnet-item",scoreForOnePercent:4,maxMagnetPerMatch:5},Board:{cols:9,rows:9},Sentry:{errorCodes:{accepted:[],ignored:["USER_INPUT","NETWORK_FAILURE"]},errorMessages:{accepted:[],ignored:["Load image failed"]}},Lives:{bonusDurationMins:5,bonusLife:1,livesCapacity:10},Performance:{Enable:!1,trackingSceneKeys:["DASHBOARD_SCENE","GAME_SCENE"],minQuality:1,maxQuality:2,fpsThreshold:48,checkInterval:2e3,qualityAdjustStep:.1,autoUpgradeQuality:!0,onlyUpdateWhenSwitchScene:!0}};It=(0,Mt.merge)((0,wt.default)({},It),Pt);var kt=It=(0,Mt.merge)((0,wt.default)({},It),Ct),Rt=function(t){return function(e){try{var n=window.game,i=e.module;if(n.scene.getScenes(!0)[0].scene.key!==t)return;var a=i.default;n.scene.remove(t),n.scene.add(t,a,!0),n.scene.bringToTop(n.globalScene)}catch(r){var s;null==(s=void 0)||s.invalidate()}}},Ot=n(537),_t=n.n(Ot),Dt=n(539),Bt=n.n(Dt),Lt=n(541),Ft=n.n(Lt),Nt=n(440),Gt=!1,Ut=function t(e,n,i){n.forEach((function(n){if(n.name){var a=null;if(a=i?i.getByName(n.name):e.children.getByName(n.name)){if("Container"===n.type){var s=a,r=n.getAll();if(t(e,r,s),!s.hotContainer)return}var o=_t()(n),h=["_events","_sysEvents","input","localTransform","list","displayList"],l=c()(o).call(o,(function(t){if("string"!==typeof t)return!1;if(g()(h).call(h,t)>=0)return!1;if(!a)return!1;var e=Bt()(n,t);return!(e instanceof Function)&&(!(e instanceof Phaser.Scene)&&(!(e instanceof Phaser.GameObjects.Group)&&(!(e instanceof Phaser.GameObjects.GameObject)&&e===Bt()(a,t))))}));l.length<1||l.forEach((function(t){if(a){var e=Bt()(n,t);Bt()(a,t),Ft()(a,t,e)}}))}}}))},Vt=function(t,e){return void 0===e&&(e=Gt),function(n){try{var i=window.game,a=n.module,s=i.scene.getScenes(!0)[0];if(s.scene.key!==t)return;Gt=e;var r=a.default,o=t+"-draft";i.scene.remove(o);var h=i.scene.add(o,r);s=i.scene.getScene(t),h.events.once(Phaser.Scenes.Events.RENDER,(0,Nt.debounce)((function(){var t=h.children.getAll();Ut(s,t),i.scene.remove(o)})),50),i.scene.run(o),i.scene.bringToTop(s),i.scene.bringToTop(i.globalScene)}catch(c){}}},Yt={Configs:kt,Utils:Tt,LiveUpdate:{Scene:Rt,SceneObjects:Vt}};window.GameCore=Yt;var zt=Yt,Ht=n(28),Wt=n(323),Xt=n(9),Kt=n(0),jt=n(8),qt=n.n(jt),Zt=n(443),Jt=function(){function t(t){this.game=void 0,this.game=t}var e=t.prototype;return e.addKillRevive=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Group,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Particles.ParticleEmitter,Phaser.GameObjects.Particles.ParticleEmitterManager].forEach((function(e){e.prototype.kill=t.kill,e.prototype.revive=t.revive}))},e.addSetWorldSize=function(){var t=this;[Phaser.GameObjects.Image,Phaser.GameObjects.Sprite].forEach((function(e){e.prototype.setWorldSize=t.setWorldSize}))},e.addSetWorldSizeForContainer=function(){var t=this;[Phaser.GameObjects.Container].forEach((function(e){e.prototype.setWorldSize=t.setWorldSizeForContainer}))},e.addGetWorldPosition=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText].forEach((function(e){e.prototype.getWorldPosition=t.getWorldPosition}))},e.addDrawDebugBox=function(){var t=this;[Phaser.GameObjects.Container,Phaser.GameObjects.Image,Phaser.GameObjects.Sprite,Phaser.GameObjects.Graphics,Phaser.GameObjects.Text,Phaser.GameObjects.BitmapText,Phaser.GameObjects.Zone].forEach((function(e){e.prototype.drawDebugBox=t.drawDebugBox}))},e.addHighQuality=function(){var t=this;[Phaser.GameObjects.Text].forEach((function(e){e.prototype.setHighQuality=t.setHighQuality}))},e.kill=function(){this.setActive(!1),this.setVisible(!1)},e.revive=function(){this.setActive(!0),this.setVisible(!0)},e.setWorldSize=function(t,e){this.setSize(t,e),this.setDisplaySize(t,e)},e.setWorldSizeForContainer=function(t,e,n){void 0===n&&(n=2),this.setSize(t*n,e*n),this.setDisplaySize(t,e)},e.getWorldPosition=function(){var t=this.getWorldTransformMatrix().decomposeMatrix();return{x:t.translateX,y:t.translateY}},e.drawDebugBox=function(t,e){var n=this.x,i=this.y,a=this.width,s=this.height,r=this.depth,o=this.originX,h=this.originY,c=this.scene.add.rectangle(n,i,a,s,t,e);c.setName("Debug Box"),c.setDepth(r);var l=GameCore.Utils.Valid.isNumber;return l(o)&&l(h)&&c.setOrigin(o,h),c},e.setHighQuality=function(){return this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer?this.setResolution(2*this.scene.game.world.getZoomRatio()):this},t}(),Qt=Jt,$t=GameCore.Configs.Ads.Mockup.GiphyApiKey,te=function(){function t(){}return t.loadBannerAdAsync=function(t,e){var n=this;return new(mt())((function(i,a){window.yaContextCb=window.yaContextCb||[];var s=document.getElementById("yandexAdContextScript");s||((s=document.createElement("script")).src="https://yandex.ru/ads/system/context.js",s.async=!0,document.head.appendChild(s));var r="yandex_rtb_wrapper_"+t,o="yandex_rtb_"+t,h=document.getElementById(r);if(!h){(h=document.createElement("div")).id=r,document.body.appendChild(h),h.style.display="block",h.style.position="fixed",h.style.zIndex="10000";var c=document.createElement("div");c.id=o,c.classList.add("yandex-adaptive"),c.style.display="block",h.appendChild(c)}n.setBannerAdSize(t,e||{}),n.getAdContentAsync().then((function(t){var e=document.getElementById("mock-banner-ads");e||((e=document.createElement("img")).id="mock-banner-ads",e.style.cssText="height: 100%; width: 100%; background-color: white; position: absolute;",h.childNodes[0].appendChild(e)),e.src=t,i()})).catch(a)}))},t.setBannerAdSize=function(t,e){var n=e||{},i=n.bannerHeight,a=void 0===i?50:i,s=n.bannerWidth,r=void 0===s?320:s,o="yandex_rtb_wrapper_"+t,h="yandex_rtb_"+t,c=document.getElementById(o),l=document.getElementById(h);if(c&&l){var u=document.body,d=(u.clientHeight,u.clientWidth);c.style.top="",c.style.bottom="0px",c.style.left=(d-r)/2+"px",c.style.margin="auto",c.style.height=a+"px",c.style.width=r+"px",l.style.height=a+"px",l.style.width=r+"px"}},t.hideBannerAdAsync=function(){return new(mt())((function(t){document.querySelectorAll('div[id^="yandex_rtb_wrapper_"]').forEach((function(t){var e=t;e.style.bottom="",e.style.top="-"+e.style.height})),t()}))},t.getAdContentAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://api.giphy.com/v1/gifs/random?api_key="+$t+"&rate=pg",t.next=3,fetch(n,{method:"GET"});case 3:return i=t.sent,t.next=6,i.json();case 6:if(a=t.sent,GameCore.Utils.Valid.isObject(a)){t.next=9;break}return t.abrupt("return","");case 9:return t.abrupt("return",null===(e=a.data)||void 0===e?void 0:e.images.downsized.url);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t}();te.bannerAdOptions={};var ee,ne={LOADED:"loaded",DISPLAYED:"displayed"};!function(t){t.IDLE="idle",t.LOADING="loading",t.FILLED="filled",t.SHOWING="showing"}(ee||(ee={}));var ie,ae=ee;!function(t){t.REWARDED="rewarded",t.INTERSTITIAL="interstitial"}(ie||(ie={}));var se=ie,re=n(41),oe=function(t){function e(e,n){var i;return(i=t.call(this,n)||this).code=void 0,i.code=e,i.message=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),he=oe,ce=function(t){this.type=void 0,this.status=void 0,this.type=t,this.status=ae.IDLE};GameCore.Ads={Types:se,Status:ae,Events:ne,AdError:he,AdInstance:ce};var le=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).events=void 0,n.enabled=void 0,n.config=void 0,n.lastAdShownTime=void 0,n.intervalBannerAd=void 0,n.interstitial=void 0,n.rewardedVideo=void 0,n.reloadBannerAdIntervals=void 0,n.bannerAdSizeOptions=void 0,n.showingBannerAd={},n.updateSizeBannerAd=function(){try{var t=n.config.bannerAdOptions,e=n.getCorrectBannerAdSizeOption(n.bannerAdSizeOptions);t.forEach((function(t){n.showingBannerAd[t.placementId]&&(GameCore.Configs.Ads.Mockup.Enable?te.setBannerAdSize(t.placementId,e):GameSDK.setBannerAdSize(t.placementId,e))}))}catch(i){}},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.events=new Phaser.Events.EventEmitter,this.lastAdShownTime=0,this.addEventUpdateSizeBannerAd()},n.configure=function(t,e){this.enabled=e.enabled,this.config=e,this.setAdInstance(t)},n.setAdInstance=function(t){var e=this.config,n=e.interstitialPID,i=e.rewardedVideoPID;this.interstitial=new t(se.INTERSTITIAL,n),this.rewardedVideo=new t(se.REWARDED,i)},n.preloadInterstitialAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.preloadAdAsync(se.INTERSTITIAL);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.showInterstitialAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.canbeShowInterstitialAd()){t.next=2;break}throw new he("INTERSTITIAL_AD_CAN_NOT_SHOW","Can't show interstitial ad");case 2:return t.next=4,this.showAdAsync(se.INTERSTITIAL);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.preloadRewardedVideoAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.preloadAdAsync(se.REWARDED);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.showRewardedVideoAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showAdAsync(se.REWARDED);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.preloadAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.enabled){t.next=2;break}throw new he("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(e))){t.next=5;break}throw new he("AD_INSTANCE_NOT_INITIALTED","The instance ads not yet initiated");case 5:return t.next=7,n.loadAsync();case 7:this.events.emit(ne.LOADED,e);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.showAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.enabled){t.next=2;break}throw new he("ADS_NOT_ENABLED","Ads is't enabled");case 2:if(null!==(n=this.getAdInstanceByType(e))){t.next=5;break}throw new he("AD_INSTANCE_NOT_INITIALTED","The instance ads not yet initiated");case 5:return this.lastAdShownTime=window.performance.now()/1e3,t.next=8,n.showAsync();case 8:this.events.emit(ne.DISPLAYED,e);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getAdStatus=function(t){var e=this.getAdInstanceByType(t);return e?e.getStatus():null},n.getAdInstanceByType=function(t){switch(t){case se.INTERSTITIAL:return this.interstitial;case se.REWARDED:return this.rewardedVideo;default:return null}},n.canbeShowInterstitialAd=function(){return this.canbeShowInterstitialAdByTime()},n.canbeShowInterstitialAdByTime=function(){var t=window.performance.now()/1e3,e=this.config.interstitialAdOptions,n=e.secondsFirstTime,i=e.secondsBetweenAds,a=t-this.lastAdShownTime;return this.lastAdShownTime>0?a>i:a>n},n.showBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.reloadBannerAdIntervals=this.reloadBannerAdIntervals||{},n=this.config.bannerAdOptions,i=GameSDK.getPlatform(),a="WEB"==i,window.addEventListener,n.forEach((function(t){var n=t.platform;if("ALL"==n||"DESKTOP"==n&&a||"MOBILE"==n&&!a){s.bannerAdSizeOptions=e||{};var i=t.placementId,r=t.secondsReload;if(i&&""!=i){if(r>0){if(s.reloadBannerAdIntervals[i])return;return s.loadBannerAdAsync(i),void(s.reloadBannerAdIntervals[i]=setInterval((function(){s.loadBannerAdAsync(i)}),1e3*r))}s.loadBannerAdAsync(i)}}})),t.abrupt("return");case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getCorrectBannerAdSizeOption=function(t){var e=this.game.canvas.offsetWidth,n=t||{},i=n.bannerWidth,a=void 0===i?0:i,s=n.bannerHeight,r=void 0===s?0:s;if(this.game.world){var o=this.game.world,h=o.getZoomRatio(),c=o.getPixelRatio();a=a?o.getPhysicPixels(a,h/c):e,r=r?o.getPhysicPixels(r,h/c):50}return{bannerWidth:a,bannerHeight:r}},n.loadBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=GameCore.Configs.Ads,i=this.getCorrectBannerAdSizeOption(this.bannerAdSizeOptions),!n.Mockup.Enable){t.next=8;break}return t.next=6,te.loadBannerAdAsync(e,i);case 6:t.next=10;break;case 8:return t.next=10,GameSDK.loadBannerAdAsync(e,i);case 10:this.showingBannerAd[e]=!0,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));return function(e){return t.apply(this,arguments)}}(),n.addEventUpdateSizeBannerAd=function(){window.addEventListener("resize",this.updateSizeBannerAd)},n.hideBannerAdAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.config.bannerAdOptions.forEach((function(t){var n=t.placementId,i=e.reloadBannerAdIntervals[n];i&&(clearInterval(i),e.reloadBannerAdIntervals[n]=null),e.showingBannerAd[n]=!1})),t.prev=2,!GameCore.Configs.Ads.Mockup.Enable){t.next=9;break}return t.next=7,te.hideBannerAdAsync();case 7:t.next=11;break;case 9:return t.next=11,GameSDK.hideBannerAdAsync();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2);case 16:case"end":return t.stop()}}),t,this,[[2,13]])})));return function(){return t.apply(this,arguments)}}(),n.getBannerHeight=function(){var t=this.getCorrectBannerAdSizeOption(this.bannerAdSizeOptions);if(this.game.world){var e=this.game.world,n=e.getZoomRatio(),i=e.getPixelRatio();return this.game.world.getPhysicPixels(t.bannerHeight,i/n)}return 50},e}(Phaser.Plugins.BasePlugin),ue=le,de=function(){function t(t,e,n){this.name=void 0,this.color=void 0,this.selfLog=void 0,this.options=void 0,this.name=t,this.color=n||"#FFF",this.options=e,this.selfLog=!0}var e=t.prototype;return e.event=function(t,e,n){this.processEvent(t,e,n),this.selfLog},e.pageview=function(t){var e=this.getPageByKey(t);this.processPageView(e),this.selfLog},e.setTrafficSource=function(t){this.processTrafficSource(t),this.selfLog},e.levelStart=function(t,e,n){this.processLevelStart(t,e,n),this.selfLog},e.levelFail=function(t,e,n){this.processLevelFail(t,e,n),this.selfLog},e.levelRescue=function(t,e,n){this.processLevelRescue(t,e,n),this.selfLog},e.levelComplete=function(t,e,n){this.processLevelComplete(t,e,n),this.selfLog},e.showInterstitialAd=function(t){this.processShowInterstitialAd(t),this.selfLog},e.showRewardedVideoAd=function(t){this.processShowRewardedVideoAd(t),this.selfLog},e.receiveReward=function(t){this.processReceiveReward(t),this.selfLog},e.showAdFail=function(t,e,n){this.processShowAdFail(t,e,n),this.selfLog},e.getPageByKey=function(t){var e=t.replace(/_/g,"-");return e=e.toLowerCase()},e.processLevelStart=function(t,e,n){},e.processLevelFail=function(t,e,n){},e.processLevelRescue=function(t,e,n){},e.processLevelComplete=function(t,e,n){},e.processShowInterstitialAd=function(t){},e.processShowRewardedVideoAd=function(t){},e.processReceiveReward=function(t){},e.processShowAdFail=function(t,e,n){},t}();GameCore.Analytics={BaseAnalytics:de};var pe=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).analytics=void 0,n.pageview=function(t){n.isActive()&&n.analytics.forEach((function(e){e.pageview(t)}))},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.analytics=[]},n.add=function(t){this.analytics.push(t)},n.setTrafficSource=function(t){this.isActive()&&this.analytics.forEach((function(e){e.setTrafficSource(t)}))},n.event=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.event(t,e,n)}))},n.levelStart=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelStart(t,e,n)}))},n.levelRescue=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelRescue(t,e,n)}))},n.levelFail=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelFail(t,e,n)}))},n.levelComplete=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.levelComplete(t,e,n)}))},n.showInterstitialAd=function(t){this.isActive()&&this.analytics.forEach((function(e){e.showInterstitialAd(t)}))},n.showRewardedVideoAd=function(t){this.isActive()&&this.analytics.forEach((function(e){e.showRewardedVideoAd(t)}))},n.receiveReward=function(t){this.isActive()&&this.analytics.forEach((function(e){e.receiveReward(t)}))},n.showAdFail=function(t,e,n){this.isActive()&&this.analytics.forEach((function(i){i.showAdFail(t,e,n)}))},n.isActive=function(){return this.analytics.length>=1},e}(Phaser.Plugins.BasePlugin),fe=pe,ge=function(){function t(t,e,n){var i=this;this.name=void 0,this.game=void 0,this.isSprite=void 0,this.audio=void 0,this.markers=void 0,this.volume=void 0,this.isMusicEnabled=function(){return!!i.game.player.getPlayerSetting("music")},this.isSoundEnabled=function(){return!!i.game.player.getPlayerSetting("sound")},this.name=e,this.game=t,this.markers={},this.isSprite=n,this.isSprite||(this.audio=this.game.sound.add(this.name))}var e=t.prototype;return e.play=function(t,e){var n,i,a,s=(0,wt.default)({volume:this.volume},e||{});if(s.volume!==this.volume&&(s.volume*=this.volume),!this.isSprite)return(null==(i=this.audio)?void 0:i.seek)>0?void this.audio.resume():void(null==(a=this.audio)||a.play(t,s));this.createMaker(t),null==(n=this.markers[t])||n.play(t,s)},e.pause=function(t){var e,n;this.isSprite?null==(e=this.markers[t])||e.pause():null==(n=this.audio)||n.pause()},e.stop=function(t){var e,n;this.isSprite?null==(e=this.markers[t])||e.stop():null==(n=this.audio)||n.stop()},e.setVolume=function(t){this.volume=t},e.createMaker=function(t){if(!this.markers[t])try{this.markers[t]=this.game.sound.addAudioSprite(this.name)}catch(e){}},t}(),me=ge,ve=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).soundManager=void 0,n.musicManager=void 0,n.isMuteAll=void 0,n.initMusic=function(t){n.musicManager=new me(n.game,t,!1),n.setMusicVolume(n.isMuteAll?0:1)},n.initSound=function(t){n.soundManager=new me(n.game,t,!0),n.setSoundVolume(n.isMuteAll?0:1)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.playSound=function(t,e){try{if(!this.soundManager||this.isMuteAll)return;if(!this.soundManager.isSoundEnabled())return;this.soundManager.play(t,e)}catch(n){}},n.stopSound=function(t){try{this.soundManager.stop(t)}catch(e){}},n.playMusic=function(t){void 0===t&&(t={});try{if(!this.musicManager||this.isMuteAll)return;if(!this.musicManager.isMusicEnabled())return;this.musicManager.play("",(0,wt.default)({loop:!0,volume:.2},t))}catch(e){}},n.pauseMusic=function(){try{if(!this.musicManager)return;this.musicManager.pause("")}catch(t){}},n.stopMusic=function(){try{if(!this.musicManager)return;this.musicManager.stop("")}catch(t){}},n.setSoundVolume=function(t){try{if(!this.soundManager)return;this.soundManager.setVolume(t)}catch(e){}},n.setMusicVolume=function(t){try{if(!this.musicManager)return;this.musicManager.setVolume(t)}catch(e){}},n.muteAll=function(){this.isMuteAll=!0,this.setMusicVolume(0),this.setSoundVolume(0)},n.unmuteAll=function(t){void 0===t&&(t=1),this.isMuteAll=!1,this.setMusicVolume(t),this.setSoundVolume(t)},e}(Phaser.Plugins.BasePlugin),ye=ve,Se=n(109),Ae="AUTH_TOKEN_REQUEST",Ee="AUTH_TOKEN_RECEIVED",xe=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.name="RequestTokenFail",i.message=e||"Request token fail",i.payload=n||{},i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),be=n(61),Te=(0,be.createSelector)([function(t){return t.auth.token}],(function(t){return t})),we=(0,be.createSelector)([function(t){return t.auth.isRequesting}],(function(t){return t})),Me=function(t){return{type:Ee,payload:{token:t}}},Ce=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.requestToken=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game.facebook,a=n(),s=Te(a),!we(a)&&""===s){t.next=7;break}return t.abrupt("return");case 7:return e({type:Ae,payload:{}}),t.next=10,i.getPlayerToken();case 10:r=t.sent,e(Me(r)),t.next=25;break;case 14:if(t.prev=14,t.t0=t.catch(0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=19;break}if("PENDING_REQUEST"!==t.t0.code){t.next=19;break}return t.abrupt("return");case 19:if(e(Me("")),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"message"))){t.next=24;break}if("string"!==typeof t.t0.message){t.next=24;break}return(0,Ht.sendException)(new Error(t.t0.message)),t.abrupt("return");case 24:(0,Ht.sendException)(new xe);case 25:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.getToken=function(){return Te(this.state)},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),Pe=Ce,Ie=function(t,e){void 0===e&&(e=1);var n=new Image;n.onload=function(){var t,n;t=this.width*e,n=this.height*e,Math.floor(n/2),Math.floor(t/2)},n.src=t},ke=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).width=void 0,n.height=void 0,n.renderOptions=void 0,n.canvas=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(t){var e=this,n=Y()(t);n.length<1||(n.forEach((function(n){e.scene.load.image(n,t[n])})),this.scene.load.start())},n.capture=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.width,i=e.height,a=e.renderOptions,this.width=n,this.height=i,this.renderOptions=a,this.createCanvas(),t.next=8,this.loadImages();case 8:return this.drawObjects(),t.abrupt("return",this.snapshotFrame());case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.createCanvas=function(){this.canvas||(this.canvas=this.game.textures.createCanvas("FrameCaptureCanvas")),this.canvas.clear(),this.canvas.setSize(this.width,this.height)},n.loadImages=function(){var t=this;return new(mt())((function(e,n){for(var i in t.renderOptions){var a=t.renderOptions[i],s=a.name,r=a.image;if(r)t.scene.textures.get(s).key!==s&&t.scene.load.image(s,r)}t.scene.load.on(Phaser.Loader.Events.COMPLETE,e),t.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(){var t=new Error("Load image failed");n(t)})),t.scene.load.start()}))},n.drawObjects=function(){for(var t in this.renderOptions){var e=this.renderOptions[t];switch(e.type){case"text":this.drawText(e);break;case"image":this.drawImage(e)}}},n.drawText=function(t){var e=this.canvas.context,n=t.x,i=t.y,a=t.font,s=t.text,r=t.fillStyle,o=t.lineWidth,h=t.textAlign;e.font=a+' nunito,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif',e.fillStyle=r||"#ffffff",o&&(e.lineWidth=o),h&&(e.textAlign=h),e.fillText(s,n,i)},n.drawImage=function(t){var e=this.canvas.context,n=t.x,i=t.y,a=t.name,s=t.frame,r=t.width,o=t.height,h=t.fallbackWithImage,c=this.scene.textures.get(a),l=c.getSourceImage(s);"__MISSING"===c.key&&h&&(l=(c=this.scene.textures.get(h)).getSourceImage()),e.drawImage(l,n,i,r,o)},n.snapshotFrame=function(){var t=this.canvas.getCanvas().toDataURL("image/jpeg",.85);return GameCore.Utils.Valid.isDebugger()&&Ie(t),t},e}(Phaser.Plugins.ScenePlugin),Re=ke,Oe={sound:!0,music:!0,vibrate:!0,language:"en",theme:GameCore.Configs.DefaultTheme},_e=n(45),De=n.n(_e),Be=function(t){try{var e=localStorage.getItem(t);return null===e?null:GameCore.Utils.Json.decode(e)}catch(n){return null}},Le=function(t,e){try{var n=Be(t),i={};GameCore.Utils.Valid.isObject(n)&&(i=n);var a=GameCore.Utils.Json.clone(e);if(!GameCore.Utils.Valid.isObject(a))return!1;var s=GameCore.Utils.Object.clear(a),r=(0,Mt.merge)(i,s),o=GameCore.Utils.Json.encode(r);return localStorage.setItem(t,o),!0}catch(h){return!1}},Fe=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="BadRequest",i.message=e||"This request is bad",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ne=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="RequestTimeout",i.message=e||"This request is timeout",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ge=n(142),Ue=GameCore.Configs,Ve=Ue.AppId,Ye=Ue.Network,ze=function(t){if(!t.ok)throw new Fe(null,{response:t})},He=function(){var t=window.game.auth.getToken();return{token:t,timeout:Ye.Timeout,headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}}},We=function(t,e,n,i){return(0,Xt.default)(qt().mark((function a(){var s,r,o,h,c;return qt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s=t+"/apps/"+Ve+"/"+e,r=new AbortController,n.signal=r.signal,o=setTimeout((function(){r.abort()}),n.timeout),GameCore.Utils.Valid.isObject(i)&&(n.body=_()(i)),a.next=8,fetch(s,n);case 8:return h=a.sent,clearTimeout(o),ze(h),a.next=13,h.json();case 13:if(a.t0=a.sent,a.t0){a.next=16;break}a.t0={};case 16:return c=a.t0,a.abrupt("return",c);case 20:if(a.prev=20,a.t1=a.catch(0),!(a.t1 instanceof Fe)){a.next=24;break}return a.abrupt("return",null);case 24:if(!(a.t1 instanceof Object&&GameCore.Utils.Object.hasOwn(a.t1,"name"))){a.next=27;break}if("AbortError"!==a.t1.name){a.next=27;break}throw new Ne(null);case 27:throw a.t1;case 28:case"end":return a.stop()}}),a,null,[[0,20]])})))},Xe=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",e());case 4:if(t.prev=4,t.t0=t.catch(0),!(t.t0 instanceof Ne&&n>0)){t.next=18;break}return t.prev=7,t.next=10,(0,Ge.sleepAsync)(600);case 10:return t.next=12,Xe(e,n-1);case 12:return t.abrupt("return",t.sent);case 15:return t.prev=15,t.t1=t.catch(7),t.abrupt("return",{});case 18:if(!(t.t0 instanceof Ne)){t.next=20;break}return t.abrupt("return",{});case 20:return t.abrupt("return",{});case 22:case"end":return t.stop()}}),t,null,[[0,4],[7,15]])})));return function(e,n){return t.apply(this,arguments)}}(),Ke=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n={}),void 0===a&&(a=Ye.Retries),t.prev=2,s=(0,wt.default)({},He(),n,{method:"GET"}),r=We(i,e,s),t.next=7,Xe(r,a);case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",{});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,i,a){return t.apply(this,arguments)}}(),je=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a,s){var r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===i&&(i={}),void 0===s&&(s=Ye.Retries),t.prev=2,r=(0,wt.default)({},He(),i,{method:"POST"}),o=We(a,e,r,n),t.next=7,Xe(o,s);case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",{});case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,n,i,a,s){return t.apply(this,arguments)}}(),qe={score:0,settings:(0,wt.default)({},Oe),userGuideDisplays:0,customFields:{diamond:300,lastReceiveGift:0}},Ze=GameCore.Configs,Je=Ze.ApiHost,Qe=Ze.PlayerDataStoreUsingApi,$e=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe){t.next=2;break}return t.abrupt("return",tn(e));case 2:return t.abrupt("return",en(e));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tn=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=GameCore.Utils.String.params(e),t.next=3,Ke("players?"+n,{},Je);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),en=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.setDataAsync(e);case 2:return i=et()(n=Y()(qe)).call(n,Y()(e)),a=c()(i).call(i,(function(t,e){return g()(i).call(i,t)===e})),t.next=6,GameSDK.player.getDataAsync(a);case 6:return s=t.sent,t.next=9,GameSDK.player.getStatsAsync();case 9:return r=t.sent,t.abrupt("return",(0,wt.default)({},s,r));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),nn=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Qe){t.next=2;break}return t.abrupt("return",an(e));case 2:return t.abrupt("return",sn());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),an=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("players/"+e+"/user-guide-displays/inc",{},{},Je);case 2:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),sn=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.incrementStatsAsync({userGuideDisplays:1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),rn="PLAYER_RECEIVED",on="PLAYER_DATA_UPDATE",hn="PLAYER_SCORE_UPDATE",cn="PLAYER_SETTING_UPDATE",ln="PLAYER_CONNECTED_PLAYERS_UPDATE",un=n(252),dn=Oe.sound,pn=Oe.music,fn=Oe.vibrate,gn=Oe.language,mn=Oe.theme,vn=function(){function t(t){this.sound=void 0,this.music=void 0,this.vibrate=void 0,this.language=void 0,this.theme=void 0;var e=t||{},n=e.sound,i=e.music,a=e.vibrate,s=e.language,r=e.theme;this.sound=GameCore.Utils.Valid.isBoolean(n)?n:dn,this.music=GameCore.Utils.Valid.isBoolean(i)?i:pn,this.vibrate=GameCore.Utils.Valid.isBoolean(a)?a:fn,this.language=GameCore.Utils.Valid.isString(s)?s:gn,this.theme=GameCore.Utils.Valid.isString(r)?r:mn}return t.prototype.toObject=function(){return{sound:this.sound,music:this.music,vibrate:this.vibrate,language:this.language,theme:this.theme}},t}(),yn=vn,Sn=qe.userGuideDisplays,An=qe.customFields,En=qe.settings,xn=function(){function t(t){this.data=void 0;var e=t.settings,n=t.score,i=t.customFields,a=t.userGuideDisplays,s=GameCore.Utils.Valid.isNumber(n)&&n>0?n:0,r=GameCore.Utils.Valid.isNumber(a)?a:Sn,o=GameCore.Utils.Valid.isObject(i)?i:An,h=En;GameCore.Utils.Valid.isObject(e)&&(h=new yn(e).toObject()),this.data={score:s,userGuideDisplays:r,settings:h,customFields:o}}return t.prototype.toObject=function(){return this.data},t}(),bn=xn,Tn=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).payload=void 0,i.name="PlayerDataNameNotSupport",i.message=e||"The name of player data is not supported",i.payload=n||{},i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),wn=(0,be.createSelector)([function(t){return t.player}],(function(t){return t})),Mn=(0,be.createSelector)([wn],(function(t){return t.playerId})),Cn=(0,be.createSelector)([function(t){return t.player.data}],(function(t){return t})),Pn=(0,be.createSelector)([Cn],(function(t){return t.settings})),In=(0,be.createSelector)([function(t){return t.player.connectedPlayers}],(function(t){return t})),kn=(0,be.createSelector)([In,function(t,e){return e.limit},function(t,e){return e.offset}],(function(t,e,n){if("number"!==typeof e)return[];if("number"!==typeof n)return[];var i=Y()(t);return r()(i).call(i,n,e+n)||[]})),Rn=(0,be.createSelector)([Cn],(function(t){return t.score})),On=(0,be.createSelector)([Cn],(function(t){return t.customFields})),_n=((0,be.createSelector)([On],(function(t){return null==t?void 0:t.diamond})),GameCore.Configs),Dn=_n.AppId,Bn=_n.LanguageSupport,Ln=_n.ThemeSupport,Fn=_n.PlayerDataStore,Nn=function(t){return{type:ln,payload:{connectedPlayers:t}}},Gn=function(t,e){return function(n,i){try{var a,s=i(),r=Pn(s);n({type:cn,payload:{name:t,value:e}});var o={settings:(0,wt.default)({},r,(a={},a[t]=e,a))};Le(Fn,o),$e(o)}catch(h){(0,Ht.sendException)(h)}}},Un=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r={customFields:(s={},s[t]=e,s)},n.next=4,i(Yn(r));case 4:o=a(),h=Cn(o),$e(h),n.next=14;break;case 9:if(n.prev=9,n.t0=n.catch(0),!(n.t0 instanceof Tn)){n.next=13;break}return n.abrupt("return");case 13:(0,Ht.sendException)(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(t,e){return n.apply(this,arguments)}}()},Vn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={customFields:t},e.next=4,n(Yn(a));case 4:s=i(),r=Cn(s),$e(r),e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(0),!(e.t0 instanceof Tn)){e.next=13;break}return e.abrupt("return");case 13:(0,Ht.sendException)(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},Yn=function(t){return function(e){try{e({type:on,payload:{data:t}}),Le(Fn,t)}catch(n){(0,Ht.sendException)(n)}}},zn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({type:hn,payload:{score:t}});case 3:$e({score:t}),a=i(),s=Cn(a),Le(Fn,s),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},Hn=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.incUserGuideDisplays=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,e(Yn({userGuideDisplays:1})),a=n(),s=Mn(a),t.next=7,nn(s);case 7:i.data.set("userGuideDisplays",1),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.receiveData=function(t,e){this.game.storage.dispatch(function(t,e){return function(n){var i=t.playerId,a=t.name,s=t.photo,r=t.locale;n({type:rn,payload:{playerId:i,name:a,photo:s,locale:r,data:e||{}}})}}(t,e))},n.updateData=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E,x,b,T;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=n(),a=wn(i),s=a.playerId,r=a.name,o=a.photo,h=a.locale,t.next=6,$e({appId:Dn,playerId:s,name:r,photo:o,locale:h});case 6:if(c=t.sent,GameCore.Utils.Valid.isObject(c)){t.next=9;break}return t.abrupt("return");case 9:if(c.playerId===s){t.next=11;break}return t.abrupt("return");case 11:l=Pn(i),u=l.theme,d=l.sound,p=l.music,f=l.vibrate,g=l.language,m=new bn(c).toObject(),v=m.settings,y=v.theme,S=v.music,A=v.sound,E=v.vibrate,x=v.language,b=g in Bn,T=u in Ln,g===x&&b||(m.settings.language=x),!0===S&&p!==S&&(m.settings.music=S),!0===A&&d!==A&&(m.settings.sound=A),!0===E&&f!==E&&(m.settings.vibrate=E),u===y&&T||(m.settings.theme=y),e(Yn(m)),!0===m.settings.music&&window.game.audio.playMusic(),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 29:case"end":return t.stop()}}),t,null,[[0,26]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setScore=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(zn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.setSetting=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.game.storage,t.next=3,i.dispatch(Gn(e,n));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.setCustomData=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.game.storage,t.next=3,i.dispatch(Un(e,n));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.updateCustomFields=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Vn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.requestConnectedPlayers=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.game.storage,t.next=3,e.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.facebook,t.next=4,new(mt())((function(t,e){i.once("players",(function(e){t(e)})),i.once("playersfail",(function(){return e([])})),i.getPlayers()}));case 4:if(a=t.sent,s=function(t){return!!t},r=c()(n=De()(a).call(a,(function(t){var e=t.getID(),n=t.getName(),i=t.getPhoto();return e&&n&&i?new un.default(e,n,i).toObject():null}))).call(n,s),!(r.length<1)){t.next=9;break}return t.abrupt("return");case 9:e(Nn(r)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.updateConnectedPlayers=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Nn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getPlayer=function(){return wn(this.state)},n.getPlayerId=function(){return this.getPlayer().playerId},n.getPlayerData=function(){return this.getPlayer().data},n.getPlayerSetting=function(t){var e=this.getPlayerSettings();return"string"!==typeof t?null:GameCore.Utils.Object.hasOwn(e,t)?e[t]:GameCore.Utils.Object.hasOwn(Oe,t)?Oe[t]:null},n.getPlayerSettings=function(){return this.getPlayerData().settings},n.getPlayerIsNew=function(){return this.getPlayer().isUserNew},n.getCoins=function(){var t=this.getCustomData("coin");return GameCore.Utils.Valid.isNumber(t)?t:0},n.getDiamond=function(){var t=this.getCustomData("diamond");return GameCore.Utils.Valid.isNumber(t)?t:0},n.getBestScore=function(){return Rn(this.state)},n.getCustomData=function(t){var e=On(this.state);return GameCore.Utils.Valid.isObject(e)&&GameCore.Utils.Object.hasOwn(e,t)?e[t]:null},n.getConnectedPlayers=function(){return In(this.state)},n.getConnectedPlayerIds=function(t,e){return kn(this.state,{limit:t,offset:e})},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),Wn=Hn,Xn=GameCore.Configs.ApiHost,Kn=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=GameCore.Utils.String.params(e),t.next=3,Ke("players?"+n,{},Xn);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||[]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jn="PROFILES_DATA_UPDATE",qn=(0,be.createSelector)([function(t){return t.profile.data}],(function(t){return t})),Zn=(0,be.createSelector)([function(t){return t.profile.profileIds}],(function(t){return t})),Jn=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r,o;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=i(),s=Zn(a),!((r=GameCore.Utils.Array.difference(t,s)).length<1)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Kn({playerIds:r});case 8:o=e.sent,n({type:jn,payload:{data:o}}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}()},Qn=function(t){function e(){return t.apply(this,arguments)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.requestProfiles=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game.storage,t.next=3,n.dispatch(Jn(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.getProfiles=function(){return qn(this.state)},(0,Se.default)(e,[{key:"state",get:function(){return this.game.storage.getState()}}]),e}(Phaser.Plugins.BasePlugin),$n=Qn,ti=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(Phaser.Events.EventEmitter),ei=ti,ni=n(52),ii=function(t){function e(e,n,i,a){var s;(s=t.call(this,e)||this).zone=void 0,s.background=void 0,s.setName(n),s.setVisible(!1);var r=s.scene.world.getWorldSize(),o=r.width,h=r.height;return s.setSize(i||o,a||h),s.addZone(),s.addBackground(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(t){GameCore.Utils.Valid.isObject(t)&&(this.setDataEnabled(),this.setData(t)),this.setBlockInputOutsideEnabled(!0),this.scene.screen.bringToTop(this.name),this.visible||(this.setVisible(!0),this.logPageviewOnOpen(),this.logEventOpen())},n.close=function(){this.setBlockInputOutsideEnabled(!1),this.visible&&(this.setVisible(!1),this.logPageviewOnClose())},n.setBlockInputOutsideEnabled=function(t){this.scene.input.setTopOnly(t)},n.addZone=function(){this.zone=this.scene.add.zone(0,0,this.width,this.height),this.zone.setInteractive({}),this.add(this.zone)},n.addBackground=function(){var t="screen-background";if(!this.scene.textures.exists(t)){var e=this.width+2,n=this.height+2,i=this.scene.add.graphics();i.fillStyle(0,1),i.fillRect(0,0,e,n),i.generateTexture(t,e,n),i.destroy()}this.background=this.scene.add.image(0,0,t),this.background.setInteractive(),this.add(this.background)},n.logPageviewOnOpen=function(){this.scene.analytics.pageview(this.name)},n.logPageviewOnClose=function(){this.scene.analytics.pageview(this.scene.scene.key)},n.logEventOpen=function(){this.scene.analytics.event(ni.AnalyticsEvents.SCREEN_OPEN,{screen_name:this.getScreenName()})},n.getScreenName=function(){return GameCore.Utils.String.toUpperCamelCase(this.name.toLowerCase())},e}(Phaser.GameObjects.Container),ai=ii,si={OPEN:"open",CLOSE:"close",CREATED:"created"};GameCore.Screen=ai,GameCore.Screens={Events:si};var ri=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).events=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.boot=function(){this.events=new ei,this.registryScreenFactory()},n.get=function(t){var e=this.scene.children.getByName(t);return null===e?null:e},n.add=function(t,e,n,i){var a=this.get(t);return a||(a=this.scene.add.screen(t,e,n,i),this.events.emit(GameCore.Screens.Events.CREATED,a),a)},n.open=function(t,e){var n=this.get(t);return!!n&&(n.open(e),n.emit(GameCore.Screens.Events.OPEN,n),this.events.emit(GameCore.Screens.Events.OPEN,n),!0)},n.close=function(t){var e=this.get(t);return!!e&&(e.close(),e.emit(GameCore.Screens.Events.CLOSE,e),this.events.emit(GameCore.Screens.Events.CLOSE,e),!0)},n.bringToTop=function(t){var e=this.scene.children.getByName(t);e&&this.scene.children.bringToTop(e)},n.registryScreenFactory=function(){Phaser.GameObjects.GameObjectFactory.register("screen",this.createScreen)},n.createScreen=function(t,e,n,i){var a=new e(this.scene,t,n,i);return Phaser.Display.Align.In.Center(a,this.scene.gameZone),this.existing(a),a},e}(Phaser.Plugins.ScenePlugin),oi=ri,hi=n(447),ci=n.n(hi),li=n(324),ui=n(545),di="CONTEXT_RECEIVED",pi="CONTEXT_PROCESSED",fi="CONTEXT_GAME_MODE_DETECTED",gi="MESSAGES_SENT_UPDATE",mi="MESSAGES_SENT_REMOVE",vi="SCENE_KEY_UPDATE",yi=n(53),Si={currentSceneKey:"",prevSceneKey:""};(0,yi.enableES5)();var Ai,Ei,xi,bi,Ti,wi,Mi,Ci,Pi,Ii,ki={processed:!1,contextId:"",contextType:"SOLO",entryPointData:{},currentGameMode:""},Ri=ki,Oi={data:{}},_i={token:"",isRequesting:!1},Di=(Ai={},Ai.auth=function(t,e){return void 0===t&&(t=_i),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.token;switch(e.type){case Ae:t.isRequesting=!0;break;case Ee:t.token=i,t.isRequesting=!1}}}))},Ai),Bi={playerId:"",name:"",photo:"",locale:"",connectedPlayers:{},data:{score:0,settings:Oe,userGuideDisplays:0,customFields:{}},isUserNew:!0},Li=(Ei={},Ei.player=function(t,e){return void 0===t&&(t=Bi),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.name,s=i.value,r=i.data,o=void 0===r?{}:r,h=i.score,c=i.connectedPlayers,l=void 0===c?[]:c;switch(e.type){case rn:var u=i.playerId,d=i.name,p=i.photo,f=i.locale,g=i.data;if(n.playerId=u,n.name=d,n.photo=p,n.locale=f,GameCore.Utils.Valid.isObject(g)){var m=g;n.data=(0,Mt.merge)(t.data,m)}g.userGuideDisplays>0&&(n.isUserNew=!1);break;case hn:n.data.score=h;break;case cn:if(!GameCore.Utils.Object.hasOwn(n.data.settings,a))break;n.data.settings[a]=s;break;case on:n.data=(0,Mt.merge)(t.data,o),o.userGuideDisplays>0&&(n.isUserNew=!1);break;case ln:if(l.length<=0)break;var v=GameCore.Utils.Object.keyBy(l,"playerId");n.connectedPlayers=(0,Mt.merge)(t.connectedPlayers,v)}}}))},Ei),Fi=n(546),Ni=n.n(Fi),Gi={data:{},profileIds:[]},Ui=(xi={},xi.profile=function(t,e){return void 0===t&&(t=Gi),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.data,s=void 0===a?[]:a;if(e.type===jn){var r,o,h=GameCore.Utils.Object.keyBy(s,"playerId"),c=Y()(h);n.data=(0,Mt.merge)((0,wt.default)({},t.data),h),n.profileIds=et()(r=[]).call(r,new(Ni())(et()(o=[]).call(o,t.profileIds,c)))}}}))},xi),Vi="MATCH_GAMEPLAY_INITIALIZE",Yi="MATCH_GAMEPLAY_START",zi="MATCH_GAMEPLAY_FINISH",Hi="MATCH_GAMEPLAY_UPDATE",Wi="MATCH_GAMEPLAY_RESCUE",Xi="MATCH_GAMEPLAY_RESET_RESCUE",Ki="MATCH_GAMEPLAY_SHOW_MINI_JOURNEY",ji="MATCH_STATS_DATA_CLEAR",qi="MATCH_STATS_DATA_UPDATE",Zi="MATCH_STATS_CURRENT_UPDATE",Ji="MATCH_SINGLE_CREATE_REQUEST",Qi="MATCH_SINGLE_DETAIL_REQUEST",$i="MATCH_SINGLE_MOVE_UPDATED",ta="MATCH_SINGLE_DATA_RECEIVED",ea="MATCH_SINGLE_DATA_CLEAR",na="MATCH_JOURNEY_CREATE_REQUEST",ia="MATCH_JOURNEY_DATA_CLEAR",aa="MATCH_JOURNEY_MOVE_UPDATED",sa="MATCH_JOURNEY_DATA_RECEIVED",ra="MATCH_JOURNEY_SCORE_RECEIVED",oa="MATCH_CHALLENGE_JOIN_REQUEST",ha="MATCH_CHALLENGE_CREATE_REQUEST",ca="MATCH_CHALLENGE_FINISH_REQUEST",la="MATCH_CHALLENGE_CONTINUE_REQUEST",ua="MATCH_CHALLENGE_DATA_RECEIVED",da="MATCH_CHALLENGE_DATA_CLEAR",pa="MATCH_GROUP_CREATE_REQUEST",fa="MATCH_GROUP_FINISH_REQUEST",ga="MATCH_ONLINE_CREATE_REQUEST",ma="MATCH_ONLINE_DATA_RECEIVED",va="MATCH_ONLINE_STATS_UPDATE",ya="MATCH_ONLINE_FINISH_REQUEST",Sa="MATCH_ONLINE_DATA_CLEAR",Aa="open",Ea="active",xa="finished",ba={mode:"",status:Aa,rescued:0,startAt:0,finishAt:0,showMiniJourney:null},Ta={single:{_id:"",data:{fen:""},playerId:"",status:Aa},group:{status:Aa,opponentInfo:{playerId:"",name:"",photo:""}},challenge:{_id:"",status:Aa,whitePlayerId:"",blackPlayerId:"",opponentInfo:{playerId:"",name:"",photo:""}},online:{_id:"",status:Aa,players:{}},journey:{_id:"",data:{fen:""},playerId:"",status:Aa},updateAt:0,isRequesting:!1},wa={current:{updateAt:0},data:{updateAt:0},isRequesting:!1},Ma=(bi={},bi.match=(0,li.combineReducers)({gameplay:function(t,e){return void 0===t&&(t=ba),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.mode,s=i.status,r=i.stateShowMiniJourney,o=i.rescued;switch(e.type){case Vi:n.status=Aa,n.mode=ba.mode,n.rescued=ba.rescued,n.startAt=ba.startAt,n.finishAt=ba.finishAt,n.opponentInfo=ba.opponentInfo;break;case Yi:n.mode=a,n.status=Ea,n.rescued=o,n.startAt=Date.now();break;case Hi:n.mode="string"===typeof a?a:t.mode,n.status=s||t.status;break;case zi:n.status=xa,n.finishAt=Date.now();break;case Wi:n.rescued+=1;break;case Ki:n.showMiniJourney=r;break;case Xi:n.rescued=0}}}))},match:function(t,e){return void 0===t&&(t=Ta),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.match,s=i.opponentInfo,r=i.players,o=i.score;switch(e.type){case Ji:case Qi:case oa:case ca:case ga:case na:n.isRequesting=!0;break;case $i:n.single=(0,wt.default)({},t.single,a),n.updateAt=Date.now();break;case aa:n.journey=(0,wt.default)({},t.journey,a),n.updateAt=Date.now();break;case ta:n.isRequesting=!1,n.single=a||Ta.single;break;case sa:n.isRequesting=!1,n.journey=a||Ta.journey;break;case ra:n.journey.score=o;break;case ea:n.isRequesting=!1,n.single=Ta.single;break;case ia:n.isRequesting=!1,n.journey=Ta.journey;break;case ha:case la:n.isRequesting=!0,n.challenge.opponentInfo=s;break;case ua:n.isRequesting=!1,n.challenge=(0,wt.default)({},a||Ta.challenge),n.challenge.opponentInfo=t.challenge.opponentInfo;break;case da:n.isRequesting=!1,n.challenge=Ta.challenge;break;case pa:n.group.status=Ea,s&&(n.group.opponentInfo=s);break;case fa:n.group.status=xa;break;case Sa:n.online.status=Ta.online.status,n.online.players=Ta.online.players;break;case ma:n.online.status=Ea,n.online.players=r;break;case ya:n.online.status=xa}}}))},stats:function(t,e){return void 0===t&&(t=wa),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.playerId,s=i.stats,r=i.match,o=i.current,h=i.players,c=i.leaders;switch(e.type){case ji:delete n.data[a],n.current=wa.current;break;case"MATCH_STATS_CONTEXT_REQUEST":n.data=wa.data,n.isRequesting=!0;break;case"MATCH_STATS_CONTEXT_RECEIVED":n.data=s,n.isRequesting=!1;break;case qi:n.data[a]=s;break;case Zi:n.current=(0,Mt.merge)((0,wt.default)({},t.current),s);break;case ma:Y()(h).forEach((function(t){n.data[t]={score:0}}));break;case va:c.forEach((function(t){var e=t.playerId,i=t.score,a=t.rank;n.data[e]={score:i,rank:a}}));break;case ua:var l=r||{},u=l.blackPlayerId,d=l.blackPlayerScore,p=l.whitePlayerId,f=l.whitePlayerScore,g=l.whitePlayerLevel,m=l.blackPlayerLevel;if(!u||!p)break;o&&(n.current=o),n.data[u]={score:d,level:m},n.data[p]={score:f,level:g}}}}))}}),bi),Ca="TOURNAMENT_ACTIVE",Pa="TOURNAMENT_REQUEST",Ia="TOURNAMENT_RECEIVED",ka={active:!1,tournamentId:null,bestSessionScore:0,isRequesting:!1},Ra=(Ti={},Ti.tournament=function(t,e){return void 0===t&&(t=ka),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.score,s=void 0===a?0:a,r=i.tournamentId;switch(e.type){case Ca:n.active=!0,n.tournamentId=r;break;case Pa:n.isRequesting=!0;break;case Ia:n.isRequesting=!1,s>t.bestSessionScore&&(n.bestSessionScore=s)}}}))},Ti),Oa=n(450),_a=n.n(Oa),Da=n(244),Ba=n.n(Da),La="LEADERBOARD_DATA_REQUEST",Fa="LEADERBOARD_DATA_UPDATE",Na="LEADERBOARD_DATA_CLEAR",Ga={leaderboardId:"",type:"",limit:0,offset:0,leaders:{},isRequesting:!1},Ua=(wi={},wi.leaderboards=function(t,e){return void 0===t&&(t=Ga),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.leaderboardId,s=i.type,r=i.limit,o=i.offset,h=i.leaders;switch(e.type){case La:t.type!==s&&0===o&&(n.leaders=Ga.leaders),n.isRequesting=!0,n.leaderboardId=a,n.type=s,n.limit=r,n.offset=o;break;case Fa:if(n.isRequesting=!1,t.type!==s)break;var c=GameCore.Utils.Json.clone((0,wt.default)({},t.leaders,h)),l=_a()(c),u=De()(l).call(l,(function(t){return t.name&&t.photo||(t.name="Unknown",t.photo=""),t}));Ba()(u).call(u,(function(t,e){return+e.score-+t.score})),u.forEach((function(e,i){e.rank=i+1,t.leaders[e.playerId]||(n.leaders[e.playerId]=e)}));break;case Na:n.isRequesting=!1,n.type=Ga.type,n.limit=Ga.limit,n.offset=Ga.offset,n.leaders=Ga.leaders,n.leaderboardId=Ga.leaderboardId}}}))},wi),Va="MISSIONS_DATA_REQUEST",Ya="MISSIONS_DATA_RECEIVE",za="MISSION_START",Ha="MISSION_UPDATE",Wa="MISSION_COMPLETED",Xa={mission:null,missions:null,isRequesting:!1},Ka=(Mi={},Mi.missions=function(t,e){return void 0===t&&(t=Xa),(0,yi.default)(t,(function(n){var i,a,s=e.payload;if(s){var r=s.name,o=s.type,h=s.value,c=s.missions;switch(e.type){case Va:n.isRequesting=!0;break;case Ya:if(n.isRequesting=!1,c.length<1)return;n.missions={},c.forEach((function(t){n.missions[t.name]=t}));break;case za:if(null===t.missions)break;var l=t.missions[r];n.mission={name:r,process:{},require:l.require,reward:l.reward},Y()(l.require).forEach((function(t){n.mission.process[t]=0}));break;case Ha:if((null==(i=t.mission)?void 0:i.name)!==r)break;n.mission.process[o]+=h;break;case Wa:if((null==(a=t.mission)?void 0:a.name)!==r)break;n.mission=null}}}))},Mi),ja="DAILY_TASKS_DATA_REQUEST",qa="DAILY_TASKS_DATA_RECEIVE",Za="DAILY_TASKS_PROCESS_UPDATE",Ja="DAILY_TASK_VALUE_ADD",Qa="DAILY_TASK_REWARDED",$a="DAILY_TASKS_SEEN",ts="DAILY_TASK_FINISHED",es={tasks:[],process:[],isRequesting:!1,isNotice:!1},ns=(Ci={},Ci.dailyTasks=function(t,e){return void 0===t&&(t=es),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.id,s=i.type,r=i.value,o=i.tasks,h=i.process;switch(e.type){case ja:n.isRequesting=!0;break;case qa:n.isRequesting=!1,n.tasks=o;break;case Za:n.process=h;break;case Ja:if(!t.process[a])break;n.process[a][s]+=r;break;case Qa:if(!t.process[a])break;n.process[a].rewarded=!0;break;case $a:n.isNotice=!1;break;case ts:n.isNotice=!0}}}))},Ci),is={rewards:[],isRequesting:!1},as=(Pi={},Pi.dailyRewards=function(t,e){return void 0===t&&(t=is),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.rewards;switch(e.type){case"DAILY_REWARDS_REQUEST":t.isRequesting=!0;break;case"DAILY_REWARDS_RECEIVE":t.isRequesting=!1,t.rewards=i}}}))},Pi),ss="LIVES_REQUEST",rs="LIVES_UPDATED",os="LIVES_RESET",hs="LIVES_COUNT_DOWN_START",cs={isRequesting:!1,lives:0,lastBonusLifeTime:0,countDownStartAt:0},ls=(Ii={},Ii.lives=function(t,e){return void 0===t&&(t=cs),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.data;switch(e.type){case ss:t.isRequesting=!0;break;case rs:t.isRequesting=!1,t.lives=i.lives,t.lastBonusLifeTime=i.lastBonusLifeTime;break;case os:t.isRequesting=!1,t.lives=cs.lives,t.lastBonusLifeTime=cs.lastBonusLifeTime,t.countDownStartAt=0;break;case hs:t.countDownStartAt=(new Date).getTime()}}}))},Ii),us=(0,li.combineReducers)((0,wt.default)({scene:function(t,e){return void 0===t&&(t=Si),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.sceneKey;if(e.type===vi)n.currentSceneKey=a,n.prevSceneKey=t.currentSceneKey}}))},context:function(t,e){return void 0===t&&(t=ki),(0,yi.default)(t,(function(t){var n=e.payload;if(n){var i=n.gameMode,a=n.contextId,s=n.contextType,r=n.entryPointData;switch(e.type){case di:t.contextId=a,t.contextType=s,t.entryPointData=r;break;case pi:t.contextId=a,t.contextType=s,t.processed=!0;break;case fi:t.currentGameMode=i}}}))},messages:function(t,e){return void 0===t&&(t=Oi),(0,yi.default)(t,(function(n){var i=e.payload;if(i){var a=i.opponentId;if("string"===typeof a)switch(e.type){case gi:t.data[a]?n.data[a].sent=!0:n.data[a]={sent:!0};break;case mi:t.data[a]?n.data[a].sent=!1:n.data[a]={sent:!1}}}}))}},Di,Li,Ui,Ma,Ra,Ua,Ka,ns,as,ls)),ds=us,ps=window,fs=(ps.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,li.compose),gs=function(t){var e=fs((0,li.applyMiddleware)(ui.default));return(0,li.createStore)(ds,t,e)},ms=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).store=void 0,n.initiator=void 0,n.dispatch=function(t){return n.store.dispatch(t)},n.getState=function(){return n.store.getState()},n.subscribe=function(t){return n.store.subscribe(t)},n.watch=function(t,e){var i=ci()((function(){var e=n.getState();return t(e)}));return n.subscribe(i((function(t){e(t)})))},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.store=gs({})},n.setInitiator=function(t){this.initiator=t},n.syncStore=function(){this.initiator.initContext(),this.initiator.initPlayer()},e}(Phaser.Plugins.BasePlugin),vs=ms,ys=n(549),Ss=n.n(ys),As=function(t){function e(e,n){var i;return(i=t.call(this,e,{type:"webfont",key:n.type})||this).payload=void 0,i.payload=n,i}(0,Kt.default)(e,t);var n=e.prototype;return n.load=function(){var t;switch(this.payload.type){case"google":t=this.getGoogleFontConfig(this.payload);break;case"local":t=this.getLocalFontConfig(this.payload)}Ss().load(t)},n.getGoogleFontConfig=function(t){var e=this,n=t.character,i=t.fontName,a=t.fontWeight;return{google:{families:[i+":"+(void 0===a?400:a)],text:n},active:function(){e.loader.nextFile(e,!0)},timeout:15e3}},n.getLocalFontConfig=function(t){var e=this,n=t.fontName,i=t.fontType,a=document.createElement("style");document.head.appendChild(a);var s=a.sheet;if(s){var r='@font-face { font-family: "'+n+'"; src: url("assets/fonts/'+n+("opentype"===i?".otf":".ttf")+'") format("'+i+'"); }';s.insertRule(r,0)}return{custom:{families:[n]},active:function(){e.loader.nextFile(e,!0)},timeout:15e3}},e}(Phaser.Loader.File),Es=As,xs=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.addFont=function(t){var e=new Es(this.scene.load,t);this.scene.load.addFile(e)},e}(Phaser.Plugins.ScenePlugin),bs=xs,Ts=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).ratio=void 0,n.width=void 0,n.height=void 0,n.worldWidth=void 0,n.worldHeight=void 0,n.worldRatio=void 0,n.forcePixelRatio=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){var e=t.width,n=t.height,i=t.ratio;this.ratio=i,this.width=e,this.height=n,this.initWorldSize(),this.addEventResize()},n.resize=function(t){var e=this;t&&t>0&&(this.forcePixelRatio=t);var n=this.getCanvasSizeFixedRatio(this.worldRatio),i=n.width,a=n.height;this.resizeCanvas(i,a),this.game.scene.scenes.forEach((function(t){var n=t.cameras.main;if(n){var i=e.getZoomRatio(),a=e.getWorldSize(),s=a.width,r=a.height;n.setZoom(i),n.centerOn(s/2,r/2)}}))},n.resizeCanvas=function(t,e){this.game.canvas.width=t,this.game.canvas.height=e,this.game.scale.resize(t,e)},n.getWorldSize=function(){return{width:this.worldWidth,height:this.worldHeight}},n.initWorldSize=function(){this.worldWidth=this.width,this.worldHeight=this.height,this.isScreenSmallerRatio(this.ratio)&&(this.worldHeight=this.width/this.getScreenRatio()),this.worldRatio=this.worldWidth/this.worldHeight},n.getZoomRatio=function(){var t=this.getWorldSize().width;return this.getCanvasSizeFixedRatio(this.worldRatio).width/t},n.getPixelRatio=function(){if(this.forcePixelRatio>0)return this.forcePixelRatio;if(GameCore.Utils.Device.isDesktop())return 2;var t=GameCore.Utils.Device.pixelRatio();return t>2&&(t=2),t},n.getPhysicPixels=function(t,e){return t*e},n.getCanvasSizeFixedRatio=function(t){var e=this.getPixelRatio(),n=this.getScreenWidth()*e,i=this.getScreenHeight()*e;return this.isScreenSmallerRatio(t)?i=n/t:n=i*t,{width:n,height:i}},n.getScreenRatio=function(){return this.getScreenWidth()/this.getScreenHeight()},n.getScreenHeight=function(){var t=document,e=t.body,n=t.documentElement,i=e.clientHeight,a=n.clientHeight;return Math.max(a,i)||0},n.getScreenWidth=function(){var t=document,e=t.body,n=t.documentElement,i=e.clientWidth,a=n.clientWidth;return Math.max(a,i)||0},n.isScreenSmallerRatio=function(t){return this.getScreenWidth()/this.getScreenHeight()<=t},n.addEventResize=function(){var t=this;window.addEventListener("resize",(function(){t.resize()}))},e}(Phaser.Plugins.BasePlugin),ws=Ts,Ms=function(){function t(t,e,n){this.contextId=void 0,this.contextType=void 0,this.entryPointData=void 0,this.contextId=t||Ri.contextId,this.contextType=e||Ri.contextType,this.entryPointData=n||Ri.entryPointData}return t.prototype.toObject=function(){return{contextId:this.contextId,contextType:this.contextType,entryPointData:this.entryPointData}},t}(),Cs=Ms,Ps=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidPlayerId",i.message=e||"The playerId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Is=Ps,ks="share_invite",Rs="journey_invite",Os="tournament",_s="challenge_friend_match",Ds="matching_group_match",Bs=n(119),Ls=new un.default("10","Your Friend",Bs.default.AVATAR.FILE).toObject(),Fs="single",Ns="challenge-friends",Gs="matching-group",Us="tournaments",Vs="online",Ys="journey",zs=(0,be.createSelector)([function(t){return t.context}],(function(t){return t})),Hs=((0,be.createSelector)([function(t){return t.context.contextId}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.contextType}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.processed}],(function(t){return t})),(0,be.createSelector)([function(t){return t.context.currentGameMode}],(function(t){return t}))),Ws=function(t,e){return{type:pi,payload:{contextId:t,contextType:e}}},Xs=function(t){return function(e){e({type:fi,payload:{gameMode:t}}),(0,Ht.addBreadcrumbSentry)("game-mode",t)}},Ks=GameCore.Configs.PlayerDataStore,js=function(t){var e=this;this.game=void 0,this.initContext=function(){var t=window.GameSDK.context.getID(),n=window.GameSDK.context.getType(),i=window.GameSDK.getEntryPointData(),a=new Cs(t,n,i).toObject(),s=a.contextId,r=a.contextType,o=a.entryPointData;e.game.storage.dispatch(function(t,e,n){return{type:di,payload:{contextId:t,contextType:e,entryPointData:n}}}(s,r,o))},this.initPlayer=function(){var t=e.getPlayerInfo(),n=e.getPlayerDataLocal();e.game.player.receiveData(t,n)},this.getPlayerInfo=function(){try{var t=window.GameSDK.player.getID(),e=window.GameSDK.player.getName(),n=window.GameSDK.player.getPhoto(),i=window.GameSDK.getLocale();if(!GameCore.Utils.Valid.isString(t))throw new Is(null,{playerId:t});return GameCore.Utils.Valid.isString(e)||(e="You"),new un.default(t,e,n,i).toObject()}catch(a){return new un.default("123","You").toObject()}},this.getPlayerDataLocal=function(){try{var t=Be(Ks);return GameCore.Utils.Valid.isObject(t)?new bn(t).toObject():null}catch(e){return null}},this.game=t},qs=n(39),Zs=[ni.AnalyticsEvents.BUTTON_CLICK,ni.AnalyticsEvents.SCREEN_OPEN],Js=function(t){function e(e,n){var i;(i=t.call(this,"FacebookAnalytics",{prefix:n},"#0F52BA")||this).game=void 0,i.game=e;var a=(GameCore.Configs.Analytics.FacebookAnalytics||{}).consoleLog;return i.selfLog=!!a,i}(0,Kt.default)(e,t);var n=e.prototype;return n.processTrafficSource=function(t){},n.processEvent=function(t,e,n){if(!(g()(Zs).call(Zs,t)>=0)){var i=this.getEventName(t);this.game.facebook.log(i,n,e)}},n.processPageView=function(t){},n.processLevelStart=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_START,{level:t,score:e,level_name:n})},n.processLevelRescue=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_RESCUE,{level:t,score:e,level_name:n})},n.processLevelFail=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!1})},n.processLevelComplete=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!0})},n.processShowInterstitialAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"interstitial",screen_name:""+t})},n.processShowRewardedVideoAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+t})},n.processShowAdFail=function(t,e){var n=t===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(ni.AnalyticsEvents.AD_SHOW_FAILED,{ad_type:n,screen_name:""+e})},n.getEventName=function(t){return this.options.prefix+"_"+t},e}(GameCore.Analytics.BaseAnalytics),Qs=Js,$s=[ni.AnalyticsEvents.SCREEN_OPEN],tr=(function(t){function e(e,n){var i;(i=t.call(this,"GoogleAnalytics",(0,wt.default)({},n),"#E35335")||this).game=void 0,i.trackingId=void 0,i.currentPath="/";var a=n.trackingId;i.game=e;var s=(GameCore.Configs.Analytics.GoogleAnalytics||{}).consoleLog;return i.selfLog=!!s,i.trackingId=a,i}(0,Kt.default)(e,t);var n=e.prototype;n.processTrafficSource=function(t){},n.processEvent=function(t,e,n){if(!(g()($s).call($s,t)>=0)){var i=this.formatEventName(t),a=e?(0,wt.default)({},e):{};a=n?(0,wt.default)({},a,{value:n}):a,a=(0,wt.default)({},a,{page_path:this.currentPath,send_to:"GA"}),gtag("event",i,a)}},n.processLevelStart=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_START,{level:t,score:e,level_name:n})},n.processLevelRescue=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_RESCUE,{level:t,score:e,level_name:n})},n.processLevelFail=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!1})},n.processLevelComplete=function(t,e,n){this.processEvent(ni.AnalyticsEvents.LEVEL_END,{level:t,score:e,level_name:n,success:!0})},n.processShowInterstitialAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"interstitial",screen_name:""+t}),this.processEvent(ni.AnalyticsEvents.AD_IMPRESSION,{ad_format:"Interstitial"})},n.processShowRewardedVideoAd=function(t){this.processEvent(ni.AnalyticsEvents.AD_SHOW,{ad_type:"rewarded_video",screen_name:""+t}),this.processEvent(ni.AnalyticsEvents.AD_IMPRESSION,{ad_format:"Rewarded"})},n.processShowAdFail=function(t,e){var n=t===GameCore.Ads.Types.REWARDED?"rewarded_video":"interstitial";this.processEvent(ni.AnalyticsEvents.AD_SHOW_FAILED,{ad_type:n,screen_name:""+e})},n.processPageView=function(t){var e=this.getGameplayMode(),n="/"+e+"/"+t;this.currentPath=n,document.title=this.formatPageTitle(e,t),gtag("event","page_view",{page_path:this.currentPath,send_to:["GA",this.trackingId]})},n.getGameplayMode=function(){var t=this.game.storage.getState();return Hs(t)},n.formatEventName=function(t){return t.toLowerCase().replace(/:/g,"_")},n.formatPageTitle=function(t,e){return this.toUpperCamelCaseWithSpace(t)+"::"+this.toUpperCamelCaseWithSpace(e)},n.toUpperCamelCaseWithSpace=function(t){var e=t.replace(/[-_\s.]+(.)?/g,(function(t,e){return e?" "+e.toUpperCase():""}));return e.substr(0,1).toUpperCase()+e.substr(1)}}(GameCore.Analytics.BaseAnalytics),function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).startGame=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.auth.requestToken();case 3:n.storage.syncStore(),n.configureSentry(),n.detectGameMode(),n.initAnalytics(),n.analytics.event(ni.AnalyticsEvents.LOAD_START),n.setTrafficSourceAnalytics(),n.scene.launch(qs.SceneKeys.GLOBAL_SCENE),n.scene.start(qs.SceneKeys.LOAD_SCENE),n.analytics.pageview(qs.SceneKeys.LOAD_SCENE),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 17:return t.prev=17,n.facebook.progressLoading.finishLoadingProgressFbBootScene(),n.scene.sleep(qs.SceneKeys.BOOT_SCENE),t.finish(17);case 21:case"end":return t.stop()}}),t,null,[[0,14,17,21]])}))),n}(0,Kt.default)(e,t);var n=e.prototype;return n.create=function(){this.facebook.progressLoading.loadingProgressFbBootScene(),this.startGame()},n.configureSentry=function(){var t=this.player.getPlayer();(0,Ht.setSentryUser)({id:t.playerId,username:t.name})},n.detectGameMode=function(){this.storage.dispatch((function(t,e){var n,i=e(),a=zs(i),s=window.game.player.getPlayerId(),r=a.contextId,o=a.entryPointData||{},h=o.type,c=o.matchId,l=o.playerId,d=o.opponentId,p=void 0===d?Ls.playerId:d,f=o.tournamentContextId,g=s===l,m=p===Ls.playerId||u()(n=[p,l]).call(n,s),v=Fs;!r||void 0!==h&&h!==Os||(v=Us),h===Os&&f&&(v=Us),r&&h===ks&&!g&&(v=Ns),c&&r&&m&&h===_s&&(v=Ns),r&&h===Ds&&(v=Gs),t(Xs(v))}))},n.initAnalytics=function(){var t=GameCore.Configs.Analytics;if(GameCore.Utils.Valid.isObject(t.FacebookAnalytics)){var e=t.FacebookAnalytics.prefix;this.analytics.add(new Qs(this.game,e))}},n.setTrafficSourceAnalytics=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getPlayerFirstVisitEntryPoint();case 3:e=t.sent,this.analytics.setTrafficSource(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),n.getPlayerFirstVisitEntryPoint=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,GameSDK.player.getDataAsync(["entry_point"]);case 2:if(e=t.sent,n=e.entry_point?e.entry_point:null){t.next=9;break}return t.next=7,GameSDK.getEntryPointAsync();case 7:n=t.sent,GameSDK.player.setDataAsync({entry_point:n}).catch();case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e}(Phaser.Scene)),er=tr,nr=n(4),ir=n(107),ar=n.n(ir),sr=n(245),rr=n.n(sr),or=n(1),hr="ALERT_SCREEN",cr="NOTIFY_SCREEN",lr="RESCUE_SCREEN",ur="SETTINGS_SCREEN",dr="BEST_SCORE_SCREEN",pr="RESULT_SCREEN",fr="GAME_OVER_SCREEN",gr="TUTORIAL_PLAY_SCREEN",mr="LEADER_BOARD_SCREEN",vr="MINI_JOURNEY_SCREEN",yr="YOUR_SCORE_SCREEN",Sr="LEVEL_SCREEN",Ar="MISSION_SCORE_COMPLETE_SCREEN",Er="MISSION_COLLECTION_COMPLETE_SCREEN",xr="MISSION_FAIL_SCREEN",br="COLLISION_COMPLETED_SCREEN",Tr="NO_SPACE_LEFT_SCREEN",wr="SCORE_REACHED_SCREEN",Mr="NEXT_TARGET_SCORE_SCREEN",Cr="COLLECTION_ITEMS_SCREEN",Pr="TARGET_SCORE_SCREEN",Ir="CLAIM_HEART_SCREEN",kr=300,Rr=999,Or=n(26),_r=n(11),Dr=n(35),Br=n(16),Lr={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Fr={STATUS:{READY:"ready",RUNNING:"running",STOPPED:"stopped"}},Nr=Fr.STATUS,Gr=function(){function t(t){this.state=void 0,this.scene=void 0,this.scene=t}var e=t.prototype;return e.init=function(){this.setState(Nr.READY)},e.start=function(){this.isRunning()||this.setState(Nr.RUNNING)},e.stop=function(){this.isRunning()&&this.setState(Nr.STOPPED)},e.setState=function(t){this.state=t},e.isReady=function(){return this.state===Nr.READY},e.isRunning=function(){return this.state===Nr.RUNNING},e.isStopped=function(){return this.state===Nr.STOPPED},t}(),Ur=Gr,Vr=n(62),Yr={targets:[],duration:600,ease:Phaser.Math.Easing.Quadratic.Out,props:{alpha:{start:1,from:1,to:0}}},zr=function(t){function e(e){return t.call(this,Yr,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),Hr=zr,Wr=n(309),Xr={targets:[],duration:300,ease:Wr.default,props:{scale:{from:1.2,to:1}}},Kr=function(t){function e(e){return t.call(this,Xr,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),jr=Kr,qr={targets:[],duration:600,ease:Phaser.Math.Easing.Back.Out,props:{y:{from:250,to:0},scale:{from:.9,to:1},alpha:{start:0,from:0,to:1}}},Zr=function(t){function e(e){return t.call(this,qr,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),Jr=Zr,Qr=or.default.DEFAULT,$r=Qr.KEY,to=Qr.FRAME,eo=function(t){function e(e,n,i,a,s,r){var o;return(o=t.call(this,e,n,i)||this).top=void 0,o.mid=void 0,o.bottom=void 0,o.payload=void 0,o.payload=r,o.setSize(a,s),o.setDepth(Dr.default.POPUP),o.createPopup(),o.scene.add.existing((0,nr.default)(o)),o}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.createPopupImages(),this.updatePopupSize(),this.alignPopupImages()},n.createPopupImages=function(){this.top=this.scene.add.image(0,0,$r,to.POPUP_TOP),this.mid=this.scene.add.image(0,0,$r,to.POPUP_MID),this.bottom=this.scene.add.image(0,0,$r,to.POPUP_BOTTOM),this.add([this.top,this.mid,this.bottom])},n.updatePopupSize=function(){var t,e=(null==(t=this.payload)?void 0:t.forceHeightTop)||this.width*this.top.height/this.top.width;this.top.setWorldSize(this.width,e),this.bottom.setWorldSize(this.width,this.width*this.bottom.height/this.bottom.width),this.mid.setWorldSize(this.width,this.height-this.top.displayHeight-this.bottom.displayHeight)},n.alignPopupImages=function(){Phaser.Display.Align.In.Center(this.top,this,0,-this.mid.displayHeight/2-this.top.displayHeight/2),Phaser.Display.Align.In.Center(this.mid,this),Phaser.Display.Align.In.Center(this.bottom,this,0,this.mid.displayHeight/2+this.bottom.displayHeight/2)},n.setFrameTop=function(t,e,n){e||(e=this.top.displayWidth),n||(n=this.top.displayHeight),this.top.setFrame(t),this.top.setWorldSize(e,n)},(0,Se.default)(e,[{key:"onClose",set:function(t){this.setInteractive({useHandCursor:!0}),this.on(Phaser.Input.Events.GAMEOBJECT_POINTER_DOWN,t)}}]),e}(Phaser.GameObjects.Container),no=eo,io=or.default.DEFAULT,ao=io.KEY,so=io.FRAME,ro=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.contents=void 0,s.buttonPlay=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onPlay=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.setVisible(!0);var n=s.getData(["onPlay"])[0];s.onPlay=n,s.runOpenAnimation()},s.handlePlay=function(){s.onPlay&&s.onPlay(),s.close()},s.setVisible(!1),s.setDepth(kr),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new no(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createMessage(),this.createButtonPlay(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonPlay])},n.createButtonPlay=function(){this.buttonPlay=new _r.default(this.scene,ao,so.BUTTON_GREEN_LARGE,170,55),this.buttonPlay.setName("Play");var t=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(60),text:"Play",origin:{x:.5,y:.5}});this.buttonPlay.add(t),Phaser.Display.Align.In.Center(t,this.buttonPlay),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,50),this.buttonPlay.onClick=this.handlePlay},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5},text:"The game will end when there s no\nmore space for your given blocks."}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-45),this.messageText.setScale(0).setAlpha(0)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{y:250,scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=n.y,a=n.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},e}(GameCore.Screen),oo=ro,ho=[{minCol:0,minRow:0,cols:4,rows:4},{minCol:4,minRow:0,cols:4,rows:4},{minCol:0,minRow:4,cols:4,rows:4},{minCol:4,minRow:4,cols:4,rows:4}],co=[{minCol:0,minRow:0,cols:5,rows:5},{minCol:3,minRow:0,cols:5,rows:5},{minCol:0,minRow:3,cols:5,rows:5},{minCol:3,minRow:3,cols:5,rows:5}],lo=[{minCol:0,minRow:0,cols:6,rows:6},{minCol:3,minRow:0,cols:6,rows:6},{minCol:0,minRow:3,cols:6,rows:6},{minCol:3,minRow:3,cols:6,rows:6}],uo="vertical",po="horizontal",fo="left",go="right",mo="top",vo="bottom",yo="vertical_left",So="vertical_right",Ao="horizontal_left",Eo="horizontal_right",xo="gem/gem",bo="gem/gem",To="gem/gem",wo="gem/gem",Mo="gem/gem",Co="gem/gem",Po="gem/gem",Io="gem/gem",ko="gem/gem",Ro=[{level:1,frames:[],width:480,height:189},{level:2,frames:[or.default.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[or.default.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[or.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[or.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[or.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],Oo=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],_o="l",Do="l_1",Bo="l_3",Lo="line_2",Fo="line_3",No="line_4",Go="line_5",Uo="square_1",Vo="square_2",Yo="square_3",zo="trapezoid",Ho="triangle",Wo="t_piece",Xo="plus_piece",Ko="cross_piece_2",jo="cross_piece_3",qo="cross_piece_4",Zo="cross_piece_5",Jo="u_piece",Qo=[_o,Do,Bo,Lo,Fo,No,Go,Uo,Vo,Yo,Ho,zo,Wo,Xo,Ko,jo,qo,Jo],$o=[{type:_o,rate:2},{type:Do,rate:8},{type:Bo,rate:6},{type:Lo,rate:9},{type:Fo,rate:9},{type:No,rate:8},{type:Go,rate:8},{type:Uo,rate:9},{type:Vo,rate:8},{type:Ho,rate:2},{type:zo,rate:2},{type:Wo,rate:1},{type:Xo,rate:1},{type:Ko,rate:2},{type:jo,rate:1},{type:qo,rate:1},{type:Jo,rate:1}],th=[[1,0],[1,0],[1,1]],eh=[[0,1],[0,1],[1,1]],nh=[[1,0],[1,1]],ih=[[1,0,0],[1,0,0],[1,1,1]],ah=[[1,1,1],[1,0,0]],sh=[[1,1,1],[0,0,1]],rh=[[1,1],[1,0]],oh=[[1,1,1],[1,0,0],[1,0,0]],hh=[[1,1],[0,1],[0,1]],ch=[[1,1],[1,0],[1,0]],lh=[[1,1],[0,1]],uh=[[1,1,1],[0,0,1],[0,0,1]],dh=[[0,0,1],[1,1,1]],ph=[[1,0,0],[1,1,1]],fh=[[0,1],[1,1]],gh=[[0,0,1],[0,0,1],[1,1,1]],mh=[[1],[1]],vh=[[1,1]],yh=[[1],[1],[1]],Sh=[[1,1,1]],Ah=[[1],[1],[1],[1]],Eh=[[1,1,1,1]],xh=[[1],[1],[1],[1],[1]],bh=[[1,1,1,1,1]],Th=[[1]],wh=[[1,1],[1,1]],Mh=[[1,1,1],[1,1,1],[1,1,1]],Ch=[[1,0],[1,1],[0,1]],Ph=[[0,1],[1,1],[1,0]],Ih=[[1,1,0],[0,1,1]],kh=[[0,1,1],[1,1,0]],Rh=[[0,1],[1,1],[0,1]],Oh=[[1,0],[1,1],[1,0]],_h=[[0,1,0],[1,1,1]],Dh=[[1,1,1],[0,1,0]],Bh=[[0,0,1],[1,1,1],[0,0,1]],Lh=[[1,0,0],[1,1,1],[1,0,0]],Fh=[[0,1,0],[0,1,0],[1,1,1]],Nh=[[1,1,1],[0,1,0],[0,1,0]],Gh=[[0,1,0],[1,1,1],[0,1,0]],Uh=[[1,0],[0,1]],Vh=[[0,1],[1,0]],Yh=[[1,0,0],[0,1,0],[0,0,1]],zh=[[0,0,1],[0,1,0],[1,0,0]],Hh=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],Wh=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],Xh=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],Kh=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],jh=[[1,1],[0,1],[1,1]],qh=[[1,0],[1,1],[1,0]],Zh=[[1,0,1],[1,1,1]],Jh=[[1,1,1],[1,0,1]],Qh=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"4bb3/4bb3/4bb3/3bb4/bbbb2bbb/bbbb1bbbb/4bb3/4bb3/4bb3 l tz-vr,b",piece:Uo,position:{x:4,y:3}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2+30},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=[{x:5,y:3},{x:5,y:4},{x:4,y:4},{x:4,y:5}],e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y;this.scene.main.board.dataBoard[a][i].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()}},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),$h=Qh,tc=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/x/bbbb1ryry/x/x/x/x l s1,b",piece:Uo,position:{x:4,y:4}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=n/2+176+30,a=i+(n-85-i)/2;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50),this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2+15},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<1;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),ec=tc,nc=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"x/x/x/4bb3/4bb3/5b3/x/x/x l l-dt,b",piece:Uo,position:{x:3,y:3}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2-20},y:{from:a,to:n/2},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking();this.scene.main.board.dataBoard[5][4].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),ic=nc,ac=function(){function t(t){this.scene=void 0,this.manager=void 0,this.tweenHand=void 0,this.dataInit={fen:"2r/2r/2r/2r/x/x/x/2r/2r l e3-v,r",piece:Fo,position:{x:2,y:4}},this.scene=t.scene,this.manager=t}var e=t.prototype;return e.start=function(){this.initBoardData(),this.handleHighlight(),this.createTweenHand()},e.initBoardData=function(){this.manager.handleGuidePlayStep(this.dataInit.fen)},e.createTweenHand=function(){var t=this.scene.gameZone,e=t.width,n=t.height;this.manager.handFrame.setVisible(!0),this.manager.handFrame.setPosition(e/2-120,n-50);var i=n/2+176+30,a=i+(n-85-i)/2;this.tweenHand=this.scene.add.tween({repeatDelay:500,targets:this.manager.handFrame,repeat:-1,x:{from:e/2-80,to:e/2-60},y:{from:a,to:n/2+30},duration:1500,ease:Phaser.Math.Easing.Sine.InOut})},e.handleHighlight=function(){for(var t=this.dataInit.position,e=t.x,n=t.y,i=0;i<3;i++)for(var a=0;a<1;a++)this.scene.main.board.dataBoard[n+i][e+a].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0).stopAnimShaking()},e.dragStart=function(){this.tweenHand.stop(),this.manager.handFrame.setVisible(!1)},e.invalidMove=function(){this.manager.handFrame.setVisible(!0),this.tweenHand.play(),this.handleHighlight()},e.nextLevel=function(){this.tweenHand.stop().remove()},t}(),sc=ac,rc=Lr.STATUS,oc=or.default.GAMEPLAY,hc=oc.KEY,cc=oc.FRAME,lc=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.currentLevel=1,n.tutorialId=void 0,n.inputType=void 0,n.handFrame=void 0,n.background=void 0,n.headerContainer=void 0,n.maskGraphics=void 0,n.textTutorial=void 0,n.skipButton=void 0,n.stepOne=void 0,n.stepTwo=void 0,n.stepThree=void 0,n.stepFour=void 0,n.showTutorialWhenStart=function(){switch(n.scene.analytics.event(ni.AnalyticsEvents.TUTORIAL_STEP,{tutorial_step:n.currentLevel}),n.currentLevel){case 1:n.stepOne.start(),n.setTextTutorial("Place the block in the horizontal line\nand see what happens!");break;case 2:n.stepTwo.start(),n.setTextTutorial("Now see what happens\nwhen you make a vertical line.");break;case 3:n.stepThree.start(),n.setTextTutorial("You can also make a 3x3 square.\nGive it a try!");break;case 4:n.stepFour.start(),n.setTextTutorial("Arrange lines and squares\nto get combo points!");break;default:n.handleCompleteTutorial()}},n.nextTutorial=function(){switch(n.currentLevel){case 1:n.stepOne.nextLevel();break;case 2:n.stepTwo.nextLevel();break;case 3:n.stepThree.nextLevel();break;case 4:n.stepFour.nextLevel()}n.currentLevel++,n.showTutorialWhenStart()},n.validTargetPosition=function(t){var e={x:0,y:0};switch(n.currentLevel){case 1:e=n.stepOne.dataInit.position;break;case 2:e=n.stepTwo.dataInit.position;break;case 3:e=n.stepThree.dataInit.position;break;case 4:e=n.stepFour.dataInit.position}return e.x===t.x&&e.y===t.y},n.scene=e,n.createHand(),n.createTutorialPlayScreen(),n.createHeader(),n.createSkipButton(),n.initTutorialStep(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createTutorialPlayScreen=function(){this.scene.screen.add(gr,oo)},n.createHeader=function(){this.headerContainer=this.scene.add.container(),this.headerContainer.setVisible(!1);var t=this.scene.gameZone.width,e=this.scene.make.image({key:hc,frame:cc.BLANK});e.setTint(0),e.setAlpha(.5),e.setWorldSize(t,100),this.headerContainer.add(e),Phaser.Display.Align.In.Center(e,this.headerContainer),this.textTutorial=this.scene.make.text({style:{fontFamily:Br.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700",align:"center"}}),this.textTutorial.setHighQuality(),this.textTutorial.setTint(16442297),this.headerContainer.add(this.textTutorial),Phaser.Display.Align.In.TopCenter(this.headerContainer,this.scene.gameZone,0,-50)},n.createSkipButton=function(){this.skipButton=new _r.default(this.scene,hc,cc.BUTTON_SKIP,50,30),this.headerContainer.add(this.skipButton),this.skipButton.onClick=this.handleSkip.bind(this),Phaser.Display.Align.In.BottomRight(this.skipButton,this.headerContainer,-5,-5)},n.handleSkip=function(){this.scene.game.globalScene.screen.open(hr,{message:"Are you sure you want\nto skip the tutorial?",onHandleYes:this.handleCompleteTutorial.bind(this)})},n.initTutorialStep=function(){this.stepOne=new ec(this),this.stepTwo=new sc(this),this.stepThree=new ic(this),this.stepFour=new $h(this)},n.start=function(){this.isRunning()||(this.scene.analytics.pageview("tutorial-screen"),this.setState(rc.RUNNING),this.headerContainer.setVisible(!0),this.showTutorialWhenStart())},n.setTextTutorial=function(t){var e=this,n=t.split(""),i="";this.scene.time.addEvent({repeat:n.length,delay:10,callback:function(){var t=n.shift()||"";i+=t,e.textTutorial.setText(i),Phaser.Display.Align.In.Center(e.textTutorial,e.headerContainer,-e.scene.gameZone.width/2,-60)}})},n.stop=function(){this.isRunning()&&(this.scene.tweens.killTweensOf([this.background]),this.background.setVisible(!1),this.maskGraphics.setVisible(!1),this.setState(rc.STOPPED))},n.handleCompleteTutorial=function(){this.scene.analytics.pageview("game-scene"),this.scene.analytics.event(ni.AnalyticsEvents.TUTORIAL_COMPLETE),this.setState(rc.STOPPED),this.scene.main.praise.tweenShowScoreText.stop().remove(),this.scene.startGame(),this.handFrame.setVisible(!1),this.headerContainer.setVisible(!1)},n.createHand=function(){this.handFrame=this.scene.make.image({key:hc,frame:cc.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(Dr.default.ON_TOP),this.handFrame.setWorldSize(64,55)},n.isValidForTutorial=function(){return this.scene.game.player.getPlayerIsNew()},n.dragStart=function(){switch(this.currentLevel){case 1:this.stepOne.dragStart();break;case 2:this.stepTwo.dragStart();break;case 3:this.stepThree.dragStart();break;case 4:this.stepFour.dragStart()}},n.skipTutorial=function(){this.isRunning()&&(this.handFrame.setVisible(!1),this.setState(rc.STOPPED))},n.invalidMove=function(){switch(this.currentLevel){case 1:this.stepOne.invalidMove();break;case 2:this.stepTwo.invalidMove();break;case 3:this.stepThree.invalidMove();break;case 4:this.stepFour.invalidMove()}},n.handleGuidePlayStep=function(t){try{this.scene.main.board.clearBoard(),this.scene.footer.pieces.clearPieces();var e=null,n=null;if(t){var i=this.scene.main.board.getBoardByFen(t);e=this.scene.handleDynamicFenSize(i),n=this.scene.footer.pieces.getPiecesByFen(t)}this.scene.main.board.startGame(e),this.scene.footer.pieces.showAvailablePieces(n)}catch(a){}},e}(Ur),uc=lc,dc={START_GAME:"start-game",REPLAY:"replay",RESCUE:"rescue",RECEIVE_DIAMONDS:"receive-diamonds",GAME_OVER:"game-over"},pc={targets:[],duration:600,ease:Phaser.Math.Easing.Cubic.Out,props:{alpha:{start:0,from:0,to:1}}},fc=function(t){function e(e){return t.call(this,pc,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),gc=fc,mc=n(140),vc=n.n(mc),yc=n(253),Sc=n.n(yc),Ac=function(t){return t.leaderboards},Ec=((0,be.createSelector)([function(t){return Ac(t).leaderboardId}],(function(t){return t})),(0,be.createSelector)([function(t){return Ac(t).limit}],(function(t){return t})),(0,be.createSelector)([function(t){return Ac(t).offset}],(function(t){return t})),(0,be.createSelector)([function(t){return Ac(t).leaders}],(function(t){return t}))),xc=((0,be.createSelector)([function(t){return Ac(t).type}],(function(t){return t})),(0,be.createSelector)([function(t){return Ac(t).isRequesting}],(function(t){return t}))),bc="global",Tc="friend",wc=GameCore.Configs,Mc=wc.ApiHost,Cc=wc.OtherHost,Pc=wc.LeadersBoard,Ic=Pc.LeaderboardId,kc=Pc.Prefix+"/"+Ic+"/leaders",Rc=Pc.Prefix+"/"+Ic+"/players",Oc=Pc.Name,_c=function(t){var e="";return Pc.LeaderboardId?(t===bc?e=kc:t===Tc&&(e=Rc),e):e},Dc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=De()(e).call(e,(function(t){return t.playerId})),a=GameCore.Utils.Object.keyBy(e,"playerId"),s=GameCore.Utils.String.params({playerIds:i}),t.next=5,Ke("players?"+s,{},Mc);case 5:return r=t.sent,o=De()(n=r.data).call(n,(function(t){var e=a[t.playerId];return(0,wt.default)({},t,{score:e.score,rank:e.rank,getScore:function(){return e.score},getFormattedScore:function(){return""},getTimestamp:function(){return(new Date).valueOf()},getRank:function(){return e.rank},getExtraData:function(){return e.extraData},getPlayer:function(){return{getName:function(){return t.name},getPhoto:function(){return t.photo},getID:function(){return t.playerId}}}})})),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Bc=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),null==Ic){t.next=3;break}return t.abrupt("return",Lc(e));case 3:return t.abrupt("return",Fc(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Lc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),n=[],i=_c(bc)){t.next=5;break}return t.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(e),t.next=8,Ke(i+"?"+a,{},Cc);case 8:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=12;break}return t.abrupt("return",n);case 12:return n=r,t.abrupt("return",Dc(n));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Fc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),i=(n=e).limit,a=n.offset,t.next=4,window.GameSDK.getLeaderboardAsync(Oc);case 4:return s=t.sent,t.next=7,s.getEntriesAsync(i,a);case 7:return r=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Nc=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),null==Ic){t.next=3;break}return t.abrupt("return",Gc(e));case 3:return t.abrupt("return",Uc(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Gc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e={}),n=[],i=_c(Tc)){t.next=5;break}return t.abrupt("return",n);case 5:return a=GameCore.Utils.String.params(e),t.next=8,Ke(i+"?"+a,{},Cc);case 8:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=12;break}return t.abrupt("return",n);case 12:return n=r,t.abrupt("return",Dc(n));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Uc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),i=(n=e).limit,a=n.offset,t.next=4,window.GameSDK.getLeaderboardAsync(Oc);case 4:return s=t.sent,t.next=7,s.getConnectedPlayerEntriesAsync(i,a);case 7:return r=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Vc=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==Ic){t.next=2;break}return t.abrupt("return",Yc(e));case 2:return t.abrupt("return",zc());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,e){t.next=3;break}return t.abrupt("return",n);case 3:if(i=_c(Tc)){t.next=6;break}return t.abrupt("return",n);case 6:return a=GameCore.Utils.String.params({playerIds:e}),t.next=9,Ke(i+"?"+a,{},Cc);case 9:if(s=t.sent,!((r=(null==s?void 0:s.data)||[]).length<1)){t.next=13;break}return t.abrupt("return",n);case 13:return n=Dc(r)[0],t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),zc=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.GameSDK.getLeaderboardAsync(Oc);case 2:return e=t.sent,t.next=5,e.getPlayerEntryAsync();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Hc=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==Ic){t.next=2;break}return t.abrupt("return",Wc(e,n));case 2:return t.abrupt("return",Xc(n));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Wc=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("players/"+e+"/leaderboard",{score:n},{},Mc);case 2:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Xc=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.GameSDK.getLeaderboardAsync(Oc);case 2:return n=t.sent,t.next=5,n.setScoreAsync(e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function Kc(t,e){var n="undefined"!==typeof vc()&&Sc()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return jc(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return jc(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}for(var qc=GameCore.Configs.LeadersBoard,Zc=function(t,e,n,i){return void 0===n&&(n=qc.LeaderBoardLimit),void 0===i&&(i=0),function(){var a=(0,Xt.default)(qt().mark((function a(s,r){var o,h,l,u,d,p,f,g,m,v,y,S,E,x,b,T,w,M,C;return qt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,o=window.game,h=o.player,o.profile,r(),l=h.getPlayerId(),s({type:La,payload:{leaderboardId:t,type:e,limit:n,offset:i}}),!qc.UseMock){a.next=11;break}return a.next=8,(0,Ge.sleepAsync)(1e3);case 8:return p=De()(u=A()(d=new Array(n)).call(d,null)).call(u,(function(t,e){var n=(e+1)*(i+1);return{playerId:"0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png",rank:n,score:Math.floor(1e5/n)}})),s(Jc(p,e)),a.abrupt("return");case 11:if(f=[],e!==bc){a.next=18;break}return a.next=15,Bc({limit:n,offset:i});case 15:f=a.sent,a.next=26;break;case 18:if(e!==Tc){a.next=26;break}return(g=h.getConnectedPlayerIds(n,i)).push(l),m=GameCore.Utils.Array.unique(g),a.next=24,Nc({playerIds:m,limit:m.length});case 24:f=a.sent,m.forEach((function(t){var e=c()(f).call(f,(function(e){return e.playerId===t}));e&&0!==e.length||f.push({playerId:t,score:0})}));case 26:for(v={},y=Kc(f);!(S=y()).done;)E=S.value,x=E.playerId,b=E.score,T=E.rank,w=E.getPlayer(),M=w.getPhoto(),C=w.getName(),v[x]={playerId:x,name:C,photo:M,score:b,rank:T};s(Jc(v,e)),a.next=35;break;case 31:a.prev=31,a.t0=a.catch(0),s(Jc([],e)),(0,Ht.sendException)(a.t0);case 35:case"end":return a.stop()}}),a,null,[[0,31]])})));return function(t,e){return a.apply(this,arguments)}}()},Jc=function(t,e){return{type:Fa,payload:{leaders:t,type:e}}},Qc=function(){return{type:Na,payload:{}}},$c={targets:[],props:{alpha:{duration:500,value:{start:0,from:0,to:1},ease:Phaser.Math.Easing.Cubic.Out},scale:{duration:1e3,value:{start:.8,from:.8,to:1},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}},tl=function(t){function e(e){return t.call(this,$c,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),el=tl,nl={targets:[],props:{alpha:{start:0,to:1,duration:500,ease:Phaser.Math.Easing.Cubic.Out},scale:{start:.8,to:1,duration:1e3,ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]},y:{start:0,to:0,duration:500,ease:Phaser.Math.Easing.Back.Out}},delay:0},il=function(t){function e(e){return t.call(this,nl,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),al=il,sl={targets:[],duration:600,ease:Phaser.Math.Easing.Linear,props:{angle:{from:0,to:360}}},rl=function(t){function e(e){return t.call(this,sl,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),ol=rl,hl=or.default.DEFAULT,cl=hl.KEY,ll=hl.FRAME,ul=function(t){function e(e){var n;return(n=t.call(this,e,0,0,cl,ll.PRELOADER)||this).anim=void 0,n.runAnimation(),n.setWorldSize(80,80),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnimation=function(){var t;null==(t=this.anim)||t.remove(),this.anim=new ol({targets:[this],repeat:-1,duration:1200}),this.anim.play()},n.setVisible=function(e){return t.prototype.setVisible.call(this,e),e?this.runAnimation():this.anim.stop(),this},e}(Phaser.GameObjects.Image),dl=ul,pl=function(t){function e(e,n){var i;(i=t.call(this,e)||this).payload=void 0,i.loading=void 0,i.photo=void 0,i.avtFrame=void 0,i.background=void 0,i.loadPhotoTimer=void 0,i.handleLoadPhotoAfterDelay=function(t,e){return function(){var n=i.scene.textures.get(t);n&&n.key===t?i.handleLoadComplete(t):(i.scene.load.once("filecomplete-image-"+t,i.handleLoadComplete),i.scene.load.image(t,e),i.scene.load.start())}},i.handleLoadComplete=function(t){if(i.scene){var e=i.payload,n=e.id,a=e.radius,s=void 0===a?0:a;if(n&&n===t){var r=n+"_bordered_"+s,o=s>0?r:n,h=i.scene.textures.get(o);if(h&&h.key===o)i.setPhoto(h.key);else if(0!=s&&s<100){if(!GameCore.Utils.Image.drawBorder({scene:i.scene,key:n,newKey:r,radius:s}))return void i.showLoading(!1);i.setPhoto(r)}else if(100==s){if(!GameCore.Utils.Image.drawCircle({scene:i.scene,key:n,newKey:r}))return void i.showLoading(!1);i.setPhoto(r)}else i.setPhoto(n)}}},i.handleLoadPhotoFailed=function(t){t.key===i.payload.id&&i.setDefaultAvatar(t.key)},i.scene.add.existing((0,nr.default)(i)),i.payload=n,i.setSize(n.width,n.height),i.createBackground(),i.createLoading(),i.createPhoto(),i.createFrame();var a=i.payload,s=a.id,r=a.url,o=a.radius;return s&&r&&i.loadPhoto(s,r,o),i.addDefaultListeners(),i}(0,Kt.default)(e,t);var n=e.prototype;return n.setFrame=function(t){this.avtFrame.setFrame(t),this.avtFrame.setVisible(!0)},n.setBackground=function(t){this.background.setFrame(t)},n.loadPhoto=function(t,e,n){var i;if(void 0===n&&(n=0),this.payload.id=t,this.payload.url=e,this.payload.radius=n,null==(i=this.loadPhotoTimer)||i.remove(),t&&e){var a=this.scene.textures.get(t);if(a&&a.key===t)this.handleLoadComplete(t);else{this.showLoading(!0);var s=this.payload.loadDelay||0;this.loadPhotoTimer=this.scene.time.delayedCall(s,this.handleLoadPhotoAfterDelay(t,e))}}else this.setPhoto(Bs.default.AVATAR.KEY)},n.addDefaultListeners=function(){var t=this;this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadPhotoFailed),this.on(Phaser.GameObjects.Events.DESTROY,(function(){var e;null==(e=t.loadPhotoTimer)||e.remove(),t.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,t.handleLoadPhotoFailed)}))},n.setDefaultAvatar=function(t){this.loadPhoto(t,Bs.default.AVATAR.FILE,this.payload.radius)},n.createBackground=function(){var t=this.payload,e=t.key,n=t.background,i=t.borderWidth,a=void 0===i?0:i;this.background=this.scene.make.image({key:e,frame:n}),this.background.setWorldSize(this.width-a,this.height-a),this.add(this.background)},n.createLoading=function(){this.loading=new dl(this.scene),this.loading.setWorldSize(.75*this.width,.75*this.height),this.loading.setVisible(!1),this.add(this.loading)},n.createPhoto=function(){this.photo=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.photo)},n.createFrame=function(){var t=this.payload,e=t.key,n=t.frame,i=t.width,a=t.height;n?(this.avtFrame=this.scene.make.image({key:e,frame:n}),this.avtFrame.setWorldSize(i,a)):this.avtFrame=this.scene.make.image({x:0,y:0,origin:{x:.5,y:.5},visible:!1}),this.add(this.avtFrame)},n.showLoading=function(t){this.photo.setVisible(!t),this.loading.setVisible(t)},n.setPhoto=function(t){this.showLoading(!1),this.photo.setTexture(t),this.photo.setFrame(0);var e=this.payload,n=e.width,i=e.height,a=Math.min(n,i)-(this.payload.borderWidth||8);this.photo.setWorldSize(a,a),Phaser.Display.Align.In.Center(this.photo,this.background)},e}(Phaser.GameObjects.Container),fl=pl,gl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidContextId",i.message=e||"This contextId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),ml=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="NewScoreIsBad",i.message=e||"The new score is bad",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),vl=function(t){return t.match},yl=(0,be.createSelector)([function(t){return vl(t).gameplay.mode}],(function(t){return t})),Sl=((0,be.createSelector)([function(t){return vl(t).gameplay.status}],(function(t){return t})),(0,be.createSelector)([function(t){return vl(t).gameplay.rescued}],(function(t){return t}))),Al=(0,be.createSelector)([function(t){return vl(t).gameplay.startAt}],(function(t){return t})),El=(0,be.createSelector)([function(t){return vl(t).gameplay.finishAt}],(function(t){return t})),xl=(0,be.createSelector)([function(t){return vl(t).gameplay.showMiniJourney}],(function(t){return t})),bl=GameCore.Configs,Tl=bl.AppId,wl=bl.OtherHost,Ml=bl.LeadersBoard,Cl=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={appId:Tl,resetScore:0,numberOfLeaders:15,timezone:"utc+0",sortOrder:"desc",statistics:"max",resettable:"manually",description:"no description"},!Ml.UseMock){t.next=5;break}return t.next=4,(0,Ge.sleepAsync)(1e3);case 4:return t.abrupt("return",(0,wt.default)({},n,e,{_id:Ml.LeaderboardId,type:"app_leaderboard",description:"mockup_leaderboard",createdAt:new Date(Date.now()).toISOString(),updatedAt:new Date(Date.now()).toISOString()}));case 5:return"leaderboards",t.next=8,je("leaderboards",(0,wt.default)({},n,e),{},wl);case 8:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Pl=(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d,p,f;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n={}),i=[],!Ml.UseMock){t.next=7;break}return t.next=5,(0,Ge.sleepAsync)(1e3);case 5:return o=(r=n).limit,h=void 0===o?10:o,c=r.offset,l=void 0===c?0:c,t.abrupt("return",De()(a=A()(s=new Array(h)).call(s,null)).call(a,(function(t,e){var n=(e+1)*(l+1);return{playerId:"player-0"+n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.jpg",rank:n,score:Math.floor(1e5/n+1e4*Math.random())}})));case 7:return u=GameCore.Utils.String.params(n),d="leaderboards/"+e+"/leaders",t.next=11,Ke(d+"?"+u,{},wl);case 11:if((p=t.sent)&&(null==p||!p.error)){t.next=14;break}throw new Error((null==p?void 0:p.error)||"Leaderboard not found");case 14:if(!((f=(null==p?void 0:p.data)||[]).length<1)){t.next=17;break}return t.abrupt("return",i);case 17:return i=f,t.abrupt("return",i);case 19:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i){var a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je("leaderboards/"+e+"/players/"+n,{score:i},{},wl);case 2:return a=t.sent,t.abrupt("return",(null==a?void 0:a.data)||{});case 4:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}()),Il=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="CurrentTournamentScoreIsNotBest",i.message=e||"The new score is not best",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),kl=GameCore.Configs.Tournament.UseLeaderboard,Rl=function(t){return{type:Ca,payload:{tournamentId:t}}},Ol=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,h,c,l,u;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game.facebook,a=t.playerId,s=t.playerName,r=t.score,o=t.autoStartGame,h=s+"'s Tournament",c=GameCore.Utils.String.generateObjectId(),e.next=7,i.tournament.createAsync({initialScore:r,config:{title:h,tournamentTitle:h},data:{playerId:a,playerName:s,leaderboardId:c}});case 7:return l=e.sent,u=l.getID(),o&&(n(Rl(u)),n(Od())),e.next=12,Cl({_id:c,createdBy:a,name:u,description:h,expireTime:6048e5});case 12:if(e.sent._id!==c){e.next=16;break}return e.next=16,Pl(c,a,r);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),(0,Ht.sendException)(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}()},_l=function(t){return(0,Xt.default)(qt().mark((function e(){var n,i,a,s,r;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.game.facebook,i=t.playerId,a=t.playerName,s=t.leaderboardId,r=t.score,s&&Pl(s,i,r),e.next=5,n.tournament.shareAsync({score:r,data:{type:Os,playerId:i,playerName:a}});case 5:Pl(s,i,r);case 6:case"end":return e.stop()}}),e)})))},Dl=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.game.facebook,t.next=4,e.getTournamentAsync();case 4:return n=t.sent,i=JSON.parse(n.getPayload()||"{}"),t.abrupt("return",i.leaderboardId);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),Bl=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=window.game.facebook,t.next=4,e.getTournamentAsync();case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),Ll=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r,o,h,c,l,d,p,f,g,m,v,y;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,s=window.game,r=s.player,o=s.facebook,h=s.analytics,e.prev=2,l=i(),d=yl(l),u()(c=[Fs,Us]).call(c,d)){e.next=7;break}return e.abrupt("return");case 7:return n({type:Pa,payload:{}}),p=r.getPlayer(),f=p.playerId,g=p.name,e.next=11,Bl();case 11:if(!e.sent){e.next=23;break}if(a=ni.AnalyticsEvents.TOURNAMENT_SHARE,!kl){e.next=21;break}return e.next=17,Dl();case 17:return m=e.sent,v={playerId:f,playerName:g,score:t,leaderboardId:m},e.next=21,n(_l(v));case 21:e.next=28;break;case 23:if(a=ni.AnalyticsEvents.TOURNAMENT_CREATE,!kl){e.next=28;break}return y={playerId:f,playerName:g,score:t,autoStartGame:!1},e.next=28,n(Ol(y));case 28:if(h.event(a,{success:!0}),!1!==kl){e.next=32;break}return e.next=32,o.requestTournamentAsync(t);case 32:n(Fl(t)),e.next=40;break;case 35:if(e.prev=35,e.t0=e.catch(2),!(e.t0 instanceof Il)){e.next=39;break}return e.abrupt("return");case 39:a&&h.event(a,{success:!1});case 40:case"end":return e.stop()}}),e,null,[[2,35]])})));return function(t,n){return e.apply(this,arguments)}}()},Fl=function(t){return{type:Ia,payload:{score:t}}},Nl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidOpponentId",i.message=e||"This opponentId is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Gl=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="WideFrameRenderFail",i.message=e||"Wide frame render fail",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ul={PASS_LEVELS:{ID:"pass-levels",EVENTS:{PASS_LEVEL:"pass-level"}},COLLECT_DIAMONDS:{ID:"collect-diamonds",EVENTS:{COLLECT_DIAMONDS:"collect-diamonds"}},INVITE_FRIENDS:{ID:"invite-friends",EVENTS:{INVITED_FRIEND:"INVITED_FRIEND"}},REACH_SCORE:{ID:"reach-score",EVENTS:{ADD_SCORE:"add-score"}},EVENTS:{TASKS_RESET:"tasks-reset",NOTICE_UPDATE:"notice-update"}},Vl=function(t,e){return e.playerId},Yl=((0,be.createSelector)([function(t){return vl(t).match.isRequesting}],(function(t){return t})),(0,be.createSelector)([function(t){return vl(t).match.single}],(function(t){return t}))),zl=(0,be.createSelector)([function(t){return vl(t).match.single._id}],(function(t){return t})),Hl=(0,be.createSelector)([function(t){return vl(t).match.single.score}],(function(t){return t||0})),Wl=((0,be.createSelector)([function(t){return vl(t).match.single.level}],(function(t){return t||0})),(0,be.createSelector)([function(t){var e;return null==(e=vl(t).match.single.data)?void 0:e.diamond}],(function(t){return t||0})),(0,be.createSelector)([function(t){var e;return null==(e=vl(t).match.single.data)?void 0:e.fen}],(function(t){return t||null})),(0,be.createSelector)([function(t){return vl(t).match.single.status}],(function(t){return t})),(0,be.createSelector)([function(t){return vl(t).match.single.playerId}],(function(t){return t})),(0,be.createSelector)([function(t){return vl(t).match.challenge}],(function(t){return t}))),Xl=(0,be.createSelector)([function(t){return vl(t).match.challenge._id}],(function(t){return t})),Kl=(0,be.createSelector)([function(t){return vl(t).match.challenge.status}],(function(t){return t})),jl=(0,be.createSelector)([function(t){return vl(t).match.challenge.opponentInfo}],(function(t){return t})),ql=((0,be.createSelector)([function(t){return vl(t).match.challenge.whitePlayerId}],(function(t){return t})),(0,be.createSelector)([function(t){return vl(t).match.challenge.blackPlayerId}],(function(t){return t})),(0,be.createSelector)([Wl,Vl],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId;return n!==e&&i===e?n:i!==e&&n===e?i:""})),(0,be.createSelector)([Wl,Vl],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId;return n===e?n:i===e?i:Ls.playerId}))),Zl=(0,be.createSelector)([Wl,Vl],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId,a=t.whitePlayerFinish,s=t.blackPlayerFinish;return e&&n===e?a:!(!e||i!==e)&&s})),Jl=(0,be.createSelector)([Wl,function(t,e){return e.opponentId}],(function(t,e){var n=t.whitePlayerId,i=t.blackPlayerId,a=t.whitePlayerFinish,s=t.blackPlayerFinish;return e&&n===e?a:!(!e||i!==e)&&s})),Ql=(0,be.createSelector)([function(t){return vl(t).match.group.opponentInfo}],(function(t){return t})),$l=((0,be.createSelector)([function(t){return vl(t).match.online.players}],(function(t){return t})),(0,be.createSelector)([function(t){return vl(t).match.journey}],(function(t){return t}))),tu=(0,be.createSelector)([function(t){return vl(t).match.journey._id}],(function(t){return t})),eu=(0,be.createSelector)([function(t){return vl(t).match.journey.level}],(function(t){return t})),nu=(0,be.createSelector)([function(t){return vl(t).match.journey.score}],(function(t){return t})),iu=(0,be.createSelector)([function(t){return vl(t).stats.data}],(function(t){return t})),au=(0,be.createSelector)([function(t){return vl(t).stats.current}],(function(t){return t})),su=((0,be.createSelector)([function(t){return vl(t).stats.isRequesting}],(function(t){return t})),(0,be.createSelector)([function(t){return t.messages.data}],(function(t){return t}))),ru=(0,be.createSelector)([su,function(t,e){return e.opponentId}],(function(t,e){return!!GameCore.Utils.Valid.isString(e)&&(!!GameCore.Utils.Object.hasOwn(t,e)&&t[e].sent)})),ou=n(463),hu=new(n.n(ou)()),cu=n(354),lu=n.n(cu),uu=function(t){if("string"!==typeof t||!t)throw new Gl(null,{imageShare:t})},du=function(){return(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.analytics,a=e.facebook,s=e.globalScene,r=e.lang,t.prev=1,s.screen.open(cr,{message:r.Text.LOADING,loading:!0}),t.next=5,pu();case 5:return o=t.sent,uu(o),h=n.getPlayer(),c=h.playerId,l=h.name,u=h.photo,t.next=10,a.shareAsync({text:r.Text.SHARE_BEST_SCORE,intent:"SHARE",image:o||"",data:{playerId:c,playerName:l,playerPhoto:u,type:ks}});case 10:i.event(ni.AnalyticsEvents.SHARE,{share_content_type:"BestScore",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.SHARE,{share_content_type:"BestScore",success:!1}),(0,Ht.sendException)(t.t0);case 17:return t.prev=17,s.screen.close(cr),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})))},pu=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,h,c,l;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.game,n=e.player,i=e.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=a.data,h=(o||{}).score,c=gu({playerId:s,playerPhoto:r,playerScore:h})){t.next=7;break}return t.abrupt("return");case 7:return l={name:"share-best-score",width:952,height:492,renderOptions:c},t.next=10,i.frameCapture.capture(l);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),fu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u,d,p;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=au(e),r=iu(e),o=i.getPlayer(),h=o.playerId,c=o.photo,l=r[h]||{},u=l.score,s.bestScore>u&&(u=s.bestScore),d=gu({playerId:h,playerPhoto:c,playerScore:u})){t.next=10;break}return t.abrupt("return");case 10:return p={name:"share-current-score",width:952,height:492,renderOptions:d},t.next=13,a.frameCapture.capture(p);case 13:return t.abrupt("return",t.sent);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),gu=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:635,y:122,image:a,width:210,height:210,fallbackWithImage:Bs.default.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},mu=(function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,h,c,l,u,d,p,f,g,m,v,y,S,A;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.profile,a=e.globalScene,s=n.getPlayer(),r=s.playerId,o=s.name,h=s.photo,(c=n.getConnectedPlayerIds(99,0)).push(r),l=[],t.next=7,Nc({playerIds:GameCore.Utils.Array.unique(c),limit:c.length});case 7:u=t.sent,d=GameCore.Utils.Object.keyBy(u,"playerId"),p={playerId:r,name:o,photo:h,score:0},GameCore.Utils.Object.hasOwn(d,r)&&(p=d[r]),l.push(p),t.t0=lu()(qt()).call(qt(),d);case 14:if((t.t1=t.t0()).done){t.next=27;break}if(f=t.t1.value,!GameCore.Utils.Object.hasOwn(d,f)){t.next=25;break}if(g=d[f],3!==l.length){t.next=20;break}return t.abrupt("break",27);case 20:if(g.playerId!==r){t.next=22;break}return t.abrupt("continue",14);case 22:if(!(Number(g.score)>Number(p.score))){t.next=24;break}return t.abrupt("continue",14);case 24:l.push(g);case 25:t.next=14;break;case 27:return m=GameCore.Utils.Array.unique(c),t.next=30,i.requestProfiles(m);case 30:if(v=i.getProfiles(),l.forEach((function(t,e){var n=t.playerId;if(GameCore.Utils.Object.hasOwn(v,n)){var i=v[n],a=i.name,s=i.photo;l[e].name=a,l[e].photo=s}})),l.length<3)for(y=0;y<=3-l.length;)l.push({playerId:"bot"+y,name:"???",score:0,photo:"./assets/images/others/avatar.png"}),y++;if(S=mu({playerId:r,playerName:o,playerPhoto:h,listLeaders:l})){t.next=37;break}return t.abrupt("return");case 37:return A={name:"share-leaderboard",width:1500,height:2e3,renderOptions:S},t.next=40,a.frameCapture.capture(A);case 40:return t.abrupt("return",t.sent);case 41:case"end":return t.stop()}}),t)})))}(),function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.listLeaders,r=void 0===s?[]:s;if(!Array.isArray(r))return null;if("string"!==typeof n)return null;if("string"!==typeof a)return null;var o={avatar:{name:""+n,type:"image",x:490,y:250,image:a,width:525,height:525,fallbackWithImage:Bs.default.AVATAR.KEY}};return r.forEach((function(t,e){var n=t.playerId,i=t.photo;o["photo_"+n]={name:""+n,type:"image",x:475,y:1215+385*e,image:i,width:150,height:150,fallbackWithImage:Bs.default.AVATAR.KEY}})),o.wideFrame={name:"wide-frame-share",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-share.png",width:1500,height:2e3},r.forEach((function(t,e){var n=t.playerId,i=t.name,a=t.score;o["name_"+n]={type:"text",x:690,y:1312+193*e,font:"600 60px",text:i,fillStyle:"#b18151"},o["score_"+n]={type:"text",x:1070,y:1312+193*e,font:"600 55px",text:a,fillStyle:"#b18151"}})),o}),vu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u,d,p,f,g,m,v,y,S;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=iu(e),r=i.getPlayer(),o=r.photo,h=r.playerId,c=jl(e),l=c.playerId,u=c.photo,d=Zl(e,{playerId:h}),p=Jl(e,{opponentId:l}),f=s[h]||{},g=f.score,m=s[l]||{},v=m.score,y=Su({playerId:h,playerPhoto:o,playerScore:g,opponentId:l,opponentPhoto:u,opponentScore:v,isPlayerFinished:d,isOpponentFinished:p})){t.next=12;break}return t.abrupt("return");case 12:return S={name:"share-game-result",width:952,height:492,renderOptions:y},t.next=15,a.frameCapture.capture(S);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),yu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u,d,p,f,g,m;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.game,i=n.player,a=n.globalScene,s=iu(e),r=i.getPlayer(),o=r.photo,h=r.playerId,c=Ql(e),l=c.playerId,u=c.photo,d=c.score,p=s[h]||{},f=p.score,g=Su({playerId:h,playerPhoto:o,playerScore:f,opponentId:l,opponentPhoto:u,opponentScore:d})){t.next=9;break}return t.abrupt("return");case 9:return m={name:"share-group-match-result",width:952,height:492,renderOptions:g},t.next=12,a.frameCapture.capture(m);case 12:return t.abrupt("return",t.sent);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Su=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.playerScore,r=void 0===s?0:s,o=t.opponentId,h=void 0===o?"20":o,c=t.opponentPhoto,l=void 0===c?"":c,u=t.opponentScore,d=void 0===u?0:u,p=t.isPlayerFinished,f=t.isOpponentFinished;if("string"!==typeof n)return null;if("string"!==typeof a)return null;if("number"!==typeof r)return null;if("string"!==typeof h)return null;if("string"!==typeof l)return null;if("number"!==typeof d)return null;if("boolean"!==typeof p)return null;if("boolean"!==typeof f)return null;var g=r===d,m=r>d,v=p||f,y=p&&f,S={leftPhoto:{name:""+n,type:"image",x:55,y:162,image:a,width:200,height:200,fallbackWithImage:Bs.default.AVATAR.KEY},rightPhoto:{name:""+h,type:"image",x:702,y:162,image:l,width:200,height:200,fallbackWithImage:Bs.default.AVATAR.KEY},wideFrame:{name:"wide-frame-game-result",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-game-result.png",width:952,height:492}};return v&&(S.leftScoreShadow={type:"text",x:148,y:443,font:"600 70px",fillStyle:"#c4683f",text:p?""+r:"???",textAlign:"center"},S.leftScore={type:"text",x:148,y:443,font:"600 70px",fillStyle:"#f2a62e",text:p?""+r:"???",textAlign:"center"},S.rightScoreShadow={type:"text",x:795,y:443,font:"600 70px",fillStyle:"#c4683f",text:f?""+d:"???",textAlign:"center"},S.rightScore={type:"text",x:795,y:443,font:"600 70px",fillStyle:"#f2a62e",text:f?""+d:"???",textAlign:"center"}),!g&&y&&(m?S.leftCrown={name:"crown-icon",type:"image",x:12,y:122,image:"./assets/images/others/crown-icon.png",width:106,height:78}:S.rightCrown={name:"crown-icon",type:"image",x:665,y:122,image:"./assets/images/others/crown-icon.png",width:106,height:78}),S},Au=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game,i=n.player,a=n.analytics,s=n.facebook,r=n.globalScene,t.prev=1,r.screen.open(cr,{message:"Loading...",loading:!0}),t.next=5,Eu();case 5:return o=t.sent,uu(o),h=i.getPlayer(),c=h.playerId,l=h.name,u=h.photo,t.next=10,s.shareAsync({text:"Great! I have a score!",intent:"SHARE",image:o||"",data:{playerId:c,playerName:l,playerPhoto:u,type:ks}});case 10:a.event(ni.AnalyticsEvents.SHARE,{share_content_type:"Score",success:!0}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),a.event(ni.AnalyticsEvents.SHARE,{share_content_type:"Score",success:!1}),(0,Ht.sendException)(t.t0);case 17:return t.prev=17,r.screen.close(cr),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[1,13,17,20]])})));return function(e){return t.apply(this,arguments)}}()},Eu=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.game,n=e.player,i=e.globalScene,a=n.getPlayer(),s=a.playerId,r=a.photo,o=n.getBestScore(),h=xu({playerId:s,playerPhoto:r,playerScore:o})){t.next=7;break}return t.abrupt("return");case 7:return c={name:"share-score",width:952,height:492,renderOptions:h},t.next=10,i.frameCapture.capture(c);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),xu=function(t){var e=t.playerId,n=void 0===e?"10":e,i=t.playerPhoto,a=void 0===i?"":i,s=t.playerScore,r=void 0===s?0:s;return"string"!==typeof n||"string"!==typeof a||"number"!==typeof r?null:{avatar:{name:""+n,type:"image",x:635,y:122,image:a,width:210,height:210,fallbackWithImage:Bs.default.AVATAR.KEY},wideFrame:{name:"wide-frame-message-win",type:"image",x:0,y:0,image:"./assets/wideframes/wide-frame-message-win.png",width:952,height:492},playerScoreShadow:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#c4683f",text:""+r,textAlign:"center"},playerScore:{type:"text",x:740,y:437,font:"600 70px",fillStyle:"#f2a62e",text:""+r,textAlign:"center"}}},bu=function(t){var e=t.contextId;if(""===e||"string"!==typeof e)throw new gl(null,{contextId:e})},Tu=function(t){var e=t.opponentId,n=t.contextId;if(""===e||"string"!==typeof e)throw new Nl(null,{opponentId:e});if(""===n||"string"!==typeof n)throw new gl(null,{contextId:n})},wu=function(t){if(null===t.imageShare)throw new Gl},Mu=function(t,e){return void 0===e&&(e=!0),function(n,i){var a,s=i(),r=su(s);if(e){var o;if(null!=(o=r[t])&&o.sent)return;n(Cu(t))}null!=(a=r[t])&&a.sent&&n(Pu(t))}},Cu=function(t){return{type:gi,payload:{opponentId:t}}},Pu=function(t){return{type:mi,payload:{opponentId:t}}},Iu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game.facebook,Tu({opponentId:e,contextId:n}),(a=window.game.facebook.getContextID())!==n||""===n){t.next=6;break}return t.abrupt("return",a);case 6:if("10"!==e||""===n){t.next=8;break}return t.abrupt("return",n);case 8:if(!n){t.next=12;break}return t.next=11,i.switchAsync(n);case 11:return t.abrupt("return",window.game.facebook.getContextID());case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 17:return t.abrupt("return","");case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}(),ku=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,u,d,p,f,g,m,v;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,h=s.facebook,n.prev=1,c=e.matchId,l=e.contextId,n.next=5,Iu(t,l);case 5:return u=n.sent,bu({contextId:u}),d=a(),n.next=10,vu(d);case 10:return p=n.sent,wu({imageShare:p}),f=r.getPlayer(),g=f.name,m=f.playerId,v=window.game.lang.getText({key:"MESSAGE_INVITE",variables:[g]}),n.next=16,h.sendMessage({cta:"Play",text:v,image:p||"",template:"challenge",data:{type:_s,matchId:c,playerId:m,opponentId:t,status:Ea}});case 16:i(Mu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"Invite",success:!0}),hu.emit(Ul.INVITE_FRIENDS.EVENTS.INVITED_FRIEND,{type:"friend",value:1,opponentId:t}),n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"Invite",success:!1}),(0,Ht.sendException)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[1,21]])})));return function(t,e){return n.apply(this,arguments)}}()},Ru=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,u,d,p,f,g,m,v;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,h=s.facebook,n.prev=1,c=e.matchId,l=e.contextId,n.next=5,Iu(t,l);case 5:return u=n.sent,bu({contextId:u}),d=a(),n.next=10,vu(d);case 10:return p=n.sent,wu({imageShare:p}),f=r.getPlayer(),g=f.name,m=f.playerId,v=window.game.lang.getText({key:"MESSAGE_FINISH_MATCH",variables:[g]}),n.next=16,h.sendMessage({cta:"See result",text:v,image:p||"",template:"finished",data:{type:_s,matchId:c,playerId:m,opponentId:t,status:xa}});case 16:i(Mu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishMatch",success:!0}),n.next=24;break;case 20:n.prev=20,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishMatch",success:!1}),(0,Ht.sendException)(n.t0);case 24:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(t,e){return n.apply(this,arguments)}}()},Ou=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,h=s.facebook,n.prev=1,c=e.matchId,l=e.contextId,n.next=5,Iu(t,l);case 5:return u=n.sent,bu({contextId:u}),d=a(),n.next=10,vu(d);case 10:return p=n.sent,wu({imageShare:p}),f=r.getPlayer(),g=f.name,m=f.playerId,v=iu(d),y=v[m]||{},S=y.score,A=void 0===S?0:S,E=window.game.lang.getText({key:"MESSAGE_BEST_SCORE",variables:[g,A]}),n.next=18,h.sendMessage({cta:"See result",text:E,image:p||"",template:"pass_score",data:{type:_s,matchId:c,playerId:m,opponentId:t,status:xa}});case 18:i(Mu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"BestScore",success:!0}),n.next=26;break;case 22:n.prev=22,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"BestScore",success:!1}),(0,Ht.sendException)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,22]])})));return function(t,e){return n.apply(this,arguments)}}()},_u=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,u,d,p,f,g,m,v,y;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=window.game,r=s.player,o=s.analytics,h=s.facebook,n.prev=1,c=e.matchId,l=e.contextId,u=e.score,n.next=5,Iu(t,l);case 5:return d=n.sent,bu({contextId:d}),p=a(),n.next=10,vu(p);case 10:return f=n.sent,wu({imageShare:f}),g=r.getPlayer(),m=g.name,v=g.playerId,y=window.game.lang.getText({key:"MESSAGE_FINISH_TURN",variables:[m,u]}),n.next=16,h.sendMessage({cta:"Play",text:y,image:f||"",template:"play_turn",data:{type:_s,matchId:c,playerId:v,opponentId:t,status:Ea}});case 16:i(Mu(t)),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishTurn",success:!0}),n.next=26;break;case 20:if(n.prev=20,n.t0=n.catch(1),o.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"FinishTurn",success:!1}),!(n.t0 instanceof gl)){n.next=25;break}return n.abrupt("return");case 25:(0,Ht.sendException)(n.t0);case 26:case"end":return n.stop()}}),n,null,[[1,20]])})));return function(t,e){return n.apply(this,arguments)}}()},Du=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.player,s=i.facebook,r=a.getPlayer(),o=r.playerId,h=r.name,c=r.photo,l=au(n),u=l.score,d={type:Ds,playerId:o,playerName:h,playerPhoto:c,playerScore:u},t.next=7,s.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i"}},text:{default:h+" beats your high score. Their score: "+u+".",localizations:{en_US:h+" beats your high score. Their score: "+u+".",vi_VN:h+" v\u1eeba v\u01b0\u1ee3t \u0111i\u1ec3m s\u1ed1 cao nh\u1ea5t c\u1ee7a b\u1ea1n! Ch\u01a1i l\u1ea7n n\u1eefa ch\u1ee9?"}},image:e||"",template:"play_turn",data:d});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}(),Bu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,s=i.facebook,t.prev=1,r=a.getPlayer(),o=r.playerId,h=r.name,c=r.photo,l=au(n),u=l.score,d={type:Ds,playerId:o,playerName:h,playerPhoto:c,playerScore:u},t.next=7,s.sendMessage({cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:h+" got "+u+" scores. So easy! Can you?",localizations:{en_US:h+" got "+u+" scores. So easy! Can you?",vi_VN:h+" \u0111\xe3 \u0111\u1ea1t "+u+" \u0111i\u1ec3m! Qu\xe1 d\u1ec5 lu\xf4n. Ch\u01a1i l\u1ea1i n\xe0o!"}},image:e||"",template:"play_turn",data:d});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),(0,Ht.sendException)(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}(),Lu=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidMatchId",i.message=e||"Invalid match id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Fu=[{key:"level-0",mapJson:"./assets/json/levels/level-0.json"}],Nu=1;Nu<=100;Nu++)Fu.push({key:"level-"+Nu,mapJson:"./assets/json/levels/level-"+Nu+".json"});var Gu=Fu,Uu=GameCore.Configs.ApiHost,Vu=(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single-matches",t.next=3,je("single-matches",e,{},Uu);case 3:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"single-matches/active",t.next=3,Ke("single-matches/active",{},Uu);case 3:return e=t.sent,t.abrupt("return",(null==e?void 0:e.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="single-matches/"+e+"/move",t.next=3,je(i,n,{},Uu);case 3:return a=t.sent,t.abrupt("return",(null==a?void 0:a.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="single-matches/"+e+"/finish",t.next=3,je(n,{},{},Uu);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})))}(),function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"matches",t.next=3,je("matches",{opponentPlayerId:e},{},Uu);case 3:return n=t.sent,t.abrupt("return",(null==n?void 0:n.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Yu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="matches/"+e+"/join",t.next=3,je(n,{},{},Uu);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),zu=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="matches/"+e,t.next=3,Ke(n,{},Uu);case 3:return i=t.sent,t.abrupt("return",(null==i?void 0:i.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Hu=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s="matches/"+e+"/finish",t.next=3,je(s,{matchId:e,score:n,level:i,extraData:a},{},Uu);case 3:return r=t.sent,t.abrupt("return",(null==r?void 0:r.data)||{});case 5:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),Wu=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidMatchStatus",i.message=e||"The match status is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Xu=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidOpponentId",i.message=e||"Invalid opponent id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ku=Xu,ju=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidBlackPlayerId",i.message=e||"Invalid black player id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),qu=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidRequestedMatchId",i.message=e||"The matchId in match data not matched with requested matchId",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Zu=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidScore",i.message=e||"The score is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Ju=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidWhitePlayerId",i.message=e||"Invalid white player id",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),Qu=function(t){var e=t.matchId,n=t.score;if(""===e||"string"!==typeof e)throw new Lu(null,{matchId:e});if("number"!==typeof n)throw new Zu(null,{score:n})},$u=function(t){var e=t.matchId,n=t.currentMatchId;if(""===e||"string"!==typeof e)throw new Lu(null,{matchId:e});if(""===n||"string"!==typeof n)throw new Lu(null,{currentMatchId:n});if(e!==n)throw new qu(null,{matchId:e,currentMatchId:n})},td=function(t){var e=t.matchId,n=t.currentMatchId;if(""===e||"string"!==typeof e)throw new Lu(null,{matchId:e});if(""===n||"string"!==typeof n)throw new Lu(null,{currentMatchId:n});if(e!==n)throw new qu(null,{matchId:e,currentMatchId:n})},ed=function(t){var e=t.playerId,n=t.match,i=n._id,a=n.playerId,s=n.status;if(""===i||"string"!==typeof i)throw new Lu(null,{matchId:i});if("finished"===s||"string"!==typeof s)throw new Wu("This match is finished",{status:s});if(a!==e)throw new Is(null,{playerId:a,currentPlayerId:e})},nd=function(t){var e=t.opponentId;if(""===e||"string"!==typeof e)throw new Ku(null,{opponentId:e})},id=function(t){var e=t.matchId;if(""===e||"string"!==typeof e)throw new Lu(null,{matchId:e})},ad=function(t){var e=t.match,n=e._id,i=e.whitePlayerId,a=e.blackPlayerId;if(""===n||"string"!==typeof n)throw new Lu(null,{matchId:n});if(""===i||"string"!==typeof i)throw new Ju(null,{whitePlayerId:i});if(""===a||"string"!==typeof a)throw new ju(null,{blackPlayerId:a})},sd=GameCore.Configs.Match,rd=function(t){try{return GameCore.Utils.Hash.stringToHash(_()(t))}catch(e){return""}},od=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}},hd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=window.game,i=n.player,a=n.globalScene,s=n.lang,a.screen.open(cr,{message:s.Text.LOADING,loading:!0}),e({type:Ji,payload:{}}),r=i.getPlayerId(),o=(0,wt.default)({},sd.LocalSingleMatchDefault,{status:"active",playerId:r,startedAt:Date.now(),rescued:0}),ed({playerId:r,match:o}),e(ud(o)),Le(sd.SingleMatchStore,o),t.next=19;break;case 11:if(t.prev=11,t.t0=t.catch(0),e(ud(null)),!(t.t0 instanceof Lu)){t.next=16;break}return t.abrupt("return");case 16:if(!(t.t0 instanceof Wu)){t.next=18;break}return t.abrupt("return");case 18:(0,Ht.sendException)(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},cd=function(t,e){return function(n,i){try{Qu((0,wt.default)({matchId:t},e));var a=i(),s=tu(a);$u({matchId:t,currentMatchId:s}),n({type:aa,payload:{match:e}});var r=e.data;e.data=rd(r);var o=window.game.player;Le(sd.JourneyMatchStore+"-"+o.getPlayerId(),e)}catch(h){if(h instanceof Lu)return;(0,Ht.sendException)(h)}}},ld=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n,i){var a,s,r,o,h,c,l,u;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=window.game.player,id({matchId:t}),s=i(),r=zl(s),o=a.getPlayerId(),td({matchId:t,currentMatchId:r}),n({type:"MATCH_SINGLE_FINISH_REQUEST",payload:{matchId:t}}),h=Yl(s),ed({playerId:o,match:h}),c=(0,wt.default)({},sd.LocalSingleMatchDefault,h,{_id:t,status:"finished",playerId:o,finishAt:Date.now()}),n(ud(c)),l=c.data,(u=(0,wt.default)({},c)).data=rd(l),Le(sd.SingleMatchStore,u),e.next=26;break;case 18:if(e.prev=18,e.t0=e.catch(0),n(ud(null)),!(e.t0 instanceof Lu)){e.next=23;break}return e.abrupt("return");case 23:if(!(e.t0 instanceof Wu)){e.next=25;break}return e.abrupt("return");case 25:(0,Ht.sendException)(e.t0);case 26:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()},ud=function(t){return{type:ta,payload:{match:t}}},dd=function(t){return{type:sa,payload:{match:t}}},pd=function(){return{type:ea,payload:{}}},fd=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,h;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.profile,s=i.globalScene,r=i.lang,s.screen.open(cr,{message:r.Text.LOADING,loading:!0}),o=t.playerId,nd({opponentId:o}),n({type:ha,payload:{opponentInfo:t}}),e.next=8,Vu(o);case 8:return h=e.sent,ad({match:h}),e.next=12,a.requestProfiles([o]);case 12:n(yd(h)),e.next=23;break;case 15:if(e.prev=15,e.t0=e.catch(0),n(yd(null)),!(e.t0 instanceof Lu)){e.next=20;break}return e.abrupt("return");case 20:if(!(e.t0 instanceof Ku)){e.next=22;break}return e.abrupt("return");case 22:(0,Ht.sendException)(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},gd=function(t,e){return void 0===e&&(e=!0),function(){var n=(0,Xt.default)(qt().mark((function n(i){var a,s,r,o,h,c,l,u,d,p;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,s=a.player,r=a.profile,o=a.globalScene,e&&o.screen.open(cr,{message:"Loading...",loading:!0}),id({matchId:t}),i({type:oa,payload:{matchId:t}}),n.next=7,Yu(t);case 7:if(h=n.sent,ad({match:h}),c=h.status,l=h.whitePlayerId,u=h.blackPlayerId,c!==Ea){n.next=16;break}return d=s.getPlayerId(),p=d===l?u:l,n.next=16,r.requestProfiles([p]);case 16:i(yd(h)),n.next=25;break;case 19:if(n.prev=19,n.t0=n.catch(0),i(yd(null)),!(n.t0 instanceof Lu)){n.next=24;break}return n.abrupt("return");case 24:(0,Ht.sendException)(n.t0);case 25:case"end":return n.stop()}}),n,null,[[0,19]])})));return function(t){return n.apply(this,arguments)}}()},md=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i){var a,s,r,o,h,c,l,u,d;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a=window.game,s=a.player,a.globalScene.screen.open(cr,{message:"Loading...",loading:!0}),id({matchId:t}),i({type:la,payload:{matchId:t,opponentInfo:e}}),n.next=7,zu(t);case 7:r=n.sent,ad({match:r}),o=r.whitePlayerId,h=r.whitePlayerScore,c=r.blackPlayerScore,l=s.getPlayerId(),u=s.getPlayerData(),d=u.score,i(yd(r,{score:l===o?h:c,bestScore:d})),n.next=23;break;case 17:if(n.prev=17,n.t0=n.catch(0),i(yd(null)),!(n.t0 instanceof Lu)){n.next=22;break}return n.abrupt("return");case 22:(0,Ht.sendException)(n.t0);case 23:case"end":return n.stop()}}),n,null,[[0,17]])})));return function(t){return n.apply(this,arguments)}}()},vd=function(t,e,n){return function(){var i=(0,Xt.default)(qt().mark((function i(a){var s,r,o,h,c;return qt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,s=window.game,r=s.globalScene,o=s.lang,r.screen.open(cr,{message:o.Text.LOADING,loading:!0}),id({matchId:t}),a({type:ca,payload:{matchId:t,score:e,extraData:n}}),h=n.level,i.next=8,Hu(t,e,h,n);case 8:return c=i.sent,ad({match:c}),i.next=12,a(yd(c));case 12:i.next=20;break;case 14:if(i.prev=14,i.t0=i.catch(0),a(yd(null)),!(i.t0 instanceof Lu)){i.next=19;break}return i.abrupt("return");case 19:(0,Ht.sendException)(i.t0);case 20:case"end":return i.stop()}}),i,null,[[0,14]])})));return function(t){return i.apply(this,arguments)}}()},yd=function(t,e,n){return void 0===n&&(n=null),{type:ua,payload:{match:t,opponentInfo:e,current:n}}},Sd=function(t){return{type:pa,payload:{opponentInfo:t}}},Ad=function(t,e){return{type:ma,payload:{matchId:t,players:e}}},Ed=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,t.prev=2,e({type:Qi,payload:{}}),t.next=6,window.FBInstant.player.getDataAsync(["level"]);case 6:s=t.sent,r=s.level,o=Be(sd.JourneyMatchStore+"-"+a)||{},h=o.data,c=o.level,o.data=od(h),r!==c&&(o.data={}),(l=r||1)>Gu.length-1&&(l=Gu.length-1),u=(0,wt.default)({},o,{level:l,playerId:a}),e({type:aa,payload:{match:u}}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(2);case 21:case"end":return t.stop()}}),t,null,[[2,18]])})));return function(e){return t.apply(this,arguments)}}()},xd=function(t){return{type:ji,payload:{playerId:t}}},bd=function(t,e){return{type:qi,payload:{playerId:t,stats:e}}},Td=function(t){return{type:Zi,payload:{stats:t}}},wd=GameCore.Configs.Match,Md=[],Cd=function(t){var e=t.contextId;if(""===e||"string"!==typeof e)throw new gl(null,{contextId:e})},Pd=null,Id=function(t){clearTimeout(Pd),Pd=setTimeout((function(){window.game.globalScene.screen.close(cr)}),t)},kd=function(){return{type:Vi,payload:{}}},Rd=function(t){return{type:Ki,payload:{stateShowMiniJourney:t}}},Od=function(){return function(t){try{t(pd()),t(Yd(Us))}catch(e){(0,Ht.sendException)(e)}}},_d=function(){return function(t){try{t(pd()),t(Yd(Fs))}catch(e){(0,Ht.sendException)(e)}}},Dd=function(){return function(t){try{t(zd())}catch(e){(0,Ht.sendException)(e)}}},Bd=function(t,e){return void 0===t&&(t="10"),void 0===e&&(e=!1),function(n){try{n(Ld("reset",t,e))}catch(i){(0,Ht.sendException)(i)}}},Ld=function(t,e,n){return void 0===e&&(e="10"),void 0===n&&(n=!1),function(){var i=(0,Xt.default)(qt().mark((function i(a){var s,r,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E;return qt().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,s=window.game,r=s.player,o=s.facebook,h=s.globalScene,s.lang,h.screen.open(cr,{message:"Loading...",loading:!0}),c=t,l=o.contextType,e||(u=GameCore.Configs.PlayerIdMock,d=GameCore.Configs.PlayerIdMock2,e=r.getPlayerId()===u?d:u),t){i.next=15;break}return i.next=9,o.chooseAsync();case 9:if(!1!==(c=i.sent)){i.next=13;break}return n&&h.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.DASHBOARD_SCENE),i.abrupt("return");case 13:i.next=25;break;case 15:if(!e||e===Ls.playerId){i.next=23;break}return i.next=18,o.createAsync(e);case 18:if(!1!==(c=i.sent)){i.next=22;break}return n&&h.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.DASHBOARD_SCENE),i.abrupt("return");case 22:c||"reset"===t||(c=t);case 23:l=o.contextType,a(Ws(c,l));case 25:return Cd({contextId:c}),p=r.getPlayerId(),f=r.getConnectedPlayers(),i.next=30,o.getContextPlayers(p);case 30:return g=i.sent,e!==(m=Ls).playerId&&f[e]?m=f[e]:1===g.length&&(m=g[0]),a(xd()),y=(v=m).playerId,S=v.name,A=v.photo,E={playerId:y,name:S,photo:A},i.next=38,a(Yd(Ns,E));case 38:a(Ws(c,l)),hu.emit(dc.START_GAME),i.next=51;break;case 42:if(i.prev=42,i.t0=i.catch(0),!(i.t0 instanceof gl)){i.next=46;break}return i.abrupt("return");case 46:if("USER_INPUT"!==(null==i.t0?void 0:i.t0.code)){i.next=48;break}return i.abrupt("return");case 48:if("INVALID_OPERATION"!==(null==i.t0?void 0:i.t0.code)){i.next=50;break}return i.abrupt("return");case 50:(0,Ht.sendException)(i.t0);case 51:return i.prev=51,Id(1e3),i.finish(51);case 54:case"end":return i.stop()}}),i,null,[[0,42,51,54]])})));return function(t){return i.apply(this,arguments)}}()},Fd=function(t){var e=window.game.player.getConnectedPlayerIds(20,0);if(!t||0===t.length)return e;for(var n=[],i=0;i<e.length;i++)u()(t).call(t,e[i])||n.push(e[i]);return n},Nd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u,d,p,f,g,m,v,y;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=window.game,i=n.player,a=n.facebook,s=n.globalScene,r=n.lang,s.screen.open(cr,{message:r.Text.LOADING,loading:!0}),o=Fd(Md),h="",c="",l=a.contextType,o.length>0&&(u=Phaser.Math.RND.between(0,o.length-1),h=o[u],Md.push(h)),!h||"string"!==typeof h){t.next=13;break}return t.next=12,a.createAsync(h);case 12:c=t.sent;case 13:return Cd({contextId:c}),d=i.getPlayerId(),t.next=17,a.getContextPlayers(d);case 17:return p=t.sent,f=Ls,h||1!==p.length||(f=p[0]||Ls),e(xd()),m=(g=f).name,v=g.photo,y={playerId:h,name:m,photo:v},t.next=25,e(Yd(Ns,y));case 25:e(Ws(c,l)),t.next=35;break;case 28:if(t.prev=28,t.t0=t.catch(0),!(t.t0 instanceof gl)){t.next=34;break}return e(Wd({mode:Fs,status:Aa})),e(_d()),t.abrupt("return");case 34:(0,Ht.sendException)(t.t0);case 35:return t.prev=35,Id(1e3),t.finish(35);case 38:case"end":return t.stop()}}),t,null,[[0,28,35,38]])})));return function(e){return t.apply(this,arguments)}}()},Gd=function(t){return void 0===t&&(t=null),function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s,r,o,h;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=window.game,a=i.facebook,s=i.globalScene,r=i.analytics,o=i.lang,s.screen.open(cr,{message:o.Text.LOADING,loading:!0}),h=a.getContextID(),Cd({contextId:h}),r.event(ni.AnalyticsEvents.JOIN_GROUP,{group_id:h}),e.next=8,n(Yd(Gs,t));case 8:e.next=17;break;case 10:if(e.prev=10,e.t0=e.catch(0),!(e.t0 instanceof gl)){e.next=14;break}return e.abrupt("return");case 14:if("INVALID_OPERATION"!==(null==e.t0?void 0:e.t0.code)){e.next=16;break}return e.abrupt("return");case 16:(0,Ht.sendException)(e.t0);case 17:return e.prev=17,Id(1e3),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,10,17,20]])})));return function(t){return e.apply(this,arguments)}}()},Ud=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,u,d,p,f,g,m,v,y,S;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=window.game,r=s.player,o=s.profile,h=s.facebook,(c=s.globalScene).screen.open(cr,{message:"Loading...",loading:!0}),l=a(),u=r.getPlayerId(l),!((d=r.getConnectedPlayers(l)).length>0)||d[e]){n.next=9;break}return c.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.DASHBOARD_SCENE),n.abrupt("return");case 9:return p=Ls,n.next=12,h.getContextPlayers(u);case 12:if(f=n.sent,e===u||e===p.playerId||!d[e]){n.next=17;break}p=d[e],n.next=25;break;case 17:if(1!==f.length){n.next=21;break}p=f[0],n.next=25;break;case 21:return n.next=23,o.requestProfiles([e]);case 23:(g=o.getProfiles())[e]&&(p=g[e]);case 25:return n.next=27,i(md(t,p));case 27:if(l=a(),ql(l,{playerId:u})!==Ls.playerId){n.next=32;break}return n.next=32,i(gd(t));case 32:if(l=a(),ql(l,{playerId:u})===u||!d[e]){n.next=37;break}return i(Bd(e,!0)),n.abrupt("return");case 37:if(Xl(l)===t){n.next=41;break}return c.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.DASHBOARD_SCENE),n.abrupt("return");case 41:if(m=Kl(l),v=Zl(l,{playerId:u}),i(Wd({mode:Ns,status:m})),y=h.getContextID(),S=h.contextType,i(Ws(y,S)),!v){n.next=52;break}return n.next=50,r.requestConnectedPlayers();case 50:return c.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.GAME_OVER_SCENE),n.abrupt("return");case 52:c.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.GAME_SCENE),n.next=58;break;case 55:n.prev=55,n.t0=n.catch(0),(0,Ht.sendException)(n.t0);case 58:return n.prev=58,Id(1e3),n.finish(58);case 61:case"end":return n.stop()}}),n,null,[[0,55,58,61]])})));return function(t,e){return n.apply(this,arguments)}}()},Vd=function(t){return function(e){try{var n=window.game.player,i=n.getPlayerId();Hc(i,t).catch((function(t){(0,Ht.sendException)(new Error(t))}));var a=n.getPlayerData(),s=a.score,r=void 0===s?0:s,o=a.level;r<t&&n.setScore(t);var h={score:t,level:o};e(bd(i,h)),e(Td(h))}catch(c){if(c instanceof ml)return;(0,Ht.sendException)(c)}}},Yd=function(t,e){return void 0===e&&(e=null),function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,d,p,f,g,m,v,y,S,E,x,b,T,w,M,C,P;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,r=window.game,o=r.player,h=r.analytics,c=r.facebook,l=r.globalScene,d=c.getContextID(),p=0,f=a(),h.event(ni.AnalyticsEvents.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(t),level:1,level_name:"level_1"}),i(kd()),!u()(s=[Fs,Us]).call(s,t)){n.next=16;break}return n.next=10,i((function(t){try{var e=window.game.player;t({type:Qi,payload:{}});var n=e.getPlayerId(),i=Be(sd.SingleMatchStore)||{},a=i.data;i.data=od(a),ed({playerId:n,match:i}),t(ud(i))}catch(s){if(t(ud(null)),s instanceof Lu)return;if(s instanceof Is)return;if(s instanceof Wu)return;(0,Ht.sendException)(s)}}));case 10:if(f=a(),zl(f)){n.next=15;break}return n.next=15,i(hd());case 15:p=Hl(f);case 16:if(t===Gs&&i(Sd(e)),t!==Ns){n.next=26;break}return n.next=20,i(fd(e));case 20:f=a(),g=Xl(f),m=jl(f),v=m.playerId,d||(d=window.game.facebook.getContextID()),y=ru(f,{opponentId:v}),d&&v&&!y&&i(ku(v,{contextId:d,matchId:g}));case 26:t===Vs&&i(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=window.game.player,s=a.getPlayer(),r=s.playerId,o=s.name,h=s.photo,e({type:ga,payload:{playerId:r}}),c={},De()(n=A()(i=new Array(20)).call(i,null)).call(n,(function(t,e){var n="0"+(e+1);c[n]={playerId:n,name:"MPlayer "+n,photo:"./assets/images/others/avatar.png"}})),c[r]={playerId:r,name:o,photo:h},e(Ad("mock",c));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),f=a(),S=o.getPlayerData(f),E=S.score,x=void 0===E?0:E,b=Yl(f),T=b.rescued,w=void 0===T?0:T,i(Td({score:p,bestScore:x})),i({type:Yi,payload:{mode:t,contextId:d,rescued:w}}),i(Xs(t)),l.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.GAME_SCENE),n.next=44;break;case 37:if(n.prev=37,n.t0=n.catch(0),!(n.t0 instanceof Lu)){n.next=43;break}return M=window.game,C=M.globalScene,P=M.lang,C.screen.open(cr,{message:P.Text.NO_REWARDS+"\n"+P.Text.CANCELLED_AD,duration:2500,loading:!1}),n.abrupt("return");case 43:(0,Ht.sendException)(n.t0);case 44:return n.prev=44,Id(0),n.finish(44);case 47:case"end":return n.stop()}}),n,null,[[0,37,44,47]])})));return function(t,e){return n.apply(this,arguments)}}()},zd=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=window.game,a=i.analytics,s=i.facebook,r=i.globalScene,o=s.getContextID(),h=n(),c=eu(h)||1,a.event(ni.AnalyticsEvents.MATCH_START,{game_mode:GameCore.Utils.String.toUpperCamelCase(Ys),level:c}),e(kd()),h=n(),tu(h)){t.next=12;break}return t.next=12,e(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=window.game,a=i.player,i.globalScene.screen.open(cr,{message:"Loading...",loading:!0}),e({type:na,payload:{}}),s=n(),r=eu(s)||1,o=a.getPlayerId(),h=(0,wt.default)({},sd.LocalSingleMatchDefault,{level:r,status:"active",playerId:o,startedAt:Date.now()}),ed({playerId:o,match:h}),e(dd(h)),Le(sd.JourneyMatchStore+"-"+o,h),t.next=21;break;case 13:if(t.prev=13,t.t0=t.catch(0),e(dd(null)),!(t.t0 instanceof Lu)){t.next=18;break}return t.abrupt("return");case 18:if(!(t.t0 instanceof Wu)){t.next=20;break}return t.abrupt("return");case 20:(0,Ht.sendException)(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}());case 12:e({type:Yi,payload:{mode:Ys,contextId:o}}),r.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.JOURNEY_SCENE),t.next=23;break;case 16:if(t.prev=16,t.t0=t.catch(0),!(t.t0 instanceof Lu)){t.next=22;break}return window.game.globalScene.screen.open(cr,{message:"Sorry!, you can now\ncreate this match!",duration:2500,loading:!1}),t.abrupt("return");case 22:(0,Ht.sendException)(t.t0);case 23:return t.prev=23,Id(0),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[0,16,23,26]])})));return function(e,n){return t.apply(this,arguments)}}()},Hd=function(t,e){return function(){var n=(0,Xt.default)(qt().mark((function n(i,a){var s,r,o,h,c,l,d,p,f,g;return qt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=window.game.player,o=e.score,h=void 0===o?0:o,c=e.level,l=void 0===c?0:c,d=a(),!u()(s=[Fs,Us]).call(s,t)){n.next=7;break}return p=zl(d),n.next=7,i(ld(p));case 7:if(t===Gs&&(i({type:fa,payload:{}}),f=r.getPlayerId(),i(bd(f,e))),t!==Ns){n.next=12;break}return g=Xl(d),n.next=12,i(vd(g,h,{level:l}));case 12:i({type:zi,payload:{mode:t}}),hu.emit(dc.GAME_OVER);case 14:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()},Wd=function(t){return function(e){var n=t.mode,i=t.status;e({type:Hi,payload:{mode:n,status:i}}),(0,Ht.addBreadcrumbSentry)("game-mode",n)}},Xd=function(){return function(t,e){var n=e(),i=au(n).level,a=void 0===i?0:i,s=yl(n);window.game.analytics.event(ni.AnalyticsEvents.MATCH_RESCUE,{game_mode:GameCore.Utils.String.toUpperCamelCase(s),level:a,level_name:"level_"+a}),t({type:Wi,payload:{}})}},Kd=or.default.DEFAULT,jd=Kd.KEY,qd=Kd.FRAME,Zd=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).buttonPlay=void 0,i.buttonShare=void 0,i.avatar=void 0,i.rankIcon=void 0,i.rankText=void 0,i.username=void 0,i.score=void 0,i.scoreText=void 0,i.background=void 0,i.showPopUp=void 0,i.showItems=void 0,i.payload=void 0,i.handleChallengeFriend=function(){var t=i.payload.playerId;i.scene.storage.dispatch(Bd(t))},i.handleShare=function(){i.scene.storage.dispatch(Au())},i.createBackground(),i.updateSize(),i.createAvatar(),i.createRank(),i.createUsername(),i.createScore(),i.createButtonShare(),i.createButtonPlay(),n&&i.updateInfo(n),i.scene.add.existing((0,nr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(t){this.payload=(0,wt.default)({scoreRight:!0,isHighlight:!1,useChallenge:!1,backgroundFrame:"",rank:-1},t),this.updateBackground(),this.updateAvatar(),this.updateRank(),this.updateUsername(),this.updateScore(),this.updateButton(),this.alignScoreAndButton()},n.createBackground=function(){this.background=this.scene.make.image({key:jd,frame:qd.LEADERBOARD_BG_ITEM}),this.background.setWorldSize(312,60),this.background.setVisible(!1),this.add(this.background)},n.updateBackground=function(){this.payload.backgroundFrame?(this.background.setVisible(!0),this.background.setFrame(this.payload.backgroundFrame||qd.LEADERBOARD_BG_ITEM),this.background.setWorldSize(312,60)):this.background.setVisible(!1)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.createAvatar=function(){this.avatar=new fl(this.scene,{key:jd,frame:qd.AVATAR_BORDER,background:qd.AVATAR_BACKGROUND,width:40,height:40,radius:30,borderWidth:5}),this.add(this.avatar),Phaser.Display.Align.In.LeftCenter(this.avatar,this,-40)},n.updateAvatar=function(){var t=this.payload,e=t.playerId,n=t.photo;this.avatar.loadPhoto(e,n)},n.createRank=function(){this.createRankIcon(1),this.createRankText(1)},n.updateRank=function(){var t=this.payload.rank;if(t<0)return this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),void this.rankText.setText("99+");this.updateRankIcon(t),this.updateRankText(t)},n.getRankIconFrame=function(t){var e=qd.ICON_CUP_GOLD;switch(t){case 1:e=qd.ICON_CUP_GOLD;break;case 2:e=qd.ICON_CUP_SILVER;break;case 3:e=qd.ICON_CUP_COPPER}return e},n.createRankIcon=function(t){var e=this.getRankIconFrame(t);this.rankIcon=this.scene.make.image({key:jd,frame:e}),this.rankIcon.setWorldSize(28,24),this.add(this.rankIcon),Phaser.Display.Align.In.LeftCenter(this.rankIcon,this.background,-6)},n.updateRankIcon=function(t){if(t>3)this.rankIcon.setVisible(!1);else{this.rankIcon.setVisible(!0);var e=this.getRankIconFrame(t);this.rankIcon.setWorldSize(28,24),this.rankIcon.setFrame(e)}},n.createRankText=function(t){this.rankText=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(32),text:""+t,origin:{x:.5,y:.5}}),this.add(this.rankText),Phaser.Display.Align.In.Center(this.rankText,this.rankIcon,0,1)},n.updateRankText=function(t){t<=3?this.rankText.setVisible(!1):(this.rankText.setVisible(!0),this.rankText.setText(""+t),this.rankText.setFont(Br.default.NUMBER_DARK.KEY))},n.updateRankUndefined=function(){this.rankIcon.setVisible(!1),this.rankText.setVisible(!0),this.rankText.setText("?"),this.payload.isHighlight?this.rankText.setFont(Br.default.NUMBER_LIGHT.KEY):this.rankText.setFont(Br.default.NUMBER_DARK.KEY)},n.getShortName=function(t){var e=t.substring(0,7);return e.split(" ")[0]||e},n.createUsername=function(){this.username=this.scene.make.text({text:this.getShortName("FRIEND NAME"),style:{fontFamily:Br.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"}}),this.username.setTint(7485207),this.username.setHighQuality(),Phaser.Display.Align.In.Center(this.username,this.avatar,65,.5),this.add(this.username)},n.updateUsername=function(){var t=this.payload.name;this.username.setText(this.getShortName(t)),this.username.setTint(7551258)},n.createScore=function(){this.score=this.scene.add.container(),this.scoreText=this.scene.make.text({text:"132500",style:{fontFamily:Br.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(36)+"px",fontStyle:"500"}}),this.scoreText.setOrigin(.5),this.score.add([this.scoreText]),this.add(this.score),Phaser.Display.Align.In.Center(this.score,this.avatar,160,0)},n.updateScore=function(){var t=this.payload.score;this.scoreText.setText(t),this.scoreText.setTint(7551258)},n.createButtonPlay=function(){this.buttonPlay=new _r.default(this.scene,jd,qd.BUTTON_CHALLENGE_LIGHT,54,36),this.buttonPlay.setName("ChallengeFriend"),Phaser.Display.Align.In.RightCenter(this.buttonPlay,this,-18,2),this.buttonPlay.onClick=this.handleChallengeFriend,this.add(this.buttonPlay)},n.createButtonShare=function(){this.buttonShare=new _r.default(this.scene,jd,qd.BUTTON_SHARE_DARK,54,36),this.buttonShare.setName("Share"),Phaser.Display.Align.In.RightCenter(this.buttonShare,this,-18,2),this.buttonShare.onClick=this.handleShare,this.add(this.buttonShare)},n.updateButton=function(){var t=this.payload,e=t.isHighlight;if(!t.useChallenge)return this.buttonShare.setVisible(!1),void this.buttonPlay.setVisible(!1);e?(this.buttonShare.setVisible(!0),this.buttonPlay.setVisible(!1)):(this.buttonShare.setVisible(!1),this.buttonPlay.setVisible(!0))},n.alignScoreAndButton=function(){this.payload.useChallenge?Phaser.Display.Align.In.Center(this.score,this.avatar,150,0):Phaser.Display.Align.In.Center(this.score,this.avatar,200,0)},n.runShowPopUpAnimation=function(t,e){this.scene.tweens.killTweensOf(this),this.showPopUp=new al({targets:[this],delay:t,duration:e,props:{y:{start:this.y+70,to:this.y}}}),this.showPopUp.play()},n.runShowItemAnimation=function(t,e){var n=this.getAll();this.scene.tweens.killTweensOf(n),this.showItems=new el({targets:n,duration:e,delay:this.scene.tweens.stagger(50,{start:t+50}),props:{scale:{duration:1e3,getStart:function(t){return.8*t.scale},getEnd:function(t){return t.scale},ease:Phaser.Math.Easing.Elastic.Out,easeParams:[.1,.45]}}}),this.showItems.play()},n.runShowUpAnimation=function(t,e){void 0===t&&(t=0),void 0===e&&(e=300);var n=100*t;this.runShowPopUpAnimation(n,e),this.runShowItemAnimation(n,e)},n.setFrameBackground=function(t){this.background.setFrame(t)},n.setUserNameLight=function(){this.username.setTint(16640200)},n.setRankLight=function(){this.rankText.setFont(Br.default.NUMBER_LIGHT.KEY)},n.setScoreLight=function(){this.scoreText.setTint(16640200)},e}(Phaser.GameObjects.Container),Jd=Zd,Qd=or.default.DEFAULT.FRAME,$d=function(t){function e(e){var n;return(n=t.call(this,e)||this).myScoreBlock=void 0,n.scene=e,n.setName("FooterBar"),n.createMyScoreBlock(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createMyScoreBlock=function(){this.myScoreBlock=new Jd(this.scene),this.myScoreBlock.setFrameBackground(Qd.LEADERBOARD_BG_ITEM),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this)},n.updateMyScoreBlock=function(t){this.myScoreBlock.setVisible(!0),this.myScoreBlock.updateInfo(t),this.myScoreBlock.setRankLight(),this.myScoreBlock.setScoreLight(),this.myScoreBlock.setUserNameLight(),this.myScoreBlock.runShowUpAnimation(0,1e3)},e}(Phaser.GameObjects.Container),tp=$d,ep=n(464),np=n(465),ip=(function(t){function e(e){var n;return(n=t.call(this,e,"UpdateAbleObject")||this).updateInfo=void 0,n}(0,Kt.default)(e,t)}(Phaser.GameObjects.GameObject),function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).classType=void 0,i.listConfigs=void 0,i.padding=void 0,i.startObjectIndex=void 0,i.endObjectIndex=void 0,i.listObjects=void 0,i.classType=n.classType,i.listConfigs=n.listConfigs,i.padding=n.padding?n.padding:0,i.objects.classType=i.classType,i.updateConfig(i.listConfigs),i}(0,Kt.default)(e,t);var n=e.prototype;return n.reset=function(){t.prototype.reset.call(this),this.killAndHideAll()},n.getChildren=function(){var t;return c()(t=this.listObjects).call(t,(function(t){return void 0!=t&&t.active}))},n.updateConfig=function(t){var e;this.reset(),this.listConfigs=t,this.listObjects=A()(e=new Array(t.length)).call(e,void 0),this.addObjectIndex(0,0);var n=this.getEndObjectIndex();this.addObjectIndex(1,n),this.startObjectIndex=this.getStartObjectIndex(),this.endObjectIndex=this.getEndObjectIndex(),this.updateMaxHeight(),this.value=this.marginTop},n.killAndHideAll=function(){var t,e=this;this.listObjects instanceof Array&&De()(t=this.listObjects).call(t,(function(t){void 0!==t&&e.objects.killAndHide(t)}))},n.setItemPosition=function(t,e){var n=t.height;t.setPosition(0,n/2+(n+this.padding)*e-this.height/2)},n.updateMaxHeight=function(){return this.maxHeight=Math.max(this.listConfigs.length*(this.objHeight+this.padding)-this.padding+this.marginBottom-this.height,0)},n.updateObject=function(t){this.objects.incY(t);var e=this.getStartObjectIndex(),n=this.getEndObjectIndex();e!=this.startObjectIndex&&(e>this.startObjectIndex?this.killObjectIndex(this.startObjectIndex,e-1):this.addObjectIndex(e,this.startObjectIndex-1),this.startObjectIndex=e),n!=this.endObjectIndex&&(n<this.endObjectIndex?this.killObjectIndex(n+1,this.endObjectIndex):this.addObjectIndex(this.endObjectIndex+1,n),this.endObjectIndex=n)},n.killObjectIndex=function(t,e){for(var n=t;n<=e;n++){var i=this.listObjects[n];i&&(this.objects.killAndHide(i),this.listObjects[n]=void 0)}},n.addObjectIndex=function(t,e){for(var n=t;n<=e;n++){var i=this.padding,a=this.listConfigs;if(n>=a.length)return;var s=this.objects.getFirstDead(!0),r=s.height,o=r/2+(r+i)*n+this.value-this.height/2;s.updateInfo(a[n]),s.setPosition(0,o),s.setActive(!0),s.setVisible(!0),this.addAt(s),this.listObjects[n]=s}},n.getStartObjectIndex=function(){var t=this.objHeight,e=this.padding;return Math.max(Math.floor((0-this.value)/(t+e)),0)},n.getEndObjectIndex=function(){var t=this.objHeight,e=this.padding,n=this.listConfigs,i=t+e;return Math.min(Math.floor((this.height-this.value)/i),n.length)},(0,Se.default)(e,[{key:"objHeight",get:function(){var t=this.objects.getChildren();return 0==t.length?this.maxHeight=0:t[0].height}}]),e}(np.default));function ap(t,e){var n="undefined"!==typeof vc()&&Sc()(t)||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){var n;if(!t)return;if("string"===typeof t)return sp(t,e);var i=r()(n=Object.prototype.toString.call(t)).call(n,8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return a()(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return sp(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sp(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}for(var rp=or.default.DEFAULT.FRAME,op=function(t){function e(e,n,i){var a;(a=t.call(this,e)||this).currentPlayerId=void 0,a.scroller=void 0;var s=a.scene.player;return a.currentPlayerId=s.getPlayerId(),a.createReuseScroller(n,i),a.scene.add.existing((0,nr.default)(a)),a}(0,Kt.default)(e,t);var n=e.prototype;return n.createReuseScroller=function(t,e){this.scroller=new ip(this.scene,{classType:Jd,listConfigs:[],width:t,height:e,padding:0,marginTop:0,marginBottom:0}),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(or.default.DEFAULT.KEY,or.default.DEFAULT.FRAME.BLANK,40,16643027),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.updateData=function(t,e){var n=_a()(t)||[];if(!(n.length<1)){for(var i,a=[],s=0,r=ap(Ba()(n).call(n,(function(t,e){return+e.score-+t.score})));!(i=r()).done;){var o=i.value,h=o.playerId,c=o.photo,l=o.score,u=o.name,d=o.rank;if(h){this.currentPlayerId;var p={playerId:h,photo:c,name:u,rank:d,score:l,scoreRight:e===bc,useChallenge:e===Tc,isHighlight:!1,backgroundFrame:""+rp.PREFIX_LEADERBOARD_BG_ITEM+s};a.push(p),++s>=2&&(s=0)}}this.scroller.updateConfig(a),this.showLeaders()}},n.removeLeaders=function(){this.scroller.updateConfig([])},n.getLeaders=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this,e=this.getLeaders();if(!(e.length<1)){for(var n=Math.min(e.length,6),i=0;i<n;i++){var a=e[i];a&&(a.setVisible(!0),a.runShowUpAnimation(i,300))}var s=300+100*n+250;this.scene.time.delayedCall(s,(function(){t.scroller.setEnable(!0)}))}},e}(Phaser.GameObjects.Container),hp=op,cp=or.default.DEFAULT,lp=cp.KEY,up=cp.FRAME,dp=function(t){function e(e){var n;return(n=t.call(this,e)||this).leaders=void 0,n.loading=void 0,n.message=void 0,n.messageAnimation=void 0,n.setSize(310,430),n.createLoading(),n.createMessage(),n.createContents(),n.createAnimation(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.showLoading=function(t){this.loading.setVisible(t),this.showMessage(!1)},n.showMessage=function(t,e){this.message.setVisible(t),e&&(this.message.setText(e),this.messageAnimation.play())},n.createLoading=function(){this.loading=new dl(this.scene),this.loading.setVisible(!1),this.add(this.loading)},n.createMessage=function(){this.message=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.message.setTint(10317116),this.add(this.message),Phaser.Display.Align.In.Center(this.message,this)},n.createContents=function(){this.createLeaders(),this.createContentBackground()},n.createLeaders=function(){this.leaders=new hp(this.scene,310,337),this.add(this.leaders),Phaser.Display.Align.In.Center(this.leaders,this,0,-11)},n.createContentBackground=function(){var t=this.scene.make.container({}),e=this.scene.make.image({key:lp,frame:up.LEADERBOARD_BG_BOTTOM});e.setFlipY(!0),e.setWorldSize(315,22);var n=this.scene.make.image({key:lp,frame:up.LEADERBOARD_BG_MIDDLE});n.setWorldSize(315,300);var i=this.scene.make.image({key:lp,frame:up.LEADERBOARD_BG_BOTTOM});i.setWorldSize(315,22),t.add(e),t.add(n),t.add(i),Phaser.Display.Align.In.Center(n,t),Phaser.Display.Align.In.Center(e,n,0,-n.displayHeight/2-e.displayHeight/2),Phaser.Display.Align.In.Center(i,n,0,n.displayHeight/2+i.displayHeight/2),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-10)},n.createAnimation=function(){this.messageAnimation=new ep.default({targets:[this.message],duration:60,repeat:2})},e}(Phaser.GameObjects.Container),pp=dp,fp=GameCore.Configs.LeadersBoard,gp=or.default.DEFAULT,mp=gp.KEY,vp=gp.FRAME,yp=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.board=void 0,s.footerBar=void 0,s.isRequesting=void 0,s.isSwitchable=void 0,s.tabId=void 0,s.offset=void 0,s.isStateChanged=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.setVisible(!0),s.selectWorldTab(),s.runOpenAnimation(),s.board.showLoading(!0);var n=[{selector:xc,callback:function(t){if(s.isRequesting=t,s.board.showLoading(t),!1===t){if(!s.scene)return;if(!s.visible||!s.scene.scene.isActive)return;var e=s.scene.game.storage.getState(),n=Ec(e);s.isSwitchable=!0,n&&0!==Y()(n).length?s.board.leaders.updateData(n,s.tabId):s.board.showMessage(!0,"Leaderboard is empty!"),s.updatePlayerEntryAsync().catch(Ht.sendException)}}}];s.handleStateChange(n)},s.handleSelectFriendTab=function(){s.isRequesting||s.isSwitchable&&s.selectFriendTab()},s.handleSelectWorldTab=function(){s.isRequesting||s.isSwitchable&&s.selectWorldTab()},s.clickClose=function(){s.runCloseAnimation()},s.setVisible(!1),s.createPopup(),s.createTitle(),s.createBoard(),s.createFooterBar(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleStateChange=function(t){var e=this;this.isStateChanged||(t.forEach((function(t){var n=t.selector,i=t.callback;e.scene.storage.watch(n,i)})),this.isStateChanged=!0)},n.createPopup=function(){this.popup=new no(this.scene,0,-5,340,510,{forceHeightTop:60}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-2)},n.createTitle=function(){var t=this.scene.add.container(),e=this.scene.make.image({key:mp,frame:vp.TEXT_LEADER_BOARD});e.setWorldSize(218,22);var n=new _r.default(this.scene,mp,vp.BUTTON_CLOSE,35,35);n.setName("Close"),n.onClick=this.clickClose,t.add([e,n]),Phaser.Display.Align.In.Center(e,t,0,9),Phaser.Display.Align.In.Center(n,t,160,-15),this.popup.add(t),Phaser.Display.Align.In.TopCenter(t,this.popup)},n.createBoard=function(){this.board=new pp(this.scene),this.popup.add(this.board),Phaser.Display.Align.In.Center(this.board,this.popup,0,-25)},n.createFooterBar=function(){this.footerBar=new tp(this.scene),this.popup.add(this.footerBar),Phaser.Display.Align.In.Center(this.footerBar,this.popup,0,178)},n.selectFriendTab=function(){this.tabId=Tc,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.scene.storage.dispatch(Qc()),this.scene.storage.dispatch(Zc(fp.LeaderboardId,Tc,fp.Limit,this.offset))},n.selectWorldTab=function(){this.tabId=bc,this.offset=0,this.board.showLoading(!0),this.board.leaders.removeLeaders(),this.footerBar.myScoreBlock.setVisible(!1),this.scene.storage.dispatch(Qc()),this.scene.storage.dispatch(Zc(fp.LeaderboardId,bc,fp.Limit,this.offset))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0),i.board.showLoading(!1),i.close()}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.updatePlayerEntryAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.scene.player.getPlayerId(),n=this.scene.player.getPlayer(),i=null,t.prev=3,t.next=6,Vc(e);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),i=null;case 12:a={playerId:e,name:n.name,photo:n.photo,score:""+n.data.score,rank:-1},i&&(a={playerId:e,name:n.name,photo:n.photo,score:""+i.getScore(),rank:i.getRank()}),this.footerBar.updateMyScoreBlock({playerId:a.playerId,rank:a.rank,photo:a.photo,name:a.name,score:a.score,backgroundFrame:vp.LEADERBOARD_BG_ITEM,isHighlight:!0});case 15:case"end":return t.stop()}}),t,this,[[3,9]])})));return function(){return t.apply(this,arguments)}}(),n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),Sp=yp,Ap=n(143),Ep={LOGO:{KEY:"spine-logo",JSON:"./assets/spine/logo/logo.json",ATLAS:"./assets/spine/logo/logo.atlas",ANIMATIONS:{START_GROW:"start_grow",IDLE_GROW:"idle_grow"}},BEST_SCORE:{KEY:"best-score",JSON:"./assets/spine/best-score/newbest-trim.json",ATLAS:"./assets/spine/best-score/newbest-trim.atlas",ANIMATIONS:{ANIM:"anim5"}}},xp=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.bestScoreSpine=void 0,n.scene=e,e.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createSpineEffect=function(){var t=this,e=this.scene.world.getPixelRatio(),n=this.scene.gameZone,i=n.width,a=n.height/2;this.bestScoreSpine=this.scene.add.spine(-i/2,a,Ep.BEST_SCORE.KEY,Ep.BEST_SCORE.ANIMATIONS.ANIM),this.bestScoreSpine.preMultipliedAlpha=!0,this.bestScoreSpine.scale=1/e,this.add(this.bestScoreSpine),this.bestScoreSpine.on("complete",(function(){t.bestScoreSpine.setVisible(!1)}))},n.playEffect=function(){this.bestScoreSpine?(this.bestScoreSpine.setVisible(!0),this.bestScoreSpine.play(Ep.BEST_SCORE.ANIMATIONS.ANIM)):this.createSpineEffect()},e}(Phaser.GameObjects.Container),bp=n(551),Tp=n.n(bp),wp=GameCore.Configs,Mp=wp.Gameplay,Cp=wp.Match.Levels,Pp=function(){function t(){this.levelIndex=0,this.levels=Cp,this.recentLevel=void 0}var e=t.prototype;return e.increaseLevel=function(){this.levelIndex++},e.getCurrentTargetScore=function(){return this.levels[this.levelIndex]},e.getNextTargetScoreLevel=function(){return this.levels[this.levelIndex+1]},e.getCurrentIndex=function(){return this.levelIndex},e.updateCurrentLevelByScore=function(t){var e,n=Tp()(e=this.levels).call(e,(function(e){return e>t}));if(-1===n)return this.handleAutoGrantNewLevel(t);this.levelIndex=n;var i=this.levels[n-1];return i&&(this.recentLevel=i),this.levels[n]},e.restart=function(){this.levelIndex=0,this.recentLevel=0},e.handleAutoGrantNewLevel=function(t){var e=Mp.Progress.BonusScore,n=this.levels[this.levels.length-1]+e;return this.levels.push(n),n<=t?this.handleAutoGrantNewLevel(t):(this.levelIndex=this.levels.length-1,this.recentLevel=this.levels[this.levelIndex],n)},t}(),Ip=n(246),kp=function(){var t,e=window.game.facebook;return e?(null==(t=e.platform)?void 0:t.toLowerCase())||"":null},Rp=function(){return"web"==kp()},Op=Math.sin,_p=Math.cos,Dp=function(t,e,n){return t*_p(e)*n},Bp=function(t,e,n,i){return void 0===i&&(i=10),t*Op(e)*n-.5*i*Math.pow(n,2)},Lp=or.default.GAMEPLAY_32,Fp=Lp.KEY,Np=Lp.FRAME,Gp=function(t){function e(e,n){var i;return(i=t.call(this,e,n.x+(n.padding||0),n.y+(n.padding||0),Fp,Np.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenStartMission=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.scene=e,i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),e.add.existing((0,nr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:Fp,frame:Np.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:Fp,frame:Np.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:Fp,frame:Np.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:Fp,frame:Np.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var t=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:t,to:0,start:t},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(t){this.rateShaking=t},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var t=this.alpha0<90?1:-1;this.t0+=3e3/1900;var e=.016*this.t0,n=Dp(this.v0,this.alpha0,e),i=Bp(this.v0,this.alpha0,e);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*t,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},e}(Phaser.GameObjects.Image),Up=Gp,Vp=n(108),Yp=n.n(Vp),zp=GameCore.Configs.Board,Hp=(zp.cols,zp.rows),Wp=void 0===Hp?8:Hp,Xp=0,Kp=function(){return Xp},jp=function(t,e){Xp=0;for(var n=[],i=t.length,a=t[0].length,s=[],r=[],o=function(e){for(var i=!0,r=0;r<a;r++)0===t[e][r].value&&(i=!1);if(i){s.push(e);for(var o=function(t){n.some((function(n){return n.x===t&&n.y===e}))||n.push({x:t,y:e})},h=0;h<a;h++)o(h)}},h=0;h<i;h++)o(h);for(var c=function(e){for(var a=!0,s=0;s<i;s++)0===t[s][e].value&&(a=!1);if(a){r.push(e);for(var o=function(t){n.some((function(n){return n.x===e&&n.y===t}))||n.push({x:e,y:t})},h=0;h<i;h++)o(h)}},l=0;l<a;l++)c(l);var u=Jp(t,e);if(u&&u.length>0)for(var d=function(t){var e=u[t],i=e.x,a=e.y;n.some((function(t){return t.x===i&&t.y===a}))||n.push({x:i,y:a})},p=0;p<u.length;p++)d(p);return Xp+=s.length,Xp+=r.length,Xp+=Math.floor(u.length/9),n},qp=function(t,e){if(0===t.length)return!1;var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||n.length<=0)},Zp=function(t,e){for(var n=e.x,i=e.y,a=[],s=n;s<n+3;s++)for(var r=i;r<i+3;r++){if(0===t[r][s].value)return[];a.push({x:s,y:r})}return a},Jp=function(t,e){for(var n=[],i=function(t){for(var e,n=[],i=0;i<t.length;i++){var a=(e=t[i],{x:3*Math.floor(e.x/3),y:3*Math.floor(e.y/3)});qp(n,a)||n.push(a)}return n}(e),a=0;a<i.length;a++){var s=i[a],r=Zp(t,s);n.push.apply(n,r)}return n},Qp=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<e;a++){for(var s=!0,r=0;r<n;r++)0===t[a][r].value&&(s=!1);s&&i.push(a)}return i},$p=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<e;r++)0===t[r][a].value&&(s=!1);s&&i.push(a)}return i},tf=function(t,e){var n=t.length,i=t[0].length;if(0===e.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<e.length;r++)if(ef(t,s,a,e[r]))return!1;return!0},ef=function(t,e,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(t[n+s]&&t[n+s][e+r]&&0===t[n+s][e+r].value||(a=!1));return a},nf=function(t,e){for(var n=t.length,i=t[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(ef(t,s,a,e))return!0;return!1},af=0,sf=function(){return af++,18+10*(rf()-1)},rf=function(){return af+1},of=function(t){var e=t;switch(t){case xo:e="b";break;case bo:e="c";break;case To:e="d";break;case wo:e="g";break;case Mo:e="o";break;case Co:e="p";break;case Po:e="q";break;case Io:e="r";break;case ko:e="y";break;case _o:e="l";break;case Do:e="l1";break;case Bo:e="l3";break;case Lo:e="e2";break;case Fo:e="e3";break;case No:e="e4";break;case Go:e="e5";break;case Uo:e="s1";break;case Vo:e="s2";break;case Yo:e="s3";break;case zo:e="tz";break;case Ho:e="ta";break;case mo:e="dt";break;case fo:e="dl";break;case go:e="dr";break;case vo:e="db";break;case uo:e="v";break;case po:e="h";break;case yo:e="vl";break;case So:e="vr";break;case Ao:e="hl";break;case Eo:e="hr"}return e},hf=function(t){var e=t;switch(t){case"b":e=xo;break;case"c":e=bo;break;case"d":e=To;break;case"g":e=wo;break;case"o":e=Mo;break;case"p":e=Co;break;case"q":e=Po;break;case"r":e=Io;break;case"y":e=ko;break;case"l":e=_o;break;case"l1":e=Do;break;case"l3":e=Bo;break;case"e2":e=Lo;break;case"e3":e=Fo;break;case"e4":e=No;break;case"e5":e=Go;break;case"s1":e=Uo;break;case"s2":e=Vo;break;case"s3":e=Yo;break;case"tz":e=zo;break;case"ta":e=Ho;break;case"dt":e=mo;break;case"dl":e=fo;break;case"dr":e=go;break;case"db":e=vo;break;case"v":e=uo;break;case"h":e=po;break;case"vl":e=yo;break;case"vr":e=So;break;case"hl":e=Ao;break;case"hr":e=Eo}return e},cf=function(t){for(var e=[],n="12345678x",i=t.split(""),a=0;a<i.length;a++)if(g()(n).call(n,i[a])>=0)for(var s="x"===i[a]?Wp:Number(i[a]),r=0;r<s;r++)e.push({value:0,frame:"gem/gem_transparent"});else e.push({value:1,frame:hf(i[a])});return e},lf=function(t){var e=t.split(","),n=e[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:hf(n[0]),direction:hf(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,frame:hf(e[1])}},uf=or.default.GAMEPLAY_32,df=uf.KEY,pf=uf.FRAME,ff=GameCore.Configs.Board,gf=ff.cols,mf=ff.rows,vf=function(t){function e(n,i,a){var s;return(s=t.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.cellItems=[],s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=e.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,nr.default)(s)),s.createWrapPiece(),s.listenEvents(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createWrapPiece=function(){var t=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:df,frame:pf.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(t,t)},n.updatePosition=function(t,e){var n=this.getContainerSize(),i=n.width,a=n.height,s=this.parent.cellSize,r=this.scene.gameZone.width;this.setPosition(t+r/6-i/2+s/2,e-a/2+s/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(t,e){this.wrapPiece.setPosition(t+this.wrapPiece.displayWidth/2,e-20)},n.listenEvents=function(){var t=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(e){t.handleDragStart(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(e){t.handleDrag(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){t.handleDragEnd(),t.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(t){this.index=t},n.setInteractiveContainer=function(){var t=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,t/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(t){var e,n,i=this;if(!this.scene.isGameOver&&this.isCanMove){null==(e=this.animScaleUp)||e.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(Dr.default.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.dragStart(),this.scene.audio.playSound(Or.default.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,s=this.getContainerSize(),r=s.width,o=s.height,h=t.worldX+this.parent.cellSize*a/2-r*a/2,c=0;if(Rp())c=t.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,c=t.worldY-u}this.distancePY=t.worldY-c;var d=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(d),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:h,y:c,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(h,c);var t=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(t,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(t){if(!this.scene.isGameOver&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var e=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(e)}this.resetCellItems(),this.scene.game.updateFps(Ip.default.max);var n=this.getContainerSize().width,i=t.worldX+this.parent.cellSize*this.scale/2-n/2,a=t.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var s=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(s,this.highlightCellCanCapture.bind(this))}catch(r){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(t,e,n,i){for(var a=this,s=gf,r=mf,o=[],h=0;h<i.length;h++){var l=i[h],u=l.x,d=l.y;s>u&&(s=u),r>d&&(r=d)}for(var p=function(e){var n=t[e],s=c()(i).call(i,(function(t){return t.y===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var h=s[r];a.checkItemInArray(o,h)||o.push(h)}},f=0;f<t.length;f++)p(f);for(var g=function(t){var n=e[t],s=c()(i).call(i,(function(t){return t.x===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var h=s[r];a.checkItemInArray(o,h)||o.push(h)}},m=0;m<e.length;m++)g(m);for(var v=function(t){var e=n[t],s=c()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!s||0===s.length)return"continue";var r=s[0];a.checkItemInArray(o,r)||o.push(r)},y=0;y<n.length;y++)v(y);for(var S=function(t){var e,n=o[t],i=n.x,h=n.y,l=c()(e=a.cellItems).call(e,(function(t){return t.x===i-s&&t.y===h-r}));if(!l||0===l.length)return"continue";l[0].cell.setFrame(pf.GEM_LIGHT)},A=0;A<o.length;A++)S(A)},n.resetCellItems=function(){for(var t=0;t<this.cellItems.length;t++)this.cellItems[t].cell.setFrame(pf.GEM)},n.checkItemInArray=function(t,e){var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove){this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Dr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(Or.default.PIECE_DROP),this.handleBoardMoveCompleted(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Dr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(t,e){return 15==t?this.parent.cellSize*e*-2:30==t?0:45==t?this.parent.cellSize*e*2:60==t?this.parent.cellSize*e*4:75==t?this.parent.cellSize*e*6:t},n.handleBoardMoveCompleted=function(){var t=this,e=this.getPositionTopLeftInBoard();if(e){var n=this.calcScore();this.scene.tutorialManager.isRunning()||(this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0));var i=e.x,a=e.y,s=this.scene.main.board.dataBoard[a][i],r=s.x+this.scene.main.board.cellPadding,o=s.y+this.scene.main.board.cellPadding,h=this.getCellsHighlight();this.scene.add.tween({targets:this,x:r,y:o,duration:50,onComplete:function(){t.updateCellsWithPadding(.5),t.scene.main.board.handleRemoveHighlight(),t.hide(),t.setScale(1),t.parent.removeActivePiece(t.index),t.scene.main.board.handleMove(h,t.onBoardHandleMoveCompleted.bind(t))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var t;if(!this.matrixData)return 0;var e=this.matrixData.length||0;if(0===e)return 0;for(var n=(null==(t=this.matrixData[0])?void 0:t.length)||0,i=0,a=0;a<e;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.scene.tutorialManager.isRunning()||(this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces())},n.drawSuggestCells=function(){var t=function(t,e){for(var n=t.length,i=t[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var h=0;h<i;h++)if(ef(t,h,o,e)&&(s=h,r=o,++a>1))return null;if(0===a)return null;for(var c=[],l=0;l<e.data.length;l++)for(var u=0;u<e.data[l].length;u++)e.data[l][u].texture&&c.push({x:s+u,y:r+l});return c&&c.length>0?c:null}(this.scene.main.board.dataBoard,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.getPositionFirstCellHighlight=function(){var t=this.scene.main.board.dataBoard,e=this.getPositionTopLeftInBoard();if(!e)return{x:0,y:0};var n=e.x,i=e.y;return e?{x:t[i][n].x,y:-(this.scene.scale.height-this.parentHeight-t[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var t=this;this.scene.audio.playSound(Or.default.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.invalidMove(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){t.updateCellsWithPadding(.5)}})},n.canMove=function(){var t=this.scene.main.board.dataBoard,e=this.getCellsHighlight();if(0===e.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<e.length;i++){var a=e[i],s=a.x,r=a.y;if(!t[r]||!t[r][s]||0!==t[r][s].value){n=!1;break}}if(!n||0===e.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var t=this.scene.main.board.dataBoard,e=[],n=this.getPositionTopLeftInBoard();if(null===n)return e;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return e;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=t[r]&&t[r][s]?t[r][s].x:0,h=t[r]&&t[r][s]?t[r][s].y:0;if(r>=mf||s>=gf||!t[r][s]||1===t[r][s].value)return[];e.push({x:s,y:r,pX:o,pY:h})}return e},n.getPositionTopLeftInBoard=function(){for(var t=this.scene.main.board.dataBoard,e=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,s=-1,r=0;r<mf;r++)for(var o=0;o<gf;o++)if(t[r][o].x-i/2<=e&&t[r][o].x+t[r][o].width+i/2>=e&&t[r][o].y-i/2<=n&&t[r][o].y+t[r][o].height+i/2>=n){a=o,s=r;break}return a<0||a>gf-1||s<0||s>mf-1?null:{x:a,y:s}},e.buildData=function(t){for(var e=[],n=0;n<t.length;n++){e[n]=[];for(var i=0;i<t[n].length;i++){var a=1===t[n][i]?pf.GEM:null;e[n][i]={x:i,y:n,texture:a}}}return e},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell||this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var t=this,e=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:e,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Sine.Out,onComplete:function(){t.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Sine.Out})},n.createCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture){var a={x:0+i*e+t,y:0+n*e+t,width:e-2*t,height:e-2*t},s=new Up(this.scene,a);s.setVisible(!0),this.cells[n][i]=s,this.cellItems.push({x:i,y:n,cell:s}),this.add(s)}}this.isCreateCell=!0},n.updateCellsWithPadding=function(t){for(var e=this.parent.cellSize,n=e-2*t,i=e-2*t,a=0;a<this.data.length;a++)for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r=this.cells[a][s],o=s*e+t,h=a*e+t;r.setWorldSize(n,i),r.setPosition(o,h)}},n.getContainerSize=function(){for(var t=0,e=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>t&&(t=this.data[n].length);var i=this.parent.cellSize;return{width:t*i*this.scale,height:e*i*this.scale}},n.resetPropsCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++)for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture)Math.floor(0+i*e+t),Math.floor(e-2*t),Math.floor(e-2*t),this.texture,this.frame,Dr.default.PIECE,Math.floor(0+i*e+t),Math.floor(e-2*t),Math.floor(e-2*t),this.texture,this.frame,this.type,this.direction,this.isReverse},n.setCanMove=function(t){this.isCanMove=t,this.correctAlpha=t?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive()},e}(Phaser.GameObjects.Container),yf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e,n){void 0===n&&(n=!1);var i=[];switch(e){case fo:n?i=ph:(i=dh,t===Do&&(i=fh),t===Bo&&(i=gh));break;case go:n?i=sh:(i=ah,t===Do&&(i=rh),t===Bo&&(i=oh));break;case mo:if(n){i=eh;break}i=th,t===Do&&(i=nh),t===Bo&&(i=ih);break;case vo:n?i=ch:(i=hh,t===Do&&(i=lh),t===Bo&&(i=uh))}return i},e.getData=function(t,n,i){return void 0===i&&(i=!1),e.buildData(e.getMatrixData(t,n,i))},e}(vf),Sf=yf,Af=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e){var n=[];switch(t){case Go:n=e===uo?xh:bh;break;case No:n=e===uo?Ah:Eh;break;case Lo:n=e===uo?mh:vh;break;case Fo:n=e===uo?yh:Sh}return n},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(vf),Ef=Af,xf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){case Uo:e=Th;break;case Vo:e=wh;break;case Yo:e=Mh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(vf),bf=xf,Tf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Rh;break;case"right":e=Oh;break;case"top":e=_h;break;case"bottom":e=Dh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(vf),wf=Tf,Mf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Ch;break;case"vertical_right":e=Ph;break;case"horizontal_right":e=kh;break;case"horizontal_left":e=Ih}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(vf),Cf=Mf,Pf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Bh;break;case"right":e=Lh;break;case"top":e=Fh;break;case"bottom":e=Nh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(vf),If=Pf,kf=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData()}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(){return Gh},e.getData=function(){return e.buildData(e.getMatrixData())},e}(vf),Rf=kf,Of=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getDataByDirectionCross2=function(t){var e=[];if("right"===t)e=Vh;else e=Uh;return e},e.getDataByDirectionCross3=function(t){var e=[];if("right"===t)e=zh;else e=Yh;return e},e.getDataByDirectionCross4=function(t){var e=[];if("right"===t)e=Wh;else e=Hh;return e},e.getDataByDirectionCross5=function(t){var e=[];if("right"===t)e=Kh;else e=Xh;return e},e.getMatrixData=function(t,n){var i=[];switch(t){case Ko:i=e.getDataByDirectionCross2(n);break;case jo:i=e.getDataByDirectionCross3(n);break;case qo:i=e.getDataByDirectionCross4(n);break;case Zo:i=e.getDataByDirectionCross5(n)}return i},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(vf),_f=Of,Df=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=jh;break;case"right":e=qh;break;case"top":e=Zh;break;case"bottom":e=Jh}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(vf),Bf=Df,Lf=or.default.DEFAULT,Ff=Lf.KEY,Nf=Lf.FRAME,Gf=function(){function t(t){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createBackground(),this.createText(),this.createTween()},e.createBackground=function(){this.background=this.scene.make.image({key:Ff,frame:Nf.BG_STREAK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},e.createText=function(){this.text=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X STREAK!"}),this.text.setVisible(!1)},e.createTween=function(){var t=this,e=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:e}},paused:!0,onComplete:function(){t.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){t.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:e-.3}},paused:!0,onComplete:function(){t.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){t.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y-n),t.background.setPosition(t.x,t.y-n)},onComplete:function(){t.y=t.y-20,t.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y+n),t.background.setPosition(t.x,t.y+n)},onComplete:function(){t.y=t.y+5,t.tweenStep5.play(),t.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e-.3,to:e}},paused:!0,onComplete:function(){t.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){t.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.background.setVisible(!1),t.text.setScale(0),t.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.text.setScale(0)}})},e.playAnim=function(t,e){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=t,this.y=e,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(t,e),this.background.setPosition(t,e),this.text.setVisible(!0),this.tweenTextStep1.play()},e.setTextCombo=function(t){this.text.setText(t+"X COMBO!")},e.setTextStreak=function(t){this.text.setText(t+"X STREAK!")},e.setBgFrame=function(t){this.background.setFrame(t)},t}(),Uf=function(){function t(t){this.scene=void 0,this.streakBreak=void 0,this.scene=t,this.init()}return t.prototype.init=function(){this.streakBreak=new Gf(this.scene)},t}(),Vf=function(){function t(){}return t.create=function(t,e,n){var i;switch(n.type){case _o:case Do:case Bo:i=new Sf(t,e,n);break;case Lo:case Fo:case No:case Go:i=new Ef(t,e,n);break;default:i=new bf(t,e,n);break;case Ho:i=new wf(t,e,n);break;case Wo:i=new If(t,e,n);break;case Jo:i=new Bf(t,e,n);break;case Xo:i=new Rf(t,e,n);break;case Ko:case jo:case qo:case Zo:i=new _f(t,e,n);break;case zo:i=new Cf(t,e,n)}return i},t}(),Yf=Vf,zf=or.default.GAMEPLAY_32,Hf=zf.KEY,Wf=zf.FRAME,Xf=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],e.add.existing((0,nr.default)(n)),n.scene=e,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(t,e){this.setPosition(t,e)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(t){if([Uo,Vo,Yo].some((function(e){return e===t})))return[];var e=[];switch(t){case _o:case Do:case Bo:case Ho:case Wo:case Jo:e=[mo,fo,go,vo];break;case Lo:case Fo:case No:case Go:e=[uo,po];break;case zo:e=[yo,So,Ao,Eo];break;case Xo:e=[];break;case Ko:case jo:case qo:case Zo:e=[fo,go]}return e},n.createAllPieces=function(){for(var t=this.cellSize,e=[],n=0;n<Qo.length;n++){var i=this.getDirectionsByType(Qo[n]);if(i.length<=0)e.push({type:Qo[n]});else{for(var a=0;a<i.length;a++)e.push({type:Qo[n],direction:i[a]});if(_o===Qo[n])for(var s=0;s<i.length;s++)e.push({type:Qo[n],direction:i[s],isReverse:!0})}}for(var r=0;r<e.length;r++){var o=(0,wt.default)({},e[r],{texture:Hf,frame:Wf.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2),cellLength:Math.floor(t/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2)}}),h=Yf.create(this.scene,this,o);h.hide(),this.allPieces.push(h)}},n.createAllPiecesGroup=function(){for(var t=0;t<this.allPieces.length;t++){var e=this.allPieces[t];this.allPiecesGroup[e.type]||(this.allPiecesGroup[e.type]=[]),this.allPiecesGroup[e.type].push(t)}},n.randomPieces=function(){var t=this;this.scene.game.updateFps(Ip.default.max);for(var e=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*e.length),a=e[i];if(!t.allPiecesGroup[a])return"continue";var s=Math.floor(Math.random()*t.allPiecesGroup[a].length),r=t.allPiecesGroup[a][s],o=[No,Go].some((function(t){return t===a}));if(t.canCaptureLines.isCapture&&o){for(var h=0;h<t.allPiecesGroup[a].length;h++){var c=t.allPiecesGroup[a][h];if(t.allPieces[c]&&t.allPieces[c].direction===t.canCaptureLines.direction){r=c;break}}e=t.buildPieceRates(!1)}n.some((function(t){return t.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r];a.push({position:r,texture:Hf,frame:Wf.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(t){void 0===t&&(t=!0);for(var e=[],n=0;n<$o.length;n++)e.push((0,wt.default)({},$o[n]));if(t){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var s=0;s<e.length;s++)e[s].type===Go&&(e[s].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<e.length;r++)e[r].type===No&&(e[r].rate=8)}for(var o=[],h=0;h<e.length;h++)for(var c=e[h],l=c.type,u=c.rate,d=0;d<u;d++)o.push(l);return o},n.drawPieces=function(){for(var t=this.scene.gameZone,e=t.width,n=t.height,i=[20,e/3,2*e/3-20],a=n/2+176-13,s=a+(n-85-a)/2,r=0;r<this.piecesActive.length;r++){var o=this.allPieces[this.piecesActive[r].position],h=i[r];o.updatePosition(h,s),o.updatePositionWrapPiece(h+20*(r-1),s),o.setIndex(r),o.drawPiece(),this.allPieces[this.piecesActive[r].position]=o}},n.removeActivePiece=function(t){this.piecesActive[t].used=!0},n.existPiecesActive=function(){var t,e=c()(t=this.piecesActive).call(t,(function(t){return!t.used}));return e&&e.length>0},n.showNewPieces=function(){for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].reset();this.randomPieces(),this.setActivePieces(),this.drawPieces()},n.calculatePieceInfo=function(){for(var t=0,e=0,n=this.cellSize,i=0;i<this.piecesActive.length;i++){var a=this.allPieces[this.piecesActive[i].position].data;t+=a[0].length,a.length>e&&(e=a.length)}return{cellLength:n/2,cols:t}},n.setActivePieces=function(){for(var t=this.scene.main.board.dataBoard,e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e].position,i=nf(t,this.allPieces[n]);this.allPieces[n].setCanMove(i)}},n.getPiecesByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=ar()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==Yp()(s=i[a]).call(s)){var o=lf(Yp()(r=i[a]).call(r));e.push(o)}}return e},n.getFenByPieces=function(){for(var t="l",e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e],i=n.type,a=n.direction,s=n.isReverse,r=n.frame;if(!n.used){var o=of(i);a&&""!==a&&(o+="-"+of(a)),s&&(o+="-r"),t+=" "+o+","+of(r)}}return t},n.clearPieces=function(){for(var t=0;t<this.piecesActive.length;t++){var e=this.piecesActive[t].position;this.allPieces[e].hide()}this.piecesActive=[]},n.showAvailablePieces=function(t){if(t&&!(t.length<=0)){for(var e=[],n=0;n<t.length;n++)for(var i=t[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,h=0;h<this.allPieces.length;h++){var c=this.allPieces[h];if(a===c.type&&s===c.direction&&r===c.isReverse){e.push({position:h,texture:Hf,frame:o,type:c.type,direction:c.direction,isReverse:c.isReverse});break}}this.piecesActive=e,this.setActivePieces(),this.drawPieces()}},n.debuggerNextPieces=function(){for(var t=0;t<this.piecesActive.length;t++)this.removeActivePiece(t);for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].wrapPiece.setVisible(!1);this.showNewPieces()},e}(Phaser.GameObjects.Container),Kf=or.default.DEFAULT,jf=Kf.KEY,qf=Kf.FRAME,Zf=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,76),e.add.existing((0,nr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createDebugButton()},n.createBackground=function(){var t=this.scene.make.image({key:jf,frame:qf.FOOTER}),e=this.scene.gameZone.width;t.setWorldSize(e,this.height),this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPieces=function(){this.pieces=new Xf(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new _r.default(this.scene,jf,qf.BUTTON_DARK_BLUE,100,30),this.debugButton.setName("Debug");var t=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([t]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},e}(Phaser.GameObjects.Container),Jf=Zf,Qf=or.default.DEFAULT,$f=Qf.KEY,tg=Qf.FRAME,eg=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.iconCrown=void 0,n.bestScoreText=void 0,n.setPosition(0,48.5),n.createBackground(),n.createScoreText(),n.createIconCrown(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:$f,frame:tg.BEST_SCORE_FRAME}),this.background.setWorldSize(55,77),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(26),origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,25)},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:$f,frame:tg.ICON_CROWN}),this.iconCrown.setWorldSize(20,18),this.add(this.iconCrown),Phaser.Display.Align.In.Center(this.iconCrown,this.background,0,5)},n.setScoreText=function(t){this.bestScoreText.setText(String(t))},n.updateBestScoreText=function(t){var e=this.scene.storage.getState();t>au(e).bestScore&&this.setScoreText(t)},e}(Phaser.GameObjects.Container),ng=eg,ig=or.default.DEFAULT,ag=ig.KEY,sg=ig.FRAME,rg=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,ag,sg.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),og=rg,hg=or.default.GAMEPLAY,cg=hg.KEY,lg=hg.FRAME,ug=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=void 0,n.currentScore=0,n.scene=e,n.scene.add.existing((0,nr.default)(n)),n.createBackground(),n.createScoreText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:cg,frame:lg.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.background,0,3)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.scoreText.setText(String(t))},n.animAddScore=function(t){var e=this,n=this.score+t;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-t,to:this.score,duration:100,ease:Phaser.Math.Easing.Sine.Out,onUpdate:function(t){var n=Math.floor(t.getValue());e.setScoreText(n),e.scene.header.bestScoreBlock.updateBestScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){e.setScoreText(e.score),e.scene.header.bestScoreBlock.updateBestScoreText(e.score),e.scene.tutorialManager.isRunning()?e.scene.tutorialManager.nextTutorial():(e.scene.handleNextTargetScore(),e.scene.bestScoreReached())}})},e}(Phaser.GameObjects.Container),dg=ug,pg=or.default.GAMEPLAY,fg=pg.KEY,gg=pg.FRAME,mg=function(t){function e(e){var n;return(n=t.call(this,e)||this).titleSprite=void 0,n.background=void 0,n.textScore=void 0,n.avatar=void 0,n.score=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.initScoreBlockAvatar=function(){this.createAvatar(),this.createBackgroundScore(),this.createScoreText(),this.setScore(0),this.setScoreText(0)},n.createAvatar=function(){this.avatar=new fl(this.scene,{key:fg,frame:gg.AVATAR_BORDER,background:gg.AVATAR_BACKGROUND,width:32,height:32,radius:32,borderWidth:5}),this.add(this.avatar),Phaser.Display.Align.In.Center(this.avatar,this,0,-10)},n.createBackgroundScore=function(){this.background=this.scene.make.image({key:fg,frame:gg.BG_SCORE}),this.background.setWorldSize(92,27),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,25)},n.createScoreText=function(){this.textScore=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(35),text:"0",origin:{x:.5,y:.5}}),this.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.background)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.textScore.setText(String(t))},e}(Phaser.GameObjects.Container),vg=mg,yg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.addScore=void 0,n.currentScore=0,n.scene=e,n.initScoreBlockAvatar(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.updateInfo=function(){var t=this.scene.player.getPlayer(),e=t.playerId,n=t.photo;if(this.avatar.loadPhoto(e,n),this.scene.gamePlayMode===Ns){var i=this.scene.storage.getState(),a=(au(i)[e]||{}).score,s=void 0===a?0:a;this.textScore.setText(String(s))}},n.animAddScore=function(t){var e=this,n=this.score+t;this.currentScore=n,this.setScore(n),this.addScore&&this.addScore.isPlaying()&&(this.addScore.remove(),this.setScoreText(n)),this.addScore=this.scene.tweens.addCounter({from:this.score-t,to:this.score,duration:100,onUpdate:function(t){var n=Math.floor(t.getValue());e.setScoreText(n),e.scene.header.bestScoreBlock.updateBestScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){e.setScore(e.score),e.scene.header.bestScoreBlock.updateBestScoreText(e.score),e.setScoreText(n),e.scene.handleNextTargetScore(),e.scene.bestScoreReached()}})},e}(vg),Sg=yg,Ag=function(t){function e(e){var n;return(n=t.call(this,e)||this).initScoreBlockAvatar(),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.updateInfo=function(){var t=this.scene.storage.getState(),e=iu(t),n=jl(t),i=n.playerId,a=n.photo,s=(e[i]||{}).score,r=void 0===s?0:s;this.textScore.setText(String(r)),this.avatar.loadPhoto(i,a)},e}(vg),Eg=Ag,xg=or.default.EFFECTS,bg=xg.KEY,Tg=xg.FRAME,wg=function(t){function e(e){var n;return(n=t.call(this,e,bg,Tg.FX_STAR_WHITE)||this).emitZone=void 0,n.emitter=void 0,n._isPlaying=!1,n.frequency=void 0,n.count=void 0,n.createEmitZone(),n.createEmitters(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createEmitZone=function(){this.emitZone=new Phaser.Geom.Rectangle},n.createEmitters=function(){var t=1/this.scene.world.getPixelRatio();this.emitter=this.createEmitter({frame:Tg.DUST_YELLOW,tint:16710522,emitZone:{source:this.emitZone,type:"random"},frequency:16,speedX:{min:-25,max:-10},speedY:{min:-7,max:7},lifespan:{min:500,max:1500},alpha:{start:.7,end:.3},scale:{min:1*t,max:1.5*t},delay:300})},n.run=function(t,e,n,i,a,s){this.emitZone.setSize(a,s),this.emitZone.setPosition(n-a/2,i-s/2),e!=this.frequency&&(this.emitter.setFrequency(e),this.frequency=e),t!=this.count&&(this.emitter.setQuantity(t),this.count=t),this._isPlaying||(this.emitter.start(),this._isPlaying=!0)},n.stop=function(){var t;null==(t=this.emitter)||t.stop(),this._isPlaying=!1},n.isPlaying=function(){return this._isPlaying},e}(Phaser.GameObjects.Particles.ParticleEmitterManager),Mg=wg,Cg=or.default.GAMEPLAY,Pg=Cg.KEY,Ig=Cg.FRAME,kg=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.rightWhiteProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.sparkling=void 0,a.setSize(n,i),a.scene=e,a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup(),this.createSparkling()},n.initBg=function(){this.leftBg=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BG_RIGHT});var t=this.leftBg,e=t.width,n=t.height,i=e*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var h=this.width-(i+o);this.midBg.setWorldSize(h,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BAR_RIGHT}),this.rightWhiteProgress=this.scene.make.image({key:Pg,frame:Ig.PROGRESS_BAR_RIGHT_WHITE});var t=this.leftProgress,e=t.width,n=t.height,i=e*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var h=this.rightWhiteProgress,c=h.width,l=h.height,u=c*this.height/l;this.rightWhiteProgress.setWorldSize(u,this.height);var d=this.width-(i+o)+2;this.midProgress.setWorldSize(d,this.height),this.add(this.rightWhiteProgress),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:Pg,frame:Ig.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:Pg,frame:Ig.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new ol({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(Pg),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:Ig.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createSparkling=function(){this.sparkling=new Mg(this.scene),this.add(this.sparkling)},n.createMilestoneFrame=function(){var t=this.scene.make.image({key:Pg,frame:Ig.FLAG});return t.setWorldSize(16,22),t},n.getMilestoneFrame=function(){var t,e=c()(t=this.listPoolMilestoneFrame).call(t,(function(t){return!t.visible}));if(!e||0===e.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return e[0]},n.handleSetAlphaListMilestone=function(t){this.listMilestoneFrame.forEach((function(e){e.score<=t?e.frame.setAlpha(1):e.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(t){t>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(t){t.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(t){this.targetScore=t},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(t){var e=t*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth,s=this.leftBg.width+this.midBg.width+this.rightBg.width;if(this.sparkling.setPosition(),0===t)return this.rightWhiteProgress.setVisible(!1),this.sparkling.stop(),this.stopAnimGlare(),void this.stopEmitter();var r=s*(t>1?1:t),o=this.leftBg.x+r-this.leftBg.width/2+this.rightWhiteProgress.width/2-1;if(this.scene.isNextTarget?(this.runSparklingEmitZone(o-2),this.scene.isNextTarget=!1):this.sparkling.run(2,50,o,this.leftBg.y-.5,4,4),this.rightWhiteProgress.setVisible(!0),this.rightWhiteProgress.x=e-s/2+this.rightWhiteProgress.width/2-3,t>=1){this.rightWhiteProgress.x=s-this.rightProgress.x-a;var h=s-this.rightProgress.x-a;if(this.sparkling.run(2,50,h,this.leftBg.y-.5,4,4),this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}if(this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,e<n)return this.leftProgress.setVisible(!0),t<=.01?(this.leftProgress.setCrop(0,0,5,2*this.height),void(this.rightWhiteProgress.x+=2)):void this.leftProgress.setCrop(0,0,e/this.leftProgress.scaleX,2*this.height);if(e>n+i){this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),this.rightProgress.setCrop(0,0,(e-(n+i-2))/this.rightProgress.scaleX,2*this.height),this.rightWhiteProgress.x=this.rightProgress.x-2;var c=this.rightProgress.x-2;this.sparkling.run(2,50,c,this.leftBg.y-.5,4,4)}else this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,(e-n)/this.midProgress.scaleX,2*this.height)},n.runSparklingEmitZone=function(t){this.scene.tweens.add({targets:this.sparkling.emitZone,x:t,duration:400})},e}(Phaser.GameObjects.Container),Rg=or.default.GAMEPLAY,Og=Rg.KEY,_g=Rg.FRAME,Dg=function(t){function e(e){var n;return(n=t.call(this,e,Og,_g.BUTTON_WOOD_SMALL)||this).button.setWorldSize(55,48),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Og,frame:_g.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,1,-1.5)},e}(_r.default),Bg=Dg,Lg=or.default.GAMEPLAY,Fg=Lg.KEY,Ng=Lg.FRAME,Gg=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.myScoreBlock=void 0,n.opponentScoreBlock=void 0,n.iconBattle=void 0,n.progressBar=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,0),e.add.existing((0,nr.default)(n)),n.createLeaf(),n.creatIconBattle(),n.createBestScoreBlock(),n.createSettingButton(),n.createMainScoreBlock(),n.createMyScoreBlock(),n.createOpponentScoreBlock(),n.createProgressBar(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLeaf=function(){var t=new og(this.scene);this.add(t),Phaser.Display.Align.In.Center(t,this,0,t.displayHeight/2)},n.createBestScoreBlock=function(){this.bestScoreBlock=new ng(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this,-132,-12.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new dg(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createMyScoreBlock=function(){this.myScoreBlock=new Sg(this.scene),this.myScoreBlock.setVisible(!1),this.add(this.myScoreBlock),Phaser.Display.Align.In.Center(this.myScoreBlock,this,-52,35)},n.createOpponentScoreBlock=function(){this.opponentScoreBlock=new Eg(this.scene),this.opponentScoreBlock.setVisible(!1),this.add(this.opponentScoreBlock),Phaser.Display.Align.In.Center(this.opponentScoreBlock,this,52,35)},n.createSettingButton=function(){this.buttonSetting=new Bg(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,132,51)},n.createProgressBar=function(){this.progressBar=new kg(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92)},n.creatIconBattle=function(){this.iconBattle=this.scene.make.image({key:Fg,frame:Ng.ICON_BATTLE}),this.iconBattle.setWorldSize(30,27),this.iconBattle.setVisible(!1),this.add(this.iconBattle),Phaser.Display.Align.In.Center(this.iconBattle,this,0,24)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!1),this.iconBattle.setVisible(!1)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1),this.opponentScoreBlock.setVisible(!0),this.myScoreBlock.setVisible(!0),this.iconBattle.setVisible(!0)},e}(Phaser.GameObjects.Container),Ug=Gg,Vg=or.default.GAMEPLAY_32.FRAME,Yg=[""+Vg.BLOCK_GRADIENT_PREFIX+10,""+Vg.BLOCK_GRADIENT_PREFIX+9],zg=[],Hg=1;Hg<=10;Hg++)zg.push(""+Vg.BLOCK_GRADIENT_PREFIX+Hg);var Wg=function(){var t=GameCore.Utils.Device,e=window.navigator.vibrate;return t.isAndroid()&&"function"===typeof e||t.isMobileWeb()&&"function"===typeof e||t.isIOS()},Xg=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Math.round(e/80),i=0,a=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,FBInstant.performHapticFeedbackAsync();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}();case 3:if(!(i<n)){t.next=11;break}return s=a(),r=(0,Ge.sleepAsync)(80),i+=1,t.next=9,mt().all([s,r]);case 9:t.next=3;break;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Kg=function(t){window.navigator.vibrate(0),window.navigator.vibrate(t)},jg=function(t){try{if(!Wg())return!1;var e=GameCore.Utils.Device;e.isAndroid()||e.isMobileWeb()?Kg(t):e.isIOS()&&Xg(t).catch((function(t){}))}catch(n){}},qg=function(){function t(t){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createTweenBreaking()},e.handleShowEffect=function(t){var e=this;t&&0!==t.length&&(this.removeCaptureCell(),this.captureCells=t,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){e.breakingTween.isPlaying()||e.removeCaptureCell()}}))},e.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var t=this.scene.main.board.dataBoard,e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.removeCaptureCell=function(){var t=this.scene.main.board.dataBoard;if(this.captureCells)for(var e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.setValueCaptureCell=function(){for(var t=this.scene.main.board.dataBoard,e=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,e),a=Phaser.Math.Between(82,98)*Math.PI/180,s=Phaser.Math.Between(3,10)/1e3,r=this.captureCells[n],o=r.x,h=t[r.y][o].cell;h.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,h.imageBreak.setFrame(or.default.GAMEPLAY_32.FRAME.GEM),h.imageBreak.setVisible(!0),h.v0=i,h.alpha0=a,h.scaleRate0=s}},e.createTweenBreaking=function(){var t=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(e){if(t.captureCells)for(var n=t.scene.main.board.dataBoard,i=0;i<t.captureCells.length;i++){t.angle=Phaser.Math.Between(-15,15);var a=t.captureCells[i],s=a.x,r=n[a.y][s].cell,o=r.imageBreak,h=r.maxScale0,c=r.alpha0<1.57?1:-1,l=.016*e.getValue(),u=Dp(r.v0,r.alpha0,l),d=Bp(r.v0,r.alpha0,l);o.setVisible(!0),o.x=r.x0+u,o.y=r.y0+-d,o.rotation+=.04*c,o.scale>h?o.scale-=r.scaleRate0:o.scale=h}},onComplete:function(){t.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},t}(),Zg=qg,Jg=or.default.GAMEPLAY,Qg=Jg.KEY,$g=Jg.FRAME,tm=or.default.GAMEPLAY_32,em=tm.KEY,nm=tm.FRAME,im=or.default.DEFAULT.FRAME,am=GameCore.Configs.Board,sm=am.cols,rm=am.rows,om=GameCore.Configs.Gameplay.VibrateValue,hm=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=4.5,a.borderTopSize=3,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.canCaptureLines=function(t,e){void 0===e&&(e=5);for(var n=t.length,i=t[0].length,a=[],s=[],r=[],o=0;o<n;o++){for(var h=0,c={x:-1,y:-1},l=0;l<i;l++)0===o&&(r[l]={count:0,x:-1,y:-1}),1===t[o][l].value?(r[l].count++,h++):(c.x=l,c.y=o,r[l].x=l,r[l].y=o);if(h===i-1&&s.push((0,wt.default)({row:o},c)),o===n-1)for(var u=0;u<i;u++)r[u].count===n-1&&a.push((0,wt.default)({col:u},r[u]))}if(s.length>=e)for(var d=0,p={x:-1,y:-1},f=0;f<s.length;f++)if(0!==f){if(s[f].x===p.x&&s[f].y===p.y+1?(p.x=s[f].x,p.y=s[f].y,d++):d=1,d>=e)return{isCapture:!0,direction:"vertical",minLine:e}}else p.x=s[f].x,p.y=s[f].y,d++;if(a.length>=e)for(var g=0,m={x:-1,y:-1},v=0;v<a.length;v++)if(0!==v){if(a[v].x===m.x+1&&a[v].y===m.y?(m.x=a[v].x,m.y=a[v].y,g++):g=1,g>=e)return{isCapture:!0,direction:"horizontal",minLine:e}}else m.x=a[v].x,m.y=a[v].y,g++;return{isCapture:!1,direction:"",minLine:e}},a.scene=e,a.setSize(n,i),a.woodenEffect=new Zg(a.scene),a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var t=this.scene.gameZone,e=t.width/2,n=t.height/2-27;this.boardFrame=this.scene.make.image({x:e,y:n,key:Qg,frame:$g.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=1.8,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(sm+1))/sm},n.initDataBoard=function(){for(var t=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,e=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<rm;n++){this.dataBoard[n]=[];for(var i=0;i<sm;i++){var a=t+i*this.cellSize+this.cellPadding*i,s=e+n*this.cellSize+this.cellPadding*n,r={x:a,y:s,width:this.cellSize,height:this.cellSize,texture:em,frame:nm.GEM_TRANSPARENT,depth:Dr.default.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new Up(this.scene,r);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:s,width:this.cellSize,height:this.cellSize,frame:nm.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleTweenStartMission=function(){for(var t=this,e=100,n=0;n<rm;n++)for(var i=function(i){var a=t.dataBoard[n][i].cell,s=0;s=4==n&&4==i?e:n>=3&&n<=5&&i>=3&&i<=5?200:n>=2&&n<=6&&i>=2&&i<=6?300:n>=1&&n<=7&&i>=1&&i<=7?400:500,t.scene.time.delayedCall(s,(function(){a.playTweenStartMission()}))},a=0;a<sm;a++)i(a)},n.handleHighlight=function(t,e){this.cellsHighlight=t;for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y;if(this.dataBoard[s]&&this.dataBoard[s][a]&&0===this.dataBoard[s][a].value){var r=this.dataBoard[s][a].cell;this.dataBoard[s][a].frame=nm.GEM,r.setVisible(!0),r.setFrame(nm.GEM),r.setAlpha(.3)}}this.canCaptureCells(t,e)},n.handleCapturePiece=function(t){var e=this;try{!function(){if(!t||t.length<=0)throw af=0,new Error("Invalid Capture");for(var n=300,i=0,a=Qp(e.dataBoard),s=$p(e.dataBoard),r=Kp(),o=function(o){var h=t[o],c=h.x,l=h.y,u=e.dataBoard[l][c].cell,d=0,p=0,f=0;if(a.length>0&&s.length>0){var m=0,v=0;i=n/sm,-1!==g()(a).call(a,l)&&-1===g()(s).call(s,c)&&(m=i*c,v=0,p=g()(a).call(a,l)),-1===g()(a).call(a,l)&&-1!==g()(s).call(s,c)&&(m=0,v=i*l,p=g()(s).call(s,c)),-1!==g()(a).call(a,l)&&-1!==g()(s).call(s,c)&&(m=i*c,v=i*l,p=Math.max(g()(s).call(s,c),g()(a).call(a,l),0)),-1===g()(a).call(a,l)&&-1===g()(s).call(s,c)&&(m=i*c,v=i*l),d=Math.max(m,v,0)}else if(s.length>0)d=(i=n/sm)*l,p=g()(s).call(s,c),f=l;else if(a.length>0)d=(i=n/rm)*c,p=g()(a).call(a,l),f=c;else{i=100;var y=t[0].x;d=i*(c-y),p=0}u.hideImageHighlight(),e.scene.time.delayedCall(d,(function(){var t="";r>2&&(s.length>=3||a.length>=3)?(t=zg[f]||zg[0],u.imageBreak.setFrame(t)):(t=Yg[p]||Yg[0],u.imageBreak.setFrame(t)),u.playTweenScaleDown(),0==e.dataBoard[l][c].value&&u.setVisible(!1)})),e.dataBoard[l][c].frame=nm.GEM_TRANSPARENT,e.dataBoard[l][c].value=0},h=0;h<t.length;h++)o(h)}()}catch(n){}},n.checkPositionCellOnCaptureCell=function(t,e){var n=c()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return n&&n.length>0},n.handlePraise=function(t,e){if(e&&0!==e.length){var n=sf(),i=Kp();i>1&&(n=18*Xp+10*(rf()-1));for(var a=[],s=0;s<t.length;s++){var r=t[s];this.checkPositionCellOnCaptureCell(r,e)&&a.push(r)}if(0!==a.length){for(var o=a[0].pX,h=0,c=a[0].pY,l=0,u=0;u<a.length;u++){var d=a[u];d.pX<o&&(o=d.pX),d.pX>h&&(h=d.pX),d.pY<c&&(c=d.pY),d.pY>l&&(l=d.pY)}var p=o+(h-o)/2,f=c+(l-c)/2;this.scene.main.praise.handlePraise(p,f,n,i),this.handleStreakBreak(p,f),this.playEatSound(i)}}},n.handleStreakBreak=function(t,e){if(!this.scene.tutorialManager.isRunning()){var n=Kp(),i=rf()-1;if(t-75<0&&(t=75),t+75>375&&(t=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&jg(s),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(im.BG_STREAK),this.scene.effectManager.streakBreak.playAnim(t,e-20)}}},n.getVibrateByLevel=function(t){return om[t]||0},n.playEatSound=function(t){switch(this.scene.audio.playSound(Or.default.EAT_BLOCK,{volume:1}),t){default:break;case 2:this.scene.audio.playSound(Or.default.GOOD);break;case 3:this.scene.audio.playSound(Or.default.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(Or.default.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var t=0;t<this.cellsHighlight.length;t++){var e=this.cellsHighlight[t],n=e.x,i=e.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=nm.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(nm.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){}},n.canCaptureCells=function(t,e){for(var n=this,i=this.dataBoard,a=[],s=0;s<i.length;s++){a[s]=[];for(var r=0;r<i[s].length;r++)a[s][r]=(0,wt.default)({},i[s][r])}for(var o=0;o<t.length;o++){var h=t[o],c=h.x;a[h.y][c].value=1}this.removeAnimCanCaptureCells(a,t);var l=jp(a,t);if(!l||l.length<=0)return!1;for(var u=function(e){var i=l[e],a=i.x,s=i.y;t.some((function(t){return t.x===a&&t.y===s}))||n.cellSharking.push((0,wt.default)({},l[e]))},d=0;d<l.length;d++)u(d);for(var p=0;p<this.cellSharking.length;p++){var f=this.cellSharking[p],g=f.x,m=f.y,v=this.dataBoard[m][g].cell;v.isHighlight()||v.showImageHighlight()}e(Qp(a),$p(a),Jp(a,t),t)},n.removeAnimCanCaptureCells=function(t,e){var n=this;if(0!==this.cellSharking.length){for(var i=Qp(t),a=$p(t),s=Jp(t,e),r=function(t){var e=n.cellSharking[t],r=e.x,o=e.y,h=n.dataBoard[o][r].cell;if(-1!==g()(i).call(i,o)||-1!==g()(a).call(a,r)||s.some((function(t){return t.x===r&&t.y===o})))return"continue";h.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)r(o);this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var t=0;t<this.cellSharking.length;t++){var e=this.cellSharking[t],n=e.x,i=e.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(t){try{this.suggestCells=t;for(var e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(nm.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){}},n.handleRemoveSuggestMove=function(){try{for(var t=0;t<this.suggestCells.length;t++){var e=this.suggestCells[t],n=e.x,i=e.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(nm.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){}},n.handleMove=function(t,e){try{for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y;if(this.dataBoard[s]&&this.dataBoard[s][a]){this.dataBoard[s][a].frame=nm.GEM,this.dataBoard[s][a].value=1;var r=this.dataBoard[s][a].cell;r.setVisible(!0),r.setFrame(nm.GEM),r.setAlpha(1)}}var o=jp(this.dataBoard,t);this.handleCapturePiece(o),this.checkIsGameOver()&&this.scene.setIsGameOver(!0),this.handlePraise(t,o),e&&e(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(h){}},n.handleResetFrameBoard=function(){for(var t=0;t<rm;t++)for(var e=0;e<sm;e++)if(this.dataBoard[t]&&this.dataBoard[t][e]&&1===this.dataBoard[t][e].value){var n=this.dataBoard[t][e],i=n.frame,a=n.cell;a.visible||(0,Ht.sendException)(new Error("Cell is invisible")),a.frame.name!==i&&(0,Ht.sendException)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.checkIsGameOver=function(){for(var t=[],e=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<e.length;i++){var a=e[i],s=a.position;if(!a.used){var r=n[s];t.push({data:r.data,type:r.type,direction:r.direction,isReverse:r.isReverse,frame:r.frame})}}return!!tf(this.dataBoard,t)},n.handleGameOver=function(){this.checkIsGameOver()&&(this.scene.disableInput(),this.runAnimationGameOver())},n.runAnimationGameOver=function(){var t=this;try{this.scene.audio.playSound(Or.default.BOARD_GAME_OVER);for(var e=[],n=function(n){for(var i=function(i){if(t.dataBoard[n]&&t.dataBoard[n][i]&&1===t.dataBoard[n][i].value){var a=Math.floor(100*(n+1));e.push({delay:a,x:i,y:n}),t.scene.time.delayedCall(a,(function(){t.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<sm;a++)i(a)},i=0;i<rm;i++)n(i);this.scene.time.addEvent({delay:e[e.length-1].delay+300,callback:function(){t.scene.handleRequestFinishGame()}})}catch(a){}},n.rescue=function(){for(var t=0;t<this.dataBoard.length;t++)for(var e=0;e<this.dataBoard[t].length;e++)if(this.dataBoard[t]){var n=this.dataBoard[t][e];n&&1===n.value&&(this.dataBoard[t][e].cell.setFrame(nm.GEM),this.dataBoard[t][e].cell.resetImageGameOver())}this.handleUseBomb()},n.hasPieceL5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===Go})).length>0},n.hasPieceCross5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===Zo})).length>0},n.handleUseBomb=function(){try{var t=this.hasPieceL5(),e=this.hasPieceCross5(),n=Math.floor(Math.random()*ho.length),i=ho[n];t&&(i=co[n]),e&&(i=lo[n]);for(var a=[],s=i.minRow;s<i.minRow+i.rows;s++)for(var r=i.minCol;r<i.minCol+i.cols;r++)this.dataBoard[s][r].frame!==nm.GEM_TRANSPARENT&&a.push({x:r,y:s});for(var o=0;o<a.length;o++){var h=a[o],c=h.x,l=h.y,u=this.dataBoard[l][c];u.frame=nm.GEM_TRANSPARENT,u.value=0,u.cell.setFrame(nm.GEM_TRANSPARENT),u.cell.setVisible(!1)}this.woodenEffect.handleShowEffect(a),this.scene.footer.pieces.setActivePieces(),this.scene.updateMatchData()}catch(d){}},n.getBoardByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){e[s]=[];for(var r=cf(i[s]),o=0;o<r.length;o++)e[s][o]=r[o]}return e},n.getFenByBoard=function(){for(var t="",e=0;e<rm;e++){for(var n=0,i="",a=0;a<sm;a++){if(0===this.dataBoard[e][a].value&&n++,1===this.dataBoard[e][a].value)n>0&&(i+=n>=rm?"x":""+n,n=0),i+=""+of(this.dataBoard[e][a].frame);a===this.dataBoard[e].length-1&&n>0&&(i+=n>=rm?"x":""+n)}t+=e===this.dataBoard.length-1?""+i:i+"/"}return t},n.startGame=function(t){if(t)for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++){var i=t[e][n],a=i.value,s=i.frame,r=this.dataBoard[e][n];1===a&&(r.value=1,r.frame=s,r.cell.setFrame(nm.GEM),r.cell.setVisible(!0))}},n.clearBoard=function(){for(var t=0;t<rm;t++)for(var e=0;e<sm;e++){var n=this.dataBoard[t][e];n.value=0,n.frame=nm.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(nm.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(t){var e,n=c()(e=this.cellsHighlight).call(e,(function(e){return e.x===t.x&&e.y&&t.y}));return!!(n&&n.length>0)},e}(Phaser.GameObjects.Container),cm=GameCore.Configs.Gameplay,lm=cm.VibrateValue,um=or.default.EFFECTS,dm=um.KEY,pm=um.FRAME,fm=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=e,e.add.existing((0,nr.default)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(dm),this.particle.setDepth(Dr.default.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:pm.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(Dr.default.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var t,e=this,n=this.scene.storage.getState(),i=yl(n),a=this.scene.gameZone.width/2;g()(t=[Gs,Ns,Us]).call(t,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:600,duration:210,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){var t;this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var e=this.scene.storage.getState(),n=yl(e),i=0;n===Fs?(i=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(i+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(i+(this.score||0))):g()(t=[Gs,Ns,Us]).call(t,n)>=0&&(i=this.scene.header.myScoreBlock.score,this.scene.header.myScoreBlock.setScore(i+(this.score||0)),this.scene.header.myScoreBlock.setScoreText(i+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:dm}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(Dr.default.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var t=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var e=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:e},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){t.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:e,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){t.praiseFrame.setScale(0),t.praiseFrame.setAlpha(0),t.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(Dr.default.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(t,e,n,i){this.startX=t,this.startY=e+15,this.listScore.push(n);var a=t-10;this.scoreText.setPosition(a,e+15),this.scoreText.setText("+"+n),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,e+15)),this.playAnimShowScoreText(),this.handlePraiseFrameText(t,e,i);var s=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&jg(s),i<=1||this.changeExplode(a,e,i)},n.getVibrateByLevel=function(t){return lm[t]||0},n.changeExplode=function(t,e,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,t,e)},n.handlePraiseFrameText=function(t,e,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0;switch(i){case pm.TEXT_COOL:a=84,s=30;break;case pm.TEXT_GOOD:a=115.5,s=30;break;case pm.TEXT_EXCELLENT:a=207,s=30}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s),this.praiseFrame.setPosition(t-a/2<0?a/2:t,e-40),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(t){return Oo[t-1]||Oo[0]||null},n.getMainFrameByLevel=function(t){if(t>6)return or.default.EFFECTS.FRAME.TEXT_EXCELLENT;var e=Ro[t-1]||Ro[0];return Phaser.Utils.Array.GetRandom(e.frames)},n.reset=function(){this.createTweenScoreText()},e}(Phaser.GameObjects.Container),gm=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=e,e.add.existing((0,nr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new hm(this.scene,354,352)},n.createPraise=function(){this.praise=new fm(this.scene)},e}(Phaser.GameObjects.Container),mm=gm,vm=n(469),ym=n(470),Sm=or.default.DEFAULT,Am=Sm.KEY,Em=Sm.FRAME,xm=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).glare=void 0,s.bestScoreText=void 0,s.tweenGlare=void 0,s.tweenScoreText=void 0,s.scorePanel=void 0,s.closeButton=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.paperFireworksCelebration=void 0,s.starTwinkle=void 0,s.scene=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.setVisible(!0),s.runOpenAnimation(),s.paperFireworksCelebration.run(0,s.scene.gameZone.height,375,200),s.scene.audio.playSound(Or.default.CONGRATULATION),s.setBestScoreText(e.bestScore)},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.screen.close(s.name)})),hu.emit("best_score_screen_close")},s.scene=e,s.setVisible(!1),s.setDepth(kr),s.createContent(),s.createConfetti(),s.createStarTwinkle(),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t=this,e=this.getData(["duration"])[0],n=void 0===e?0:e;this.scene.time.delayedCall(n,(function(){t.runCloseAnimation()}))},n.createConfetti=function(){this.paperFireworksCelebration=new vm.default(this.scene),this.paperFireworksCelebration.setDepth(Dr.default.ON_TOP)},n.createStarTwinkle=function(){this.starTwinkle=new ym.default(this.scene),this.add(this.starTwinkle)},n.runAnim=function(){this.glare.setScale(0).setAlpha(0),this.bestScoreText.setScale(0).setAlpha(0),this.tweenScoreText.play(),this.tweenGlare.play()},n.createContent=function(){this.createCup(),this.createScorePanel(),this.createButtons()},n.createCup=function(){var t=this.scene.make.image({key:Am,frame:Em.ICON_CUP});t.setWorldSize(290,216),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-105)},n.createScorePanel=function(){this.scorePanel=this.scene.add.container();var t=this.scene.make.image({key:Am,frame:Em.POPUP_SCORE_PANEL});t.setWorldSize(200,56),this.scorePanel.add(t),this.bestScoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(60),origin:{x:.5,y:.5}}),this.bestScoreText.setText("0"),this.scorePanel.add(this.bestScoreText),this.add(this.scorePanel),Phaser.Display.Align.In.Center(t,this.scorePanel,0,0),Phaser.Display.Align.In.Center(this.bestScoreText,this.scorePanel,0,1.5),Phaser.Display.Align.In.Center(this.scorePanel,this,0,46.5)},n.createButtons=function(){this.createCloseButton(),this.createCloseBlueButton()},n.createCloseButton=function(){var t=new _r.default(this.scene,Am,Em.BUTTON_CLOSE,0,0);t.button.setWorldSize(35,35),t.setName("Close"),this.add(t),t.onClick=this.handleClosePopup,Phaser.Display.Align.In.Center(t,this,126,-213)},n.createCloseBlueButton=function(){this.closeButton=new _r.default(this.scene,Am,Em.BUTTON_DARK_BLUE_SMALL,119,46),this.closeButton.onClick=this.handleClosePopup,this.closeButton.setName("Share");var t=this.scene.make.image({key:Am,frame:Em.TEXT_CLOSE_BLUE});t.setWorldSize(55,15),this.closeButton.add(t),this.add(this.closeButton),Phaser.Display.Align.In.Center(t,this.closeButton,0,0),Phaser.Display.Align.In.Center(this.closeButton,this,0,129)},n.setBestScoreText=function(t){this.bestScoreText.setText(""+t)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this],delay:t,duration:e,props:{y:250,scale:0},onComplete:function(){i.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){var t=this;this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.scene.time.delayedCall(2e3,(function(){t.scene.postSessionScore()}))},n.runPopupEntrancesAnimation=function(t,e){var n=this;if(!this.popupShowUpAnimation){var i=this.y,a=this.scale;this.popupShowUpAnimation=new Jr({targets:[this],delay:t,duration:e,props:{y:{from:350,to:i},alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:a}},onComplete:function(){n.starTwinkle.run(1,0,-108,290,216),n.handleDelegate()}})}this.popupShowUpAnimation.play()},e}(GameCore.Screen),bm=xm,Tm=n(471),wm=or.default.DEFAULT,Mm=wm.KEY,Cm=wm.FRAME,Pm=function(t){function e(e){var n;return(n=t.call(this,e,Mm,Cm.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Mm,frame:Cm.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),Im=Pm,km=or.default.DEFAULT,Rm=km.KEY,Om=km.FRAME,_m=function(t){function e(e){var n;return(n=t.call(this,e,Rm,Om.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Rm,frame:Om.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),Dm=_m,Bm=or.default.DEFAULT,Lm=Bm.KEY,Fm=Bm.FRAME,Nm=function(t){function e(e){var n;return(n=t.call(this,e,Lm,Fm.BUTTON_DARK_BLUE_BIG)||this).button.setWorldSize(120,55),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Lm,frame:Fm.ICON_SWORD_BLUE});t.setWorldSize(22,20),this.add(t),Phaser.Display.Align.In.Center(t,this,-40)},n.createText=function(){var t=this.scene.make.image({key:Lm,frame:Fm.TEXT_PLAY_WITH_BLUE});t.setWorldSize(76,12),this.add(t),Phaser.Display.Align.In.Center(t,this,12)},e}(_r.default),Gm=Nm,Um=or.default.DEFAULT,Vm=Um.KEY,Ym=Um.FRAME,zm=function(t){function e(e){var n;return(n=t.call(this,e,Vm,Ym.BUTTON_GREEN_BIG)||this).button.setWorldSize(120,55),n.setName("Play"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Vm,frame:Ym.ICON_I_PLAY});t.setWorldSize(22,27),this.add(t),Phaser.Display.Align.In.Center(t,this,-30,-2)},n.createText=function(){var t=this.scene.make.image({key:Vm,frame:Ym.TEXT_PLAY});t.setWorldSize(56,17),this.add(t),Phaser.Display.Align.In.Center(t,this,15,-2)},e}(_r.default),Hm=zm,Wm=or.default.DEFAULT,Xm=Wm.KEY,Km=Wm.FRAME,jm=function(t){function e(e){var n;return(n=t.call(this,e)||this).popup=void 0,n.avatarMe=void 0,n.textScoreMe=void 0,n.avatarOpponent=void 0,n.textScoreOpponent=void 0,n.title=void 0,n.titleFrame=void 0,n.contents=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.myInfoBlock=void 0,n.tweenMyInfoBlock=void 0,n.opponentInfoBlock=void 0,n.tweenOpponentInfoBlock=void 0,n.icon=void 0,n.tweenIcon=void 0,n.iconCrown=void 0,n.tweenIconCrown=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.homeButton=void 0,n.shareButton=void 0,n.buttonClose=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(Nd());case 2:hu.emit(dc.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(_d());case 2:hu.emit(dc.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickShare=function(){n.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d,p,f;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=window.game,a=i.player,s=i.analytics,r=i.facebook,o=i.globalScene,h=i.lang,t.prev=1,o.screen.open(cr,{message:h.Text.LOADING,loading:!0}),c=n(),t.next=6,vu(c);case 6:return l=t.sent,uu(l),u=a.getPlayer(),d=u.playerId,p=u.name,f=u.photo,t.next=12,r.shareAsync({text:h.Text.SHARE_GAME_RESULTS,intent:"SHARE",image:l||"",data:{playerId:d,playerName:p,playerPhoto:f,type:ks}});case 12:s.event(ni.AnalyticsEvents.SHARE,{share_content_type:"MatchResult",success:!0}),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),s.event(ni.AnalyticsEvents.SHARE,{share_content_type:"MatchResult",success:!1}),(0,Ht.sendException)(t.t0);case 19:return t.prev=19,o.screen.close(cr),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[1,15,19,22]])})));return function(e,n){return t.apply(this,arguments)}}())},n.handleShareBestScore=function(){n.scene.storage.dispatch(du())},n.createPopup(),n.createPopupContent(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new no(this.scene,0,0,290,290,{forceHeightTop:54}),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createContentBackground(),this.createMyInfoBlock(),this.createOpponentInfoBlock(),this.createIcon(),this.createIconCrown(),this.createButtons(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.playButton,this.shareButton])},n.updateButtons=function(){try{this.checkExistConnectedPlayerId()?(this.playWithFriendsButton.setVisible(!0),this.playButton.setVisible(!1)):(this.playWithFriendsButton.setVisible(!1),this.playButton.setVisible(!0))}catch(t){}},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:Xm,frame:Km.TEXT_WAITING_OPPONENT}),this.titleFrame.setWorldSize(238,16),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,10),this.buttonClose=new _r.default(this.scene,Xm,Km.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add([this.titleFrame,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createContentBackground=function(){var t=this.scene.make.image({key:Xm,frame:Km.POPUP_CONTENT_BACKGROUND});t.setWorldSize(263,140),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-30)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonShare()},n.createButtonHome=function(){this.homeButton=new Im(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.popup,-100,80)},n.clickHome=function(){this.scene.scene.switch(qs.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Gm(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.popup,0,80)},n.createButtonPlay=function(){this.playButton=new Hm(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.popup,0,80)},n.createButtonShare=function(){this.shareButton=new Dm(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this.popup,100,80)},n.createMyInfoBlock=function(){this.myInfoBlock=this.scene.add.container(),this.avatarMe=new fl(this.scene,{key:Xm,frame:Km.AVATAR_BORDER_BIG,background:Km.AVATAR_BACKGROUND,width:87,height:87,borderWidth:8}),this.myInfoBlock.add(this.avatarMe),Phaser.Display.Align.In.Center(this.avatarMe,this.myInfoBlock,0,0);var t=this.scene.make.image({key:Xm,frame:Km.SCORE_PANEL_DARK});t.setWorldSize(95,26),this.myInfoBlock.add(t),Phaser.Display.Align.In.BottomCenter(t,this.avatarMe,0,10),this.textScoreMe=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.myInfoBlock.add(this.textScoreMe),Phaser.Display.Align.In.Center(this.textScoreMe,t),this.popup.add(this.myInfoBlock),Phaser.Display.Align.In.Center(this.myInfoBlock,this.popup,-72,-38),this.myInfoBlock.setAlpha(0),this.tweenMyInfoBlock=this.scene.tweens.add({targets:this.myInfoBlock,paused:!0,duration:200,delay:400,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createOpponentInfoBlock=function(){this.opponentInfoBlock=this.scene.add.container(),this.avatarOpponent=new fl(this.scene,{key:Xm,frame:Km.AVATAR_BORDER_BIG,background:Km.AVATAR_BACKGROUND,width:87,height:87,borderWidth:8}),this.opponentInfoBlock.add(this.avatarOpponent),Phaser.Display.Align.In.Center(this.avatarOpponent,this.opponentInfoBlock,0,0);var t=this.scene.make.image({key:Xm,frame:Km.SCORE_PANEL_DARK});t.setWorldSize(95,26),this.opponentInfoBlock.add(t),Phaser.Display.Align.In.BottomCenter(t,this.avatarOpponent,0,10),this.textScoreOpponent=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(42),text:"0",origin:{x:.5,y:.5}}),this.opponentInfoBlock.add(this.textScoreOpponent),Phaser.Display.Align.In.Center(this.textScoreOpponent,t),this.popup.add(this.opponentInfoBlock),Phaser.Display.Align.In.Center(this.opponentInfoBlock,this.popup,72,-38),this.opponentInfoBlock.setAlpha(0),this.tweenOpponentInfoBlock=this.scene.tweens.add({targets:this.opponentInfoBlock,paused:!0,duration:200,delay:500,scale:{from:1.5,to:1},alpha:{from:0,to:1},ease:Phaser.Math.Easing.Bounce.Out})},n.createIcon=function(){this.icon=this.scene.make.image({key:Xm,frame:Km.TEXT_VS}),this.icon.setWorldSize(32,18);var t=this.icon.scale;this.popup.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this.popup,0,-30),this.icon.setAlpha(0),this.tweenIcon=this.scene.tweens.add({targets:this.icon,paused:!0,duration:200,delay:300,scale:{from:1.5,to:t},alpha:{from:0,to:1},ease:"Power1"})},n.createIconCrown=function(){this.iconCrown=this.scene.make.image({key:Xm,frame:Km.ICON_CROWN_BIG}),this.iconCrown.setWorldSize(50,46),this.iconCrown.setVisible(!1);var t=this.iconCrown.scale;this.popup.add(this.iconCrown),this.iconCrown.setScale(0),this.tweenIconCrown=this.scene.tweens.add({targets:this.iconCrown,paused:!0,duration:200,delay:300,scale:{from:1.5,to:t},alpha:{from:0,to:1},ease:"Power1"})},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.runOpenAnimation=function(){this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.updateInfo=function(){var t=this.scene.storage.getState(),e=iu(t),n=this.scene.player.getPlayer().playerId,i=jl(t).playerId,a=Zl(t,{playerId:n}),s=Jl(t,{opponentId:i}),r=(e[n]||{}).score,o=void 0===r?0:r,h=(e[i]||{}).score,c=void 0===h?0:h;return this.textScoreMe.setText(String(o)),this.textScoreOpponent.setText(String(c)),a&&s?o===c?(this.titleFrame.setFrame(Km.TEXT_DRAW),this.titleFrame.setWorldSize(85,22),void this.scene.audio.playSound(Or.default.DRAW)):o>c?(this.titleFrame.setFrame(Km.TEXT_WIN),this.titleFrame.setWorldSize(175,32),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarMe,-110,-80),void this.scene.audio.playSound(Or.default.WIN)):o<c?(this.titleFrame.setFrame(Km.TEXT_LOSE),this.titleFrame.setWorldSize(121,20),this.iconCrown.setVisible(!0),Phaser.Display.Align.In.Center(this.iconCrown,this.avatarOpponent,35,-80),void this.scene.audio.playSound(Or.default.LOSE)):void 0:(this.titleFrame.setFrame(Km.TEXT_WAITING_OPPONENT),this.titleFrame.setWorldSize(238,16),void this.scene.audio.playSound(Or.default.WAIT_OPPONENT))},n.loadAvatars=function(){var t=this.scene.storage.getState(),e=this.scene.player.getPlayer(),n=e.photo,i=e.playerId,a=jl(t),s=a.playerId,r=a.photo;this.avatarMe.loadPhoto(i,n,5),this.avatarOpponent.loadPhoto(s,r,5)},n.runAnim=function(){this.icon.setVisible(!0),this.myInfoBlock.setVisible(!0),this.opponentInfoBlock.setVisible(!0),this.iconCrown.setScale(0),this.tweenIconCrown.play(),this.tweenIcon.play(),this.tweenMyInfoBlock.play(),this.tweenOpponentInfoBlock.play()},n.checkExistConnectedPlayerId=function(){var t=this,e=this.scene.player.getConnectedPlayerIds(20,0);return!(c()(e).call(e,(function(e){return e!==t.scene.player.getPlayerId()})).length<=Md.length)},e}(Phaser.GameObjects.Container),qm=jm,Zm={targets:[],yoyo:!0,duration:120,ease:Phaser.Math.Easing.Circular.Out,props:{scale:{from:1,to:1.3}}},Jm=function(t){function e(e){return t.call(this,Zm,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),Qm=Jm,$m=or.default.DEFAULT,tv=$m.KEY,ev=$m.FRAME,nv=function(t){function e(e){var n;return(n=t.call(this,e,tv,ev.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("JourneyIcon"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:tv,frame:ev.ICON_BROWN_JOURNEY});t.setWorldSize(28,26),this.add(t),Phaser.Display.Align.In.Center(t,this)},e}(_r.default),iv=nv,av=or.default.DEFAULT,sv=av.KEY,rv=av.FRAME,ov=function(t){function e(e){var n;return(n=t.call(this,e)||this).popup=void 0,n.title=void 0,n.contents=void 0,n.scoreText=void 0,n.bestScoreText=void 0,n.tweenScoreText=void 0,n.popupShowUpAnimation=void 0,n.contentShowUpAnimation=void 0,n.popupFadeOutAnimation=void 0,n.scoreBlock=void 0,n.bestScoreBlock=void 0,n.playWithFriendsButton=void 0,n.playButton=void 0,n.homeButton=void 0,n.journeyButton=void 0,n.bestScore=void 0,n.currentScore=void 0,n.payload=void 0,n.buttonClose=void 0,n.counterAnimation=void 0,n.scoreAnimation=void 0,n.clickPlayWithFriends=function(){n.runCloseAnimation(),n.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.scene.storage.dispatch(Nd());case 2:hu.emit(dc.REPLAY);case 3:case"end":return t.stop()}}),t)}))))},n.clickPlay=function(){n.runCloseAnimation(),n.scene.storage.dispatch(_d()),hu.emit(dc.REPLAY)},n.clickJourney1=function(){n.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)},n.initScore(),n.scene=e,n.createPopup(),n.createPopupContent(),n.createScoreAnimation(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new no(this.scene,0,0,290,290,{forceHeightTop:54}),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.playButton,this.journeyButton])},n.updateButtons=function(){try{this.playWithFriendsButton.setVisible(!1),this.playButton.setVisible(!0)}catch(t){}},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:sv,frame:rv.TEXT_YOUR_SCORE});t.setWorldSize(182,22),Phaser.Display.Align.In.Center(t,this.title,0,10),this.buttonClose=new _r.default(this.scene,sv,rv.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),Phaser.Display.Align.In.RightCenter(this.buttonClose,this.title,155,-12),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container();var t=this.scene.make.image({key:sv,frame:rv.SCORE_PANEL});t.setWorldSize(263,70),this.scoreBlock.add(t),this.scoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(85),text:"0",origin:{x:.5,y:.5}}),this.scoreBlock.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.scoreBlock,0,4),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-78)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var t=this.scene.make.image({key:sv,frame:rv.BEST_SCORE_FRAME_LONG});t.setWorldSize(193,77),this.bestScoreBlock.add(t),this.bestScoreText=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(44),text:"0",origin:{x:.5,y:.5}}),this.bestScoreBlock.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,16),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,65)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonPlay(),this.createButtonJourney()},n.createButtonHome=function(){this.homeButton=new Im(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.bestScoreBlock,-100,80)},n.clickHome=function(){this.scene.scene.switch(qs.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Gm(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.playWithFriendsButton.setVisible(!1),this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.bestScoreBlock,0,80)},n.createButtonPlay=function(){this.playButton=new Hm(this.scene),this.playButton.onClick=this.clickPlay,this.playButton.setVisible(!1),this.popup.add(this.playButton),Phaser.Display.Align.In.Center(this.playButton,this.bestScoreBlock,0,80)},n.createButtonJourney=function(){this.journeyButton=new iv(this.scene),this.journeyButton.onClick=this.clickJourney1,this.popup.add(this.journeyButton),Phaser.Display.Align.In.Center(this.journeyButton,this.bestScoreBlock,100,80)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(t){this.bestScoreText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=au(t),n=e.score,i=e.bestScore;if(void 0===n&&void 0===i){var a=iu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(t){this.payload=t;var e=t.bestScore,n=t.currentScore;if(this.setBestScore(e),n<=e)return this.setCurrentScore(0),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter()},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new Qm({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var t,e=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(t=this.counterAnimation)||t.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(t){e.scene.audio.playSound(Or.default.SCORE_COUNT);var n=Math.floor(t.getValue());e.runScoreAnimation(),e.setCurrentScore(n)},onComplete:function(){e.setBestScore(i<a?a:i),e.setCurrentScore(a)}})},n.setCurrentScore=function(t){this.scoreText.setText(""+t)},e}(Phaser.GameObjects.Container),hv=ov,cv=(GameCore.Configs.LeadersBoard,or.default.DEFAULT),lv=(cv.KEY,cv.FRAME,function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).bestScore=void 0,s.currentScore=void 0,s.confettiLeftEffect=void 0,s.confettiRightEffect=void 0,s.queueScreens=[],s.popupYourScore=void 0,s.popupResult=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.open=function(){t.prototype.open.call((0,nr.default)(s)),s.popupYourScore.setVisible(!1),s.popupResult.setVisible(!1),s.runFadeInMaskAnimation(100,300),s.initScore(),s.updateScore(),s.showPopupYourScore(),s.scene.audio.playSound(Or.default.GAME_OVER_SCENE)},s.onPopupClose=function(){var t,e;null==(t=s.popupYourScore)||t.runCloseAnimation(),null==(e=s.popupResult)||e.runCloseAnimation(),s.runFadeOutMaskAnimation(0,200),s.scene.time.delayedCall(300,(function(){s.close(),s.scene.screen.open(vr,{onClose:function(){s.scene.storage.dispatch(_d()),hu.emit(dc.START_GAME)}})}))},s.createConfettiSmallAnimation(),s.createPopups(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.showQueueScreens=function(){var t=this.queueScreens.pop();if(t&&t===pr)this.showPopupResult()},n.showPopupBestScore=function(){},n.showPopupYourScore=function(){this.popupYourScore.setVisible(!0),this.popupYourScore.runOpenAnimation(),this.popupYourScore.updateButtons(),this.popupYourScore.updateScore()},n.showPopupResult=function(){this.popupResult.setVisible(!0),this.popupResult.runOpenAnimation(),this.popupResult.updateInfo(),this.popupResult.loadAvatars(),this.popupResult.updateButtons(),this.popupResult.runAnim()},n.updateQueueScreens=function(){this.updateQueueResultScreen()},n.updateQueueResultScreen=function(){var t,e=this.scene.storage.getState(),n=yl(e);if(-1!==g()(t=[Ns,Gs,Us]).call(t,n)&&Xl(e)){var i=jl(e).playerId;n===Gs&&i===Ls.playerId||this.queueScreens.push(pr)}},n.createPopups=function(){this.createPopupYourScore(),this.createPopupResult()},n.createPopupYourScore=function(){this.popupYourScore=new hv(this.scene),this.popupYourScore.setVisible(!1),this.popupYourScore.buttonClose.onClick=this.onPopupClose,this.add(this.popupYourScore),Phaser.Display.Align.In.Center(this.popupYourScore,this,0,0)},n.createPopupResult=function(){this.popupResult=new qm(this.scene),this.popupResult.setVisible(!1),this.popupResult.buttonClose.onClick=this.onPopupClose,this.add(this.popupResult),Phaser.Display.Align.In.Center(this.popupResult,this,0,-61)},n.createConfettiSmallAnimation=function(){this.confettiLeftEffect=new Tm.default(this.scene,{speedX:{min:-20,max:100},rotate:{start:-1080,end:0}}),this.confettiRightEffect=new Tm.default(this.scene,{speedX:{min:20,max:-100},rotate:{start:0,end:1080}}),this.confettiLeftEffect.setDepth(Dr.default.ON_TOP),this.confettiRightEffect.setDepth(Dr.default.ON_TOP)},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=au(t),n=e.score,i=e.bestScore;if(this.bestScore=i,void 0===n||void 0===i){var a=iu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen)),uv=lv,dv=n(326),pv=n.n(dv),fv=function(t){return t.lives},gv=(0,be.createSelector)([function(t){return fv(t).lives}],(function(t){return t})),mv=(0,be.createSelector)([function(t){return fv(t).lastBonusLifeTime}],(function(t){return t})),vv=(0,be.createSelector)([function(t){return fv(t).countDownStartAt}],(function(t){return t})),yv=GameCore.Configs,Sv=yv.Match,Av=yv.Lives,Ev=function(t){return function(e){setTimeout((function(){e(Tv()),e(bv()),e(xv())}),t)}},xv=function(){return function(t){var e=60*Av.bonusDurationMins*1e3;setInterval((function(){t(Tv()),t(bv())}),e)}},bv=function(){return function(t){t({type:hs,payload:{}})}},Tv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=gv(r),(h=Av.bonusLife+o)>Av.livesCapacity&&(h=Av.livesCapacity),c={lives:h,lastBonusLifeTime:(new Date).getTime()},e({type:rs,payload:{data:c}}),t.next=11,window.FBInstant.player.setDataAsync({lives:c});case 11:Le(Sv.LivesStore+"-"+s,c),t.next=16;break;case 14:t.prev=14,t.t0=t.catch(0);case 16:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}()},wv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game.player,a=i.getPlayer(),s=a.playerId,r=n(),o=gv(r),h=mv(r),(c=o-Av.bonusLife)>Av.livesCapacity&&(c=Av.livesCapacity),c<0&&(c=0),e({type:rs,payload:{data:l={lives:c,lastBonusLifeTime:h}}}),t.next=13,window.FBInstant.player.setDataAsync({lives:l});case 13:Le(Sv.LivesStore+"-"+s,l),t.next=18;break;case 16:t.prev=16,t.t0=t.catch(0);case 18:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,n){return t.apply(this,arguments)}}()},Mv=function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=n(),a=gv(i)||0,s=mv(i)){t.next=8;break}return t.next=7,e(Cv({lives:a,lastBonusLifeTime:(new Date).getTime()}));case 7:return t.abrupt("return");case 8:return r=(new Date).getTime(),o=Math.floor((r-s)/1e3/(60*Av.bonusDurationMins)),(h=o+a)>Av.livesCapacity&&(h=Av.livesCapacity),c={lives:h,lastBonusLifeTime:h===a?s:(new Date).getTime()},t.next=15,e(Cv(c));case 15:t.next=19;break;case 17:t.prev=17,t.t0=t.catch(0);case 19:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,n){return t.apply(this,arguments)}}()},Cv=function(t){return function(){var e=(0,Xt.default)(qt().mark((function e(n){var i,a,s;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=window.game.player,a=i.getPlayer(),s=a.playerId,n({type:rs,payload:{data:t}}),e.next=5,window.FBInstant.player.setDataAsync({lives:t});case 5:Le(Sv.LivesStore+"-"+s,t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Pv=n(71),Iv=or.default.GAMEPLAY_32.FRAME,kv="vertical",Rv="horizontal",Ov="left",_v="right",Dv="top",Bv="bottom",Lv="vertical_left",Fv="vertical_right",Nv="horizontal_left",Gv="horizontal_right",Uv="gem/gem",Vv="gem/diamond/diamond-10",Yv="gem/diamond/diamond-11",zv="gem/diamond/diamond-12",Hv="gem/diamond/diamond-13",Wv="gem/diamond/diamond-14",Xv="gem/diamond/diamond-15",Kv="gem/ruby/ruby-20",jv="gem/sapphire/sapphire-30",qv=[{level:1,frames:[],width:480,height:189},{level:2,frames:[or.default.EFFECTS.FRAME.TEXT_COOL],width:480,height:189},{level:3,frames:[or.default.EFFECTS.FRAME.TEXT_GOOD],width:579,height:189},{level:4,frames:[or.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:5,frames:[or.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189},{level:6,frames:[or.default.EFFECTS.FRAME.TEXT_EXCELLENT],width:906,height:189}],Zv=[{level:1,scale:.5,speed:.5,quantity:.5},{level:2,scale:.6,speed:.6,quantity:.6},{level:3,scale:.7,speed:.7,quantity:.7},{level:4,scale:.8,speed:.8,quantity:.8},{level:5,scale:.9,speed:.9,quantity:.9},{level:6,scale:1,speed:1,quantity:1}],Jv="l",Qv="l_1",$v="l_3",ty="line_2",ey="line_3",ny="line_4",iy="line_5",ay="square_1",sy="square_2",ry="square_3",oy="trapezoid",hy="triangle",cy="t_piece",ly="plus_piece",uy="cross_piece_2",dy="cross_piece_3",py="cross_piece_4",fy="cross_piece_5",gy="u_piece",my=[Jv,Qv,$v,ty,ey,ny,iy,ay,sy,ry,hy,oy,cy,ly,uy,dy,py,fy,gy],vy=[{type:Jv,rate:3},{type:Qv,rate:4},{type:$v,rate:2},{type:ty,rate:16},{type:ey,rate:12},{type:ny,rate:8},{type:iy,rate:4},{type:ay,rate:16},{type:sy,rate:8},{type:hy,rate:4},{type:oy,rate:4},{type:cy,rate:2},{type:ly,rate:1},{type:uy,rate:4},{type:dy,rate:2},{type:py,rate:1},{type:gy,rate:2}],yy=[[1,0],[1,0],[1,1]],Sy=[[0,1],[0,1],[1,1]],Ay=[[1,0],[1,1]],Ey=[[1,0,0],[1,0,0],[1,1,1]],xy=[[1,1,1],[1,0,0]],by=[[1,1,1],[0,0,1]],Ty=[[1,1],[1,0]],wy=[[1,1,1],[1,0,0],[1,0,0]],My=[[1,1],[0,1],[0,1]],Cy=[[1,1],[1,0],[1,0]],Py=[[1,1],[0,1]],Iy=[[1,1,1],[0,0,1],[0,0,1]],ky=[[0,0,1],[1,1,1]],Ry=[[1,0,0],[1,1,1]],Oy=[[0,1],[1,1]],_y=[[0,0,1],[0,0,1],[1,1,1]],Dy=[[1],[1]],By=[[1,1]],Ly=[[1],[1],[1]],Fy=[[1,1,1]],Ny=[[1],[1],[1],[1]],Gy=[[1,1,1,1]],Uy=[[1],[1],[1],[1],[1]],Vy=[[1,1,1,1,1]],Yy=[[1]],zy=[[1,1],[1,1]],Hy=[[1,1,1],[1,1,1],[1,1,1]],Wy=[[1,0],[1,1],[0,1]],Xy=[[0,1],[1,1],[1,0]],Ky=[[1,1,0],[0,1,1]],jy=[[0,1,1],[1,1,0]],qy=[[0,1],[1,1],[0,1]],Zy=[[1,0],[1,1],[1,0]],Jy=[[0,1,0],[1,1,1]],Qy=[[1,1,1],[0,1,0]],$y=[[0,0,1],[1,1,1],[0,0,1]],tS=[[1,0,0],[1,1,1],[1,0,0]],eS=[[0,1,0],[0,1,0],[1,1,1]],nS=[[1,1,1],[0,1,0],[0,1,0]],iS=[[0,1,0],[1,1,1],[0,1,0]],aS=[[1,0],[0,1]],sS=[[0,1],[1,0]],rS=[[1,0,0],[0,1,0],[0,0,1]],oS=[[0,0,1],[0,1,0],[1,0,0]],hS=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],cS=[[0,0,0,1],[0,0,1,0],[0,1,0,0],[1,0,0,0]],lS=[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]],uS=[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]],dS=[[1,1],[0,1],[1,1]],pS=[[1,1],[1,0],[1,1]],fS=[[1,0,1],[1,1,1]],gS=[[1,1,1],[1,0,1]],mS={1:Iv.GEM,10:Iv.GEM_DIAMOND_10,11:Iv.GEM_DIAMOND_11,12:Iv.GEM_DIAMOND_12,13:Iv.GEM_DIAMOND_13,14:Iv.GEM_DIAMOND_14,15:Iv.GEM_DIAMOND_15},vS={1:{type:ay,direction:null,isReverse:!1,data:Yy},I2:{type:ty,direction:kv,isReverse:!1,data:Dy},I3:{type:ey,direction:kv,isReverse:!1,data:Ly},I4:{type:ny,direction:kv,isReverse:!1,data:Ny},I5:{type:iy,direction:kv,isReverse:!1,data:Uy},II2:{type:ty,direction:Rv,isReverse:!1,data:By},II3:{type:ey,direction:Rv,isReverse:!1,data:Fy},II4:{type:ny,direction:Rv,isReverse:!1,data:Gy},II5:{type:iy,direction:Rv,isReverse:!1,data:Vy},J1:{type:Jv,direction:Dv,isReverse:!0,data:yy},J2:{type:Jv,direction:Ov,isReverse:!0,data:Ry},J3:{type:Jv,direction:Bv,isReverse:!0,data:Cy},J4:{type:Jv,direction:_v,isReverse:!0,data:by},L1:{type:Jv,direction:Dv,isReverse:!1,data:yy},L2:{type:Jv,direction:_v,isReverse:!1,data:xy},L3:{type:Jv,direction:Bv,isReverse:!1,data:My},L4:{type:Jv,direction:Ov,isReverse:!1,data:ky},O:{type:sy,direction:null,isReverse:!1,data:zy},"polyplet-left-2":{type:uy,direction:Ov,isReverse:!1,data:aS},"polyplet-left-3":{type:dy,direction:Ov,isReverse:!1,data:rS},"polyplet-left-4":{type:py,direction:Ov,isReverse:!1,data:hS},"polyplet-left-5":{type:fy,direction:Ov,isReverse:!1,data:lS},"polyplet-right-2":{type:uy,direction:_v,isReverse:!1,data:sS},"polyplet-right-3":{type:dy,direction:_v,isReverse:!1,data:oS},"polyplet-right-4":{type:py,direction:_v,isReverse:!1,data:cS},"polyplet-right-5":{type:fy,direction:_v,isReverse:!1,data:uS},S1:{type:oy,direction:Gv,isReverse:!1,data:jy},S2:{type:oy,direction:Lv,isReverse:!1,data:Wy},T1:{type:hy,direction:Dv,isReverse:!1,data:Jy},T2:{type:hy,direction:_v,isReverse:!1,data:Zy},T3:{type:hy,direction:Bv,isReverse:!1,data:Qy},T4:{type:hy,direction:Ov,isReverse:!1,data:qy},TT1:{type:cy,direction:Bv,isReverse:!1,data:nS},TT2:{type:cy,direction:Ov,isReverse:!1,data:$y},TT3:{type:cy,direction:Dv,isReverse:!1,data:eS},TT4:{type:cy,direction:_v,isReverse:!1,data:tS},U1:{type:gy,direction:Dv,isReverse:!1,data:fS},U2:{type:gy,direction:_v,isReverse:!1,data:pS},U3:{type:gy,direction:Bv,isReverse:!1,data:gS},U4:{type:gy,direction:Ov,isReverse:!1,data:dS},V1:{type:Qv,direction:_v,isReverse:!1,data:Ty},V2:{type:Qv,direction:Bv,isReverse:!1,data:Py},V3:{type:Qv,direction:Dv,isReverse:!1,data:Ay},V4:{type:Qv,direction:Ov,isReverse:!1,data:Oy},VV1:{type:$v,direction:_v,isReverse:!1,data:wy},VV2:{type:$v,direction:Bv,isReverse:!1,data:Iy},VV3:{type:$v,direction:Dv,isReverse:!1,data:Ey},VV4:{type:$v,direction:Ov,isReverse:!1,data:_y},X:{type:ly,direction:null,isReverse:!1,data:iS},Z1:{type:oy,direction:Nv,isReverse:!1,data:Ky},Z2:{type:oy,direction:Fv,isReverse:!1,data:Xy}},yS=GameCore.Configs.Board,SS=(yS.cols,yS.rows,0),AS=function(){return SS},ES=function(t,e){SS=0;for(var n=[],i=t.length,a=t[0].length,s=[],r=[],o=function(e){for(var i=!0,r=0;r<a;r++)0===t[e][r].value&&(i=!1);if(i){s.push(e);for(var o=function(i){n.some((function(t){return t.x===i&&t.y===e}))||n.push({x:i,y:e,frame:t[e][i].frame})},h=0;h<a;h++)o(h)}},h=0;h<i;h++)o(h);for(var c=function(e){for(var a=!0,s=0;s<i;s++)0===t[s][e].value&&(a=!1);if(a){r.push(e);for(var o=function(i){n.some((function(t){return t.x===e&&t.y===i}))||n.push({x:e,y:i,frame:t[i][e].frame})},h=0;h<i;h++)o(h)}},l=0;l<a;l++)c(l);var u=TS(t,e);if(u&&u.length>0)for(var d=function(e){var i=u[e],a=i.x,s=i.y;n.some((function(t){return t.x===a&&t.y===s}))||n.push({x:a,y:s,frame:t[s][a].frame})},p=0;p<u.length;p++)d(p);return SS+=s.length,SS+=r.length,SS+=Math.floor(u.length/9),n},xS=function(t,e){if(0===t.length)return!1;var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||n.length<=0)},bS=function(t,e){for(var n=e.x,i=e.y,a=[],s=n;s<n+3;s++)for(var r=i;r<i+3;r++){if(0===t[r][s].value)return[];a.push({x:s,y:r})}return a},TS=function(t,e){for(var n=[],i=function(t){for(var e,n=[],i=0;i<t.length;i++){var a=(e=t[i],{x:3*Math.floor(e.x/3),y:3*Math.floor(e.y/3)});xS(n,a)||n.push(a)}return n}(e),a=0;a<i.length;a++){var s=i[a],r=bS(t,s);n.push.apply(n,r)}return n},wS=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<e;a++){for(var s=!0,r=0;r<n;r++)0===t[a][r].value&&(s=!1);s&&i.push(a)}return i},MS=function(t){for(var e=t.length,n=t[0].length,i=[],a=0;a<n;a++){for(var s=!0,r=0;r<e;r++)0===t[r][a].value&&(s=!1);s&&i.push(a)}return i},CS=function(t,e){var n=t.length,i=t[0].length;if(0===e.length)return!1;for(var a=0;a<n;a++)for(var s=0;s<i;s++)for(var r=0;r<e.length;r++)if(PS(t,s,a,e[r]))return!1;return!0},PS=function(t,e,n,i){for(var a=!0,s=0;s<i.data.length;s++)for(var r=0;r<i.data[s].length;r++)i.data[s][r].texture&&(t[n+s]&&t[n+s][e+r]&&0===t[n+s][e+r].value||(a=!1));return a},IS=function(t,e){for(var n=t.length,i=t[0].length,a=0;a<n;a++)for(var s=0;s<i;s++)if(PS(t,s,a,e))return!0;return!1},kS=0,RS=function(){return kS+1},OS=function(t){var e=t;switch(t){case Uv:e="g";break;case Vv:e="d10";break;case Yv:e="d11";break;case zv:e="d12";break;case Hv:e="d13";break;case Wv:e="d14";break;case Xv:e="d15";break;case Kv:e="r20";break;case jv:e="s30";break;case Jv:e="l";break;case Qv:e="l1";break;case $v:e="l3";break;case ty:e="e2";break;case ey:e="e3";break;case ny:e="e4";break;case iy:e="e5";break;case ay:e="s1";break;case sy:e="s2";break;case ry:e="s3";break;case oy:e="tz";break;case hy:e="ta";break;case ly:e="pl";break;case cy:e="tp";break;case uy:e="cr2";break;case dy:e="cr3";break;case py:e="cr4";break;case fy:e="cr5";break;case gy:e="up";break;case Dv:e="dt";break;case Ov:e="dl";break;case _v:e="dr";break;case Bv:e="db";break;case kv:e="v";break;case Rv:e="h";break;case Lv:e="vl";break;case Fv:e="vr";break;case Nv:e="hl";break;case Gv:e="hr"}return e},_S=function(t){var e=t;switch(t){case"g":e=Uv;break;case"d10":e=Vv;break;case"d11":e=Yv;break;case"d12":e=zv;break;case"d13":e=Hv;break;case"d14":e=Wv;break;case"d15":e=Xv;break;case"r20":e=Kv;break;case"s30":e=jv;break;case"b":case"c":case"d":case"g":case"o":case"p":case"q":case"r":case"y":e="gem/gem";break;case"l":e=Jv;break;case"l1":e=Qv;break;case"l3":e=$v;break;case"e2":e=ty;break;case"e3":e=ey;break;case"e4":e=ny;break;case"e5":e=iy;break;case"s1":e=ay;break;case"s2":e=sy;break;case"s3":e=ry;break;case"tz":e=oy;break;case"ta":e=hy;break;case"pl":e=ly;break;case"tp":e=cy;break;case"cr2":e=uy;break;case"cr3":e=dy;break;case"cr4":e=py;break;case"cr5":e=fy;break;case"up":e=gy;break;case"dt":e=Dv;break;case"dl":e=Ov;break;case"dr":e=_v;break;case"db":e=Bv;break;case"v":e=kv;break;case"h":e=Rv;break;case"vl":e=Lv;break;case"vr":e=Fv;break;case"hl":e=Nv;break;case"hr":e=Gv}return e},DS=function(t){for(var e=[],n=t.split(","),i=0;i<n.length;i++){var a=n[i],s=_S(a);"x"===a?e.push({value:0,frame:"gem/gem_transparent"}):e.push({value:1,frame:s})}return e},BS=function(t){var e=t.split("|"),n=e[0].split("-");if(n.length<=0)throw new Error("Invalid piece");return{type:_S(n[0]),direction:_S(n[1])||null,isReverse:n[2]&&"r"===n[2]||!1,fenPiece:e[1]}},LS=or.default.DEFAULT,FS=LS.KEY,NS=LS.FRAME,GS=or.default.GAMEPLAY,US=GS.KEY,VS=GS.FRAME,YS=or.default.GAMEPLAY_32,zS=YS.KEY,HS=YS.FRAME,WS=GameCore.Configs,XS=WS.Network,KS=WS.Board,jS=function(t){function e(e,n,i,a){var s;(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){var t=s.getData(["onClose"])[0];s.scene.screen.close(s.name),t&&t()}))},s.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}};try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(kr),s.background.setAlpha(.5)}catch(r){}return s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(n){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this,n),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=eu(t),n=Gu[e];n||(n=Gu[Gu.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.scene.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(a,s),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Ht.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.updateContent=function(){this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!eu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Ed());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(cr,{message:"Loading level...",duration:XS.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(cr)},n.createPopup=function(){this.popup=new no(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:FS,frame:NS.TEXT_JOURNEY});t.setWorldSize(113,20),this.buttonClose=new _r.default(this.scene,FS,NS.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:FS,frame:NS.TEXT_COLLECT});t.setWorldSize(91,15);var e=this.scene.make.image({key:FS,frame:NS.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=eu(n),a=Gu[i];a||(a=Gu[Gu.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,Pv.isArray)(s)&&!(s.length<2))for(var r=s[0].value,o=pv()(t=pv()(e=pv()(r).call(r,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),h=JSON.parse(o),c=Y()(h),l=this.calcPosition(c.length),u=0;u<c.length;u++){var d=c[u],p=mS[d],f=h[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:zS,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:US,frame:VS.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<KS.rows;t++){this.boardCellData[t]=[];for(var e=0;e<KS.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=HS.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(s)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=$l(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<KS.rows;t++)for(var e=0;e<KS.cols;e++){this.boardCellData[t][e].setFrame(HS.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=Yp()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=_S(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=eu(t),n=Gu[e],i=this.scene.make.tilemap({key:n.key}).layers;if((0,Pv.isArray)(i)){var a=i[0].data;if((0,Pv.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var h=r[o];if(!(h.index<0)){var c=mS[h.index-1];this.boardCellData[s][o].setFrame(c)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:zS,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new _r.default(this.scene,FS,NS.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:FS,frame:NS.TEXT_PLAY});t.setWorldSize(50,15);var e=this.scene.make.image({key:FS,frame:NS.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this,e=this.scene.storage.getState();gv(e)<1?this.scene.screen.open(Ir):(this.scene.storage.dispatch(wv()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=eu(e);n>Gu.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Dd()))})))},n.getLevelName=function(t){var e;return"journey_"+rr()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),qS=or.default.DEFAULT,ZS=qS.KEY,JS=qS.FRAME,QS=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textTargetScore=void 0,s.textScore=void 0,s.backgroundContent=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this);var e=this.scene.levelManager.getCurrentTargetScore();this.textScore.setText(""+e),this.runOpenAnimation()},n.createPopup=function(){this.popup=new no(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:ZS,frame:JS.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:ZS,frame:JS.TEXT_NEXT_MILESTONE});t.setWorldSize(245,23),this.title.add([t]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextTargetScore(),this.createTextScore()},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"Target Score",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.popup,0,-60)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.popup,0,-15)},n.createButtons=function(){this.createButtonContinue()},n.createButtonContinue=function(){var t=this.scene.make.image({key:ZS,frame:JS.TEXT_PLAY});t.setWorldSize(86,26),this.buttonContinue=new _r.default(this.scene,ZS,JS.BUTTON_GREEN,172,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t);var e=this.scene.make.image({key:ZS,frame:JS.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonContinue.add(e),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(t,this.buttonContinue,20,-2),Phaser.Display.Align.In.Center(e,this.buttonContinue,-50,-2),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,0,55)},n.clickButtonContinue=function(){this.scene.nextLevel(),this.runCloseAnimation()},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.scene.main.board.handleTweenStartMission(),n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),$S=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).textMain=void 0,i.payload=void 0,i.chars=void 0,i.listText=[],i.tweenText=void 0,i.payload=n,i.createTextMain(),i.initListText(),i.createAnim(),i.scene.add.existing((0,nr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createTextMain=function(){var t=this.payload,e=t.font,n=t.size,i=t.text;this.textMain=this.scene.make.bitmapText({font:e,size:n,origin:{x:.5,y:.5},text:i}).setVisible(!1),this.add(this.textMain)},n.initListText=function(){var t=this.payload,e=t.text,n=t.font,i=t.size;if(e){this.chars=e.split("");for(var a=0,s=0;s<this.chars.length;s++){var r=this.chars[s],o=this.scene.make.bitmapText({font:n,size:i,origin:{x:.5,y:.5},text:r});this.listText.push(o),a+=o.width}for(var h=-a/2+4,c=0;c<this.chars.length;c++){var l=this.listText[c],u=0;"!"===l.text&&(u=-5),"W"===l.text&&(u=6),l.setX(h+u),l.setAlpha(0),h+=l.width+1}this.add(this.listText)}},n.createAnim=function(){this.tweenText=this.scene.tweens.add({targets:this.listText,paused:!0,duration:150,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Back.easeOut",delay:this.scene.tweens.stagger(100,{})})},n.runAnim=function(){this.resetListText(),this.tweenText.play()},n.resetListText=function(){for(var t=0;t<this.listText.length;t++)this.listText[t].setScale(0).setAlpha(0)},n.restart=function(){this.resetListText()},n.start=function(t){var e=this;void 0===t&&(t=0),t?this.scene.time.addEvent({delay:t,callback:function(){e.runAnim()}}):this.runAnim()},e}(Phaser.GameObjects.Container),tA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textNoSpaceLeft=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.runPopupEntrancesAnimation(300,300),s.handleDelegate()},s.close=function(){t.prototype.close.call((0,nr.default)(s))},s.scene=e,s.setDepth(kr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.textNoSpaceLeft.setVisible(!1),e.textNoSpaceLeft.restart(),e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new $S(this.scene,{text:"NO SPACE LEFT!",font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},e}(GameCore.Screen),eA=or.default.DEFAULT,nA=eA.KEY,iA=eA.FRAME,aA=GameCore.Configs.Match,sA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.isUseRescue=void 0,s.countdownCount=void 0,s.popup=void 0,s.skipText=void 0,s.continueButton=void 0,s.tweenContinueButton=void 0,s.continueButtonAnimation=void 0,s.textRescueTime=void 0,s.tweenTextRescueTime=void 0,s.progressCircle=void 0,s.skipTextTween=void 0,s.countdownTimer=void 0,s.bgProgress=void 0,s.popupShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.open=function(){t.prototype.open.call((0,nr.default)(s)),s.scene.audio.playSound(Or.default.RESCUE_TIME),s.runOpenAnimation()},s.close=function(){t.prototype.close.call((0,nr.default)(s)),s.bgProgress.setVisible(!1),s.progressCircle.setVisible(!1),s.continueButton.setVisible(!1),s.skipText.setVisible(!1),s.textRescueTime.setScale(0).setAlpha(0)},s.handleShowRewardedVideoAd=(0,Xt.default)(qt().mark((function t(){var e,n,i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=s.scene.game,n=e.globalScene,i=e.lang,a=e.audio,s.countdownTimer.remove(),t.prev=2,!s.isUseRescue){t.next=5;break}return t.abrupt("return");case 5:return s.isUseRescue=!0,s.scene.audio.pauseMusic(),n.screen.open(cr,{message:i.Text.LOADING_AD,duration:0,loading:!0}),a.pauseMusic(),a.muteAll(),t.next=12,s.scene.ads.showRewardedVideoAsync();case 12:s.scene.storage.dispatch(Xd()),s.scene.analytics.showRewardedVideoAd(s.scene.getSceneName()),n.screen.close(cr),hu.emit(dc.RESCUE),s.scene.screen.close(s.name),s.scene.audio.playSound(Or.default.DAILY_REWARD),n.screen.close(cr),t.next=29;break;case 21:if(t.prev=21,t.t0=t.catch(2),s.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,s.getScreenName(),t.t0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=28;break}if("USER_INPUT"!==t.t0.code){t.next=28;break}return s.showNotifySkipAds(),t.abrupt("return");case 28:s.showNotifyNoAds();case 29:return t.prev=29,s.scene.audio.unmuteAll(),s.scene.audio.playMusic(),s.scene.ads.preloadRewardedVideoAsync().catch((function(t){})),t.finish(29);case 34:case"end":return t.stop()}}),t,null,[[2,21,29,34]])}))),s.showNotifyNoAds=function(t){if(!t||t.name===cr){var e=s.scene.game,n=e.globalScene,i=e.lang;n.screen.events.off(GameCore.Screens.Events.CLOSE),n.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),n.screen.open(cr,{message:i.Text.NO_ADS_TO_DISPLAY,duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var t=s.scene.game,e=t.globalScene,n=t.lang;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(cr,{message:n.Text.NO_REWARDS+"\n"+n.Text.CANCELLED_AD,duration:3e3,loading:!1})},s.showGameOver=function(t){t&&t.name!==cr||(s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.endGame())},s.handleSkip=function(){s.countdownTimer.remove(),s.scene.screen.close(s.name),s.scene.endGame()},s.handleRunCountdown=function(){s.countdownCount-=1,s.countdownCount<=0?s.rescueTimeout():s.setTime(s.countdownCount)},s.scene=e,s.countdownCount=aA.MaxRescueCount,s.setDepth(kr),s.background.setAlpha(.5),s.createPopup(),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.tweenTextRescueTime.play(),this.skipText.setVisible(!0),this.skipTextTween.play(),this.tweenContinueButton.play()},n.updateInfo=function(){var t=this.scene.storage.getState(),e=au(t);this.textRescueTime.setText(String(e.score||0))},n.setTime=function(t){this.textRescueTime.setText(""+t),Phaser.Display.Align.In.Center(this.textRescueTime,this.zone,0,-42)},n.createPopup=function(){this.popup=new no(this.scene,0,-5,290,310),this.add(this.popup)},n.createContent=function(){this.createTitle(),this.createTextRescueTime(),this.createBgProgressCircle(),this.createProgressCircle(),this.createContinueButton(),this.createSkipText()},n.createTitle=function(){var t=this.scene.add.container(),e=this.scene.make.image({key:nA,frame:iA.TEXT_SECOND_CHANGE});e.setWorldSize(233,20),Phaser.Display.Align.In.Center(e,t,0,10),t.add([e]),this.popup.add(t),Phaser.Display.Align.In.TopCenter(t,this.popup,0,-2)},n.createTextRescueTime=function(){this.textRescueTime=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(140),origin:{x:.5,y:.5}}),this.textRescueTime.setOrigin(.5).setScale(0).setAlpha(0),this.add(this.textRescueTime),Phaser.Display.Align.In.Center(this.textRescueTime,this,0,-40),this.tweenTextRescueTime=this.scene.tweens.add({delay:100,targets:this.textRescueTime,paused:!0,duration:200,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Power1"})},n.createProgressCircle=function(){this.progressCircle=this.scene.add.graphics(),this.add(this.progressCircle)},n.setProgressCircle=function(t){var e=Phaser.Math.DegToRad(-90),n=Phaser.Math.DegToRad(t-360-90);this.progressCircle.clear(),this.progressCircle.beginPath(),this.progressCircle.lineStyle(7,16762368),this.progressCircle.arc(0,-44,54,e,n,!0,.02),this.progressCircle.strokePath(),this.progressCircle.closePath()},n.runCountdown=function(){this.startProgressCircle();var t={delay:1e3,loop:!0,callback:this.handleRunCountdown};this.countdownTimer=this.scene.time.addEvent(t)},n.startProgressCircle=function(){var t=this;this.scene.tweens.addCounter({from:0,to:360,duration:1e3*aA.RescueGamePopupTimeout,onUpdate:function(e){var n=+e.getValue().toFixed(2);t.setProgressCircle(n)},onComplete:function(){t.setProgressCircle(0),t.progressCircle.setAlpha(1)}})},n.createBgProgressCircle=function(){this.bgProgress=this.scene.make.image({key:nA,frame:iA.BG_PROGRESS_CIRCLE}),this.bgProgress.setWorldSize(115,115),this.popup.add(this.bgProgress),Phaser.Display.Align.In.Center(this.bgProgress,this.popup,0,-38)},n.rescueTimeout=function(){this.countdownTimer.remove(),this.scene.screen.close(this.name),this.scene.endGame()},n.createContinueButton=function(){this.continueButton=new _r.default(this.scene,nA,iA.BUTTON_GREEN,160,54),this.continueButton.setName("Continue"),this.add(this.continueButton),this.continueButton.onClick=this.handleShowRewardedVideoAd;var t=this.scene.add.image(0,0,nA,iA.ICON_ADS);t.setWorldSize(30,27),Phaser.Display.Align.In.Center(t,this.continueButton,-54,-2.5),this.continueButton.add(t);var e=this.scene.make.image({key:nA,frame:this.scene.lang.Texture.CONTINUE});e.setWorldSize(99,16),this.continueButton.add(e),Phaser.Display.Align.In.Center(e,this.continueButton,19,-2),Phaser.Display.Align.In.Center(this.continueButton,this.textRescueTime,0,115),this.continueButton.setScale(0).setAlpha(0),this.tweenContinueButton=this.scene.tweens.add({paused:!0,targets:this.continueButton,ease:Wr.default,props:{alpha:{from:0,to:1},scale:{from:1.2,to:1}},delay:300,duration:300})},n.createSkipText=function(){this.skipText=new _r.default(this.scene,nA,this.scene.lang.Texture.NO_THANKS,98,17),this.skipText.setName("NoThanks"),this.add(this.skipText),this.skipText.onClick=this.handleSkip,Phaser.Display.Align.In.BottomCenter(this.skipText,this.continueButton,0,43.5),this.skipText.setVisible(!1).setAlpha(0),this.skipTextTween=this.scene.tweens.add({targets:this.skipText,delay:aA.DelayNoThank,paused:!0,alpha:{from:0,to:1},ease:"Power1",duration:500})},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runPopupEntrancesAnimation=function(t,e){var n=this;if(!this.popupShowUpAnimation){var i=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}},onComplete:function(){n.bgProgress.setVisible(!0),n.progressCircle.setVisible(!0),n.continueButton.setVisible(!0),n.skipText.setVisible(!0),n.runAnim(),n.updateInfo(),n.isUseRescue=!1,n.countdownCount=aA.RescueGamePopupTimeout,n.setTime(n.countdownCount),n.runCountdown()}})}this.popupShowUpAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),rA=sA,oA=n(561),hA=n.n(oA),cA=function(t,e,n){return void 0===e&&(e=.1),void 0===n&&(n=.04),e*t+hA()(t)*n*t*t},lA=function(t){function e(n){var i;return(i=t.call(this,n)||this).windX=1,i.airFrictionX=.05,i.airFrictionY=.01,i._lastRotaion=0,i.rotationRate=Math.random()+e.bonusRotationRate<.5?-1:1,i.scaleXNumber=i.getRandomFloat(.1,.2),i.scaleYNumber=i.scaleXNumber,i.scaleRate=-1,i.maxScale=i.getRandomFloat(.5,1),i.deltaAlpha=0,i.airFrictionX=.01*Math.random()+(e.bonusAirFrictionX||.007),i.airFrictionY=.004*Math.random()+(e.bonusAirFrictionY||.006),i.maxScale=Math.max(i.scaleXNumber,i.maxScale),i.alpha=0,(0,nr.default)(i)||(0,nr.default)(i)}(0,Kt.default)(e,t);var n=e.prototype;return n.getRandomNumberBetween=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},n.getRandomFloat=function(t,e){return Math.random()*(e-t)+t},n.setValueAirFrictionX=function(t){e.bonusAirFrictionX=t,this.airFrictionX=.01*Math.random()+(e.bonusAirFrictionX||.007)},n.setValueAirFrictionY=function(t){e.bonusAirFrictionY=t},n.setValueRotationRate=function(t){e.bonusRotationRate=t},n.reset=function(){this.scaleXNumber=this.getRandomFloat(.3,.8),this.scaleYNumber=this.scaleXNumber,this.scaleRate=-1,this.alpha=0,this.deltaAlpha=0},n.update=function(e,n,i){for(var a=t.prototype.update.call(this,e,n,i),s=.5,r=e;r>16.67;)this.velocityX-=cA(this.velocityX,s,this.airFrictionX)/60,this.velocityY-=cA(this.velocityY,s,this.airFrictionY)/60,r-=16.67;if(this.velocityX-=cA(this.velocityX,s,this.airFrictionX)*r/1e3,this.velocityY-=cA(this.velocityY,s,this.airFrictionY)*r/1e3,this._lastRotaion=this.rotation,this.lifeCurrent>3*this.life/4)this.scaleX=this.maxScale,this.scaleY=this.maxScale,this.deltaAlpha+=e/(this.life/4),this.alpha=this.deltaAlpha;else if(this.lifeCurrent>0){var o=this.scaleRate>0?this.maxScale:1;this.scaleXNumber+=o*this.scaleRate*(e/(3*this.life/4)*3),this.scaleYNumber+=o*this.scaleRate*(e/(3*this.life/4)*3),this.scaleX=this.scaleXNumber,this.scaleY=this.scaleYNumber,this.alpha=this.deltaAlpha,this.scaleX<=0&&(this.scaleRate=1),this.scaleX>=this.maxScale&&(this.scaleRate=-1)}else this.reset();return a},e}(Phaser.GameObjects.Particles.Particle);lA.bonusAirFrictionX=0,lA.bonusAirFrictionY=0,lA.bonusRotationRate=0,lA.scaleXNumber=void 0,lA.scaleYNumber=void 0,lA.bonusAirFrictionX=0,lA.bonusAirFrictionY=0,lA.bonusRotationRate=0,lA.scaleXNumber=Math.random(),lA.scaleYNumber=Math.random();var uA=lA,dA=or.default.EFFECTS,pA=dA.KEY,fA=dA.FRAME,gA=function(t){function e(e){var n;return(n=t.call(this,e,pA)||this).position1={x:-70,y:-180},n.emitterStar1=void 0,n.circleImage1=void 0,n.tweenShowCircle1=void 0,n.tweenHideCircle1=void 0,n.position2={x:-20,y:190},n.emitterStar2=void 0,n.circleImage2=void 0,n.tweenShowCircle2=void 0,n.tweenHideCircle2=void 0,n.position3={x:90,y:0},n.emitterStar3=void 0,n.circleImage3=void 0,n.tweenShowCircle3=void 0,n.tweenHideCircle3=void 0,n.setDepth(Dr.default.ON_TOP+1),n.createEmitterStars(),n.createTweenCircle(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createEmitterStars=function(){var t=[fA.GLARE_CROSS,fA.DUST],e=[16636263,5289969,15880535];this.emitterStar1=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position1.x,y:this.position1.y,speed:{min:50,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:uA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar2=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position2.x,y:this.position2.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:uA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}}),this.emitterStar3=this.createEmitter({name:"Emitter1",frame:t,tint:e,x:this.position3.x,y:this.position3.y,speed:{min:100,max:200},gravityY:40,lifespan:{min:1e3,max:4e3},maxParticles:0,on:!1,alpha:0,particleClass:uA,emitZone:{type:"edge",source:new Phaser.Geom.Circle(0,0,1)}})},n.createTweenCircle=function(){var t=this;this.circleImage1=this.scene.make.image({x:this.position1.x,y:this.position1.y,key:pA,frame:fA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle1.play()}}),this.tweenHideCircle1=this.scene.add.tween({paused:!0,targets:this.circleImage1,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage1.setVisible(!1),t.emitterStar1.stop()}}),this.circleImage2=this.scene.make.image({x:this.position2.x,y:this.position2.y,key:pA,frame:fA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle2.play()}}),this.tweenHideCircle2=this.scene.add.tween({paused:!0,targets:this.circleImage2,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage2.setVisible(!1),t.emitterStar2.stop()}}),this.circleImage3=this.scene.make.image({x:this.position3.x,y:this.position3.y,key:pA,frame:fA.GLOW_CIRCLE}).setAlpha(0).setVisible(!1).setScale(0),this.tweenShowCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,scale:{from:0,to:1},alpha:{from:0,to:1},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.tweenHideCircle3.play()}}),this.tweenHideCircle3=this.scene.add.tween({paused:!0,targets:this.circleImage3,alpha:{from:1,to:0},ease:"Sine.easeInOut",duration:1e3,onComplete:function(){t.circleImage3.setVisible(!1),t.emitterStar3.stop()}})},n.getImages=function(){return[this.circleImage1,this.circleImage2,this.circleImage3]},n.playConfettiAnimation=function(){var t=this;this.scene.time.addEvent({delay:300,callback:function(){t.emitterStar1.flow(1e4,30),t.circleImage1.setVisible(!0),t.tweenShowCircle1.play()},callbackScope:this}),this.scene.time.addEvent({delay:800,callback:function(){t.emitterStar2.flow(1e4,25),t.circleImage2.setVisible(!0),t.tweenShowCircle2.play()},callbackScope:this}),this.scene.time.addEvent({delay:1300,callback:function(){t.emitterStar3.flow(1e4,30),t.circleImage3.setVisible(!0),t.tweenShowCircle3.play()},callbackScope:this})},e}(Phaser.GameObjects.Particles.ParticleEmitterManager),mA=gA,vA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textScoreReached=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.starSuperTwinkle=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.scene.enableInput(),s.runPopupEntrancesAnimation(300,300),s.textScoreReached.restart(),s.scene.audio.playSound(Or.default.SCORE_REACHED)},s.close=function(){t.prototype.close.call((0,nr.default)(s))},s.scene=e,s.setDepth(kr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.textScoreReached.start(),n.starSuperTwinkle.playConfettiAnimation(),n.handleDelegate(),n.runAnim()}})),this.tweenBackground.play()},n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText(),this.createAnim()},n.createText=function(){this.textScoreReached=new $S(this.scene,{text:"SCORE REACHED!",font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textScoreReached),Phaser.Display.Align.In.Center(this.textScoreReached,this)},n.createAnim=function(){this.starSuperTwinkle=new mA(this.scene),this.add(this.starSuperTwinkle),this.add(this.starSuperTwinkle.getImages())},e}(GameCore.Screen),yA=or.default.DEFAULT,SA=yA.KEY,AA=yA.FRAME,EA=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).onClick=void 0,i.options=void 0,i.text=void 0,i.panel=void 0,i.icon=void 0,i.animOn=void 0,i.animOff=void 0,i.setSize(n.width,n.height),i.options=n,i.createPanel(),i.createIcon(),i.createText(),i.createAnimation(),i.updateStatus(i.options.enable),i.createInput(),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createInput=function(){var t=this;this.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){t.options.enable?t.animOff.play():t.animOn.play(),t.onClick&&t.onClick(!t.options.enable)}))},n.createPanel=function(){this.panel=this.scene.make.image({key:SA,frame:AA.BUTTON_TOGGLE_ON}),this.panel.setWorldSize(this.width,this.height),this.add(this.panel),Phaser.Display.Align.In.Center(this.panel,this)},n.createIcon=function(){this.icon=this.scene.make.image({key:SA,frame:AA.BUTTON_CIRCLE}),this.icon.setWorldSize(27,27),this.add(this.icon),Phaser.Display.Align.In.LeftCenter(this.icon,this)},n.createText=function(){this.text=this.scene.make.image({key:SA}),this.text.setWorldSize(30,17),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.panel)},n.createAnimation=function(){var t=this;this.animOn=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:-this.panel.width/2+this.icon.width/2,to:this.panel.width/2-this.icon.width/2-3},onComplete:function(){Phaser.Display.Align.In.LeftCenter(t.text,t.panel,-21),t.text.setFrame(AA.TEXT_ON),t.text.setWorldSize(26,17),t.panel.setFrame(AA.BUTTON_TOGGLE_ON),t.panel.setWorldSize(t.width,t.height),t.options.enable=!0}}),this.animOff=this.scene.add.tween({targets:this.icon,duration:200,paused:!0,x:{from:this.panel.width/2-this.icon.width/2,to:-this.panel.width/2+this.icon.width/2},onComplete:function(){Phaser.Display.Align.In.RightCenter(t.text,t.panel,-15),t.text.setFrame(AA.TEXT_OFF),t.text.setWorldSize(30,17),t.panel.setFrame(AA.BUTTON_TOGGLE_OFF),t.panel.setWorldSize(t.width,t.height),t.options.enable=!1}})},n.updateStatus=function(t){this.options.enable=t,t?this.animOn.play():this.animOff.play()},e}(Phaser.GameObjects.Container),xA=EA,bA=or.default.DEFAULT,TA=bA.KEY,wA=bA.FRAME,MA=function(t){function e(e){var n;return(n=t.call(this,e,TA,wA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:TA,frame:wA.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),CA=MA,PA=or.default.DEFAULT,IA=PA.KEY,kA=PA.FRAME,RA=function(t){function e(e){var n;return(n=t.call(this,e,IA,kA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Journey"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:IA,frame:kA.ICON_BROWN_JOURNEY});t.setWorldSize(30,28),this.add(t),Phaser.Display.Align.In.Center(t,this,-.25,-1.5)},e}(_r.default),OA=RA,_A=or.default.DEFAULT,DA=_A.KEY,BA=_A.FRAME,LA=function(t){function e(e){var n;return(n=t.call(this,e,DA,BA.BUTTON_DARK_BLUE)||this).button.setWorldSize(246,53),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:DA,frame:BA.ICON_SWORD_BLUE});t.setWorldSize(31,25),this.add(t),Phaser.Display.Align.In.Center(t,this,-60)},n.createText=function(){var t=this.scene.make.image({key:DA,frame:BA.TEXT_PLAY_WITH_BLUE});t.setWorldSize(102,16),this.add(t),Phaser.Display.Align.In.Center(t,this,20)},e}(_r.default),FA=LA,NA=or.default.DEFAULT,GA=NA.KEY,UA=NA.FRAME,VA=function(t){function e(e){var n;return(n=t.call(this,e,GA,UA.BUTTON_BROWN)||this).button.setWorldSize(246,53),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:GA,frame:UA.ICON_REPLAY});t.setWorldSize(26,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-45,-2)},n.createText=function(){var t=this.scene.make.image({key:GA,frame:UA.TEXT_REPLAY});t.setWorldSize(79,16),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-1)},e}(_r.default),YA=VA,zA=or.default.DEFAULT,HA=zA.KEY,WA=zA.FRAME,XA=function(t){function e(e){var n;return(n=t.call(this,e,HA,WA.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:HA,frame:WA.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),KA=XA,jA=or.default.DEFAULT,qA=jA.KEY,ZA=jA.FRAME,JA=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.buttonReplay=void 0,s.buttonPlayWithFriend=void 0,s.buttonHome=void 0,s.buttonJourney=void 0,s.buttonShare=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(t){s.scene.player.setSetting("music",t),t?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(t){s.scene.player.setSetting("sound",t)},s.handleVibrateSetting=function(t){t&&jg(199),s.scene.player.setSetting("vibrate",t)},s.clickReplay=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.scene.screen.close(s.name),t.next=3,s.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=window.game,s=a.globalScene,r=a.lang,s.screen.open(cr,{message:r.Text.LOADING,loading:!0}),o=n(),h=yl(o),u()(i=[Fs,Us]).call(i,h)&&(e(pd()),e(hd())),c=null,h===Ns&&(c=jl(o),e({type:da,payload:{}})),e(xd()),t.next=11,e(Yd(h,c));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 16:return t.prev=16,Id(300),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})));return function(e,n){return t.apply(this,arguments)}}());case 3:hu.emit(dc.REPLAY);case 4:case"end":return t.stop()}}),t)}))))},s.clickButtonPlayWithFriends=function(){s.scene.storage.dispatch(Ld()),s.scene.screen.close(s.name)},s.clickButtonHome=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.scene.switch(qs.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},s.clickButtonLeaderboard=function(){s.scene.screen.open(mr)},s.clickButtonShare=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.storage.dispatch(Au());case 1:case"end":return t.stop()}}),t)}))))},s.createPopup(),s.createTitle(),s.createContentBackground(),s.createSwitchButtons(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:qA,frame:ZA.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-48)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new no(this.scene,0,0,290,390),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:qA,frame:ZA.TEXT_SETTING});t.setWorldSize(141,23),this.buttonClose=new _r.default(this.scene,qA,ZA.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createJourneyButton(),this.createShareButton()},n.createReplayButton=function(){this.buttonReplay=new YA(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,43)},n.createPlayWithFriendButton=function(){this.buttonPlayWithFriend=new FA(this.scene),this.popup.add(this.buttonPlayWithFriend),this.buttonPlayWithFriend.onClick=this.clickButtonPlayWithFriends,Phaser.Display.Align.In.Center(this.buttonPlayWithFriend,this.buttonReplay,0,65)},n.createHomeButton=function(){this.buttonHome=new CA(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,72)},n.createJourneyButton=function(){this.buttonJourney=new OA(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,72)},n.clickButtonJourney=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.createShareButton=function(){this.buttonShare=new KA(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.buttonReplay,90,72)},n.createSwitchButtons=function(){var t=this.scene.player.getPlayerSettings(),e=(t.music,t.sound),n=t.vibrate;this.createSoundButton(e),Wg()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.backgroundContent,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,0)},n.createMusicButton=function(t){this.settingMusicContainer=this.scene.make.container({});var e=this.scene.make.image({key:qA,frame:ZA.ICON_MUSIC});e.setWorldSize(37,40),this.settingMusic=new xA(this.scene,{enable:t,width:89,height:31}),this.settingMusic.setName("Music"),Phaser.Display.Align.In.Center(e,this.settingMusicContainer,-60),Phaser.Display.Align.In.Center(this.settingMusic,this.settingMusicContainer,40),this.settingMusicContainer.add([e,this.settingMusic]),this.popup.add(this.settingMusicContainer),Phaser.Display.Align.In.Center(this.settingMusicContainer,this.backgroundContent,0,60)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:qA,frame:ZA.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new xA(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:qA,frame:ZA.ICON_SOUND});e.setWorldSize(41,36),this.settingSound=new xA(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),QA=JA,$A=or.default.DEFAULT,tE=$A.KEY,eE=$A.FRAME,nE=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textTargetScore=void 0,s.textScore=void 0,s.titleFrame=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.createTextTargetScore(),s.createTextScore(),s.addItem(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.scene.levelManager.getCurrentTargetScore(),a=this.scene.levelManager.getCurrentIndex();this.textScore.setText(""+i),0===a?(this.titleFrame.setFrame(eE.TEXT_FIRST_MILESTONE),this.titleFrame.setWorldSize(216,20)):(this.titleFrame.setFrame(eE.TEXT_NEXT_MILESTONE),this.titleFrame.setWorldSize(213,20));var s=this.getData(["duration"])[0];this.runOpenAnimation(),this.scene.time.delayedCall(s,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:tE,frame:eE.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"Target Score",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.backgroundContent,0,-30)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.backgroundContent,0,15)},n.createPopup=function(){this.popup=new no(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:tE,frame:eE.TEXT_FIRST_MILESTONE}),this.titleFrame.setWorldSize(216,20),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterTargetScoreScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),iE=nE,aE=or.default.DEFAULT,sE=aE.KEY,rE=aE.FRAME,oE=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.contents=void 0,s.scoreText=void 0,s.bestScoreText=void 0,s.tweenScoreText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.scoreBlock=void 0,s.bestScoreBlock=void 0,s.playWithFriendsButton=void 0,s.homeButton=void 0,s.shareButton=void 0,s.bestScore=void 0,s.currentScore=void 0,s.payload=void 0,s.counterAnimation=void 0,s.scoreAnimation=void 0,s.scene=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.initScore(),s.updateScore(),s.setVisible(!0),s.runOpenAnimation()},s.clickPlayWithFriends=function(){s.scene.storage.dispatch(Ld())},s.clickShare=function(){s.scene.storage.dispatch(du())},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){}))},s.setVisible(!1),s.scene=e,s.setDepth(kr),s.createPopup(),s.createPopupContent(),s.createScoreAnimation(),Phaser.Display.Align.In.Center(s.popup,s.zone,0,-100),s.background.setVisible(!1),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createPopup=function(){this.popup=new no(this.scene,0,0,300,310),this.add(this.popup)},n.createPopupContent=function(){this.createTitle(),this.createScoreBlock(),this.createBestScoreBlock(),this.createButtons(),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.homeButton,this.playWithFriendsButton,this.shareButton])},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:sE,frame:rE.TEXT_YOUR_SCORE});t.setWorldSize(182,22),Phaser.Display.Align.In.Center(t,this.title,0,10);var e=new _r.default(this.scene,sE,rE.BUTTON_CLOSE,35,35);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.RightCenter(e,this.title,165,-15),this.title.add([t,e]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createScoreBlock=function(){this.scoreBlock=this.scene.add.container();var t=this.scene.make.image({key:sE,frame:rE.SCORE_PANEL});t.setWorldSize(263,76),this.scoreBlock.add(t),this.scoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(55),text:"0",origin:{x:.5,y:.5}}),this.scoreBlock.add(this.scoreText),this.popup.add(this.scoreBlock),Phaser.Display.Align.In.TopCenter(this.scoreBlock,this.popup,0,-90)},n.createBestScoreBlock=function(){this.bestScoreBlock=this.scene.add.container();var t=this.scene.make.image({key:sE,frame:rE.BEST_SCORE_FRAME_LONG});t.setWorldSize(193,77),this.bestScoreBlock.add(t),this.bestScoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(48),text:"0",origin:{x:.5,y:.5}}),this.bestScoreBlock.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.bestScoreBlock,0,16),this.popup.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this.scoreBlock,0,65)},n.createButtons=function(){this.createButtonHome(),this.createButtonPlayWithFriend(),this.createButtonShare()},n.createButtonHome=function(){this.homeButton=new Im(this.scene),this.homeButton.onClick=this.clickHome.bind(this),this.popup.add(this.homeButton),Phaser.Display.Align.In.Center(this.homeButton,this.bestScoreBlock,-100,80)},n.clickHome=function(){this.scene.scene.switch(qs.SceneKeys.DASHBOARD_SCENE)},n.createButtonPlayWithFriend=function(){this.playWithFriendsButton=new Gm(this.scene),this.playWithFriendsButton.onClick=this.clickPlayWithFriends,this.popup.add(this.playWithFriendsButton),Phaser.Display.Align.In.Center(this.playWithFriendsButton,this.bestScoreBlock,0,80)},n.createButtonShare=function(){this.shareButton=new Dm(this.scene),this.shareButton.onClick=this.clickShare,this.popup.add(this.shareButton),Phaser.Display.Align.In.Center(this.shareButton,this.bestScoreBlock,100,80)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setBestScore=function(t){this.bestScoreText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},n.initScore=function(){var t=this.scene.player.getBestScore();this.bestScore=t,this.currentScore=0},n.updateScore=function(){var t=this.scene.storage.getState(),e=au(t),n=e.score,i=e.bestScore;if(void 0===n&&void 0===i){var a=iu(t)[this.scene.player.getPlayerId()];n=(null==a?void 0:a.score)||0,i=this.scene.player.getBestScore()}this.bestScore=(i||0)<this.bestScore?this.bestScore:i||0,this.currentScore=n,this.updateData({bestScore:this.bestScore,currentScore:this.currentScore})},n.updateData=function(t){this.payload=t;var e=t.bestScore,n=t.currentScore;if(this.setBestScore(e),n<=e)return this.setCurrentScore(n),this.runScoreAnimation(),void(n>0?this.runScoreCounter():this.counterAnimation=null);this.runAnimation()},n.runAnimation=function(){this.runScoreCounter(),this.scene.time.delayedCall(1300,(function(){}))},n.runScoreAnimation=function(){this.scoreAnimation.play()},n.createScoreAnimation=function(){this.scoreAnimation=new Qm({targets:[this.scoreText],props:{scale:{from:1,to:1.3}}})},n.runScoreCounter=function(){var t,e=this,n=this.payload,i=n.bestScore,a=n.currentScore;null==(t=this.counterAnimation)||t.remove(),this.counterAnimation=this.scene.tweens.addCounter({from:0,to:a,delay:700,duration:2e3,completeDelay:300,onUpdate:function(t){e.scene.audio.playSound(Or.default.SCORE_COUNT);var n=Math.floor(t.getValue());e.runScoreAnimation(),e.setCurrentScore(n)},onComplete:function(){e.setBestScore(i<a?a:i),e.setCurrentScore(a),e.scene.audio.playSound(Or.default.GAME_OVER)}})},n.setCurrentScore=function(t){this.scoreText.setText(""+t)},e}(GameCore.Screen),hE=oE,cE=GameCore.Configs,lE=cE.Match,uE=(cE.Network,cE.Tutorial),dE=cE.Board,pE=cE.Ads,fE=or.default.GAMEPLAY_32.FRAME,gE=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).lastTimeInputEnabled=0,n.usedRescue=!1,n.levelManager=void 0,n.bestScoreGlareEffect=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.tutorialManager=void 0,n.effectManager=void 0,n.bestScore=0,n.isBestScoreScreenShowed=void 0,n.isGameOver=void 0,n.isShowedNextTargetScreen=void 0,n.piecesByFen=void 0,n.isGameError=void 0,n.gamePlayMode=void 0,n.isNextTarget=!1,n.run=function(){var t=n.storage.getState();if(null===xl(t)&&n.storage.dispatch(Rd(!1)),n.checkAndAddShortcut(),n.tutorialManager.isValidForTutorial()||uE.ForceUseTutorial)return n.handleStartTutorial(),void n.player.incUserGuideDisplays();var e=n.player.getPlayerId(),i=jl(t).playerId,a=Zl(t,{playerId:e}),s=Jl(t,{opponentId:i});a&&s?n.screen.open(fr):n.startGame()},n.create=function(){t.prototype.create.call((0,nr.default)(n)),n.createBackground(Bs.default.BACKGROUND.KEY);var e=n.player.getBestScore();n.bestScore=e,n.createLevelManager(),n.createMain(),n.createHeader(),n.createFooter(),n.createTutorialManager(),n.createEffectManager(),n.createScreens(),n.createBestScoreGlareEffect(),n.createInput(),n.listenEvents(),n.input.setTopOnly(!0),n.preLoadAds()},n.closeSettingScreen=function(){(0,nr.default)(n).screen.close(ur)},n.closeGameOverScreen=function(){(0,nr.default)(n).screen.close(fr)},n.handlePauseGame=function(){n.isGameOver||n.checkReachTargetScore()||(0,nr.default)(n).screen.open(ur)},n.handleShowInterstitialAd=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=!0),t.prev=1,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,n.ads.showInterstitialAdAsync();case 7:n.analytics.showInterstitialAd(n.getSceneName()),t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return");case 13:return t.prev=13,e&&n.postSessionScore(),n.audio.playMusic(),n.ads.preloadInterstitialAdAsync().catch(Ht.sendException),n.audio.playMusic(),t.finish(13);case 19:case"end":return t.stop()}}),t,null,[[1,10,13,19]])})));return function(e){return t.apply(this,arguments)}}(),n.rescued=function(){try{var t=n.getLevelLogInfo(),e=t.level,i=t.score,a=t.levelName;n.analytics.levelRescue(e,i,a),n.main.board.rescue(),n.nextLevel(),n.usedRescue=!0}catch(s){}},n.replay=function(){n.restartGame(),n.startGame()},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(t){})),this.ads.preloadRewardedVideoAsync().catch((function(t){}))},n.createHeader=function(){this.header=new Ug(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createLevelManager=function(){this.levelManager=new Pp},n.createBestScoreGlareEffect=function(){this.bestScoreGlareEffect=new xp(this),Phaser.Display.Align.In.Center(this.bestScoreGlareEffect,this.gameZone)},n.createMain=function(){this.main=new mm(this)},n.createFooter=function(){this.footer=new Jf(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new uc(this)},n.createEffectManager=function(){this.effectManager=new Uf(this)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createSettingScreen(),this.createRescueScreen(),this.createGameOverScreen(),this.createYourScoreScreen(),this.createScoreReachedScreen(),this.createNextTargetScoreScreen(),this.createBestScoreScreen(),this.createNoSpaceLeftScreen(),this.createTargetScoreScreen(),this.createLeaderboardScreen(),this.createMiniJourneyScreen()},n.createLeaderboardScreen=function(){this.screen.add(mr,Sp)},n.createMiniJourneyScreen=function(){this.screen.add(vr,jS)},n.createTargetScoreScreen=function(){this.screen.add(Pr,iE)},n.createNoSpaceLeftScreen=function(){this.screen.add(Tr,tA)},n.createBestScoreScreen=function(){this.screen.add(dr,bm)},n.createNextTargetScoreScreen=function(){this.screen.add(Mr,QS)},n.createScoreReachedScreen=function(){this.screen.add(wr,vA)},n.createYourScoreScreen=function(){this.screen.add(yr,hE)},n.createSettingScreen=function(){this.screen.add(ur,QA)},n.startGame=function(){var t=this;try{this.isGameOver=!1,this.tutorialManager.skipTutorial(),this.closeSettingScreen(),this.closeGameOverScreen(),this.handleUsedRescue(),this.restartGame(),this.header.setVisible(!0),this.header.progressBar.reset(),this.handleGameModeUI(),this.updateCurrentBestScore(),this.updateLevelManager(),this.updateProgressBar(),this.header.buttonSetting.setDisabled(!0),this.time.delayedCall(300,(function(){t.header.buttonSetting.setDisabled(!1)})),this.openTargetScoreScreen(),this.handleGameModeChange()}catch(e){this.isGameError||(this.isGameError=!0,this.replay()),(0,Ht.sendExceptionWithScope)(new Error("Start game scene"),{error:e,scene:"GameScene"})}},n.handleGameModeChange=function(){var t=this,e=[{selector:yl,callback:function(e){e!==t.gamePlayMode&&t.handleGameModeUI()}}];this.handleStateChange(e)},n.handleGameModeUI=function(){var t,e=this.storage.getState();this.gamePlayMode=yl(e),this.gamePlayMode&&this.gamePlayMode!==Fs&&g()(t=[Gs,Ns,Us]).call(t,this.gamePlayMode)>=0?this.handleStartGameFriendMode():this.handleStartGameSingleMode()},n.startGameAfterTargetScoreScreenClose=function(){var t,e=this.storage.getState(),n=yl(e),i=this.getLevelLogInfo(),a=i.level,s=i.score,r=i.levelName;this.analytics.levelStart(a,s,r),this.levelManager.getCurrentIndex()>0&&this.main.board.handleTweenStartMission(),g()(t=[Gs,Ns,Us]).call(t,n)>=0?this.footer.pieces.showNewPieces():this.piecesByFen?this.footer.pieces.showAvailablePieces(this.piecesByFen):this.footer.pieces.showNewPieces()},n.openTargetScoreScreen=function(){var t=this;this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Pr,{duration:1500})}))},n.handleUsedRescue=function(){this.usedRescue&&this.storage.dispatch(Xd())},n.handleStartTutorial=function(){this.analytics.event(ni.AnalyticsEvents.TUTORIAL_BEGIN),this.tutorialManager.start(),this.header.setVisible(!1)},n.handleStartGameSingleMode=function(){var t,e,n=this.storage.getState(),i=(null==(t=Yl(n))?void 0:t.data)||{},a=(null==(e=Yl(n))?void 0:e.score)||0;if(i){var s=i.fen,r=null;if(this.piecesByFen=null,s){var o=this.main.board.getBoardByFen(s);r=this.handleDynamicFenSize(o),this.piecesByFen=this.footer.pieces.getPiecesByFen(s),this.isFenGameOver(r,this.piecesByFen)&&(r=null,this.piecesByFen=null,this.storage.dispatch(xd()),n=this.storage.getState(),a=0,this.resetRescued())}this.main.board.clearBoard(),r&&this.main.board.startGame(r),this.footer.pieces.clearPieces(),this.header.showItemSingleMode(),this.header.mainScoreBlock.setScore(a),this.header.mainScoreBlock.setScoreText(a),this.main.praise.reset()}},n.handleStartGameFriendMode=function(){this.header.showItemPlayWithFriendsMode(),this.header.myScoreBlock.updateInfo(),this.header.opponentScoreBlock.updateInfo(),this.main.praise.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces()},n.listenEvents=function(){var t=this;hu.on(dc.START_GAME,(function(){t.startGame()})),hu.on(dc.RESCUE,this.rescued),hu.on(dc.REPLAY,this.replay),hu.on(dc.GAME_OVER,this.handleGameOver.bind(this)),hu.on("handle_state_change",this.handleStateChange.bind(this))},n.postSessionScore=function(){var t=this.storage.getState(),e=au(t).score,n=void 0===e?0:e;this.storage.dispatch(Ll(n))},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.createRescueScreen=function(){this.screen.add(lr,rA)},n.createGameOverScreen=function(){this.screen.add(fr,uv)},n.updateCurrentBestScore=function(){var t=this.player.getBestScore()||0,e=this.storage.getState(),n=au(e),i=n.score,a=void 0===i?0:i,s=n.bestScore,r=void 0===s?0:s,o=t>r?t:r;o=o>a?o:a,this.player.setScore(o),this.header.bestScoreBlock.setScoreText(o)},n.updateLevelManager=function(){var t=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(t)},n.updateProgressBar=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);this.header.progressBar.setTargetScore(e),this.header.progressBar.setPercent(t/e)},n.setIsGameOver=function(t){this.isGameOver=t},n.handleGameOver=function(){this.isGameOver=!0;var t=this.getLevelLogInfo(),e=t.level,n=t.score,i=t.levelName;this.analytics.levelFail(e,n,i),this.screen.open(fr)},n.handleRequestFinishGame=function(){var t=this;this.isGameOver=!0;var e=this.storage.getState(),n=Sl(e);n<lE.MaxRescueCount&&this.ads.preloadRewardedVideoAsync().catch((function(t){})),this.screen.open(Tr,{duration:3e3,onClose:function(){if(t.enableInput(),n<lE.MaxRescueCount&&pE.Enabled)return t.screen.open(lr),void(t.isGameOver=!1);t.usedRescue=!1,t.endGame()}})},n.checkAnimPlaying=function(){var t=this.tweens.getAllTweens();return!(!t||0===t.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(t){return t.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.restartGame=function(){var t;null==(t=this.header.mainScoreBlock.addScore)||t.stop().remove(),this.header.mainScoreBlock.setScore(0),this.header.mainScoreBlock.setScoreText(0),this.header.myScoreBlock.setScore(0),this.header.myScoreBlock.setScoreText(0),this.header.progressBar.hideProgressBar(),this.header.progressBar.setPercent(0),this.levelManager.restart(),this.main.praise.listScore=[]},n.endGame=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.restartGame(),this.handleShowInterstitialAd(!1).catch(Ht.sendException),this.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d,p,f,g,m,v,y,S,A,E,x,b,T,w,M,C,P;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=window.game,a=i.analytics,s=i.facebook,r=i.globalScene,o=i.lang,r.screen.open(cr,{message:o.Text.LOADING,loading:!0}),h=n(),c=yl(h),l=au(h),u=l.score,d=void 0===u?0:u,p=l.level,f=void 0===p?0:p,e(Ll(d)),e(Vd(d)),t.next=10,e(Hd(c,{score:d}));case 10:if(h=n(),g=Al(h),m=El(h),v=Math.floor((m-g)/1e3),a.event(ni.AnalyticsEvents.MATCH_END,{game_mode:GameCore.Utils.String.toUpperCamelCase(c),level:f,level_name:"level_"+f,time_played:v}),y=s.getContextID(),c===Gs&&y&&e(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=window.game.analytics,t.prev=1,a=window.game.facebook.getContextID(),bu({contextId:a}),s=n(),r=Ql(s),o=r.playerId,h=r.score,c=au(s),l=c.score,!o||o===Ls.playerId){t.next=25;break}if(!(l>h)){t.next=18;break}return t.next=13,yu(s);case 13:return u=t.sent,t.next=16,Du(u,s);case 16:t.next=23;break;case 18:return t.next=20,fu(s);case 20:return u=t.sent,t.next=23,Bu(u,s);case 23:t.next=30;break;case 25:return t.next=27,fu(s);case 27:return u=t.sent,t.next=30,Bu(u,s);case 30:wu({imageShare:u}),i.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"InviteGroup",success:!0}),t.next=38;break;case 34:t.prev=34,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.MESSAGE,{message_content_type:"InviteGroup",success:!0}),(0,Ht.sendException)(t.t0);case 38:case"end":return t.stop()}}),t,null,[[1,34]])})));return function(e,n){return t.apply(this,arguments)}}()),!y||c!==Ns){t.next=26;break}if(S=jl(h),(A=S.playerId)&&A!==Ls.playerId){t.next=21;break}return t.abrupt("return");case 21:E=iu(h),x=E[A]||{},b=x.score,T=void 0===b?0:b,w=Wl(h),M=w._id,C=w.whitePlayerFinish,P=w.blackPlayerFinish,e(C&&P?d>T?Ou(A,{matchId:M,contextId:y}):Ru(A,{matchId:M,contextId:y}):_u(A,{matchId:M,contextId:y,score:d}));case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 31:return t.prev=31,Id(300),t.finish(31);case 34:case"end":return t.stop()}}),t,null,[[0,28,31,34]])})));return function(e,n){return t.apply(this,arguments)}}()),this.resetRescued();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.handleUpdateScore=function(t){if(!this.tutorialManager.isRunning()){var e=this.getCurrentScoreByMode()+t;this.storage.dispatch(Td({score:e})),this.updateMatchData()}},n.handleAddScoreAnim=function(t){var e,n=this.storage.getState(),i=yl(n);this.tutorialManager.isRunning()?this.header.mainScoreBlock.animAddScore(t):i&&i!==Fs&&g()(e=[Gs,Ns,Us]).call(e,i)>=0?this.header.myScoreBlock.animAddScore(t):this.header.mainScoreBlock.animAddScore(t)},n.getBestScore=function(){var t=this.storage.getState();return au(t).bestScore},n.bestScoreReached=function(){if(!this.isBestScoreScreenShowed&&!this.isGameOver){var t=this.getBestScore(),e=this.getCurrentScoreByMode();!t||t>=e||(this.player.setScore(e),this.isBestScoreScreenShowed=!0,this.audio.playSound(Or.default.CONGRATULATION),this.bestScoreGlareEffect.playEffect())}},n.updateProgressTargetScore=function(t){var e=t/this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(e)},n.checkReachTargetScore=function(){return this.getCurrentScoreByMode()>=this.header.progressBar.getTargetScore()},n.handleNextTargetScore=function(){var t=this;if(!this.isGameOver&&(this.checkReachTargetScore()&&!this.isShowedNextTargetScreen)){this.isShowedNextTargetScreen=!0,this.disableInput();var e=this.getLevelLogInfo(),n=e.level,i=e.score,a=e.levelName;this.analytics.levelComplete(n,i,a),this.screen.open(wr,{duration:4e3,onClose:function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isShowedNextTargetScreen=!1,t.handleShowInterstitialAd(!1).catch(Ht.sendException),t.showNextTargetScreen();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},n.getCurrentScoreByMode=function(){var t,e=this.storage.getState(),n=yl(e);return n&&n!==Fs&&g()(t=[Gs,Ns,Us]).call(t,n)>=0?this.header.myScoreBlock.score:this.header.mainScoreBlock.score},n.showNextTargetScreen=function(){var t=this.getCurrentScoreByMode();this.levelManager.updateCurrentLevelByScore(t);this.screen.open(Mr)},n.updateMatchData=function(){if(!this.tutorialManager.isRunning()){var t=this.getFen(),e=this.storage.getState(),n=Yl(e).data||{},i=yl(e),a=Sl(e);if(!i||i===Fs){var s,r,o=zl(e),h=au(e).score,c=void 0===h?0:h;this.storage.dispatch((s=o,r={score:c,rescued:a,data:(0,wt.default)({},n,{fen:t}),updateAt:Date.now()},function(t,e){try{Qu((0,wt.default)({matchId:s},r));var n=e(),i=zl(n);$u({matchId:s,currentMatchId:i}),t({type:$i,payload:{match:r}});var a=r.data;r.data=rd(a),Le(sd.SingleMatchStore,r)}catch(o){if(o instanceof Lu)return;(0,Ht.sendException)(o)}}))}}},n.nextLevel=function(){var t=this.getCurrentScoreByMode(),e=this.levelManager.updateCurrentLevelByScore(t);this.isNextTarget=!0,this.header.progressBar.hideProgressBar(),this.header.progressBar.setTargetScore(e),this.header.progressBar.setPercent(t/e);var n=this.getLevelLogInfo(),i=n.level,a=n.levelName;this.analytics.levelStart(i,t,a)},n.update=function(t){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=t:t-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=t)},n.isFenGameOver=function(t,e){for(var n=[],i=0;i<e.length;i++){var a=e[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case _o:case Do:case Bo:n.push({data:Sf.getData(s,r,o)});break;case Lo:case Fo:case No:case Go:n.push({data:Ef.getData(s,r)});break;case Uo:case Vo:case Yo:n.push({data:bf.getData(s)});break;case Ho:n.push({data:wf.getData(r)});break;case Wo:n.push({data:If.getData(r)});break;case Jo:n.push({data:Bf.getData(r)});break;case Ko:case jo:case qo:case Zo:n.push({data:_f.getData(s,r)});break;case zo:n.push({data:Cf.getData(r)});break;case Xo:n.push({data:Rf.getData()})}}return tf(t,n)},n.handleDynamicFenSize=function(t){var e,n,i=0;if((n=t.length)&&(i=t[0].length),0===n||0===i)return t;var a=et()(e=[]).call(e,t);if(n>dE.rows)ar()(a).call(a,dE.rows,n-dE.rows);else if(i<dE.rows)for(var s=0;s<dE.rows-n;s++){var r;a.push(A()(r=new Array(n)).call(r,{value:0,frame:fE.GEM_TRANSPARENT}))}return i>dE.cols?a.forEach((function(t){ar()(t).call(t,dE.cols,i-dE.cols)})):i<dE.cols&&a.forEach((function(t){for(var e=0;e<dE.cols-i;e++)t.push({value:0,frame:fE.GEM_TRANSPARENT})})),a},n.checkAndAddShortcut=function(){if(!this.game.player.getPlayer().isUserNew){var t=this.storage.getState();Hs(t)!=Us&&this.facebook.attemptToAddShortcut()}},n.getLevelName=function(){var t,e=this.levelManager.getCurrentIndex()+1;return"target_"+rr()(t=GameCore.Utils.Number).call(t,e,4,"0")},n.getLevelLogInfo=function(){return{level:this.levelManager.getCurrentIndex()+1,score:this.getCurrentScoreByMode(),levelName:this.getLevelName()}},n.resetRescued=function(){this.storage.dispatch((function(t){t({type:Xi,payload:{}}),Le(wd.SingleMatchStore,{rescued:0})}))},e}(Ap.default);var mE=gE,vE=function(t){return{type:vi,payload:{sceneKey:t}}},yE=(0,be.createSelector)([function(t){return t.scene.currentSceneKey}],(function(t){return t})),SE=or.default.DEFAULT,AE=SE.KEY,EE=SE.FRAME,xE=function(t){function e(e){var n;return(n=t.call(this,e,0,0)||this).fps=0,n.fpsString="FPS: %1",n.fpsText=void 0,n.background=void 0,n.lastUpdate=void 0,n.update=function(t){if(!(t-n.lastUpdate<800)){n.lastUpdate=t;var e=Math.floor(n.scene.game.loop.actualFps);n.setFps(e)}},n.createFps(),n.setDepth(Dr.default.DEBUG),n.scene.add.existing((0,nr.default)(n)),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,Kt.default)(e,t);var n=e.prototype;return n.setFps=function(t){this.fps=t;var e=Phaser.Utils.String.Format(this.fpsString,[t]);this.fpsText.setText(e)},n.createFps=function(){this.background=this.scene.make.image({key:AE,frame:EE.BLANK}),this.background.setName("BG"),this.background.setTint(13801480),this.background.setWorldSize(45,25),this.fpsText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.fpsString,font:Br.default.PRIMARY.KEY,origin:{x:.5,y:.5}}),this.fpsText.setName("FPS Meter"),Phaser.Display.Align.In.Center(this.fpsText,this.background),this.add([this.background,this.fpsText]),this.setFps(0)},e}(Phaser.GameObjects.Container),bE=xE,TE=function(t){function e(e){var n;if((n=t.call(this,e,0,0)||this).performance=void 0,n.memory=0,n.maxMemoryLimit=void 0,n.maxPercentThreshold=void 0,n.normalColor=3459162,n.warningColor=16768343,n.alarmColor=15812200,n.memoryString="Memory: %1MB / %2MB",n.memoryText=void 0,n.lastUpdate=void 0,n.update=function(t){if(!(t-n.lastUpdate<1e3)){n.lastUpdate=t;var e=n.performance.memory.usedJSHeapSize,i=1048576*n.maxMemoryLimit,a=Math.round(e/1048576);n.setMemory(a),n.memoryText.setTint(n.normalColor),e>n.maxPercentThreshold/100*i&&n.memoryText.setTint(n.warningColor),e>i&&n.memoryText.setTint(n.alarmColor)}},n.performance=window.performance,n.createMemory(),n.setDepth(Dr.default.DEBUG),n.scene.add.existing((0,nr.default)(n)),!n.isSupport())return n.memoryText.setText("Memory: not supported!"),(0,nr.default)(n);var i=n.performance.memory.jsHeapSizeLimit;return n.maxPercentThreshold=90,n.setMaxMemory(i/1048576),n.scene.events.on(Phaser.Scenes.Events.UPDATE,n.update),n}(0,Kt.default)(e,t);var n=e.prototype;return n.isSupport=function(){var t;return this.performance&&!(null==(t=this.performance)||!t.memory)},n.setMaxMemory=function(t){this.maxMemoryLimit=Math.round(t)},n.setMemory=function(t){this.memory=t;var e=Phaser.Utils.String.Format(this.memoryString,[t,this.maxMemoryLimit]);this.memoryText.setText(e)},n.createMemory=function(){this.memoryText=this.scene.make.bitmapText({size:this.scene.fontSize(14),text:this.memoryString,font:Br.default.PRIMARY.KEY,depth:2e3}),this.memoryText.setName("Memory Meter"),this.add(this.memoryText),this.setMemory(0)},e}(Phaser.GameObjects.Container),wE=TE,ME=or.default.DEFAULT,CE=ME.KEY,PE=ME.FRAME,IE=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.contents=void 0,s.buttonNo=void 0,s.buttonYes=void 0,s.messageText=void 0,s.popupShowUpAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.onHandleYes=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.setVisible(!0);var n=s.getData(["message","onHandleYes"]),i=n[0],a=void 0===i?"":i,r=n[1];s.setTextMessage(a),s.onHandleYes=r,s.runOpenAnimation()},s.handleClosePopup=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((function(){s.scene.screen.close(s.name)}))},s.handleNo=function(){s.close()},s.handleYes=function(){s.onHandleYes&&s.onHandleYes(),s.close()},s.setVisible(!1),s.setDepth(kr),s.createPopup(),s.createPopupContent(),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.runAnim=function(){this.messageText.setScale(0).setAlpha(0)},n.createPopup=function(){this.popup=new no(this.scene,0,0,325,260),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createPopupContent=function(){this.createTitle(),this.createMessage(),this.createButtonNo(),this.createButtonYes(),this.popup.add([this.title]),this.contents=this.scene.make.group({}),this.contents.addMultiple([this.messageText,this.buttonNo,this.buttonYes])},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:CE,frame:PE.TEXT_TUTORIAL});t.setWorldSize(153,26);var e=new _r.default(this.scene,CE,PE.BUTTON_CLOSE,35,35);e.onClick=this.handleClosePopup,e.setName("Close"),Phaser.Display.Align.In.Center(e,this.title,155,-19),Phaser.Display.Align.In.Center(t,this.title,0,10),this.title.add([t,e]),this.popup.add(this.title),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,-2)},n.createButtonNo=function(){this.buttonNo=new _r.default(this.scene,CE,PE.BUTTON_DARK_BLUE,120,40),this.buttonNo.setName("No");var t=this.scene.make.image({key:CE,frame:PE.TEXT_NO});t.setWorldSize(35,20),this.buttonNo.add(t),Phaser.Display.Align.In.Center(t,this.buttonNo),this.popup.add(this.buttonNo),Phaser.Display.Align.In.Center(this.buttonNo,this.popup,80,60),this.buttonNo.onClick=this.handleNo},n.createButtonYes=function(){this.buttonYes=new _r.default(this.scene,CE,PE.BUTTON_GREEN_LARGE,120,40),this.buttonYes.setName("Yes");var t=this.scene.make.image({key:CE,frame:PE.TEXT_YES});t.setWorldSize(49,20),this.buttonYes.add(t),Phaser.Display.Align.In.Center(t,this.buttonYes),this.popup.add(this.buttonYes),Phaser.Display.Align.In.Center(this.buttonYes,this.popup,-80,60),this.buttonYes.onClick=this.handleYes},n.createMessage=function(){this.messageText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(45),origin:{x:.5,y:.5}}),this.messageText.align=1,this.popup.add(this.messageText),Phaser.Display.Align.In.Center(this.messageText,this.popup,0,-40),this.messageText.setScale(0).setAlpha(0)},n.runCloseAnimation=function(){this.runPopupExitsAnimation(0,200)},n.runPopupExitsAnimation=function(t,e){var n,i=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){i.popup.setY(0)}})),null==(n=this.popupFadeOutAnimation)||n.play()},n.setTextMessage=function(t){this.messageText.setText(""+t)},n.runOpenAnimation=function(){this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runPopupContentEntrancesAnimation(200,300)},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){this.contentShowUpAnimation||(this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:this.scene.tweens.stagger(80,{start:t}),props:{alpha:{start:0,from:0,to:1}}})),this.contentShowUpAnimation.play()},e}(GameCore.Screen),kE=IE,RE=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).loadingIcon=void 0,s.messageText=void 0,s.openAnimation=void 0,s.closeTimerEvent=void 0,s.addLoadingIcon(),s.addMessageText(),s.setDepth(Rr),s.background.setAlpha(.8),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n,i=this;t.prototype.open.call(this,e);var a=this.getData(["message","duration","loading"]),s=a[0],r=void 0===s?"":s,o=a[1],h=void 0===o?0:o,c=a[2],l=void 0!==c&&c;this.setMessage(r),this.showLoading(l),null==(n=this.closeTimerEvent)||n.remove(),h>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:h,callback:function(){i.visible&&i.scene.screen.close(i.name)}})),this.runOpenAnimation()},n.addLoadingIcon=function(){this.loadingIcon=new dl(this.scene),this.add(this.loadingIcon),Phaser.Display.Align.In.Center(this.loadingIcon,this.zone)},n.addMessageText=function(){this.messageText=this.scene.make.bitmapText({size:this.scene.fontSize(50),font:Br.default.PRIMARY_LIGHT.KEY,origin:{x:.5,y:.5}}),this.messageText.setCenterAlign(),this.add(this.messageText)},n.setMessage=function(t){this.messageText.setText(t)},n.showLoading=function(t){this.loadingIcon.setVisible(t);var e=!1===t?20:80;Phaser.Display.Align.In.Center(this.messageText,this.zone,0,e)},n.runOpenAnimation=function(){var t,e;null==(t=this.openAnimation)||t.stop(),null==(e=this.openAnimation)||e.remove(),this.openAnimation=new jr({targets:[this.messageText,this.loadingIcon],props:{scale:{getStart:function(t){return t.scale-.3},getEnd:function(t){return t.scale}}}}),this.openAnimation.play()},n.logPageviewOnOpen=function(){},n.logPageviewOnClose=function(){},e}(GameCore.Screen),OE=RE,_E=or.default.DEFAULT,DE=_E.KEY,BE=_E.FRAME,LE=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).mask=void 0,n.fadeInAnim=void 0,n.fadeOutAnim=void 0,n.fpsMeter=void 0,n.memoryMeter=void 0,n.switchScene=function(t){n.currentScene.key!==t&&n.currentScene.switch(t)},n.runScene=function(t){n.currentScene.run(t)},n.emitGameEventStartScene=function(t){var e=t.scene.key;n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(e),n.game.events.emit(Phaser.Scenes.Events.START,e),(0,Ht.addBreadcrumbSentry)("scene","Start scene: "+e)},n.emitGameEventSleepScene=function(t){var e=t.scene.scene.key;e!==qs.SceneKeys.LOAD_SCENE&&(n.runMaskFadeInAnimation(),n.game.events.emit(Phaser.Scenes.Events.SLEEP,e))},n.emitGameEventWakeScene=function(t){var e=t.scene.scene.key;e!==qs.SceneKeys.LOAD_SCENE&&(n.updateSceneState(),n.runMaskFadeOutAnimation(),n.updateActiveSceneKey(e),n.game.events.emit(Phaser.Scenes.Events.WAKE,e))},n.emitGameEventPauseScene=function(t){var e=t.scene.scene.key;n.game.events.emit(Phaser.Scenes.Events.PAUSE,e)},n.emitGameEventResumeScene=function(t){var e=t.scene.key;n.game.events.emit(Phaser.Scenes.Events.RESUME,e)},n.emitGameEventShutdownScene=function(t){var e=t.scene.scene.key;n.game.events.emit(Phaser.Scenes.Events.SHUTDOWN,e)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.listenScenesEvents(),this.game.globalScene=this},n.setup=function(){this.scaleGame(),this.addMask(),this.addNotifyScreen(),this.addAlertScreen(),this.addFPS(),this.addMemory()},n.addNotifyScreen=function(){var t=this.screen.add(cr,OE);Phaser.Display.Align.In.Center(t,this.gameZone)},n.addAlertScreen=function(){var t=this.screen.add(hr,kE);Phaser.Display.Align.In.Center(t,this.gameZone)},n.addMask=function(){this.mask=this.make.image({key:DE,frame:BE.BLANK});var t=this.gameZone,e=t.width,n=t.height;this.mask.setAlpha(0),this.mask.setOrigin(0,0),this.mask.setTint(0),this.mask.setWorldSize(e,n)},n.addFPS=function(){GameCore.Configs.Statistics.ShowFPSInGame&&(this.fpsMeter=new bE(this),Phaser.Display.Align.In.TopLeft(this.fpsMeter,this.gameZone,-20,-10))},n.addMemory=function(){GameCore.Configs.Statistics.ShowMemoryInGame&&(this.memoryMeter=new wE(this),Phaser.Display.Align.In.TopLeft(this.memoryMeter,this.gameZone,-45,-3))},n.updateSceneState=function(){this.setGlobalSceneOnTop()},n.setGlobalSceneOnTop=function(){this.scene.bringToTop(this)},n.runMaskFadeInAnimation=function(){},n.runMaskFadeOutAnimation=function(){},n.listenScenesEvents=function(){var t=this;this.scene.manager.getScenes(!1).forEach((function(e){e.events.on(Phaser.Scenes.Events.CREATE,t.emitGameEventStartScene),e.events.on(Phaser.Scenes.Events.SLEEP,t.emitGameEventSleepScene),e.events.on(Phaser.Scenes.Events.WAKE,t.emitGameEventWakeScene),e.events.on(Phaser.Scenes.Events.PAUSE,t.emitGameEventPauseScene),e.events.on(Phaser.Scenes.Events.RESUME,t.emitGameEventResumeScene),e.events.on(Phaser.Scenes.Events.SHUTDOWN,t.emitGameEventShutdownScene)})),this.events.on(qs.SceneEvents.SWITCH,this.switchScene),this.events.on(qs.SceneEvents.RUN,this.runScene)},n.getActiveScene=function(){return this.scene.manager.getScenes(!0)[0]},n.updateActiveSceneKey=function(t){t!==qs.SceneKeys.GLOBAL_SCENE&&this.storage.dispatch(vE(t))},n.logEventOpen=function(){},n.logPageviewOnOpen=function(){},(0,Se.default)(e,[{key:"currentScene",get:function(){var t=this.storage.getState(),e=yE(t);return(e?this.scene.manager.getScene(e):this.getActiveScene()).scene}}]),e}(Ap.default),FE=LE,NE=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="LoadResourceFail",i.message=e||"Load resource fail",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),GE=[{id:"pass-levels",title:"PASS_10_LEVELS",require:{level:10},reward:{diamond:100}},{id:"collect-diamonds",title:"COLLECT_300_DIAMONDS",require:{diamond:300},reward:{diamond:100}},{id:"reach-score",title:"REACH_TOTAL_SCORES",require:{score:1e5},reward:{diamond:200}}],UE=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",GE);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),VE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.tasks}],(function(t){return t})),YE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.process}],(function(t){return t})),zE=(0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.isRequesting}],(function(t){return t})),HE=((0,be.createSelector)([function(t){var e;return null==(e=t.dailyTasks)?void 0:e.isNotice}],(function(t){return t})),GameCore.Configs.DailyTasks),WE=function(t){return function(e){e({type:qa,payload:{tasks:t}});var n=window.game.player.getCustomData("dailyTasks")||{},i=n.startedTime,a=void 0===i?0:i,s=n.logTasks,r=void 0===s?{}:s;e((Date.now()-a)/1e3>HE.Duration?XE(t):KE(r))}},XE=function(t){return function(e){var n={};t.forEach((function(t){var e=t.id,i=t.require;n[e]={},Y()(i).forEach((function(t){var i;n[e]=((i={})[t]=0,i.rewarded=!1,i)}))})),window.game.player.setCustomData("dailyTasks",{logTasks:n,startedTime:Date.now()}),e(KE(n)),hu.emit(Ul.EVENTS.TASKS_RESET)}},KE=function(t){return{type:Za,payload:{process:t}}},jE=n(396),qE=n.n(jE),ZE=function(){var t=(window.game.player.getCustomData("dailyTasks")||{}).logTasks;return GameCore.Utils.Json.clone(t)},JE=function(){function t(t,e){var n=this;this.game=void 0,this.id=void 0,this.taskData=void 0,this.requireTypes=void 0,this.process=function(t,e){var i;void 0===e&&(e=!0);var a=t.type,s=t.value;if(!(s<1)&&(-1!==g()(i=n.requireTypes).call(i,a)&&!n.isPassRequiredTarget(a)&&n.processMore(t))){a=t.type,s=t.value;var r=n.getCorrectValue(a,s);n.game.storage.dispatch(function(t,e,n,i){return void 0===i&&(i=!0),function(a){var s=ZE();if(GameCore.Utils.Valid.isObject(s)){var r=s;GameCore.Utils.Object.hasOwn(r,t)&&!r[t].rewarded&&(i&&(r[t][e]+=n,window.game.player.setCustomData("dailyTasks",{logTasks:r})),a({type:Ja,payload:{id:t,type:e,value:n}}))}}}(n.id,a,r,e)),n.isTaskFinished(a)&&n.game.storage.dispatch(function(t){return function(e){e({type:ts,payload:{id:t}}),hu.emit(Ul.EVENTS.NOTICE_UPDATE)}}(n.id))}},this.game=t,this.id=e,this.init()}var e=t.prototype;return e.init=function(){var t=this,e=this.game.storage.getState(),n=VE(e)||[];if(!((null==n?void 0:n.length)<1)){var i=null==n?void 0:qE()(n).call(n,(function(e){return e.id===t.id}));i&&(this.taskData=i,this.requireTypes=Y()(this.taskData.require),this.initEvents())}},e.getDataByType=function(t){var e=this.game.storage.getState(),n=YE(e),i={value:0,target:0};if(!n)return i;if(!GameCore.Utils.Object.hasOwn(n,this.taskData.id))return i;var a=n[this.taskData.id];if(GameCore.Utils.Valid.isObject(a)&&GameCore.Utils.Object.hasOwn(a,t)){var s=a[t];"number"===typeof s&&(i.value=s)}return i.target=this.taskData.require[t]||0,i},e.getCorrectValue=function(t,e){var n=this.getDataByType(t),i=n.value,a=n.target,s=e;return i+e>a&&(s=a-i),Math.round(s)},e.isPassRequiredTarget=function(t){var e=this.getDataByType(t);return e.value>=e.target},e.isTaskFinished=function(t){var e=this.getDataByType(t);return e.value>=e.target},t}(),QE=JE,$E=Ul.COLLECT_DIAMONDS,tx=$E.ID,ex=$E.EVENTS,nx=function(t){function e(e){return t.call(this,e,tx)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){hu.off(ex.COLLECT_DIAMONDS,this.process),hu.on(ex.COLLECT_DIAMONDS,this.process)},n.processMore=function(){return!0},e}(QE),ix=nx,ax=Ul.PASS_LEVELS,sx=ax.ID,rx=ax.EVENTS,ox=function(t){function e(e){return t.call(this,e,sx)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){hu.off(rx.PASS_LEVEL,this.process),hu.on(rx.PASS_LEVEL,this.process)},n.processMore=function(){return!0},e}(QE),hx=ox,cx=Ul.REACH_SCORE,lx=cx.ID,ux=cx.EVENTS,dx=function(t){function e(e){var n;return(n=t.call(this,e,lx)||this).totalScore=void 0,n.lastUpdate=void 0,n.totalScore=0,n.lastUpdate=Date.now(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){hu.off(ux.ADD_SCORE,this.process),hu.on(ux.ADD_SCORE,this.process)},n.processMore=function(t){var e=t.value,n=Date.now();return n-this.lastUpdate<3e3?(this.totalScore+=e,!1):(t.value+=this.totalScore,this.totalScore=0,this.lastUpdate=n,!0)},e}(QE),px=dx,fx=function(){function t(t){var e=this;this.game=void 0,this.eventsListener=void 0,this.init=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.eventsListener={},t.next=3,e.initData();case 3:e.initEvents();case 4:case"end":return t.stop()}}),t)}))),this.initData=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.game.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),!zE(i)){t.next=4;break}return t.abrupt("return");case 4:return e({type:ja,payload:{}}),t.next=7,UE();case 7:a=t.sent,e(WE(a));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),this.game=t,this.init()}var e=t.prototype;return e.getEventListener=function(t){return this.eventsListener[t]},e.initEvents=function(){this.eventsListener[Ul.PASS_LEVELS.ID]=new hx(this.game),this.eventsListener[Ul.REACH_SCORE.ID]=new px(this.game),this.eventsListener[Ul.COLLECT_DIAMONDS.ID]=new ix(this.game)},t}(),gx=fx,mx=[{name:"collect-red-gems",id:"collect-gems",require:{red:5},reward:50},{name:"collect-blue-gems",id:"collect-gems",require:{blue:5},reward:50},{name:"collect-pink-gems",id:"collect-gems",require:{pink:5},reward:50},{name:"collect-green-gems",id:"collect-gems",require:{green:5},reward:50},{name:"collect-yellow-gems",id:"collect-gems",require:{yellow:5},reward:50},{name:"collect-red-blue-gems",id:"collect-gems",require:{red:5,blue:5},reward:120},{name:"collect-red-pink-gems",id:"collect-gems",require:{red:5,pink:5},reward:120},{name:"collect-red-green-gems",id:"collect-gems",require:{red:5,green:5},reward:120},{name:"collect-red-yellow-gems",id:"collect-gems",require:{red:5,yellow:5},reward:120},{name:"collect-blue-pink-gems",id:"collect-gems",require:{blue:5,pink:5},reward:120},{name:"collect-blue-green-gems",id:"collect-gems",require:{blue:5,green:5},reward:120},{name:"collect-blue-yellow-gems",id:"collect-gems",require:{blue:5,yellow:5},reward:120},{name:"collect-pink-green-gems",id:"collect-gems",require:{pink:5,green:5},reward:120},{name:"collect-pink-yellow-gems",id:"collect-gems",require:{pink:5,yellow:5},reward:120},{name:"collect-green-yellow-gems",id:"collect-gems",require:{green:5,yellow:5},reward:120},{name:"collect-red-blue-pink-gems",id:"collect-gems",require:{red:5,blue:5,pink:5},reward:210},{name:"collect-red-blue-green-gems",id:"collect-gems",require:{red:5,blue:5,green:5},reward:210},{name:"collect-red-blue-yellow-gems",id:"collect-gems",require:{red:5,blue:5,yellow:5},reward:210},{name:"collect-red-pink-green-gems",id:"collect-gems",require:{red:5,pink:5,green:5},reward:210},{name:"collect-red-pink-yellow-gems",id:"collect-gems",require:{red:5,pink:5,yellow:5},reward:210},{name:"collect-red-green-yellow-gems",id:"collect-gems",require:{red:5,green:5,yellow:5},reward:210},{name:"collect-blue-pink-green-gems",id:"collect-gems",require:{blue:5,pink:5,green:5},reward:210},{name:"collect-blue-pink-yellow-gems",id:"collect-gems",require:{blue:5,pink:5,yellow:5},reward:210},{name:"collect-blue-green-yellow-gems",id:"collect-gems",require:{blue:5,green:5,yellow:5},reward:210},{name:"collect-pink-green-yellow-gems",id:"collect-gems",require:{pink:5,green:5,yellow:5},reward:210}],vx=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",mx);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),yx=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.missions}],(function(t){return t})),Sx=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.isRequesting}],(function(t){return t})),Ax=((0,be.createSelector)([yx,function(t,e){return e.name}],(function(t,e){return t?"string"!==typeof e?null:GameCore.Utils.Object.hasOwn(t,e)?t[e]:null:null})),function(t){return{type:Ya,payload:{missions:t}}}),Ex={TYPES:{COLLECT_GEMS:"collect-gems",USE_ITEM:"use-item",COMBO:"combo"},EVENTS:{MISSION_START:"mission-start",MISSION_UPDATE:"mission-update",MISSION_FAILED:"mission-failed",MISSION_COMPLETED:"mission-completed"}},xx=(0,be.createSelector)([function(t){var e;return null==(e=t.missions)?void 0:e.mission}],(function(t){return t})),bx=((0,be.createSelector)([xx],(function(t){return t?t.name:null})),function(){function t(t,e,n){var i=this;this.game=void 0,this.id=void 0,this.name=void 0,this.reward=void 0,this.process=function(t){var e=t.id,n=t.type,a=t.value;a<1||i.id===e&&i.isTypeRequired(n)&&i.processMore(t)&&(i.game.storage.dispatch(function(t,e,n){return{type:Ha,payload:{name:t,type:e,value:n}}}(i.name,n,a)),i.isMissionComplete()&&(hu.emit(Ex.EVENTS.MISSION_COMPLETED,{name:i.name,reward:i.reward}),i.game.storage.dispatch(function(t){return{type:Wa,payload:{name:t}}}(i.name))))},this.id=e,this.name=n,this.game=t}var e=t.prototype;return e.start=function(){var t=this.game.storage.getState(),e=xx(t);e&&e.name===this.name&&(this.reward=e.reward,this.initEvents())},e.getMissionData=function(){var t=this.game.storage.getState(),e=xx(t);return e?e.name!==this.name?null:e:null},e.getDataByType=function(t){var e=this.getMissionData();if(!e)return null;var n=e.require[t];return{value:e.process[t],target:n}},e.isTypeRequired=function(t){var e=this.getDataByType(t);return!!e&&e.target>0},e.isMissionComplete=function(){var t=this.getMissionData();if(!t)return!0;var e=t.require,n=t.process,i=!0;return Y()(e).forEach((function(t){if(i){var a=e[t];n[t]<a&&(i=!1)}})),i},t}()),Tx=bx,wx=Ex.EVENTS,Mx=Ex.TYPES,Cx=function(t){function e(e,n){return t.call(this,e,Mx.COLLECT_GEMS,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){hu.off(wx.MISSION_UPDATE,this.process),hu.on(wx.MISSION_UPDATE,this.process)},n.processMore=function(){return!0},e}(Tx),Px=Cx,Ix=Ex.EVENTS,kx=Ex.TYPES,Rx=function(t){function e(e,n){return t.call(this,e,kx.COMBO,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){hu.off(Ix.MISSION_UPDATE,this.process),hu.on(Ix.MISSION_UPDATE,this.process)},n.processMore=function(t){var e=this.getMissionData();if(!e)return!1;var n=t.type;return t.value>=e.require[n]},e}(Tx),Ox=Rx,_x=Ex.EVENTS,Dx=Ex.TYPES,Bx=function(t){function e(e,n){return t.call(this,e,Dx.USE_ITEM,n)||this}(0,Kt.default)(e,t);var n=e.prototype;return n.initEvents=function(){hu.off(_x.MISSION_UPDATE,this.process),hu.on(_x.MISSION_UPDATE,this.process)},n.processMore=function(t){return!0},e}(Tx),Lx=Bx,Fx=function(){function t(t){var e=this;this.game=void 0,this.listener=void 0,this.init=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initData();case 2:e.initListeners(),e.initEvents();case 4:case"end":return t.stop()}}),t)}))),this.initData=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.game.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),!Sx(i)){t.next=4;break}return t.abrupt("return");case 4:return e({type:Va,payload:{}}),t.next=7,vx();case 7:a=t.sent,e(Ax(a));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),this.startListener=function(t){e.listener[t]&&e.listener[t].start()},this.game=t,this.init()}var e=t.prototype;return e.initListeners=function(){var t=this;this.listener={};var e=this.game.storage.getState(),n=yx(e);n&&Y()(n).forEach((function(e){switch(n[e].id){case Ex.TYPES.COLLECT_GEMS:t.listener[e]=new Px(t.game,e);break;case Ex.TYPES.COMBO:t.listener[e]=new Ox(t.game,e);break;case Ex.TYPES.USE_ITEM:t.listener[e]=new Lx(t.game,e)}}))},e.initEvents=function(){hu.off(Ex.EVENTS.MISSION_START,this.startListener),hu.on(Ex.EVENTS.MISSION_START,this.startListener)},t}(),Nx=Fx,Gx=(GameCore.Configs.Match,function(){return function(){var t=(0,Xt.default)(qt().mark((function t(e,n){var i,a,s,r,o,h,c,l,u,d,p,f,m,v,y,S,A,E,x,b,T,w,M,C;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n(),a=zs(i),s=Hs(i),r=window.game,o=r.player,h=r.analytics,c=r.facebook,l=r.globalScene,u=o.getPlayer(),d=a.contextId,p=a.entryPointData,m=(f=p||{}).type,v=f.matchId,y=f.opponentId,S=f.playerId,A=f.playerName,E=f.playerPhoto,x=f.playerScore,b=u.playerId===S,T=Ls,b||"string"!==typeof S||"string"!==typeof A||(T={playerId:S,name:A,photo:"string"===typeof E?E:"",locale:"en_US"}),u.isUserNew&&h.event(ni.AnalyticsEvents.NEW_USER),s!==Us){t.next=25;break}return t.prev=12,t.next=15,c.getTournamentAsync();case 15:w=t.sent,M=w.getID().toString(),e(Rl(M)),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(12),(0,Ht.sendException)(t.t0);case 23:return e(Od()),t.abrupt("return");case 25:if(s!==Ns){t.next=34;break}if(m!==ks){t.next=30;break}return b||o.updateConnectedPlayers([T]),e(Ld(d,T.playerId,!0)),t.abrupt("return");case 30:if(!(g()(C=[y,S]).call(C,u.playerId)>=0)||m!==_s){t.next=34;break}return e(Ud(v,b?y:S)),t.abrupt("return");case 34:if(s!==Gs){t.next=39;break}return e(bd(S,{score:x,level:0})),e(Gd(T)),t.abrupt("return");case 39:if(!u.isUserNew){t.next=42;break}return e(_d()),t.abrupt("return");case 42:l.events.emit(qs.SceneEvents.SWITCH,qs.SceneKeys.DASHBOARD_SCENE);case 43:case"end":return t.stop()}}),t,null,[[12,20]])})));return function(e,n){return t.apply(this,arguments)}}()}),Ux={BACKGROUND:{KEY:"background",FILE:"./assets/music/bg_music.mp3"},EFFECTS:{KEY:"effects",FILE:"./assets/sounds/effects.mp3",JSON:"./assets/sounds/effects.json"}},Vx=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).handleFBInstantGameStarted=function(){window.__fbGameReady=!0,n.player.requestConnectedPlayers(),setTimeout(n.subscribebot,500)},n.startGame=function(){n.analytics.event(ni.AnalyticsEvents.APP_READY),n.storage.dispatch(vE(qs.SceneKeys.LOAD_SCENE)),n.storage.dispatch(Gx())},n.subscribebot=function(){n.facebook.attemptToSubscribeBot()},n.handleLoadSoundCompleted=function(){n.audio.initSound(Ux.EFFECTS.KEY)},n.handleLoadMusicCompleted=function(){n.audio.initMusic(Ux.BACKGROUND.KEY),n.audio.playMusic()},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){var t=this;this.facebook.progressLoading.loadingProgressFbLoadScene(),this.analytics.event(ni.AnalyticsEvents.SCREEN_OPEN,{screen_name:"LoadScene"}),this.load.on("progress",(function(e){t.facebook.progressLoading.onProgress(e)})),this.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(t){var e=new NE("Load resources at LoadScene failed.");(0,Ht.sendExceptionWithScope)(e,{file:null==t?void 0:t.url})})),this.load.multiatlas(or.default.DEFAULT.KEY,or.default.DEFAULT.JSON,or.default.DEFAULT.URL),this.load.bitmapFont(Br.default.PRIMARY.KEY,Br.default.PRIMARY.TEXTURE,Br.default.PRIMARY.DATA),this.load.bitmapFont(Br.default.PRIMARY_LIGHT.KEY,Br.default.PRIMARY_LIGHT.TEXTURE,Br.default.PRIMARY_LIGHT.DATA),this.load.atlas({key:or.default.EFFECTS.KEY,textureURL:or.default.EFFECTS.PATH,atlasURL:or.default.EFFECTS.JSON}),this.load.atlas({key:or.default.GAMEPLAY_32.KEY,textureURL:or.default.GAMEPLAY_32.TEXTURE,atlasURL:or.default.GAMEPLAY_32.JSON}),this.load.bitmapFont(Br.default.NUMBER_LIGHT.KEY,Br.default.NUMBER_LIGHT.TEXTURE,Br.default.NUMBER_LIGHT.DATA),this.load.atlas({key:or.default.GAMEPLAY.KEY,textureURL:or.default.GAMEPLAY.TEXTURE,atlasURL:or.default.GAMEPLAY.JSON}),this.load.bitmapFont(Br.default.NUMBER_DARK.KEY,Br.default.NUMBER_DARK.TEXTURE,Br.default.NUMBER_DARK.DATA),this.load.image(Bs.default.BACKGROUND.KEY,Bs.default.BACKGROUND.FILE),this.load.image(Bs.default.AVATAR.KEY,Bs.default.AVATAR.FILE),this.load.spine(Ep.BEST_SCORE.KEY,Ep.BEST_SCORE.JSON,Ep.BEST_SCORE.ATLAS),this.load.spine(Ep.LOGO.KEY,Ep.LOGO.JSON,[Ep.LOGO.ATLAS],!0),this.player.updateData().then().catch(Ht.sendException)},n.create=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.analytics.event(ni.AnalyticsEvents.LOAD_COMPLETE),this.facebook.on("startgame",this.handleFBInstantGameStarted),this.facebook.gameStarted(),this.initModules(),this.setupGlobalScene(),this.lazyLoadResource(),this.startGame();case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.setupGlobalScene=function(){var t=this.scene.get(qs.SceneKeys.GLOBAL_SCENE);t instanceof FE&&t.setup()},n.initModules=function(){new Nx(this.game),new gx(this.game)},n.lazyLoadResource=function(){var t=this;setTimeout((function(){t.scene.wake(),t.loadSounds(),t.loadWideframesResource(),t.lazyLoadLevel(),t.lazyLoadLives(),t.load.once(Phaser.Loader.Events.COMPLETE,(function(){t.scene.sleep()}))}),1500)},n.lazyLoadLevel=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.storage.getState(),!eu(e)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.storage.dispatch(Ed());case 7:this.loadLevelConfig(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.lazyLoadLives=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n,i,a,s,r,o,h,c,l,u;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.game.player,i=n.getPlayer(),a=i.playerId,t.prev=2,e({type:ss,payload:{}}),t.next=6,null==(s=window.FBInstant.player.getDataAsync(["lives"]))?void 0:s.lives;case 6:return r=t.sent,o=Be(Sv.LivesStore+"-"+a)||{},h=o.lives,c=void 0===h?Av.livesCapacity:h,l=o.lastBonusLifeTime,u=void 0===l?0:l,r&&(c=r.lives||0,u=r.lastBonusLifeTime||0),e({type:rs,payload:{data:{lives:c,lastBonusLifeTime:u}}}),e((function(t,e){t(bv());var n=e(),i=60*Av.bonusDurationMins*1e3,a=(new Date).getTime(),s=mv(n);t(a-s<i?Ev(i-(a-s)):xv())})),t.next=15,e(Mv());case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),e({type:os,payload:{}});case 20:case"end":return t.stop()}}),t,null,[[2,17]])})));return function(e){return t.apply(this,arguments)}}());case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),n.loadLevelConfig=function(){try{var t=this.storage.getState(),e=eu(t),n=Gu[e];n||(n=Gu[Gu.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.cache.tilemap.exists(a))return;this.load.tilemapTiledJSON(a,s),this.load.start()}catch(r){(0,Ht.sendException)(r)}},n.loadSounds=function(){var t=Phaser.Loader.Events.FILE_KEY_COMPLETE;this.load.once(t+"audio-"+Ux.EFFECTS.KEY,this.handleLoadSoundCompleted),this.load.audioSprite(Ux.EFFECTS.KEY,Ux.EFFECTS.JSON,Ux.EFFECTS.FILE)},n.loadWideframesResource=function(){this.frameCapture.preload({"wide-frame-share":"./assets/wideframes/wide-frame-share.png","wide-frame-message-win":"./assets/wideframes/wide-frame-message-win.png","wide-frame-game-result":"./assets/wideframes/wide-frame-game-result.png"})},e}(Phaser.Scene),Yx=Vx,zx=n(117),Hx=n.n(zx),Wx=function(){return(0,Xt.default)(qt().mark((function t(){var e,n,i,a,s,r,o,h,c;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.game,n=e.player,i=e.analytics,a=e.facebook,s=e.globalScene,t.prev=1,s.screen.open(cr,{message:"Loading...",loading:!0}),r=n.getPlayer(),o=r.playerId,h=r.name,c=r.photo,t.next=6,a.inviteAsync({template:Rs,cta:{default:"Play",localizations:{en_US:"Play",vi_VN:"Ch\u01a1i ngay"}},text:{default:"Great! I have a best score!",localizations:{en_US:"Great! I have a best score!",vi_VN:"Th\u1eadt tuy\u1ec7t! M\xecnh v\u1eeba ph\xe1 k\u1ef7 l\u1ee5c n\xe0y!"}},image:"",data:{playerId:o,playerName:h,playerPhoto:c,type:Rs}});case 6:i.event(ni.AnalyticsEvents.INVITE,{invite_content_type:"BestScore",success:!0}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),i.event(ni.AnalyticsEvents.INVITE,{invite_content_type:"BestScore",success:!1}),(0,Ht.sendException)(t.t0);case 13:return t.prev=13,s.screen.close(cr),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,9,13,16]])})))},Xx=n(325),Kx={targets:[],yoyo:!0,repeat:-1,duration:600,repeatDelay:50,ease:n.n(Xx)()(.55,.47,.43,.91),easeParams:[0,.9],props:{scale:{from:1,to:1.2}}},jx=function(t){function e(e){return t.call(this,Kx,e)||this}return(0,Kt.default)(e,t),e}(Vr.default),qx=jx,Zx=or.default.DEFAULT,Jx=Zx.KEY,Qx=Zx.FRAME,$x=GameCore.Configs.Lives,tb=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.circle=void 0,n.icon=void 0,n.textLives=void 0,n.textTimer=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.iconBeat=void 0,n.intervalTimer=void 0,n.scene.add.existing((0,nr.default)(n)),n.createBackgroundLives(),n.createTextLives(),n.createTextTimer(),n.createIconPlus(),n.createHeartBeatAnimation(),n.setSize(140,27),n.setInteractive().on(Phaser.Input.Events.POINTER_DOWN,(function(){n.scene.screen.open(Ir)})),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackgroundLives=function(){this.background=this.scene.make.image({key:Jx,frame:Qx.LIVES_TIME_BLOCK}),this.background.setWorldSize(111,27),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.setFrameLivesTimeBlock2=function(){this.background.setFrame(Qx.LIVES_TIME_BLOCK_2)},n.createIconPlus=function(){this.icon=this.scene.make.image({key:Jx,frame:Qx.ICON_PLUS}),this.icon.setWorldSize(14,14),this.add(this.icon),Phaser.Display.Align.In.Center(this.icon,this,-62,11)},n.createTextLives=function(){this.circle=this.scene.make.image({key:Jx,frame:Qx.LIVES_HEART}),this.circle.setWorldSize(38,31),this.add(this.circle),Phaser.Display.Align.In.Center(this.circle,this,-51,0);var t=this.scene.storage.getState(),e=gv(t);this.textLives=this.scene.make.text({text:""+e,style:{fontFamily:Br.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}}),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.circle)},n.createTextTimer=function(){this.textTimer=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(40),text:"00:00",origin:{x:.2,y:.5}}),this.add(this.textTimer),Phaser.Display.Align.In.Center(this.textTimer,this,8,2)},n.updateTextLives=function(){var t=this.scene.storage.getState(),e=gv(t);this.textLives.setText(e)},n.startIntervalTimer=function(){var t=this;this.runHeartBeatAnimation();var e=60*$x.bonusDurationMins*1e3;this.intervalTimer=setInterval((function(){var n,i,a=t.scene.storage.getState(),s=gv(a)||0;if(s===$x.livesCapacity)return t.textTimer.setText("Full"),void t.textLives.setText(String($x.livesCapacity));var o=vv(a),h=mv(a),c=(new Date).getTime();c-h<e&&(o=h);var l=(0,Ge.convertHMS)(e-(c-o)),u=r()(n="0"+l.minutes).call(n,-2),d=r()(i="0"+l.seconds).call(i,-2);Hx()(t.textLives.text)!==s&&t.updateTextLives(),t.textTimer.setText(u+":"+d)}),1e3)},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setLives=function(t){this.textLives.setText(String(t))},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play(),this.iconBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new qx({targets:[this.circle],props:{scale:"+=0.005"}}),this.textLivesBeat=new qx({targets:[this.textLives],props:{scale:"+=0.05"}}),this.iconBeat=new qx({targets:[this.icon],props:{scale:"+=0.025"}})},e}(Phaser.GameObjects.Container),eb=tb,nb=or.default.DEFAULT,ib=nb.KEY,ab=nb.FRAME,sb=function(t){function e(e){var n;return(n=t.call(this,e,ib,ab.BUTTON_DARK_BLUE)||this).button.setWorldSize(231,63),n.setName("Invite"),n.createText(),n}return(0,Kt.default)(e,t),e.prototype.createText=function(){var t=this.scene.make.image({key:ib,frame:ab.TEXT_INVITE_FRIENDS});t.setWorldSize(173,18),this.add(t),Phaser.Display.Align.In.Center(t,this,0,0)},e}(_r.default),rb=sb,ob=or.default.DEFAULT,hb=ob.KEY,cb=ob.FRAME,lb=GameCore.Configs.Lives,ub=function(t){function e(e){var n;return(n=t.call(this,e,hb,cb.BUTTON_GREEN)||this).heart=void 0,n.textLives=void 0,n.groupHeartBeat=void 0,n.heartBeat=void 0,n.textLivesBeat=void 0,n.button.setWorldSize(231,63),n.setName("RefillLives"),n.createText(),n.createIcon(),n.createHeart(),n.createHeartBeatAnimation(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createText=function(){var t=this.scene.make.image({key:hb,frame:cb.TEXT_REFILL_LIVES});t.setWorldSize(127,15),this.add(t),Phaser.Display.Align.In.Center(t,this,-20,0)},n.createIcon=function(){var t=this.scene.make.image({key:hb,frame:cb.ICON_ADS});t.setWorldSize(33,32),this.add(t),Phaser.Display.Align.In.Center(t,this,70,-3)},n.createHeart=function(){this.heart=this.scene.make.image({key:hb,frame:cb.LIVES_HEART}),this.heart.setAngle(-30),this.heart.setWorldSize(46,36),this.add(this.heart),Phaser.Display.Align.In.Center(this.heart,this,-105,-20),this.textLives=this.scene.make.text({text:"+"+lb.livesCapacity,style:{fontFamily:Br.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(40)+"px",fontStyle:"700"},origin:{x:.5,y:.5}}),this.textLives.setAngle(-30),this.add(this.textLives),Phaser.Display.Align.In.Center(this.textLives,this.heart)},n.runHeartBeatAnimation=function(){this.heartBeat.play(),this.textLivesBeat.play()},n.createHeartBeatAnimation=function(){this.heartBeat=new qx({targets:[this.heart],props:{scale:"+=0.005"}}),this.textLivesBeat=new qx({targets:[this.textLives],props:{scale:"+=0.025"}})},e}(_r.default),db=ub,pb=or.default.DEFAULT,fb=pb.KEY,gb=pb.FRAME,mb=GameCore.Configs,vb=mb.Network,yb=mb.Lives,Sb=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.currentScreen=void 0,s.refillLivesButton=void 0,s.inviteFriendButton=void 0,s.textTitle=void 0,s.livesContent=void 0,s.textContent=void 0,s.adsTimer=void 0,s.livesTimer=void 0,s.intervalTimer=void 0,s.textBlock=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.clickPlayWithFriend=function(){s.scene.storage.dispatch(Wx())},s.handleShowRewardedVideoAd=(0,Xt.default)(qt().mark((function t(){var e,n,i,a,r,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.scene.game,n=e.globalScene,i=e.audio,t.prev=2,e.globalScene.screen.open(cr,{message:"Loading ads...",duration:vb.Timeout,loading:!0}),i.pauseMusic(),t.next=7,new(mt())((function(t,e){var n;null==(n=s.adsTimer)||n.remove(),s.adsTimer=s.scene.time.delayedCall(vb.Timeout,e),s.scene.ads.getAdStatus(GameCore.Ads.Types.REWARDED)===GameCore.Ads.Status.LOADING?s.scene.ads.events.once(GameCore.Ads.Events.LOADED,t):s.scene.ads.preloadRewardedVideoAsync().then(t).catch(e)}));case 7:return t.next=9,s.scene.ads.showRewardedVideoAsync();case 9:s.scene.audio.playSound(Or.default.DAILY_REWARD),s.scene.analytics.showRewardedVideoAd(s.getScreenName()),s.scene.storage.dispatch(function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={lives:Av.livesCapacity,lastBonusLifeTime:(new Date).getTime()},t.next=4,e(Cv(n));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()),s.close(),t.next=23;break;case 15:if(t.prev=15,t.t0=t.catch(2),s.scene.analytics.showAdFail(GameCore.Ads.Types.REWARDED,s.getScreenName(),t.t0),!(t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code"))){t.next=22;break}if("USER_INPUT"!==t.t0.code){t.next=22;break}return s.showNotifySkipAds(),t.abrupt("return");case 22:s.showNotifyNoAds();case 23:return t.prev=23,null==(a=s.adsTimer)||a.destroy(),s.scene.audio.playMusic(),n.screen.close(cr),s.scene.ads.preloadRewardedVideoAsync().catch((function(t){})),r=s.getData(["onClose"]),(o=r[0])&&o(),t.finish(23);case 31:case"end":return t.stop()}}),t,null,[[2,15,23,31]])}))),s.showNotifyNoAds=function(t){if(!t||t.name===cr){var e=s.scene.game.globalScene;e.screen.events.off(GameCore.Screens.Events.CLOSE),e.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),e.screen.open(cr,{message:"No ads to display!",duration:2e3,loading:!1})}},s.showNotifySkipAds=function(){var t=s.scene.game.globalScene;t.screen.events.off(GameCore.Screens.Events.CLOSE),t.screen.events.once(GameCore.Screens.Events.CLOSE,s.showGameOver),t.screen.open(cr,{message:"Sorry, No Rewards!\nYou have cancelled the ad!",duration:3e3,loading:!1})},s.showGameOver=function(t){t&&t.name!==cr||s.scene.screen.close(s.name)},s.createPopup(),s.createLivesTimer(),s.createTitle(),s.createContentBackground(),s.createLiveContent(),s.createTextContent(),s.createButtons(),s.addItem(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){t.prototype.open.call(this,e),this.updateIntervalTimer(),this.startIntervalTimer(),this.runOpenAnimation(),null!=e&&e.currentScreen&&(this.currentScreen=e.currentScreen),this.showLivesTimer()},n.showLivesTimer=function(){var t=this.getData(["showLivesTimer"])[0];this.livesTimer.setVisible(t),t&&this.livesTimer.startIntervalTimer()},n.createLivesTimer=function(){this.livesTimer=new eb(this.scene),this.popup.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this.popup,0,-270)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:fb,frame:gb.LIVES_HEART}),this.backgroundContent.setWorldSize(114,93),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createLiveContent=function(){var t=this.scene.storage.getState(),e=gv(t);this.livesContent=this.scene.make.text({text:""+e,style:{fontFamily:Br.default.FONT_FAMILY_ARIAL,fontSize:this.scene.fontSize(150)+"px",fontStyle:"700",align:"center"}}),this.livesContent.setTint(16777215),this.popup.add(this.livesContent),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)},n.createTextContent=function(){this.textBlock=this.scene.make.image({key:fb,frame:gb.LIVES_TIME_BLOCK}),this.popup.add(this.textBlock),this.textBlock.setWorldSize(167,30),Phaser.Display.Align.In.Center(this.textBlock,this.backgroundContent,0,80),this.textContent=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(40),origin:{x:.5,y:.5}}),this.popup.add(this.textContent),Phaser.Display.Align.In.Center(this.textContent,this.textBlock,0,2)},n.startIntervalTimer=function(){var t=this;this.intervalTimer=setInterval((function(){t.updateIntervalTimer()}),1e3)},n.updateIntervalTimer=function(){var t,e,n=60*yb.bonusDurationMins*1e3,i=this.scene.storage.getState(),a=gv(i),s=vv(i),o=mv(i),h=(new Date).getTime();h-o<n&&(s=o);var c=(0,Ge.convertHMS)(n-(h-s)),l=r()(t="0"+c.minutes).call(t,-2),u=r()(e="0"+c.seconds).call(e,-2);this.setTextContent("Next life: "+l+"m "+u+"s"),a>0?(this.textTitle.setFrame(gb.TEXT_KEEP_PLAYING),this.textTitle.setWorldSize(199,22)):(this.textTitle.setFrame(gb.TEXT_OUT_OF_LIVE),this.textTitle.setWorldSize(186,22)),Hx()(this.livesContent.text)!=a&&(this.livesContent.setText(""+a),Phaser.Display.Align.In.Center(this.livesContent,this.backgroundContent,0,0)),a===yb.livesCapacity?(this.setTextContent("Full"),this.refillLivesButton.setVisible(!1),this.inviteFriendButton.setVisible(!0)):(this.refillLivesButton.setVisible(!0),this.refillLivesButton.runHeartBeatAnimation(),this.inviteFriendButton.setVisible(!1))},n.stopIntervalTimer=function(){clearInterval(this.intervalTimer)},n.setTextContent=function(t){this.textContent.setText(t),Phaser.Display.Align.In.Center(this.textContent,this.textBlock,0,2)},n.createPopup=function(){this.popup=new no(this.scene,0,-30,290,323),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-30)},n.createTitle=function(){this.title=this.scene.add.container(),this.textTitle=this.scene.make.image({key:fb,frame:gb.TEXT_OUT_OF_LIVE}),this.textTitle.setWorldSize(186,22),this.buttonClose=new _r.default(this.scene,fb,gb.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.handleClose,this.title.add([this.textTitle,this.buttonClose]),this.popup.add([this.title]),Phaser.Display.Align.In.Center(this.textTitle,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createButtons=function(){this.createRefillLivesButton(),this.createInviteFriendButton()},n.createRefillLivesButton=function(){this.refillLivesButton=new db(this.scene),this.popup.add(this.refillLivesButton),this.refillLivesButton.onClick=this.handleShowRewardedVideoAd,Phaser.Display.Align.In.Center(this.refillLivesButton,this.popup,0,85)},n.createInviteFriendButton=function(){this.inviteFriendButton=new rb(this.scene),this.inviteFriendButton.setVisible(!1),this.popup.add(this.inviteFriendButton),this.inviteFriendButton.onClick=this.clickPlayWithFriend,Phaser.Display.Align.In.Center(this.inviteFriendButton,this.popup,0,85)},n.addItem=function(){this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){var n=this;if(!this.popupFadeOutMaskAnimation){var i=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:i,from:i,to:0}},onComplete:function(){var t=n.getData(["onClose"])[0];t&&t()}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),Ab=Sb,Eb=or.default.DEFAULT,xb=Eb.KEY,bb=Eb.FRAME,Tb=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.createBackground(),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.createBackground=function(){this.background=this.scene.make.image({key:xb,frame:bb.FOOTER,origin:{x:.5,y:1}}),this.background.setWorldSize(375,85),this.add(this.background)},e}(Phaser.GameObjects.Container),wb=Tb,Mb=or.default.DEFAULT,Cb=Mb.KEY,Pb=Mb.FRAME,Ib=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,Cb,Pb.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),kb=Ib,Rb=function(t){function e(e){var n;return(n=t.call(this,e)||this).leaf=void 0,n.createLeaf(),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e.prototype.createLeaf=function(){this.leaf=new kb(this.scene),this.add(this.leaf),Phaser.Display.Align.In.Center(this.leaf,this,0,this.leaf.displayHeight/2)},e}(Phaser.GameObjects.Container),Ob=Rb,_b=or.default.DEFAULT,Db=_b.KEY,Bb=_b.FRAME,Lb=function(t){function e(e){var n;return(n=t.call(this,e,Db,Bb.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("JourneyIcon"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Db,frame:Bb.ICON_BROWN_JOURNEY});t.setWorldSize(28,26),this.add(t),Phaser.Display.Align.In.Center(t,this,.5,-2)},e}(_r.default),Fb=Lb,Nb=or.default.DEFAULT,Gb=Nb.KEY,Ub=Nb.FRAME,Vb=function(t){function e(e){var n;return(n=t.call(this,e,Gb,Ub.BUTTON_BROWN)||this).button.setWorldSize(242,54),n.setName("Journey"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Gb,frame:Ub.ICON_WHITE_JOURNEY});t.setWorldSize(28,26),this.add(t),Phaser.Display.Align.In.Center(t,this,-63,-2)},n.createText=function(){var t=this.scene.make.image({key:Gb,frame:Ub.TEXT_JOURNEY});t.setWorldSize(105,18),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-2)},e}(_r.default),Yb=Vb,zb=or.default.DEFAULT,Hb=zb.KEY,Wb=zb.FRAME,Xb=function(t){function e(e){var n;return(n=t.call(this,e,Hb,Wb.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("LeaderBoard"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Hb,frame:Wb.ICON_RANK});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),Kb=Xb,jb=function(t){function e(e,n,i){var a;return(a=t.call(this,e,n,i)||this).logo=void 0,a.drawLogo(),e.add.existing((0,nr.default)(a)),a}return(0,Kt.default)(e,t),e.prototype.drawLogo=function(){var t=this;this.logo=this.scene.add.spine(0,0,Ep.LOGO.KEY,Ep.LOGO.ANIMATIONS.START_GROW),this.add(this.logo),this.logo.on("complete",(function(e){e.animation.name===Ep.LOGO.ANIMATIONS.START_GROW&&t.logo.play(Ep.LOGO.ANIMATIONS.IDLE_GROW,!0)}))},e}(Phaser.GameObjects.Container),qb=jb,Zb=or.default.DEFAULT,Jb=Zb.KEY,Qb=Zb.FRAME,$b=function(t){function e(e){var n;return(n=t.call(this,e,Jb,Qb.BUTTON_GREEN_LARGE)||this).button.setWorldSize(242,70),n.setName("PlaySingle"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:Jb,frame:Qb.ICON_PLAY_GREEN});t.setWorldSize(31,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-75,-2)},n.createText=function(){var t=this.scene.make.image({key:Jb,frame:Qb.TEXT_SINGLE});t.setWorldSize(136,17),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-2)},e}(_r.default),tT=$b,eT=or.default.DEFAULT,nT=eT.KEY,iT=eT.FRAME,aT=function(t){function e(e){var n;return(n=t.call(this,e,nT,iT.BUTTON_MINOR)||this).button.setWorldSize(62,53),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:nT,frame:iT.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-1.5)},e}(_r.default),sT=aT,rT=function(t){function e(e){var n;return(n=t.call(this,e)||this).logo=void 0,n.playSingleButton=void 0,n.journeyButton=void 0,n.leaderBoardButton=void 0,n.journey1Button=void 0,n.settingButton=void 0,n.playSingleButtonAnimation=void 0,n.createLogo(),n.createPlaySingleButton(),n.createJourneyButton(),n.createLeaderBoardButton(),n.createJourney1Button(),n.createSettingButton(),n.alignButton(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLogo=function(){this.logo=new qb(this.scene,0,0),this.add(this.logo),Phaser.Display.Align.In.Center(this.logo,this,0,-140)},n.createPlaySingleButton=function(){this.playSingleButton=new tT(this.scene),this.add(this.playSingleButton)},n.runPlaySingleButtonAnimation=function(){this.playSingleButtonAnimation.play()},n.createPlaySingleButtonAnimation=function(){this.playSingleButtonAnimation=new qx({targets:[this.playSingleButton],props:{scale:{from:1,to:1.05}}})},n.createJourneyButton=function(){this.journeyButton=new Yb(this.scene),this.add(this.journeyButton)},n.createLeaderBoardButton=function(){this.leaderBoardButton=new Kb(this.scene),this.add(this.leaderBoardButton)},n.createJourney1Button=function(){this.journey1Button=new Fb(this.scene),this.add(this.journey1Button)},n.createSettingButton=function(){this.settingButton=new sT(this.scene),this.add(this.settingButton)},n.alignButton=function(){Phaser.Display.Align.In.Center(this.playSingleButton,this,0,44),Phaser.Display.Align.In.Center(this.journeyButton,this,0,118),Phaser.Display.Align.In.Center(this.leaderBoardButton,this,-90,192),Phaser.Display.Align.In.Center(this.journey1Button,this,0,192),Phaser.Display.Align.In.Center(this.settingButton,this,90,192)},e}(Phaser.GameObjects.Container),oT=rT,hT=or.default.DEFAULT,cT=hT.KEY,lT=hT.FRAME,uT=or.default.GAMEPLAY,dT=uT.KEY,pT=uT.FRAME,fT=or.default.GAMEPLAY_32,gT=fT.KEY,mT=fT.FRAME,vT=GameCore.Configs,yT=vT.Network,ST=vT.Board,AT=function(t){function e(e,n,i,a){var s;(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.buttonPlay=void 0,s.boardCellData=[],s.targetData=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.clickClose=function(){s.runCloseAnimation()},s.decodeMathData=function(t){try{return JSON.parse(GameCore.Utils.Hash.hashToString(t))}catch(e){return""}};try{s.createPopup(),s.createTitle(),s.createTargetItems(),s.createBoard(),s.createButtonPlay(),s.setDepth(kr),s.background.setAlpha(.5)}catch(r){}return s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.open.call(this),e.next=3,this.checkReceiveLevelFromFb();case 3:this.loadLevelConfig();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.startGame=function(){this.runOpenAnimation(),this.updateContent(),this.popup.setVisible(!0)},n.updateContent=function(){try{this.resetTarget(),this.drawTargetItems(),this.resetCellBoard(),this.updateCellBoard()}catch(t){}},n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.scene.storage.getState(),!eu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.scene.storage.dispatch(Ed());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.loadLevelConfig=function(){try{var t=this.scene.storage.getState(),e=eu(t),n=Gu[e];n||(n=Gu[Gu.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.scene.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.scene.load.tilemapTiledJSON(a,s),this.scene.load.start(),this.scene.load.off(Phaser.Loader.Events.COMPLETE),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Ht.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.showLoadingScreen=function(){this.scene.game.globalScene.screen.open(cr,{message:"Loading level...",duration:yT.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.scene.game.globalScene.screen.close(cr)},n.createPopup=function(){this.popup=new no(this.scene,0,-7,286,373),this.popup.setVisible(!1),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:cT,frame:lT.TEXT_JOURNEY});t.setWorldSize(113,20),this.buttonClose=new _r.default(this.scene,cT,lT.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickClose,this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,138.5,-19.5),Phaser.Display.Align.In.TopCenter(this.title,this.popup,0,7)},n.createTargetItems=function(){var t=this.scene.make.image({key:cT,frame:lT.TEXT_COLLECT});t.setWorldSize(91,15);var e=this.scene.make.image({key:cT,frame:lT.WOOD_PANEL});e.setWorldSize(200,37),this.popup.add([t,e]),Phaser.Display.Align.In.Center(t,this.popup,0,-155),Phaser.Display.Align.In.Center(e,this.popup,0,-125)},n.drawTargetItems=function(){var t,e,n=this.scene.storage.getState(),i=eu(n),a=Gu[i];a||(a=Gu[Gu.length-1]);var s=this.scene.make.tilemap({key:a.key}).properties;if(s&&(0,Pv.isArray)(s)&&!(s.length<2))for(var r=s[0].value,o=pv()(t=pv()(e=pv()(r).call(r,"{",'{"')).call(e,", ",', "')).call(t,":",'":'),h=JSON.parse(o),c=Y()(h),l=this.calcPosition(c.length),u=0;u<c.length;u++){var d=c[u],p=mS[d],f=h[d],g=this.targetData[u];g||(g=this.spawnTargetItem(p,f));var m=g,v=m.container,y=m.text,S=m.gem;v.setVisible(!0),y.setText("x"+f),S.setFrame(p),this.targetData.push(g),Phaser.Display.Align.In.Center(v,this.popup,l[u],-130)}},n.spawnTargetItem=function(t,e){var n=this.scene.make.container({}),i=this.scene.make.image({key:gT,frame:t});i.setWorldSize(15,15);var a=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"x"+e});return n.add([i,a]),Phaser.Display.Align.In.Center(a,n,0,15),this.popup.add(n),{container:n,gem:i,text:a}},n.calcPosition=function(t){for(var e=[],n=150/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createBoard=function(){var t=this.scene.make.image({key:dT,frame:pT.BOARD});t.setWorldSize(200,184),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-12),this.initCellBoard()},n.initCellBoard=function(){for(var t=0;t<ST.rows;t++){this.boardCellData[t]=[];for(var e=0;e<ST.cols;e++){var n=20*e-86.5+1.65*e,i=19*t-92+1*t,a=mT.GEM_TRANSPARENT,s=this.spawnCellBoard(a,n,i);this.boardCellData[t].push(s)}}},n.updateCellBoard=function(){var t=this.scene.storage.getState(),e=$l(t).data.fen;if(e){var n=e.split("l")[0];this.drawBoardByFen(n)}else this.drawBoardByMap()},n.resetTarget=function(){for(var t=0;t<this.targetData.length;t++){var e,n;null==(e=this.targetData[t])||null==(n=e.container)||n.setVisible(!1)}},n.resetCellBoard=function(){for(var t=0;t<ST.rows;t++)for(var e=0;e<ST.cols;e++){this.boardCellData[t][e].setFrame(mT.GEM_TRANSPARENT)}},n.drawBoardByFen=function(t){for(var e=Yp()(t).call(t).split("/"),n=0;n<e.length;n++)for(var i=e[n].split(","),a=0;a<i.length;a++){var s=i[a];if("x"!==s){var r=_S(s);this.boardCellData[n][a].setFrame(r)}}},n.drawBoardByMap=function(){var t=this.scene.storage.getState(),e=eu(t),n=Gu[e];n||(n=Gu[Gu.length-1]);var i=this.scene.make.tilemap({key:n.key}).layers;if((0,Pv.isArray)(i)){var a=i[0].data;if((0,Pv.isArray)(a))for(var s=0;s<a.length;s++)for(var r=a[s],o=0;o<r.length;o++){var h=r[o];if(!(h.index<0)){var c=mS[h.index-1];this.boardCellData[s][o].setFrame(c)}}}},n.spawnCellBoard=function(t,e,n){var i=this.scene.make.image({key:gT,frame:t});return i.setWorldSize(20,19),this.popup.add(i),Phaser.Display.Align.In.Center(i,this.popup,e,n),i},n.createButtonPlay=function(){this.buttonPlay=new _r.default(this.scene,cT,lT.BUTTON_GREEN_BIG,118,50),this.buttonPlay.setName("Play"),this.buttonPlay.onClick=this.handlePlay.bind(this);var t=this.scene.make.image({key:cT,frame:lT.TEXT_PLAY});t.setWorldSize(50,15);var e=this.scene.make.image({key:cT,frame:lT.ICON_I_PLAY});e.setWorldSize(20,26),this.buttonPlay.add([t,e]),Phaser.Display.Align.In.Center(t,this.buttonPlay,16,-2),Phaser.Display.Align.In.Center(e,this.buttonPlay,-28,-2),this.popup.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this.popup,0,111)},n.handlePlay=function(){var t=this,e=this.scene.storage.getState();gv(e)<1?this.scene.screen.open(Ir):(this.scene.storage.dispatch(wv()),this.runCloseAnimation(),this.popupFadeOutAnimation.next((function(){t.scene.screen.close(t.name);var e=t.scene.storage.getState(),n=eu(e);n>Gu.length||(t.scene.analytics.levelStart(n,void 0,t.getLevelName(n)),t.scene.storage.dispatch(Dd()))})))},n.getLevelName=function(t){var e;return"journey_"+rr()(e=GameCore.Utils.Number).call(e,t,4,"0")},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.popup.setVisible(!1)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),ET=or.default.DEFAULT,xT=ET.KEY,bT=ET.FRAME,TT=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(t){s.scene.player.setSetting("music",t),t?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(t){s.scene.player.setSetting("sound",t)},s.handleVibrateSetting=function(t){t&&jg(199),s.scene.player.setSetting("vibrate",t)},s.createPopup(),s.createContentBackground(),s.createTitle(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){var t=this.scene.make.image({key:xT,frame:bT.POPUP_CONTENT_BACKGROUND});t.setWorldSize(260,145),this.popup.add(t),Phaser.Display.Align.In.Center(t,this.popup,0,-4)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new no(this.scene,0,0,286,226),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,10)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:xT,frame:bT.TEXT_SETTING});t.setWorldSize(141,23),this.buttonClose=new _r.default(this.scene,xT,bT.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-18)},n.createButtons=function(){var t=this.scene.player.getPlayerSettings(),e=t.sound,n=t.vibrate;this.createSoundButton(e),Wg()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.popup,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,0)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:xT,frame:bT.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new xA(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:xT,frame:bT.ICON_SOUND});e.setWorldSize(40,35),this.settingSound=new xA(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.popup,0,-33)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},ease:Phaser.Math.Easing.Back.In,onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),wT=TT,MT=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).main=void 0,n.header=void 0,n.footer=void 0,n.run=function(){n.checkAndAddShortcut()},n.onCreate=function(){var t=n.storage.getState(),e=xl(t);null===e?n.storage.dispatch(Rd(!1)):!1===e&&n.showMiniJourneyScreen(),n.run()},n.onResume=function(){n.run()},n.onWake=function(){n.run();var t=n.storage.getState();xl(t)||n.showMiniJourneyScreen()},n.clickPlayWithFriend=function(){n.storage.dispatch(Ld())},n.clickPlaySolo=function(){n.storage.dispatch(_d())},n.clickJourney=function(){n.storage.dispatch(Dd())},n.clickLevelScene=function(){n.scene.switch(qs.SceneKeys.LEVEL_SCENE)},n.clickLeaderBoard=function(){n.screen.open(mr)},n.clickJourney1=function(){n.scene.switch(qs.SceneKeys.LEVEL_SCENE)},n.clickSetting=function(){n.screen.open(ur)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.showMiniJourneyScreen=function(){this.storage.dispatch(Rd(!0)),this.screen.open(vr)},n.checkAndAddShortcut=function(){var t=this.storage.getState();Hs(t)===Fs&&this.facebook.attemptToAddShortcut()},n.preload=function(){this.events.on("wake",this.onWake),this.events.on("resume",this.onResume),this.events.on("create",this.onCreate)},n.create=function(){t.prototype.create.call(this),this.createBackground(Bs.default.BACKGROUND.KEY),this.createHeaderBar(),this.createMainContent(),this.createFooterBar(),this.createScreens()},n.createHeaderBar=function(){this.header=new Ob(this),this.header.setDepth(Dr.default.BUTTON),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createMainContent=function(){this.main=new oT(this),this.main.setDepth(Dr.default.LOGO),this.main.playSingleButton.onClick=this.clickPlaySolo,this.main.journeyButton.onClick=this.clickLevelScene,this.main.leaderBoardButton.onClick=this.clickLeaderBoard,this.main.journey1Button.onClick=this.clickJourney1,this.main.settingButton.onClick=this.clickSetting,Phaser.Display.Align.In.Center(this.main,this.gameZone)},n.createFooterBar=function(){this.footer=new wb(this),this.footer.setDepth(Dr.default.BUTTON),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createScreens=function(){this.createSettingsScreen(),this.createLeaderBoardScreen(),this.createMiniJourneyScreen(),this.createClaimHeartScreen()},n.createSettingsScreen=function(){this.screen.add(ur,wT)},n.createLeaderBoardScreen=function(){this.screen.add(mr,Sp)},n.createMiniJourneyScreen=function(){this.screen.add(vr,AT)},n.createClaimHeartScreen=function(){this.screen.add(Ir,Ab)},e}(Ap.default);var CT,PT=MT,IT=or.default.GAMEPLAY_32,kT=IT.KEY,RT=IT.FRAME,OT=function(t){function e(e,n){var i;return(i=t.call(this,e,n.x+(n.padding||0),n.y+(n.padding||0),kT,RT.GEM)||this).scene=void 0,i.canCapture={direction:"bottom",angle:0},i.status=void 0,i.rateShaking=1,i.t0=0,i.x0=void 0,i.y0=void 0,i.v0=void 0,i.alpha0=void 0,i.scale0=void 0,i.maxScale0=void 0,i.scaleRate0=void 0,i.imageBreak=void 0,i.imageGameOver=void 0,i.imageGameStart=void 0,i.tweenImageGameOver=void 0,i.imageHighlight=void 0,i.tweenImageHighlight=void 0,i.tweenStartMission=void 0,i.tweenScaleDown=void 0,i.tweenAlphaImageBreak=void 0,i.tweenFadeOut=void 0,i.setWorldSize(n.width,n.height),i.x0=n.x+(n.padding||0),i.y0=n.y+(n.padding||0),i.scale0=i.scale,i.alpha0=i.alpha,i.scene=e,i.createTweenFadeOut(),i.createImageGameStart(),i.createImageBreak(),i.createImageGameOver(),i.createTweenImageGameOver(),i.createImageHighlight(),i.createTweenImageGHighlight(),i.createTweenScaleDown(),i.createTweenAlphaImageBreak(),i.createTweenStartMission(),e.add.existing((0,nr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.createTweenFadeOut=function(){this.tweenFadeOut=this.scene.add.tween({targets:[this],duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:this.alpha,to:0},scale:{from:this.scale,to:0},paused:!0})},n.createImageBreak=function(){this.imageBreak=this.scene.make.image({key:kT,frame:RT.GEM_WHITE}),this.imageBreak.setVisible(!1),this.imageBreak.setScale(this.scale0),this.imageBreak.setPosition(this.x,this.y)},n.createImageGameOver=function(){this.imageGameOver=this.scene.make.image({key:kT,frame:RT.GEM_SILVER}),this.imageGameOver.setDepth(this.depth+1),this.imageGameOver.setVisible(!1),this.imageGameOver.setScale(this.scale0),this.imageGameOver.setPosition(this.x,this.y)},n.createImageGameStart=function(){this.imageGameStart=this.scene.make.image({key:kT,frame:RT.GEM_GLARE}),this.imageGameStart.setDepth(this.depth+1),this.imageGameStart.setVisible(!1),this.imageGameStart.setScale(this.scale0),this.imageGameStart.setPosition(this.x,this.y)},n.createTweenImageGameOver=function(){this.tweenImageGameOver=this.scene.add.tween({targets:[this.imageGameOver],duration:1200,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createImageHighlight=function(){this.imageHighlight=this.scene.make.image({key:kT,frame:RT.GEM_LIGHT}),this.imageHighlight.setDepth(this.depth+1),this.imageHighlight.setVisible(!1),this.imageHighlight.setScale(this.scale0),this.imageHighlight.setPosition(this.x,this.y)},n.createTweenImageGHighlight=function(){this.tweenImageHighlight=this.scene.add.tween({targets:[this.imageHighlight],duration:100,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:1,start:0},paused:!0})},n.createTweenStartMission=function(){this.tweenStartMission=this.scene.add.tween({targets:[this.imageGameStart],duration:200,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:0,to:this.scale0,start:0},alpha:{from:0,to:1,start:0},yoyo:!0,paused:!0})},n.createTweenScaleDown=function(){var t=this.imageBreak.scale;this.tweenScaleDown=this.scene.add.tween({delay:100,targets:[this.imageBreak],duration:600,ease:Phaser.Math.Easing.Quadratic.InOut,scale:{from:t,to:0,start:t},paused:!0})},n.createTweenAlphaImageBreak=function(){this.tweenAlphaImageBreak=this.scene.add.tween({targets:[this.imageBreak],duration:150,ease:Phaser.Math.Easing.Sine.InOut,alpha:{from:.2,to:.68},paused:!0})},n.showImageHighlight=function(){var t=this.frame.name+"_light";this.imageHighlight.setFrame(t),this.imageHighlight.setVisible(!0).setAlpha(1)},n.hideImageHighlight=function(){this.imageHighlight.setVisible(!1)},n.isHighlight=function(){return this.imageHighlight.visible},n.isShaking=function(){return"SHAKING"===this.status},n.playAnimShaking=function(){this.status="SHAKING"},n.playTweenBreaking=function(){this.status="BREAKING"},n.setRateShaking=function(t){this.rateShaking=t},n.stopAnimShaking=function(){this.rotation=0,this.status=""},n.reset=function(){this.x=this.x0,this.y=this.y0,this.rotation=0,this.scale=this.scale0,this.alpha=1},n.resetImageBreak=function(){this.imageBreak.x=this.x0,this.imageBreak.y=this.y0,this.imageBreak.rotation=0,this.imageBreak.scale=this.scale0,this.imageBreak.setVisible(!1)},n.resetImageGameOver=function(){this.imageGameOver.x=this.x0,this.imageGameOver.y=this.y0,this.imageGameOver.setVisible(!1)},n.playAnimImageGameOver=function(){this.resetImageGameOver(),this.imageGameOver.setVisible(!0).setAlpha(0),this.tweenImageGameOver.play()},n.playTweenScaleDown=function(){this.resetImageBreak(),this.imageBreak.setVisible(!0).setScale(this.scale0).setAlpha(0),this.tweenAlphaImageBreak.play(),this.tweenScaleDown.play()},n.playTweenStartMission=function(){this.imageGameStart.setVisible(!0).setAlpha(0),this.tweenStartMission.play()},n.preUpdate=function(){if("SHAKING"===this.status)this.rotation+=.015*this.rateShaking,this.rotation>.1&&(this.rateShaking=-1),this.rotation<-.1&&(this.rateShaking=1)},n.handleTweenBreaking=function(){var t=this.alpha0<90?1:-1;this.t0+=3e3/1900;var e=.016*this.t0,n=Dp(this.v0,this.alpha0,e),i=Bp(this.v0,this.alpha0,e);this.imageBreak.x=this.x0+n,this.imageBreak.y=this.y0-i,this.imageBreak.rotation+=.04*t,this.imageBreak.scale>.4?this.imageBreak.scale-=this.scale0:this.imageBreak.scale=.4;var a=this.scene.gameZone,s=a.width,r=a.height;(this.imageBreak.x-this.imageBreak.displayWidth/2<0||this.imageBreak.x+this.imageBreak.displayWidth/2>s||this.imageBreak.y-this.imageBreak.displayHeight/2>r)&&(this.status="")},n.playAnimFadeOut=function(){this.tweenFadeOut.play()},e}(Phaser.GameObjects.Image),_T=OT,DT=n(482),BT=n(458),LT=function(){function t(t){this.scene=void 0,this.tweenScaleUp=void 0,this.tweenScaleDown=void 0,this.tweenMoveTo=void 0,this.target=void 0,this.handleOnComplete=void 0,this.playing=void 0,this.path=void 0,this.scene=t,this.path=new Phaser.Curves.Path}var e=t.prototype;return e.runScaleUpAnimation=function(t,e){var n;null==(n=this.tweenScaleUp)||n.remove(),this.tweenScaleUp||(this.tweenScaleUp=new DT.default({targets:[this.target],delay:t,duration:e,props:{scale:"+=0.05"}})),this.tweenScaleUp.play()},e.runScaleDownAnimation=function(t,e){var n;null==(n=this.tweenScaleDown)||n.remove(),this.tweenScaleDown||(this.tweenScaleDown=new BT.default({targets:[this.target],delay:t,duration:e,props:{scale:"-=0.15"}})),this.tweenScaleDown.play()},e.runAnimMoveToPosition=function(t,e,n,i){var a=this;this.playing=!0,this.target.setDepth(Dr.default.ON_TOP);var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=Math.abs(n-s)/2,h=Math.abs(i-r),c=Phaser.Math.Between(1,2),l=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=(o-d*Phaser.Math.Between(o/4,o/3))*c,f=r-u*(h/4);l.push(new Phaser.Math.Vector2(p,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var g=new Phaser.Curves.Spline(l);this.tweenMoveTo=this.scene.add.tween({delay:t,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:e,onUpdate:function(t){var e=t.getValue(0),n=g.getPoint(e);a.target.setPosition(n.x,n.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}})},e.runGemMoveToPosition=function(t,e,n,i){var a=this;this.playing=!0;var s=this.target.x,r=this.target.y;this.path.startPoint=new Phaser.Math.Vector2(s,r);for(var o=this.scene.gameZone.width/2,h=Math.abs(n-s)+o-50,c=Math.abs(i-r),l=[],u=1;u<4;u++){var d=-1;u%2==0&&(d=1);var p=1.5*(h-d*Phaser.Math.Between(h/8,h/7)),f=r-u*(c/4);l.push(new Phaser.Math.Vector2(p,f))}l.push(new Phaser.Math.Vector2(n,i)),this.path.splineTo(l),this.path.lineTo(n,i);var g=new Phaser.Curves.Spline(l);return this.tweenMoveTo=this.scene.add.tween({delay:t,targets:this.path,t:{from:0,to:1},ease:"Sine.easeInOut",duration:e,onUpdate:function(t){var e=t.getValue(0),n=1-e+.1,i=g.getPoint(e);a.target.setAlpha(n),a.target.setPosition(i.x,i.y)},onComplete:function(){a.playing=!1,a.handleOnComplete&&a.handleOnComplete()}}),this.tweenMoveTo},e.setTarget=function(t){this.target=t},(0,Se.default)(t,[{key:"onComplete",set:function(t){this.handleOnComplete=t}},{key:"isPlaying",get:function(){return this.playing}}]),t}(),FT=function(){function t(t){this.scene=void 0,this.listAnimCollectionItem=[],this.scene=t}var e=t.prototype;return e.handleShowEffect=function(t){var e=this;if(t&&0!==t.length){for(var n=this.scene.header.collectItems.getTargetKeys(),i=this.scene.header.collectItems.getJsonAmount(),a=this.scene.header.collectItems.getJsonTarget(),s=0,r=function(r){var o=n[r],h=c()(t).call(t,(function(t){return t.frame===o}));i[o]+h.length>=a[o]&&s++,e.showEffect(h)},o=0;o<n.length;o++)r(o);s===Y()(a).length&&this.scene.setLevelCompleted(!0),this.scene.time.delayedCall(2e3,(function(){e.scene.handleCollectionItemsComplete()}))}},e.showEffect=function(t){for(var e=this,n=t.length,i=this.scene.main.board.dataBoard,a=function(a){var s=t[a],r=s.x,o=s.y,h=s.frame,c=i[o][r].cell,l=c.imageBreak,u=e.scene.gameZone.width/2,d=e.scene.header.collectItems.getPositionCollectionItem(h),p=u+d.x,f=d.y-24,g=e.getFreeAnim();c.resetImageBreak(),l.setVisible(!0),l.setFrame(h),g.setTarget(l),g.onComplete=function(){(n--,l.setVisible(!1),l.setPosition(c.x,c.y),e.scene.header.collectItems.collectItem(h),n<=0)&&(e.scene.header.collectItems.getCollectItemByKey(h).runAnimCollectionItem(),e.scene.updateMatchData())},g.runScaleUpAnimation(0,300),g.runScaleDownAnimation(450,400),g.runAnimMoveToPosition(700,Phaser.Math.Between(500,1e3),p,f)},s=0;s<t.length;s++)a(s)},e.getFreeAnim=function(){var t=new LT(this.scene);return this.listAnimCollectionItem.push(t),t},t}(),NT=FT,GT=function(){function t(t){this.angle=void 0,this.scene=void 0,this.scaleUpTween=void 0,this.breakingTween=void 0,this.breakingDelay=0,this.captureCells=void 0,this.timerEventRemoveCaptureCells=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createTweenBreaking()},e.handleShowEffect=function(t){var e=this;t&&0!==t.length&&(this.removeCaptureCell(),this.captureCells=t,this.setValueCaptureCell(),this.breakingTween.resetTweenData(!1),this.breakingTween.restart(),this.timerEventRemoveCaptureCells&&this.timerEventRemoveCaptureCells.remove(),this.timerEventRemoveCaptureCells=this.scene.time.addEvent({delay:500,callback:function(){e.breakingTween.isPlaying()||e.removeCaptureCell()}}))},e.onCaptureCellComplete=function(){if(this.captureCells&&this.scene.main&&this.scene.main.board)for(var t=this.scene.main.board.dataBoard,e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.removeCaptureCell=function(){var t=this.scene.main.board.dataBoard;if(this.captureCells)for(var e=0;e<this.captureCells.length;e++){var n=this.captureCells[e],i=n.x;t[n.y][i].cell.resetImageBreak()}},e.setValueCaptureCell=function(){for(var t=this.scene.main.board.dataBoard,e=Math.round(68.25),n=0;n<this.captureCells.length;n++){var i=Phaser.Math.Between(50,e),a=Phaser.Math.Between(82,98)*Math.PI/180,s=Phaser.Math.Between(3,10)/1e3,r=this.captureCells[n],o=r.x,h=t[r.y][o].cell;h.maxScale0=Phaser.Math.FloatBetween(2.5,4)/10,h.imageBreak.setVisible(!0),h.imageBreak.setFrame(or.default.GAMEPLAY_32.FRAME.GEM),h.v0=i,h.alpha0=a,h.scaleRate0=s}},e.createTweenBreaking=function(){var t=this;this.breakingTween=this.scene.tweens.addCounter({from:0,to:1900,onUpdate:function(e){if(t.captureCells)for(var n=t.scene.main.board.dataBoard,i=0;i<t.captureCells.length;i++){t.angle=Phaser.Math.Between(-15,15);var a=t.captureCells[i],s=a.x,r=n[a.y][s].cell,o=r.imageBreak,h=r.maxScale0,c=r.alpha0<1.57?1:-1,l=.016*e.getValue(),u=Dp(r.v0,r.alpha0,l),d=Bp(r.v0,r.alpha0,l);o.setVisible(!0),o.x=r.x0+u,o.y=r.y0+-d,o.rotation+=.04*c,o.scale>h?o.scale-=r.scaleRate0:o.scale=h}},onComplete:function(){t.onCaptureCellComplete()},delay:this.breakingDelay,duration:2500}).stop()},t}(),UT=GT,VT=or.default.GAMEPLAY,YT=VT.KEY,zT=VT.FRAME,HT=or.default.GAMEPLAY_32,WT=HT.KEY,XT=HT.FRAME,KT=GameCore.Configs.Board,jT=KT.cols,qT=KT.rows,ZT=or.default.DEFAULT.FRAME,JT=GameCore.Configs.Gameplay.VibrateValue,QT=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.suggestCells=[],a.pX=void 0,a.pY=void 0,a.borderLeftSize=4.5,a.borderTopSize=3,a.cellSize=void 0,a.cellPadding=void 0,a.diceSize=void 0,a.dataBoard=[],a.cellsHighlight=[],a.cellSharking=[],a.boardFrame=void 0,a.woodenEffect=void 0,a.collectionEffect=void 0,a.canCaptureLines=function(t,e){void 0===e&&(e=5);for(var n=t.length,i=t[0].length,a=[],s=[],r=[],o=0;o<n;o++){for(var h=0,c={x:-1,y:-1},l=0;l<i;l++)0===o&&(r[l]={count:0,x:-1,y:-1}),1===t[o][l].value?(r[l].count++,h++):(c.x=l,c.y=o,r[l].x=l,r[l].y=o);if(h===i-1&&s.push((0,wt.default)({row:o},c)),o===n-1)for(var u=0;u<i;u++)r[u].count===n-1&&a.push((0,wt.default)({col:u},r[u]))}if(s.length>=e)for(var d=0,p={x:-1,y:-1},f=0;f<s.length;f++)if(0!==f){if(s[f].x===p.x&&s[f].y===p.y+1?(p.x=s[f].x,p.y=s[f].y,d++):d=1,d>=e)return{isCapture:!0,direction:"vertical",minLine:e}}else p.x=s[f].x,p.y=s[f].y,d++;if(a.length>=e)for(var g=0,m={x:-1,y:-1},v=0;v<a.length;v++)if(0!==v){if(a[v].x===m.x+1&&a[v].y===m.y?(m.x=a[v].x,m.y=a[v].y,g++):g=1,g>=e)return{isCapture:!0,direction:"horizontal",minLine:e}}else m.x=a[v].x,m.y=a[v].y,g++;return{isCapture:!1,direction:"",minLine:e}},a.scene=e,a.setSize(n,i),a.woodenEffect=new UT(a.scene),a.collectionEffect=new NT(a.scene),a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.calcCellLength(),this.initDataBoard()},n.createBoard=function(){var t=this.scene.gameZone,e=t.width/2,n=t.height/2-27;this.boardFrame=this.scene.make.image({x:e,y:n,key:YT,frame:zT.BOARD}),this.boardFrame.setWorldSize(this.width,this.height)},n.calcCellLength=function(){this.cellPadding=1.8,this.cellSize=(this.width-2*this.borderLeftSize-this.cellPadding*(jT+1))/jT},n.initDataBoard=function(){for(var t=this.boardFrame.x-this.boardFrame.displayWidth/2+this.cellSize/2+this.borderLeftSize,e=this.boardFrame.y-this.boardFrame.displayHeight/2+this.cellSize/2+this.borderTopSize,n=0;n<qT;n++){this.dataBoard[n]=[];for(var i=0;i<jT;i++){var a=t+i*this.cellSize+this.cellPadding*i,s=e+n*this.cellSize+this.cellPadding*n,r={x:a,y:s,width:this.cellSize,height:this.cellSize,texture:WT,frame:XT.GEM_TRANSPARENT,depth:Dr.default.PIECE-.1,padding:this.cellPadding,isWoodenEffect:!0},o=new _T(this.scene,r);o.setVisible(!1),this.dataBoard[n][i]={x:a,y:s,width:this.cellSize,height:this.cellSize,frame:XT.GEM_TRANSPARENT,value:0,cell:o}}}},n.handleHighlight=function(t,e){this.cellsHighlight=t;for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y,r=i.frame;if(this.dataBoard[s]&&this.dataBoard[s][a]&&0===this.dataBoard[s][a].value){var o=this.dataBoard[s][a].cell;this.dataBoard[s][a].frame=r||XT.GEM,o.setVisible(!0),o.setFrame(r||XT.GEM),o.setAlpha(.3)}}this.canCaptureCells(t,e)},n.handleTweenStartMission=function(){for(var t=this,e=100,n=0;n<qT;n++)for(var i=function(i){var a=t.dataBoard[n][i].cell,s=0;s=4==n&&4==i?e:n>=3&&n<=5&&i>=3&&i<=5?200:n>=2&&n<=6&&i>=2&&i<=6?300:n>=1&&n<=7&&i>=1&&i<=7?400:500,t.scene.time.delayedCall(s,(function(){a.playTweenStartMission()}))},a=0;a<jT;a++)i(a)},n.handleCapturePiece=function(t){var e=this;try{!function(){if(!t||t.length<=0)throw kS=0,new Error("Invalid Capture");var n=c()(t).call(t,(function(t){return t.frame!==XT.GEM}));e.collectionEffect.handleShowEffect(n);for(var i=300,a=0,s=wS(e.dataBoard),r=MS(e.dataBoard),o=AS(),h=function(n){var h=t[n],c=h.x,l=h.y,u=e.dataBoard[l][c].cell,d=0,p=0,f=0;if(s.length>0&&r.length>0){var m=0,v=0;a=i/jT,-1!==g()(s).call(s,l)&&-1===g()(r).call(r,c)&&(m=a*c,v=0,p=g()(s).call(s,l)),-1===g()(s).call(s,l)&&-1!==g()(r).call(r,c)&&(m=0,v=a*l,p=g()(r).call(r,c)),-1!==g()(s).call(s,l)&&-1!==g()(r).call(r,c)&&(m=a*c,v=a*l,p=Math.max(g()(r).call(r,c),g()(s).call(s,l),0)),-1===g()(s).call(s,l)&&-1===g()(r).call(r,c)&&(m=a*c,v=a*l),d=Math.max(m,v,0)}else if(r.length>0)d=(a=i/jT)*l,p=g()(r).call(r,c),f=l;else if(s.length>0)d=(a=i/qT)*c,p=g()(s).call(s,l),f=c;else{a=100;var y=t[0].x;d=a*(c-y),p=0}u.hideImageHighlight(),e.scene.time.delayedCall(d,(function(){if(u.frame.name===XT.GEM){u.resetImageBreak();var t="";o>2&&(r.length>=3||s.length>=3)?(t=zg[f]||zg[0],u.imageBreak.setFrame(t)):(t=Yg[p]||Yg[0],u.imageBreak.setFrame(t)),u.playTweenScaleDown()}0==e.dataBoard[l][c].value&&u.setVisible(!1)})),e.dataBoard[l][c].frame=XT.GEM_TRANSPARENT,e.dataBoard[l][c].value=0},l=0;l<t.length;l++)h(l)}()}catch(n){}},n.checkPositionCellOnCaptureCell=function(t,e){var n=c()(e).call(e,(function(e){return e.x===t.x&&e.y===t.y}));return n&&n.length>0},n.handlePraise=function(t,e){for(var n=[],i=0;i<t.length;i++){var a=t[i];this.checkPositionCellOnCaptureCell(a,e)&&n.push(a)}0!==n.length&&this.playEatSound(1)},n.handleStreakBreak=function(t,e){var n=AS(),i=RS();if(t-75<0&&(t=75),t+75>375&&(t=300),!(i<2||n>=2)){var a=i>6?6:i,s=this.getVibrateByLevel(a);this.scene.player.getPlayerSettings().vibrate&&jg(s),this.playEatSound(a),this.scene.effectManager.streakBreak.setTextStreak(i),this.scene.effectManager.streakBreak.setBgFrame(ZT.BG_STREAK),this.scene.effectManager.streakBreak.playAnim(t,e-20)}},n.getVibrateByLevel=function(t){return JT[t]||0},n.playEatSound=function(t){switch(this.scene.audio.playSound(Or.default.EAT_BLOCK),t){default:break;case 2:this.scene.audio.playSound(Or.default.GOOD);break;case 3:this.scene.audio.playSound(Or.default.COOL);break;case 4:case 5:case 6:this.scene.audio.playSound(Or.default.EXCELLENT)}},n.handleRemoveHighlight=function(){try{if(!this.cellsHighlight)return;for(var t=0;t<this.cellsHighlight.length;t++){var e=this.cellsHighlight[t],n=e.x,i=e.y;if(this.dataBoard[i]&&this.dataBoard[i][n]&&0===this.dataBoard[i][n].value){var a=this.dataBoard[i][n].cell;this.dataBoard[i][n].frame=XT.GEM_TRANSPARENT,a.setVisible(!1),a.setFrame(XT.GEM_TRANSPARENT),a.setAlpha(1)}}this.cellsHighlight=[]}catch(s){}},n.canCaptureCells=function(t,e){for(var n=this,i=this.dataBoard,a=[],s=0;s<i.length;s++){a[s]=[];for(var r=0;r<i[s].length;r++)a[s][r]=(0,wt.default)({},i[s][r])}for(var o=0;o<t.length;o++){var h=t[o],c=h.x;a[h.y][c].value=1}this.removeAnimCanCaptureCells(a,t);var l=ES(a,t);if(!l||l.length<=0)return!1;for(var u=function(e){var i=l[e],a=i.x,s=i.y;t.some((function(t){return t.x===a&&t.y===s}))||n.cellSharking.push((0,wt.default)({},l[e]))},d=0;d<l.length;d++)u(d);for(var p=0;p<this.cellSharking.length;p++){var f=this.cellSharking[p],g=f.x,m=f.y,v=this.dataBoard[m][g].cell;v.isHighlight()||v.showImageHighlight()}e(wS(a),MS(a),TS(a,t),t)},n.removeAnimCanCaptureCells=function(t,e){var n=this;if(0!==this.cellSharking.length){for(var i=wS(t),a=MS(t),s=TS(t,e),r=function(t){var e=n.cellSharking[t],r=e.x,o=e.y,h=n.dataBoard[o][r].cell;if(-1!==g()(i).call(i,o)||-1!==g()(a).call(a,r)||s.some((function(t){return t.x===r&&t.y===o})))return"continue";h.hideImageHighlight()},o=0;o<this.cellSharking.length;o++)r(o);this.cellSharking=[]}},n.removeAllCanCaptureCells=function(){if(0!==this.cellSharking.length){for(var t=0;t<this.cellSharking.length;t++){var e=this.cellSharking[t],n=e.x,i=e.y;this.dataBoard[i][n].cell.hideImageHighlight()}this.cellSharking=[]}},n.handleSuggestMove=function(t){try{this.suggestCells=t;for(var e=0;e<t.length;e++){var n=t[e],i=n.x,a=n.y,s=this.dataBoard[a][i].cell;s.setFrame(XT.GEM_HIGHT_LIGHT),s.setVisible(!0),s.setAlpha(1)}}catch(r){}},n.handleRemoveSuggestMove=function(){try{for(var t=0;t<this.suggestCells.length;t++){var e=this.suggestCells[t],n=e.x,i=e.y,a=this.dataBoard[i][n].cell;this.isCellHighlight(a)||(a.setFrame(XT.GEM_TRANSPARENT),a.setVisible(!1))}this.suggestCells=[]}catch(s){}},n.handleMove=function(t,e){try{for(var n=0;n<t.length;n++){var i=t[n],a=i.x,s=i.y,r=i.frame,o=void 0===r?XT.GEM:r;if(this.dataBoard[s]&&this.dataBoard[s][a]){this.dataBoard[s][a].frame=o,this.dataBoard[s][a].value=1;var h=this.dataBoard[s][a].cell;h.setVisible(!0),h.setFrame(o),h.setAlpha(1)}}var c=ES(this.dataBoard,t);this.handleCapturePiece(c),this.handlePraise(t,c),e&&e(),this.handleResetFrameBoard(),this.scene.updateMatchData(),this.handleGameOver()}catch(l){}},n.handleResetFrameBoard=function(){for(var t=0;t<qT;t++)for(var e=0;e<jT;e++)if(this.dataBoard[t]&&this.dataBoard[t][e]&&1===this.dataBoard[t][e].value){var n=this.dataBoard[t][e],i=n.frame,a=n.cell;a.visible||(0,Ht.sendException)(new Error("Cell is invisible")),a.frame.name!==i&&(0,Ht.sendException)(new Error("Cell is frame not true")),a.setVisible(!0).setFrame(i)}},n.handleGameOver=function(){if(!this.scene.isLevelComplete){for(var t=[],e=this.scene.footer.pieces.piecesActive,n=this.scene.footer.pieces.allPieces,i=0;i<e.length;i++){var a=e[i],s=a.position;if(!a.used){var r=n[s].piece;t.push({data:r.data,type:r.type,direction:r.direction,isReverse:r.isReverse,frame:r.frame})}}CS(this.dataBoard,t)&&(this.scene.disableInput(),this.runAnimationGameOver())}},n.runAnimationGameOver=function(){var t=this;try{this.scene.audio.playSound(Or.default.BOARD_GAME_OVER);for(var e=[],n=function(n){for(var i=function(i){if(t.dataBoard[n]&&t.dataBoard[n][i]&&1===t.dataBoard[n][i].value){var a=Math.floor(100*(n+1));e.push({delay:a,x:i,y:n}),t.scene.time.delayedCall(a,(function(){t.dataBoard[n][i].cell.playAnimImageGameOver()}))}},a=0;a<jT;a++)i(a)},i=0;i<qT;i++)n(i);this.scene.time.addEvent({delay:e[e.length-1].delay+300,callback:function(){t.scene.handleRequestFinishGame()}})}catch(a){}},n.hasPieceL5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===iy})).length>0},n.hasPieceCross5=function(){var t=this.scene.footer.pieces.piecesActive;return c()(t).call(t,(function(t){return t.type===fy})).length>0},n.getBoardByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=n[0].split("/"),a=i.length,s=0;s<a;s++){e[s]=[];for(var r=DS(i[s]),o=0;o<r.length;o++)e[s][o]=r[o]}return e},n.getFenByBoard=function(){for(var t="",e=0;e<qT;e++){for(var n="",i=0;i<jT;i++){var a=this.dataBoard[e][i],s=a.value,r=a.frame,o=OS(r)||"g";switch(s){case 0:n+=",x";break;case 1:n+=","+o}}t+="/"+(n=n.substring(1))}return t.substring(1)},n.startGame=function(t,e){if(t){for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++){var a=t[n][i].frame,s=t[n][i].value,r=this.dataBoard[n][i];1===s&&(a&&a!==XT.GEM_TRANSPARENT||((0,Ht.sendExceptionWithScope)(new Error("MapByBoardError"),{level:this.scene.levelManager.getLevel(),row:n,col:i,frame:a,fen:e}),a=XT.GEM),r.value=1,r.frame=a,r.cell.setFrame(a),r.cell.setVisible(!0),r.cell.setWorldSize(this.cellSize,this.cellSize),r.cell.setAlpha(0),r.cell.setScale(0))}this.fadeIn()}},n.clearBoard=function(){for(var t=0;t<qT;t++)for(var e=0;e<jT;e++){var n=this.dataBoard[t][e];n.value=0,n.frame=XT.GEM_TRANSPARENT,n.cell.reset(),n.cell.setFrame(XT.GEM_TRANSPARENT),n.cell.setVisible(!1),n.cell.resetImageGameOver()}},n.isCellHighlight=function(t){var e,n=c()(e=this.cellsHighlight).call(e,(function(e){return e.x===t.x&&e.y&&t.y}));return!!(n&&n.length>0)},n.setFrameBoardByIndex=function(t,e,n){var i=this.dataBoard[t][e],a=i.cell;a.setFrame(n),a.setVisible(!0),i.frame=n,i.value=1,a.setScale(0),a.setAlpha(0)},n.getFrameByMapItemIndex=function(t){return mS[t]},n.fadeOut=function(){for(var t=[],e=0;e<qT;e++)for(var n=0;n<jT;n++){var i=this.dataBoard[e][n];i.value&&t.push(i.cell)}if(!t||0===t.length)return null;var a=this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:1,to:0},scale:{from:t[0].scale,to:0},paused:!0});return a.play(),a},n.fadeIn=function(){for(var t=[],e=0;e<qT;e++)for(var n=0;n<jT;n++){var i=this.dataBoard[e][n];i.value&&t.push(i.cell)}var a=this.scene.add.tween({targets:t,duration:300,ease:Phaser.Math.Easing.Quadratic.InOut,alpha:{from:0,to:t[0].alpha0},scale:{from:0,to:t[0].scale0},paused:!0});return a.play(),a},e}(Phaser.GameObjects.Container),$T="score",tw="collect",ew=GameCore.Configs.Gameplay.VibrateValue,nw=or.default.EFFECTS,iw=nw.KEY,aw=nw.FRAME,sw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.listScore=[],n.score=void 0,n.startX=void 0,n.startY=void 0,n.scoreText=void 0,n.tweenShowScoreText=void 0,n.tweenHideScoreText=void 0,n.tweenShowPraiseFrame=void 0,n.tweenHidePraiseFrame=void 0,n.praiseFrame=void 0,n.praiseScoreText=void 0,n.particle=void 0,n.emitter=void 0,n.scene=e,e.add.existing((0,nr.default)(n)),n.setVisible(!1).setAlpha(0),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createScoreText(),this.createTweenScoreText(),this.createPraiseFrame(),this.createPraiseScoreText(),this.createParticle(),this.createEmitter()},n.createParticle=function(){this.particle=this.scene.add.particles(iw),this.particle.setDepth(Dr.default.ON_TOP+1)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{start:.05,end:.2},speed:{min:20,max:70},lifespan:{min:500,max:1e3},quantity:20,on:!1,tint:[16441092,16422659],frame:aw.FX_STAR,delay:350})},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(50),text:"+0",origin:{x:.5,y:.5}}),this.scoreText.setScale(0).setAlpha(0),this.scoreText.setDepth(Dr.default.ON_TOP),this.scoreText.setVisible(!1)},n.createTweenScoreText=function(){var t,e=this,n=this.scene.storage.getState(),i=yl(n),a=this.scene.gameZone.width/2;g()(t=[Gs,Ns,Us]).call(t,i)>=0&&(a=105),this.tweenShowScoreText=this.scene.tweens.add({paused:!0,targets:this.scoreText,scale:{from:0,to:1},alpha:{from:0,to:1},duration:300,onComplete:function(){e.tweenHideScoreText=e.scene.tweens.add({targets:e.scoreText,scale:{from:1,to:.5},alpha:{from:1,to:.5},x:a,y:65,delay:1e3,duration:300,onComplete:function(){e.scoreText.setVisible(!1),e.scoreText.setAlpha(0),e.scoreText.setScale(0),e.scene.handleAddScoreAnim(e.score||0)}})}})},n.playAnimShowScoreText=function(){if(this.tweenHideScoreText&&this.tweenHideScoreText.isPlaying()){this.tweenHideScoreText.stop(),this.scoreText.setPosition(this.startX,this.startY);var t=this.scene.storage.getState(),e=0;yl(t)===Fs&&(e=this.scene.header.mainScoreBlock.score,this.scene.header.mainScoreBlock.setScore(e+(this.score||0)),this.scene.header.mainScoreBlock.setScoreText(e+(this.score||0)))}this.score=this.listScore.shift()||0,this.scene.handleUpdateScore(this.score),this.scoreText.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowScoreText.play()},n.createPraiseFrame=function(){this.praiseFrame=this.scene.make.image({x:0,y:0,key:iw}),this.praiseFrame.setScale(0),this.praiseFrame.setAlpha(0),this.praiseFrame.setDepth(Dr.default.ON_TOP),this.praiseFrame.setVisible(!1)},n.createTweenPraiseFrame=function(){var t=this;if(!this.tweenShowPraiseFrame||!this.tweenHidePraiseFrame){var e=this.praiseFrame.scale;this.tweenShowPraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:0,to:e},alpha:{from:0,to:1},duration:300,delay:100,ease:Phaser.Math.Easing.Back.Out,onComplete:function(){t.tweenHidePraiseFrame.play()}}),this.tweenHidePraiseFrame=this.scene.tweens.add({paused:!0,targets:this.praiseFrame,scale:{from:e,to:0},alpha:{from:1,to:0},duration:300,delay:1e3,onComplete:function(){t.praiseFrame.setScale(0),t.praiseFrame.setAlpha(0),t.praiseFrame.setVisible(!1)}})}},n.playAnimShowPraiseFrame=function(){this.createTweenPraiseFrame(),(this.tweenShowPraiseFrame.isPlaying()||this.tweenHidePraiseFrame.isPlaying())&&(this.tweenShowPraiseFrame.resetTweenData(!1),this.tweenHidePraiseFrame.resetTweenData(!1)),this.praiseFrame.setScale(0).setAlpha(0).setVisible(!0),this.tweenShowPraiseFrame.play()},n.createPraiseScoreText=function(){this.praiseScoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(30),origin:{x:.5,y:.5}}),this.praiseScoreText.setDepth(Dr.default.ON_TOP),this.add(this.praiseScoreText),Phaser.Display.Align.In.Center(this.praiseScoreText,this,0,20)},n.handlePraise=function(t,e,n,i){this.startX=t,this.startY=e+15,this.listScore.push(n);var a=t-10,s=this.scene.targetMissionManager.getTargetType()===$T;this.scoreText.setPosition(a,e+15),this.scoreText.setText("+"+n),this.scoreText.setVisible(s),a-this.scoreText.fontSize/2<0&&(a+=this.scoreText.fontSize/2,this.scoreText.setPosition(a,e+15)),s&&(this.playAnimShowScoreText(),this.handlePraiseFrameText(t,e,i));var r=this.getVibrateByLevel(i);this.scene.player.getPlayerSettings().vibrate&&jg(r),i<=1||this.changeExplode(a,e,i)},n.getVibrateByLevel=function(t){return ew[t]||0},n.changeExplode=function(t,e,n){var i=this.getExplodeByLevel(n);i&&(this.emitter.setScale({start:.05*i.scale,end:.2*i.scale}),this.emitter.setSpeed({min:30*i.speed,max:80*i.speed}),this.emitter.setQuantity(20*i.quantity)),this.emitter.explode(20*i.quantity,t,e)},n.handlePraiseFrameText=function(t,e,n){var i=this.getMainFrameByLevel(n);if(i){var a=0,s=0,r=this.scene.targetMissionManager.getTargetType()===$T?-40:0;switch(i){case aw.TEXT_COOL:a=84,s=30;break;case aw.TEXT_GOOD:a=115.5,s=30;break;case aw.TEXT_EXCELLENT:a=207,s=30}this.praiseFrame.setFrame(i),this.praiseFrame.setWorldSize(a,s),this.praiseFrame.setPosition(t-a/2<0?a/2:t,e+r),this.playAnimShowPraiseFrame()}},n.getExplodeByLevel=function(t){return Zv[t-1]||Zv[0]||null},n.getMainFrameByLevel=function(t){var e=qv[t-1]||qv[0];return Phaser.Utils.Array.GetRandom(e.frames)},n.reset=function(){this.createTweenScoreText()},e}(Phaser.GameObjects.Container),rw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.board=void 0,n.praise=void 0,n.scene=e,e.add.existing((0,nr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBoard(),this.createPraise()},n.createBoard=function(){this.board=new QT(this.scene,354,352)},n.createPraise=function(){this.praise=new sw(this.scene)},e}(Phaser.GameObjects.Container),ow=rw,hw=or.default.DEFAULT,cw=hw.KEY,lw=hw.FRAME,uw=function(t){function e(e){var n;return(n=t.call(this,e)||this).background=void 0,n.bestScoreText=void 0,n.setPosition(0,48.5),n.createBackground(),n.createScoreText(),n.createLevelTitleText(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:cw,frame:lw.BEST_SCORE_FRAME}),this.background.setWorldSize(55,77),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.bestScoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(32),origin:{x:.5,y:.5},text:"0"}),this.add(this.bestScoreText),Phaser.Display.Align.In.Center(this.bestScoreText,this.background,0,23)},n.createLevelTitleText=function(){var t=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5},text:"LEVEL"});this.add(t),Phaser.Display.Align.In.Center(t,this.background,0,4)},n.setScoreText=function(t){this.bestScoreText.setText(String(t))},e}(Phaser.GameObjects.Container),dw=uw,pw=or.default.GAMEPLAY,fw=pw.KEY,gw=pw.FRAME,mw=or.default.GAMEPLAY_32.KEY,vw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.imageGem=void 0,n.imageCheck=void 0,n.text=void 0,n.particle=void 0,n.emitter=void 0,n.currentPosition=void 0,n.imageGlow=void 0,n.tweenGlow=void 0,n.imageGlowCrop=void 0,n.tweenCropMaskTopDown=void 0,n.tweenCropMaskDownBottom=void 0,n.imageStar=void 0,n.tweenShowStar=void 0,n.tweenHideStar=void 0,n.tweenShowMe=void 0,n.scene=e,n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createImageGem(),this.createImageCheck(),this.createText(),this.createParticle(),this.createEmitter(),this.createGlow(),this.createTweenGlow(),this.createGlowCrop(),this.createStar(),this.createTweenStar(),this.createTweenShowMe()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:mw}),this.imageGem.setWorldSize(22,22),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-7)},n.createImageCheck=function(){this.imageCheck=this.scene.make.image({key:fw,frame:gw.ICON_CHECK}),this.imageCheck.setWorldSize(22,17),this.imageCheck.setVisible(!1),this.add(this.imageCheck),Phaser.Display.Align.In.Center(this.imageCheck,this.imageGem)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Br.default.NUMBER_LIGHT.KEY,size:this.scene.fontSize(24),origin:{x:.5,y:.5}}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this.imageGem,0,19)},n.createParticle=function(){this.particle=this.scene.add.particles(fw).setDepth(Dr.default.ON_TOP)},n.createEmitter=function(){var t=1.5/this.scene.world.getPixelRatio();this.emitter=this.particle.createEmitter({on:!1,angle:{start:0,end:360,steps:8},frame:[gw.DUST],lifespan:1e3,quantity:1,scale:{start:t,end:0,ease:"Quart.easeIn"},speed:50})},n.createGlow=function(){this.imageGlow=this.scene.make.image({key:fw,frame:gw.VIOLET_GLOW}),this.imageGlow.setVisible(!1).setScale(0).setAlpha(0),this.add(this.imageGlow),Phaser.Display.Align.In.Center(this.imageGlow,this.imageGem)},n.createTweenGlow=function(){var t=this;this.tweenGlow=this.scene.tweens.add({targets:[this.imageGlow],paused:!0,scale:{from:0,to:.6},alpha:{from:0,to:1},delay:100,duration:600,onComplete:function(){t.imageGlow.setVisible(!1).setScale(0).setAlpha(0),t.playAnimMaskCrop(),t.playAnimStar()}})},n.createGlowCrop=function(){this.imageGlowCrop=this.scene.make.image({key:fw,frame:gw.MASK}),this.imageGlowCrop.setVisible(!1),this.imageGlowCrop.setWorldSize(this.imageGem.displayWidth,this.imageGem.displayHeight),this.add(this.imageGlowCrop),Phaser.Display.Align.In.Center(this.imageGlowCrop,this.imageGem)},n.createStar=function(){this.imageStar=this.scene.make.image({key:fw,frame:gw.ICON_STAR_1}),this.imageStar.setVisible(!1).setScale(0).setAlpha(0),this.imageStar.setWorldSize(27,26),this.add(this.imageStar),Phaser.Display.Align.In.Center(this.imageStar,this.imageGem,-10,-10)},n.createTweenStar=function(){var t=this;this.tweenHideStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:1,to:0},alpha:{from:1,to:0},delay:100,duration:500,onComplete:function(){t.imageStar.setVisible(!1).setScale(0).setAlpha(0)}}),this.tweenShowStar=this.scene.add.tween({paused:!0,targets:[this.imageStar],scale:{from:0,to:1},alpha:{from:0,to:1},delay:100,duration:500,onComplete:function(){t.tweenHideStar.play()}})},n.createTweenShowMe=function(){this.tweenShowMe=this.scene.add.tween({paused:!0,targets:[this],alpha:{from:0,to:1},duration:200})},n.cropTopDownImageGlow=function(){var t=this;if(!this.tweenCropMaskTopDown){var e=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskTopDown=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*e;t.imageGlowCrop.setCrop(0,0,n/i,r/a)},onComplete:function(){t.cropDownBottomImageGlow()}})}this.tweenCropMaskTopDown.play()},n.cropDownBottomImageGlow=function(){var t=this;if(!this.tweenCropMaskDownBottom){var e=this.imageGlowCrop.displayHeight,n=this.imageGlowCrop.displayWidth,i=this.imageGlowCrop.scaleX,a=this.imageGlowCrop.scaleY;this.tweenCropMaskDownBottom=this.scene.tweens.addCounter({from:0,to:1,delay:200,duration:300,paused:!0,onUpdate:function(s){var r=s.getValue(0)*e;t.imageGlowCrop.setCrop(0,r/a,n/i,e/a)}})}this.tweenCropMaskDownBottom.play()},n.playAnimStar=function(){this.imageStar.setVisible(!0),this.tweenShowStar.play()},n.playAnimMaskCrop=function(){this.imageGlowCrop.setVisible(!0).setCrop(0,0,0,0),this.cropTopDownImageGlow()},n.setFrame=function(t){this.imageGem.setFrame(t)},n.getFrame=function(){return this.imageGem.frame.name},n.setText=function(t,e){this.text.setText(t+" / "+e)},n.completeMission=function(){this.imageGem.setAlpha(.3),this.text.setAlpha(.3),this.imageCheck.setVisible(!0)},n.reset=function(){this.imageGem.setAlpha(1),this.text.setAlpha(1),this.imageCheck.setVisible(!1)},n.updateCurrentPosition=function(t){this.currentPosition=t},n.runAnimCollectionItem=function(){var t=this.scene.gameZone.width/2;this.tweenGlow.play(),this.emitter.explode(8,t+this.currentPosition.x,this.currentPosition.y-25)},n.playAnimShowMe=function(){this.setVisible(!0).setAlpha(0),this.tweenShowMe.play()},e}(Phaser.GameObjects.Container),yw=or.default.GAMEPLAY,Sw=yw.KEY,Aw=yw.FRAME,Ew=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.target=void 0,n.targetKeys=[],n.jsonPosition={},n.jsonAmount={},n.jsonTarget={},n.jsonCollectItem={},n.textMission=void 0,n.background=void 0,n.listCollectItems=[],n.scene=e,n.createBackground(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Sw,frame:Aw.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this,0,-1)},n.calcPosition=function(t){for(var e=[],n=200/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.parseTargetToJson=function(){if(!(0,Pv.isObject)(this.target))for(var t=JSON.parse(this.target),e=Y()(t),n=this.calcPosition(e.length),i=0;i<e.length;i++){var a=e[i],s=mS[a];this.targetKeys.push(s),this.jsonAmount[s]=0,this.jsonTarget[s]=t[a],this.jsonPosition[s]={x:n[i],y:68};var r=this.listCollectItems[i];r||(r=new vw(this.scene),this.add(r),this.listCollectItems.push(r)),r.updateCurrentPosition(this.jsonPosition[s]),r.setVisible(!0),r.setX(n[i]),r.setFrame(s),r.setText(0,t[a]),this.jsonCollectItem[s]=r}},n.hideListCollectItems=function(){this.listCollectItems.forEach((function(t){t.setVisible(!1),t.reset()}))},n.showListCollectItems=function(){this.listCollectItems.forEach((function(t){t.reset(),t.playAnimShowMe()}))},n.showCollectItemByKey=function(t){var e,n=c()(e=this.listCollectItems).call(e,(function(e){return e.getFrame()===t}));n&&0!==n.length&&(this.jsonAmount[t]>=this.jsonTarget[t]?n[0].completeMission():n[0].reset(),n[0].playAnimShowMe())},n.start=function(){this.parseTargetToJson()},n.setTargets=function(t){var e,n;this.target=pv()(e=pv()(n=pv()(t).call(t,"{",'{"')).call(n,", ",', "')).call(e,":",'":')},n.collectItem=function(t){if(t in this.jsonAmount){this.jsonAmount[t]++;var e=this.jsonAmount[t],n=this.jsonTarget[t];e===n&&this.jsonCollectItem[t].completeMission(),this.jsonCollectItem[t].setText(e,n)}},n.checkCompleteMission=function(){for(var t=Y()(this.jsonTarget),e=0;e<t.length;e++){var n=t[e];if(this.jsonTarget[n]>this.jsonAmount[n])return!1}return!0},n.reset=function(){this.hideListCollectItems(),this.targetKeys=[],this.jsonAmount={},this.jsonTarget={},this.jsonCollectItem={},this.jsonPosition={}},n.getPositionCollectionItem=function(t){return this.jsonPosition[t]},n.getTargetKeys=function(){return this.targetKeys},n.getJsonAmount=function(){return this.jsonAmount},n.getJsonTarget=function(){return this.jsonTarget},n.getCollectItemByKey=function(t){return this.jsonCollectItem[t]},n.updateJsonAmountByFen=function(t){this.jsonAmount=JSON.parse(_()(t));for(var e=Y()(this.jsonTarget),n=0;n<e.length;n++){var i=e[n],a=this.jsonCollectItem[i];this.jsonTarget[i]>this.jsonAmount[i]?a.reset():a.completeMission(),a.setText(this.jsonAmount[i],this.jsonTarget[i])}},n.resetTextAmount=function(){for(var t=Y()(this.jsonTarget),e=0;e<t.length;e++){var n=t[e],i=this.listCollectItems[e];i&&i.setText(0,this.jsonTarget[n])}},e}(Phaser.GameObjects.Container),xw=or.default.DEFAULT,bw=xw.KEY,Tw=xw.FRAME,ww=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,bw,Tw.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.setInteractive().on(Phaser.Input.Events.POINTER_MOVE,(function(){n.disableInteractive()})),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),Mw=ww,Cw=or.default.GAMEPLAY,Pw=Cw.KEY,Iw=Cw.FRAME,kw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.scoreText=void 0,n.background=void 0,n.tweenShow=void 0,n.tweenHide=void 0,n.addScore=void 0,n.score=0,n.scene=e,n.scene.add.existing((0,nr.default)(n)),n.createBackground(),n.createScoreText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createBackground=function(){this.background=this.scene.make.image({key:Pw,frame:Iw.BG_MAIN_SCORE}),this.background.setWorldSize(187,48),this.add(this.background),Phaser.Display.Align.In.Center(this.background,this)},n.createScoreText=function(){this.scoreText=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(52),text:"0",origin:{x:.5,y:.5}}),this.add(this.scoreText),Phaser.Display.Align.In.Center(this.scoreText,this.background)},n.setScore=function(t){this.score=t},n.setScoreText=function(t){this.scoreText.setText(String(t))},n.animAddScore=function(t){var e=this;if(this.addScore&&this.addScore.isPlaying()){this.addScore.stop();var n=this.score+t;this.setScore(n),this.setScoreText(n)}this.addScore=this.scene.tweens.addCounter({from:0,to:t,duration:100,onUpdate:function(t){var n=e.score+Math.floor(t.getValue());e.setScoreText(n),e.scene.updateProgressTargetScore(n)},onComplete:function(){var n=e.score+t;e.setScore(n),e.setScoreText(n),e.scene.handleCompleteScoreMission()}})},n.reset=function(){this.setScore(0),this.setScoreText(0)},e}(Phaser.GameObjects.Container),Rw=kw,Ow=or.default.GAMEPLAY,_w=Ow.KEY,Dw=Ow.FRAME,Bw=function(t){function e(e,n,i){var a;return(a=t.call(this,e)||this).scene=void 0,a.leftBg=void 0,a.midBg=void 0,a.rightBg=void 0,a.leftProgress=void 0,a.midProgress=void 0,a.rightProgress=void 0,a.iconCup=void 0,a.glareCup=void 0,a.tweenRotationGlareCup=void 0,a.targetScore=void 0,a.listPoolMilestoneFrame=[],a.listMilestoneFrame=[],a.particle=void 0,a.emitter=void 0,a.progressBarFull=void 0,a.setSize(n,i),a.scene=e,a.init(),a}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initBg(),this.initProgressBar(),this.createParticle(),this.createEmitter(),this.createGlareCup(),this.createTweenGlare(),this.createIconCup()},n.initBg=function(){this.leftBg=this.scene.make.image({key:_w,frame:Dw.PROGRESS_BG_LEFT}),this.midBg=this.scene.make.image({key:_w,frame:Dw.PROGRESS_BG_MID}),this.rightBg=this.scene.make.image({key:_w,frame:Dw.PROGRESS_BG_RIGHT});var t=this.leftBg,e=t.width,n=t.height,i=e*this.height/n;this.leftBg.setWorldSize(i,this.height);var a=this.rightBg,s=a.width,r=a.height,o=s*this.height/r;this.rightBg.setWorldSize(o,this.height);var h=this.width-(i+o);this.midBg.setWorldSize(h,this.height),this.add(this.leftBg),this.add(this.midBg),this.add(this.rightBg),Phaser.Display.Align.In.LeftCenter(this.leftBg,this,0,0),Phaser.Display.Align.In.Center(this.midBg,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightBg,this,0,0)},n.initProgressBar=function(){this.leftProgress=this.scene.make.image({key:_w,frame:Dw.PROGRESS_BAR_LEFT}),this.midProgress=this.scene.make.image({key:_w,frame:Dw.PROGRESS_BAR_MID}),this.rightProgress=this.scene.make.image({key:_w,frame:Dw.PROGRESS_BAR_RIGHT});var t=this.leftProgress,e=t.width,n=t.height,i=e*this.height/n;this.leftProgress.setWorldSize(i,this.height);var a=this.rightProgress,s=a.width,r=a.height,o=s*this.height/r;this.rightProgress.setWorldSize(o,this.height);var h=this.width-(i+o)+2;this.midProgress.setWorldSize(h,this.height),this.add(this.leftProgress),this.add(this.midProgress),this.add(this.rightProgress),this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1),Phaser.Display.Align.In.LeftCenter(this.leftProgress,this,0,0),Phaser.Display.Align.In.Center(this.midProgress,this,0,0),Phaser.Display.Align.In.RightCenter(this.rightProgress,this,0,0)},n.createIconCup=function(){this.iconCup=this.scene.make.image({key:_w,frame:Dw.ICON_CUP}),this.iconCup.setWorldSize(25,20),this.add(this.iconCup),Phaser.Display.Align.In.RightCenter(this.iconCup,this.glareCup,-9,1)},n.createGlareCup=function(){this.glareCup=this.scene.make.image({key:_w,frame:Dw.CUP_GLARE}),this.glareCup.setWorldSize(44,44),this.glareCup.setVisible(!1),this.add(this.glareCup),Phaser.Display.Align.In.RightCenter(this.glareCup,this.rightBg,42,-3)},n.createTweenGlare=function(){this.tweenRotationGlareCup=new ol({targets:[this.glareCup],repeat:-1,duration:6e3})},n.createParticle=function(){this.particle=this.scene.add.particles(_w),this.add(this.particle)},n.createEmitter=function(){this.emitter=this.particle.createEmitter({x:0,y:0,scale:{min:.3,max:1},speed:{min:10,max:30},lifespan:{min:500,max:1e3},quantity:1,on:!1,frame:Dw.DUST}),this.emitter.setPosition(this.scene.gameZone.width/2-10,-3)},n.createMilestoneFrame=function(){var t=this.scene.make.image({key:_w,frame:Dw.FLAG});return t.setWorldSize(16,22),t},n.getMilestoneFrame=function(){var t,e=c()(t=this.listPoolMilestoneFrame).call(t,(function(t){return!t.visible}));if(!e||0===e.length){var n=this.createMilestoneFrame();return this.listPoolMilestoneFrame.push(n),this.add(n),n}return e[0]},n.handleSetAlphaListMilestone=function(t){this.listMilestoneFrame.forEach((function(e){e.score<=t?e.frame.setAlpha(1):e.frame.setAlpha(.5)}))},n.handleSetAlphaCup=function(t){t>=this.targetScore?this.iconCup.setAlpha(1):this.iconCup.setAlpha(.5)},n.runEmitter=function(){this.emitter.start()},n.stopEmitter=function(){this.emitter.stop()},n.runAnimGlare=function(){this.glareCup.setVisible(!0),this.tweenRotationGlareCup.play()},n.stopAnimGlare=function(){this.tweenRotationGlareCup.stop(),this.glareCup.setVisible(!1)},n.hideProgressBar=function(){this.leftProgress.setVisible(!1),this.rightProgress.setVisible(!1),this.midProgress.setVisible(!1)},n.hideMilestone=function(){this.listPoolMilestoneFrame.forEach((function(t){t.setVisible(!1)}))},n.resetListMilestone=function(){this.listMilestoneFrame=[]},n.reset=function(){this.hideMilestone(),this.hideProgressBar(),this.setPercent(0),this.resetListMilestone()},n.setTargetScore=function(t){this.targetScore=t},n.getTargetScore=function(){return this.targetScore},n.setPercent=function(t){var e=t*this.width,n=this.leftProgress.displayWidth,i=this.midProgress.displayWidth,a=this.rightProgress.displayWidth;if(t>=1){if(this.progressBarFull)return;return this.progressBarFull=!0,this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.rightProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setCrop(0,0,a/this.rightProgress.scaleX,2*this.height),this.runAnimGlare(),void this.runEmitter()}return this.stopAnimGlare(),this.stopEmitter(),this.progressBarFull=!1,e<n?(this.leftProgress.setVisible(!0),void this.leftProgress.setCrop(0,0,e/this.leftProgress.scaleX,2*this.height)):e>n+i?(this.leftProgress.setVisible(!0),this.midProgress.setVisible(!0),this.midProgress.setCrop(0,0,i/this.midProgress.scaleX,2*this.height),this.rightProgress.setVisible(!0),void this.rightProgress.setCrop(0,0,(e-(n+i-2))/this.rightProgress.scaleX,2*this.height)):(this.leftProgress.setVisible(!0),this.leftProgress.setCrop(0,0,n/this.leftProgress.scaleX,2*this.height),this.midProgress.setVisible(!0),void this.midProgress.setCrop(0,0,(e-n)/this.midProgress.scaleX,2*this.height))},e}(Phaser.GameObjects.Container),Lw=or.default.GAMEPLAY,Fw=Lw.KEY,Nw=Lw.FRAME,Gw=function(t){function e(e){var n;return(n=t.call(this,e,Fw,Nw.BUTTON_WOOD_SMALL)||this).button.setWorldSize(55,48),n.setName("Setting"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:Fw,frame:Nw.ICON_SETTING});t.setWorldSize(30,30),this.add(t),Phaser.Display.Align.In.Center(t,this,1,-1.5)},e}(_r.default),Uw=Gw,Vw=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonSetting=void 0,n.bestScoreBlock=void 0,n.mainScoreBlock=void 0,n.progressBar=void 0,n.collectItems=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,0),e.add.existing((0,nr.default)(n)),n.createSettingButton(),n.createBestScoreBlock(),n.createMainScoreBlock(),n.createProgressBar(),n.createCollectItems(),n.createLeaf(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createLeaf=function(){var t=new Mw(this.scene);this.add(t),Phaser.Display.Align.In.Center(t,this,0,t.displayHeight/2)},n.createBestScoreBlock=function(){this.bestScoreBlock=new dw(this.scene),this.add(this.bestScoreBlock),Phaser.Display.Align.In.Center(this.bestScoreBlock,this,-132,-12.5)},n.createMainScoreBlock=function(){this.mainScoreBlock=new Rw(this.scene),this.add(this.mainScoreBlock),Phaser.Display.Align.In.Center(this.mainScoreBlock,this,0,52)},n.createSettingButton=function(){this.buttonSetting=new Uw(this.scene),this.add(this.buttonSetting),Phaser.Display.Align.In.Center(this.buttonSetting,this,132,51)},n.createProgressBar=function(){this.progressBar=new Bw(this.scene,315,13),this.add(this.progressBar),Phaser.Display.Align.In.Center(this.progressBar,this,-19,92),this.progressBar.setVisible(!1)},n.createCollectItems=function(){this.collectItems=new Ew(this.scene),this.add(this.collectItems),Phaser.Display.Align.In.Center(this.collectItems,this,0,52),this.collectItems.setVisible(!1)},n.getScore=function(){return this.mainScoreBlock.score},n.showItemSingleMode=function(){this.mainScoreBlock.setVisible(!0)},n.showItemPlayWithFriendsMode=function(){this.mainScoreBlock.setVisible(!1)},n.start=function(){switch(this.scene.targetMissionManager.getTargetType()){case $T:this.targetScore();break;case tw:this.targetCollect()}},n.targetScore=function(){var t=Hx()(this.scene.targetMissionManager.getTargetValue()),e=this.scene.storage.getState(),n=nu(e)||0;(0,Pv.isArray)(t)||(this.progressBar.reset(),this.progressBar.setVisible(!0),this.progressBar.setTargetScore(t),this.progressBar.setPercent(n/t),this.scene.header.mainScoreBlock.reset(),this.scene.header.mainScoreBlock.setVisible(!0),this.scene.header.mainScoreBlock.setScore(n),this.scene.header.mainScoreBlock.setScoreText(n),this.collectItems.setVisible(!1))},n.targetCollect=function(){this.collectItems.reset(),this.mainScoreBlock.setVisible(!1),this.progressBar.setVisible(!1);var t=this.scene.targetMissionManager.getTargetValue();this.collectItems.setTargets(t),this.collectItems.setVisible(!0),this.collectItems.start()},e}(Phaser.GameObjects.Container),Yw=Vw,zw=or.default.GAMEPLAY_32,Hw=zw.KEY,Ww=zw.FRAME,Xw=GameCore.Configs.Board,Kw=Xw.cols,jw=Xw.rows,qw=function(t){function e(n,i,a){var s;return(s=t.call(this,n)||this).scene=void 0,s.type=void 0,s.direction=void 0,s.isReverse=!1,s.data=[],s.matrixData=void 0,s.texture=void 0,s.frame=void 0,s.maxHeight=void 0,s.cellItems=[],s.originalData=void 0,s.isSetDrag=!1,s.isCreateCell=!1,s.wrap=void 0,s.wrapPiece=void 0,s.isDragEnd=!1,s.isActive=!0,s.isVisible=!0,s.pointerY=void 0,s.parentHeight=void 0,s.index=void 0,s.props=void 0,s.cells=[],s.parent=void 0,s.moveTopNumber=30,s.backupPx=void 0,s.backupPy=void 0,s.animMoveTopAndScaleUp=void 0,s.animMoveDownAndScaleDown=void 0,s.animScaleUp=void 0,s.animScaleDown=void 0,s.distancePY=void 0,s.isCanMove=void 0,s.correctAlpha=1,s.props=a,s.type=a.type,s.matrixData=a.matrixData,s.data=e.buildData(s.matrixData),s.direction=a.direction||null,s.parentHeight=a.parentHeight||0,s.isReverse=a.isReverse||!1,s.parent=i,s.scene=n,s.scene.add.existing((0,nr.default)(s)),s.createWrapPiece(),s.listenEvents(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.createWrapPiece=function(){var t=this.scene.gameZone.width/3;this.wrapPiece=this.scene.make.image({key:Hw,frame:Ww.GEM_TRANSPARENT}),this.wrapPiece.setWorldSize(t,t)},n.updatePosition=function(t,e){var n=this.getContainerSize(),i=n.width,a=n.height,s=this.parent.cellSize,r=this.scene.gameZone.width;this.setPosition(t+r/6-i/2+s/2,e-a/2+s/2),this.backupPx=this.x,this.backupPy=this.y},n.updatePositionWrapPiece=function(t,e){this.wrapPiece.setPosition(t+this.wrapPiece.displayWidth/2,e-20)},n.listenEvents=function(){var t=this;this.setInteractiveContainer(),this.wrapPiece.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.parent.playTweenToEnableMaxFps()})),this.wrapPiece.on(Phaser.Input.Events.DRAG_START,(function(e){t.handleDragStart(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG,(function(e){t.handleDrag(e)})),this.wrapPiece.on(Phaser.Input.Events.DRAG_END,(function(){t.handleDragEnd(),t.parent.stopTweenToEnableMaxFps()}))},n.setIndex=function(t){this.index=t},n.updateDataPiece=function(t){this.data=t},n.setInteractiveContainer=function(){var t=this.scene.gameZone.width/3;this.wrapPiece.setInteractive().input.hitArea.setTo(0,0,t/this.wrapPiece.scale,180/this.wrapPiece.scale),this.scene.input.setDraggable(this.wrapPiece)},n.handleDragStart=function(t){var e,n,i=this;if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove){if(this.scene.tutorialManager.isRunning()){if(!this.scene.tutorialManager.validStep(this.index))return;this.scene.tutorialManager.stopAnimHand()}null==(e=this.animScaleUp)||e.stop(),null==(n=this.animScaleDown)||n.stop(),this.setAlpha(this.correctAlpha).setScale(1).setPosition(this.x,this.y),this.isDragEnd=!1,this.isSetDrag=!0,this.setDepth(Dr.default.PIECE+1),this.animMoveDownAndScaleDown&&this.animMoveDownAndScaleDown.isPlaying()&&(this.animMoveDownAndScaleDown.stop(),this.setScale(1)),this.scene.audio.playSound(Or.default.PIECE_PICK);var a=this.scene.main.board.cellSize/this.parent.cellSize,s=this.getContainerSize(),r=s.width,o=s.height,h=t.worldX+this.parent.cellSize*a/2-r*a/2,c=0;if(Rp())c=t.worldY+this.parent.cellSize*a/2-o*a;else{var l=this.scene.gameZone.height/2+this.scene.main.board.width/2-2*this.parent.cellSize+this.moveTopNumber,u=this.y+o*a-l+o;u=this.scene.gameZone.width/this.scene.gameZone.height>=375/619?44+o*a:53+o*a,c=t.worldY-u}this.distancePY=t.worldY-c;var d=41*this.scene.main.board.cellPadding/100;this.updateCellsWithPadding(d),this.animMoveTopAndScaleUp=this.scene.tweens.add({x:h,y:c,scale:a,duration:150,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){if(!i.isDragEnd){i.setPosition(h,c);var t=i.getCellsHighlight();i.scene.main.board.handleRemoveHighlight(),i.scene.main.board.handleHighlight(t,i.highlightCellCanCapture.bind(i))}}}),this.drawSuggestCells()}},n.handleDrag=function(t){if(!this.scene.isGameOver&&!this.scene.isLevelComplete&&this.isCanMove&&this.isSetDrag)try{if(this.animMoveTopAndScaleUp&&this.animMoveTopAndScaleUp.isPlaying()){var e=this.scene.main.board.cellSize/this.parent.cellSize;this.animMoveTopAndScaleUp.complete(),this.animMoveTopAndScaleUp.stop(),this.setScale(e)}this.resetCellItems(),this.scene.game.updateFps(Ip.default.max);var n=this.getContainerSize().width,i=t.worldX+this.parent.cellSize*this.scale/2-n/2,a=t.worldY-this.distancePY;this.setPosition(i,a),this.canMove();var s=this.getCellsHighlight();this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.handleHighlight(s,this.highlightCellCanCapture.bind(this))}catch(r){this.handleDragPieceInvalidMove()}},n.highlightCellCanCapture=function(t,e,n,i){for(var a=this,s=Kw,r=jw,o=[],h=0;h<i.length;h++){var l=i[h],u=l.x,d=l.y;s>u&&(s=u),r>d&&(r=d)}for(var p=function(e){var n=t[e],s=c()(i).call(i,(function(t){return t.y===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var h=s[r];a.checkItemInArray(o,h)||o.push(h)}},f=0;f<t.length;f++)p(f);for(var g=function(t){var n=e[t],s=c()(i).call(i,(function(t){return t.x===n}));if(!s||0===s.length)return"continue";for(var r=0;r<s.length;r++){var h=s[r];a.checkItemInArray(o,h)||o.push(h)}},m=0;m<e.length;m++)g(m);for(var v=function(t){var e=n[t],s=c()(i).call(i,(function(t){return t.x===e.x&&t.y===e.y}));if(!s||0===s.length)return"continue";var r=s[0];a.checkItemInArray(o,r)||o.push(r)},y=0;y<n.length;y++)v(y);for(var S=function(t){var e,n=o[t],i=n.x,h=n.y,l=c()(e=a.cellItems).call(e,(function(t){return t.x===i-s&&t.y===h-r}));if(!l||0===l.length)return"continue";var u=a.getFrameLight(l[0].cell.frame.name);l[0].cell.setFrame(u)},A=0;A<o.length;A++)S(A)},n.getFrameLight=function(t){var e=t;switch(t){case Ww.GEM:e=Ww.GEM_LIGHT;break;case Ww.GEM_DIAMOND_10:e=Ww.GEM_DIAMOND_10_LIGHT;break;case Ww.GEM_DIAMOND_11:e=Ww.GEM_DIAMOND_11_LIGHT;break;case Ww.GEM_DIAMOND_12:e=Ww.GEM_DIAMOND_12_LIGHT;break;case Ww.GEM_DIAMOND_13:e=Ww.GEM_DIAMOND_13_LIGHT;break;case Ww.GEM_DIAMOND_14:e=Ww.GEM_DIAMOND_14_LIGHT;break;case Ww.GEM_DIAMOND_15:e=Ww.GEM_DIAMOND_15_LIGHT}return e},n.resetCellItems=function(){for(var t=0;t<this.cellItems.length;t++){var e=this.cellItems[t].cell.frame.name.replace("_light","");this.cellItems[t].cell.setFrame(e)}},n.checkItemInArray=function(t,e){var n=c()(t).call(t,(function(t){return t.x===e.x&&t.y===e.y}));return!(!n||0===n.length)},n.handleDragPieceInvalidMove=function(){this.scene.main.board.handleRemoveHighlight(),this.scene.main.board.removeAllCanCaptureCells()},n.handleDragEnd=function(){if(!this.isDragEnd&&this.isSetDrag&&this.isCanMove&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Dr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),!this.scene.isGameOver&&!this.scene.isLevelComplete)){this.resetCellItems();try{this.canMove(),this.scene.audio.playSound(Or.default.PIECE_DROP),this.handleBoardMoveCompleted(),this.scene.updateMatchData(),this.wrapPiece.disableInteractive()}catch(t){this.handleInvalidMove()}}},n.cancelDrag=function(){!this.isDragEnd&&this.isSetDrag&&(this.isDragEnd=!0,this.isSetDrag=!1,this.setDepth(Dr.default.PIECE),this.scene.main.board.handleRemoveSuggestMove(),this.scene.main.board.removeAllCanCaptureCells(),this.resetCellItems(),this.scene.main.board.handleRemoveHighlight(),this.handleInvalidMove())},n.calculatePY=function(t,e){return 15==t?this.parent.cellSize*e*-2:30==t?0:45==t?this.parent.cellSize*e*2:60==t?this.parent.cellSize*e*4:75==t?this.parent.cellSize*e*6:t},n.handleBoardMoveCompleted=function(){var t=this,e=this.getPositionTopLeftInBoard();if(e){if(this.scene.targetMissionManager.getTargetType()===$T){var n=this.calcScore();this.scene.handleUpdateScore(n||0),this.scene.handleAddScoreAnim(n||0)}var i=e.x,a=e.y,s=this.scene.main.board.dataBoard[a][i],r=s.x+this.scene.main.board.cellPadding,o=s.y+this.scene.main.board.cellPadding,h=this.getCellsHighlight();this.scene.add.tween({targets:this,x:r,y:o,duration:50,onComplete:function(){t.updateCellsWithPadding(.5),t.scene.main.board.handleRemoveHighlight(),t.hide(),t.setScale(1),t.parent.removeActivePiece(t.index),t.scene.main.board.handleMove(h,t.onBoardHandleMoveCompleted.bind(t))}})}else this.scene.main.board.handleRemoveHighlight()},n.calcScore=function(){var t;if(!this.matrixData)return 0;var e=this.matrixData.length||0;if(0===e)return 0;for(var n=(null==(t=this.matrixData[0])?void 0:t.length)||0,i=0,a=0;a<e;a++)for(var s=0;s<n;s++)1===this.matrixData[a][s]&&i++;return i},n.hide=function(){this.setVisible(!1),this.wrapPiece.setVisible(!1)},n.show=function(){this.setVisible(!0),this.wrapPiece.setVisible(!0)},n.playAnimShow=function(){this.setAlpha(0).setScale(0),this.show(),this.animScaleUp.play()},n.onBoardHandleMoveCompleted=function(){this.parent.setActivePieces(),this.parent.existPiecesActive()||this.parent.showNewPieces(),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.nextStep()},n.drawSuggestCells=function(){var t=function(t,e){for(var n=t.length,i=t[0].length,a=0,s=0,r=0,o=0;o<n;o++)for(var h=0;h<i;h++)if(PS(t,h,o,e)&&(s=h,r=o,++a>1))return null;if(0===a)return null;for(var c=[],l=0;l<e.data.length;l++)for(var u=0;u<e.data[l].length;u++)e.data[l][u].texture&&c.push({x:s+u,y:r+l});return c&&c.length>0?c:null}(this.scene.main.board.dataBoard,{data:this.data});t&&this.scene.main.board.handleSuggestMove(t)},n.getPositionFirstCellHighlight=function(){var t=this.scene.main.board.dataBoard,e=this.getPositionTopLeftInBoard();if(!e)return{x:0,y:0};var n=e.x,i=e.y;return e?{x:t[i][n].x,y:-(this.scene.scale.height-this.parentHeight-t[i][n].y)}:{x:0,y:0}},n.handleInvalidMove=function(){var t=this;this.scene.audio.playSound(Or.default.PIECE_INVALID_MOVE),this.scene.main.board.handleRemoveHighlight(),this.animMoveDownAndScaleDown=this.scene.tweens.add({x:this.backupPx,y:this.backupPy,scaleX:1,scaleY:1,duration:300,targets:this,ease:"Sine.easeInOut",delay:20,onComplete:function(){t.updateCellsWithPadding(.5)}}),this.scene.tutorialManager.isRunning()&&this.scene.tutorialManager.handleStep()},n.canMove=function(){var t=this.scene.main.board.dataBoard,e=this.getCellsHighlight();if(0===e.length)throw new Error("Invalid Move");for(var n=!0,i=0;i<e.length;i++){var a=e[i],s=a.x,r=a.y;if(!t[r]||!t[r][s]||0!==t[r][s].value){n=!1;break}}if(!n||0===e.length)throw new Error("Invalid Move");return n},n.getCellsHighlight=function(){var t=this.scene.main.board.dataBoard,e=[],n=this.getPositionTopLeftInBoard();if(null===n)return e;if(this.scene.tutorialManager.isRunning()&&!this.scene.tutorialManager.validTargetPosition(n))return e;for(var i=0;i<this.data.length;i++)for(var a=0;a<this.data[i].length;a++)if(this.data[i][a].texture){var s=a+n.x,r=i+n.y,o=t[r]&&t[r][s]?t[r][s].x:0,h=t[r]&&t[r][s]?t[r][s].y:0;if(r>=jw||s>=Kw||!t[r][s]||1===t[r][s].value)return[];e.push({x:s,y:r,pX:o,pY:h,frame:this.data[i][a].texture})}return e},n.getPositionTopLeftInBoard=function(){for(var t=this.scene.main.board.dataBoard,e=this.x+this.parent.cellSize*this.scale/2,n=this.y+this.parent.cellSize*this.scale/2,i=this.scene.main.board.cellPadding,a=-1,s=-1,r=0;r<jw;r++)for(var o=0;o<Kw;o++)if(t[r][o].x-i/2<=e&&t[r][o].x+t[r][o].width+i/2>=e&&t[r][o].y-i/2<=n&&t[r][o].y+t[r][o].height+i/2>=n){a=o,s=r;break}return a<0||a>Kw-1||s<0||s>jw-1?null:{x:a,y:s}},e.buildData=function(t){for(var e=[],n=0;n<t.length;n++){e[n]=[];for(var i=0;i<t[n].length;i++){var a=1===t[n][i]?Ww.GEM:null;e[n][i]={x:i,y:n,texture:a}}}return e},n.getPaddingCell=function(){return this.height/this.data.length/40},n.drawPiece=function(){return this.isCreateCell?this.updateCells():this.createCells(.5),this.createAnimShow(),this.playAnimShow(),this.wrapPiece.setInteractive(),this},n.createAnimShow=function(){var t=this,e=140*this.index;this.animScaleUp=this.scene.tweens.add({delay:e,paused:!0,duration:163,targets:this,alpha:{from:0,to:this.alpha},scale:{from:0,to:1.2},ease:Phaser.Math.Easing.Linear,onComplete:function(){t.animScaleDown.play()}}),this.animScaleDown=this.scene.tweens.add({delay:83,paused:!0,duration:150,targets:this,scale:1,ease:Phaser.Math.Easing.Linear})},n.createCells=function(t){for(var e=this.parent.cellSize,n=0;n<this.data.length;n++){this.cells[n]=[];for(var i=0;i<this.data[n].length;i++)if(this.data[n][i].texture&&"x"!==this.data[n][i].texture){var a={x:0+i*e+t,y:0+n*e+t,width:e-2*t,height:e-2*t},s=new _T(this.scene,a);s.setFrame(this.data[n][i].texture),s.setVisible(!0),this.cells[n][i]=s,this.cellItems.push({x:i,y:n,cell:s}),this.add(s)}}this.isCreateCell=!0},n.updateCells=function(){for(var t=0;t<this.data.length;t++)for(var e=0;e<this.data[t].length;e++)if(this.data[t][e].texture&&"x"!==this.data[t][e].texture){var n=this.cells[t][e];n.setFrame(this.data[t][e].texture),n.setVisible(!0),this.cells[t][e]=n}},n.updateCellsWithPadding=function(t){for(var e=this.parent.cellSize,n=e-2*t,i=e-2*t,a=0;a<this.data.length;a++)for(var s=0;s<this.data[a].length;s++)if(this.data[a][s].texture){var r=this.cells[a][s],o=s*e+t,h=a*e+t;r.setWorldSize(n,i),r.setPosition(o,h)}},n.getContainerSize=function(){for(var t=0,e=this.data.length,n=0;n<this.data.length;n++)this.data[n].length>t&&(t=this.data[n].length);var i=this.parent.cellSize;return{width:t*i*this.scale,height:e*i*this.scale}},n.setCanMove=function(t){this.isCanMove=t,this.correctAlpha=t?1:.4,this.setAlpha(this.correctAlpha)},n.reset=function(){this.setVisible(!1),this.setScale(1),this.wrapPiece.disableInteractive(),this.data=e.buildData(this.matrixData)},n.getScore=function(){if(!this.matrixData)return 0;for(var t=0,e=0;e<this.matrixData.length;e++)for(var n=0;n<this.matrixData[0].length;n++)1===this.matrixData[e][n]&&t++;return t},e}(Phaser.GameObjects.Container),Zw=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction,a.isReverse)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e,n){void 0===n&&(n=!1);var i=[];switch(e){case Ov:n?i=Ry:(i=ky,t===Qv&&(i=Oy),t===$v&&(i=_y));break;case _v:n?i=by:(i=xy,t===Qv&&(i=Ty),t===$v&&(i=wy));break;case Dv:if(n){i=Sy;break}i=yy,t===Qv&&(i=Ay),t===$v&&(i=Ey);break;case Bv:n?i=Cy:(i=My,t===Qv&&(i=Py),t===$v&&(i=Iy))}return i},e.getData=function(t,n,i){return void 0===i&&(i=!1),e.buildData(e.getMatrixData(t,n,i))},e}(qw),Jw=Zw,Qw=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t,e){var n=[];switch(t){case iy:n=e===kv?Uy:Vy;break;case ny:n=e===kv?Ny:Gy;break;case ty:n=e===kv?Dy:By;break;case ey:n=e===kv?Ly:Fy}return n},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(qw),$w=Qw,tM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){case ay:e=Yy;break;case sy:e=zy;break;case ry:e=Hy}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(qw),eM=tM,nM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=qy;break;case _v:e=Zy;break;case Dv:e=Jy;break;case Bv:e=Qy}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(qw),iM=nM,aM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=Wy;break;case Fv:e=Xy;break;case Gv:e=jy;break;case Nv:e=Ky}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(qw),sM=aM,rM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=$y;break;case _v:e=tS;break;case Dv:e=eS;break;case Bv:e=nS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(qw),oM=rM,hM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData()}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(){return iS},e.getData=function(){return e.buildData(e.getMatrixData())},e}(qw),cM=hM,lM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.type,a.direction)}))||this}return(0,Kt.default)(e,t),e.getDataByDirectionCross2=function(t){var e=[];if(t===_v)e=sS;else e=aS;return e},e.getDataByDirectionCross3=function(t){var e=[];if(t===_v)e=oS;else e=rS;return e},e.getDataByDirectionCross4=function(t){var e=[];if(t===_v)e=cS;else e=hS;return e},e.getDataByDirectionCross5=function(t){var e=[];if(t===_v)e=uS;else e=lS;return e},e.getMatrixData=function(t,n){var i=[];switch(t){case uy:i=e.getDataByDirectionCross2(n);break;case dy:i=e.getDataByDirectionCross3(n);break;case py:i=e.getDataByDirectionCross4(n);break;case fy:i=e.getDataByDirectionCross5(n)}return i},e.getData=function(t,n){return e.buildData(e.getMatrixData(t,n))},e}(qw),uM=lM,dM=function(t){function e(n,i,a){return t.call(this,n,i,(0,wt.default)({},a,{matrixData:e.getMatrixData(a.direction)}))||this}return(0,Kt.default)(e,t),e.getMatrixData=function(t){var e=[];switch(t){default:e=dS;break;case _v:e=pS;break;case Dv:e=fS;break;case Bv:e=gS}return e},e.getData=function(t){return e.buildData(e.getMatrixData(t))},e}(qw),pM=dM,fM=function(){function t(){}return t.create=function(t,e,n){var i;switch(n.type){case Jv:case Qv:case $v:i=new Jw(t,e,n);break;case ty:case ey:case ny:case iy:i=new $w(t,e,n);break;default:i=new eM(t,e,n);break;case hy:i=new iM(t,e,n);break;case cy:i=new oM(t,e,n);break;case gy:i=new pM(t,e,n);break;case ly:i=new cM(t,e,n);break;case uy:case dy:case py:case fy:i=new uM(t,e,n);break;case oy:i=new sM(t,e,n)}return i},t}(),gM=fM,mM=or.default.GAMEPLAY_32,vM=mM.KEY,yM=mM.FRAME,SM=zt.Configs,AM=SM.Gameplay,EM=SM.Match,xM=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.tweenToEnableMaxFps=void 0,n.cellSize=void 0,n.canCaptureLines=void 0,n.allPieces=[],n.allPiecesGroup=[],n.piecesActive=[],n.listPieceMap=[],n.amountPieceContainGem=0,n.hasPieceContainGem=void 0,n.segmentAmountPiece1Min=0,n.segmentAmountPiece1Max=0,n.segmentAmountPiece1Cur=0,n.segmentAmountPiece5Min=0,n.segmentAmountPiece5Max=0,n.segmentAmountPiece5Cur=0,n.segmentAvgScore=0,n.segmentTotalPieceScore=0,n.segmentTotalPiece=0,n.segmentTotalScore=0,n.segmentPieceDistancePerGem=0,n.segmentPieceRandomGem=!1,e.add.existing((0,nr.default)(n)),n.scene=e,n.canCaptureLines={isCapture:!1,direction:"",minLine:5},n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.initCellSize(),this.createAllPieces(),this.createAllPiecesGroup(),this.createTweenToEnableMaxFps(),this.addDebuggerBtnRandomPieces()},n.initCellSize=function(){this.cellSize=41*this.scene.main.board.cellSize/100},n.setContentPosition=function(t,e){this.setPosition(t,e)},n.createTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps=this.scene.add.tween({targets:[],duration:300,loop:-1,paused:!0})},n.playTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.play()},n.stopTweenToEnableMaxFps=function(){this.tweenToEnableMaxFps.stop()},n.getDirectionsByType=function(t){if([ay,sy,ry].some((function(e){return e===t})))return[];var e=[];switch(t){case Jv:case Qv:case $v:case hy:case cy:case gy:e=[Dv,Ov,_v,Bv];break;case ty:case ey:case ny:case iy:e=[kv,Rv];break;case oy:e=[Lv,Fv,Nv,Gv];break;case ly:e=[];break;case uy:case dy:case py:case fy:e=[Ov,_v]}return e},n.createAllPieces=function(){for(var t=this.cellSize,e=[],n=0;n<my.length;n++){var i=this.getDirectionsByType(my[n]);if(i.length<=0)e.push({type:my[n]});else{for(var a=0;a<i.length;a++)e.push({type:my[n],direction:i[a]});if(Jv===my[n])for(var s=0;s<i.length;s++)e.push({type:my[n],direction:i[s],isReverse:!0})}}for(var r=0;r<e.length;r++){var o=(0,wt.default)({},e[r],{texture:vM,frame:yM.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2),cellLength:Math.floor(t/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(t/2),height:Math.floor(t/2)}}),h=gM.create(this.scene,this,o);h.hide(),this.allPieces.push({piece:h,isUsed:!1})}},n.createAllPiecesGroup=function(){for(var t=0;t<this.allPieces.length;t++){var e=this.allPieces[t].piece;this.allPiecesGroup[e.type]||(this.allPiecesGroup[e.type]=[]),this.allPiecesGroup[e.type].push(t)}},n.randomPieces=function(){var t=this;this.scene.game.updateFps(Ip.default.max);for(var e=this.buildPieceRates(!1),n=[],i=function(){var i=Math.floor(Math.random()*e.length),a=e[i];if(!t.allPiecesGroup[a])return"continue";var s=Math.floor(Math.random()*t.allPiecesGroup[a].length),r=t.allPiecesGroup[a][s],o=[ny,iy].some((function(t){return t===a}));if(t.canCaptureLines.isCapture&&o){for(var h=0;h<t.allPiecesGroup[a].length;h++){var c=t.allPiecesGroup[a][h],l=t.allPieces[c].piece;if(l&&l.direction===t.canCaptureLines.direction){r=c;break}}e=t.buildPieceRates(!1)}n.some((function(t){return t.index===r}))||n.push({index:r,type:a})};n.length<3;)i();for(var a=[],s=0;s<n.length;s++){var r=n[s].index,o=this.allPieces[r].piece;a.push({position:r,texture:vM,frame:yM.GEM,type:o.type,direction:o.direction,isReverse:o.isReverse})}this.piecesActive=a},n.buildPieceRates=function(t){void 0===t&&(t=!0);for(var e=[],n=0;n<vy.length;n++)e.push((0,wt.default)({},vy[n]));if(t){var i=this.scene.main.board.dataBoard,a=5;if(this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var s=0;s<e.length;s++)e[s].type===iy&&(e[s].rate=8);else if(a=4,this.canCaptureLines=this.scene.main.board.canCaptureLines(i,a),this.canCaptureLines.isCapture)for(var r=0;r<e.length;r++)e[r].type===ny&&(e[r].rate=8)}for(var o=[],h=0;h<e.length;h++)for(var c=e[h],l=c.type,u=c.rate,d=0;d<u;d++)o.push(l);return o},n.drawPieces=function(){for(var t=this.scene.gameZone,e=t.width,n=t.height,i=[20,e/3,2*e/3-20],a=n/2+176-13,s=a+(n-85-a)/2,r=0;r<this.piecesActive.length;r++){var o=this.piecesActive[r],h=o.position,c=o.fenPiece,l=this.allPieces[h].piece,u=i[r];if(c){var d=this.convertFenPiecesToData(c);d&&l.updateDataPiece(d)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var p=this.getRandomPieceData(l.data);p&&l.updateDataPiece(p)}}l.updatePosition(u,s),l.updatePositionWrapPiece(u+20*(r-1),s),l.setIndex(r),l.drawPiece(),this.allPieces[h]={piece:l,isUsed:!0}}},n.isPieceContainGem=function(){if(1===Phaser.Math.Between(0,1)&&!this.hasPieceContainGem)return this.amountPieceContainGem++,this.hasPieceContainGem=!0,!0;if(this.amountPieceContainGem<AM.RatePieceContainGem)return this.amountPieceContainGem++,!1;if(this.amountPieceContainGem>=AM.RatePieceContainGem){var t=this.hasPieceContainGem;return this.amountPieceContainGem=0,this.hasPieceContainGem=!1,!t}return!1},n.convertFenPiecesToData=function(t){if(!t)return null;var e=t.split("/");if(0===e.length)return null;for(var n=[],i=0;i<e.length;i++){var a=e[i].split(",");n[i]=[];for(var s=0;s<a.length;s++){var r=_S(a[s]);"null"!==a[s]&&"x"!==a[s]||(r=null),n[i].push({x:i,y:s,texture:r})}}return n},n.getRandomPieceData=function(t){var e=this.scene.header.collectItems.getTargetKeys();if(!e||0===e.length)return null;for(var n=0,i=t.length,a=t[0].length,s=0;s<i;s++)for(var r=0;r<a;r++)if(t[s][r].texture&&Phaser.Math.Between(0,1)){var o=yM.GEM;if(n<AM.MaxGemInPiece)o=e[Phaser.Math.Between(0,e.length-1)];t[s][r]={x:s,y:r,texture:o},n++}return t},n.removeActivePiece=function(t){this.piecesActive[t].used=!0},n.existPiecesActive=function(){var t,e=c()(t=this.piecesActive).call(t,(function(t){return!t.used}));return e&&e.length>0},n.showNewPieces=function(){this.resetAllPieces(),this.listPieceMap.length>0?this.showListPieceMap():(this.randomPieces(),this.setActivePieces(),this.drawPieces())},n.setActivePieces=function(){for(var t=this.scene.main.board.dataBoard,e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e].position,i=this.allPieces[n].piece,a=IS(t,i);i.setCanMove(a)}},n.getPiecesByFen=function(t){var e=[],n=t.split(" ");if(n.length<2)throw new Error("Invalid fen");for(var i=ar()(n).call(n,2),a=0;a<i.length;a++){var s,r;if("l"!==Yp()(s=i[a]).call(s)){var o=BS(Yp()(r=i[a]).call(r));e.push(o)}}return e},n.getFenByPieces=function(){for(var t="l",e=0;e<this.piecesActive.length;e++){var n=this.piecesActive[e],i=n.type,a=n.direction,s=n.isReverse,r=n.used,o=n.position;if(!r){var h=OS(i);a&&""!==a&&(h+="-"+OS(a)),s&&(h+="-r");var c=this.allPieces[o].piece;t+=" "+h+"|"+this.getFenDataPiece(c)}}return t},n.getFenDataPiece=function(t){for(var e=t.data,n=e.length,i=e[0].length,a="",s=0;s<n;s++){for(var r="",o=0;o<i;o++)r+=","+OS(e[s][o].texture);a+="/"+r.substring(1)}return a.substring(1)},n.clearPieces=function(){for(var t=0;t<this.piecesActive.length;t++){var e=this.piecesActive[t].position;this.allPieces[e].isUsed=!1,this.allPieces[e].piece.hide()}this.piecesActive=[],this.listPieceMap=[]},n.resetAllPieces=function(){for(var t=0;t<this.allPieces.length;t++)this.allPieces[t].isUsed=!1,this.allPieces[t].piece.reset()},n.showAvailablePieces=function(t){if(t&&!(t.length<=0)){this.resetAllPieces();for(var e=[],n=0;n<t.length;n++){for(var i=t[n],a=i.type,s=i.direction,r=i.isReverse,o=i.frame,h=!1,c=0;c<this.allPieces.length;c++){var l=this.allPieces[c],u=l.piece,d=l.isUsed;if(a===u.type&&s===u.direction&&r===u.isReverse){if(d){h=!0;continue}h=!1,e.push({position:c,texture:vM,frame:o,type:u.type,direction:u.direction,isReverse:u.isReverse,fenPiece:t[n].fenPiece}),this.allPieces[c].isUsed=!0;break}}if(h){var p=this.spawnPiece(a,s,r),f=p.piece,g=p.index;e.push({position:g,texture:vM,frame:o,type:f.type,direction:f.direction,isReverse:f.isReverse,fenPiece:t[n].fenPiece})}}this.piecesActive=e,this.setActivePieces(),this.drawPieces()}},n.spawnPiece=function(t,e,n){var i=this.cellSize,a={type:t,direction:e,isReverse:n,texture:vM,frame:yM.GEM,x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2),cellLength:Math.floor(i/2),parentHeight:this.height,wrap:{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.floor(i/2),height:Math.floor(i/2)}},s=gM.create(this.scene,this,a);return s.hide(),this.allPieces.push({piece:s,isUsed:!0}),{piece:s,index:this.allPieces.length-1}},n.showListPieceMap=function(){var t;if(this.piecesActive=ar()(t=this.listPieceMap).call(t,0,3),this.showAvailablePieces(this.piecesActive),this.scene.footer.textExist){var e=this.listPieceMap.length<=0?"Done":"Exits";this.scene.footer.textExist.setText(e)}},n.validItemsPieceMap=function(t){for(var e,n=!0,i=et()(e=[]).call(e,t),a=function(){var t=i.shift(),e=c()(i).call(i,(function(e){return e.type===(null==t?void 0:t.type)&&e.direction===t.direction&&e.isReverse===t.isReverse}));e&&e.length>0&&(n=!1)};i.length>1;)a();return n},n.getPieceDataByType=function(t){return vS[t]},n.addItemPieceMap=function(t){if(t.properties){var e=this.getFenPieceForPropertiesPieceMap(t);e&&(t=(0,wt.default)({},t,{fenPiece:e}))}this.listPieceMap.push(t)},n.getFenPieceForPropertiesPieceMap=function(t){var e,n;if(!t.properties)return"";var i="",a=null==(e=c()(n=this.allPieces).call(n,(function(e){var n=e.piece;return n.direction===t.direction&&n.isReverse===t.isReverse&&n.type===t.type}))[0])?void 0:e.piece,s=t.properties[0].value.split(","),r=t.properties[1].value.split(","),o=0;if(!a)return i;for(var h=a.data,l=h.length,u=h[0].length,d=0;d<l;d++){for(var p="",f=0;f<u;f++){var m=h[d][f].texture,v=m,y=g()(r).call(r,String(o));m&&(-1!==y&&(v=mS[s[y]]),o++);var S=null;v&&(S=OS(v)),p+=","+S}i+="/"+p.substring(1)}return i.substring(1)},n.start=function(){0!==this.listPieceMap.length?this.showListPieceMap():this.showNewPieces()},n.getListPieceMap=function(){return this.listPieceMap},n.setListPieceMap=function(t){var e;this.listPieceMap=et()(e=[]).call(e,t)},n.buildPiecesByMap=function(){var t=this.scene.mapManager.getTileMap().layers[0].properties;if(t&&!(t.length<=0))for(var e=0;e<t.length;e++){var n=t[e].value;if(n){var i=n.avgScore,a=n.score,s=n.pieceDistancePerGem,r=n.piece1,o=n.piece5;r=r.replace("min",'"min"').replace("max",'"max"'),o=o.replace("min",'"min"').replace("max",'"max"');var h=JSON.parse(r),c=JSON.parse(o);this.segmentAvgScore=i,this.segmentAmountPiece1Min=h.min,this.segmentAmountPiece1Max=h.max,this.segmentAmountPiece5Min=c.min,this.segmentAmountPiece5Max=c.max,this.segmentTotalScore=a,this.segmentPieceDistancePerGem=s,this.segmentTotalPieceScore=0,this.segmentTotalPiece=0,this.listPieceMap=[],this.buildObjectPieces()}}},n.buildObjectPieces=function(){for(;this.checkAverageScore();)this.buildObjectPiece()},n.checkAverageScore=function(){return 0===this.segmentTotalPiece||0===this.segmentTotalPieceScore||!(this.segmentTotalPiece>EM.PieceRandoms.maxPiece)&&!(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore+EM.PieceRandoms.measureError&&this.segmentTotalPieceScore/this.segmentTotalPiece>=this.segmentAvgScore-EM.PieceRandoms.measureError&&this.segmentTotalPieceScore>=this.segmentTotalScore)},n.buildObjectPiece=function(){var t=this.getPieceByAvgScore();if(t)if(this.checkPieceMaxAmountConfig(t)){var e="";if(Math.floor((this.segmentTotalPiece-1)/3)%this.segmentPieceDistancePerGem===0){if(Phaser.Math.Between(0,1)&&!this.segmentPieceRandomGem||!this.segmentPieceRandomGem&&this.segmentTotalPiece%3===2){var n=this.getRandomPieceData(t.data);n&&(t.updateDataPiece(n),e=this.getFenDataPiece(t)),this.segmentPieceRandomGem=!0}}else this.segmentPieceRandomGem=!1;this.listPieceMap.push({type:t.type,direction:t.direction,isReverse:t.isReverse,fenPiece:e})}else this.buildObjectPiece()},n.checkPieceMaxAmountConfig=function(t){var e=t.getScore();switch(e){case 1:if(this.segmentAmountPiece1Max<=this.segmentAmountPiece1Cur)return!1;this.segmentAmountPiece1Cur++;break;case 5:if(this.segmentAmountPiece5Max<=this.segmentAmountPiece5Cur)return!1;this.segmentAmountPiece5Cur++}return this.segmentTotalPiece++,this.segmentTotalPieceScore+=e,!0},n.getPieceByAvgScore=function(){var t=this;if(this.segmentTotalPieceScore<this.segmentTotalScore){var e=this.buildPieceRates(!1),n=e[Math.floor(Math.random()*e.length)];if(!this.allPiecesGroup[n])return null;var i=Math.floor(Math.random()*this.allPiecesGroup[n].length),a=this.allPiecesGroup[n][i];return this.allPieces[a].piece}if(this.segmentTotalPieceScore/this.segmentTotalPiece<=this.segmentAvgScore){var s,r=c()(s=this.allPieces).call(s,(function(e){return e.piece.getScore()<=t.segmentAvgScore}));return r&&0!==r.length?r[Phaser.Math.Between(0,r.length-1)].piece:null}if(this.segmentTotalPieceScore/this.segmentTotalPiece>this.segmentAvgScore){var o,h=c()(o=this.allPieces).call(o,(function(e){return e.piece.getScore()>t.segmentAvgScore}));return h&&0!==h.length?h[Phaser.Math.Between(0,h.length-1)].piece:null}return null},n.debuggerNextPieces=function(){for(var t=0;t<this.piecesActive.length;t++)this.removeActivePiece(t);for(var e=0;e<this.allPieces.length;e++)this.allPieces[e].piece.wrapPiece.setVisible(!1);this.showNewPieces()},n.addDebuggerBtnRandomPieces=function(){var t=this;if(zt.Utils.Valid.isDebugger())for(var e=[80,187.5,295],n=this.scene.gameZone.height,i=function(i){var a=new _r.default(t.scene,vM,yM.GEM,50,30);t.add(a),a.onClick=function(){t.debuggerNewPieces(i)},a.setPosition(e[i],n)},a=0;a<3;a++)i(a)},n.debuggerNewPieces=function(t){this.removeActivePiece(t);var e=this.piecesActive[t],n=this.allPieces[e.position].piece;n.setVisible(!1);var i=Phaser.Math.Between(0,this.allPieces.length-1);this.piecesActive[t]={position:i,texture:vM,frame:yM.GEM,type:n.type,direction:n.direction,isReverse:n.isReverse};var a=this.scene.gameZone,s=a.width,r=a.height,o=[20,s/3,2*s/3-20],h=r/2+176-13,c=h+(r-85-h)/2,l=this.piecesActive[t],u=l.position,d=l.fenPiece,p=this.allPieces[u].piece,f=o[t];if(d){var g=this.convertFenPiecesToData(d);g&&p.updateDataPiece(g)}else{if(0===this.listPieceMap.length)if(this.isPieceContainGem()){var m=this.getRandomPieceData(p.data);m&&p.updateDataPiece(m)}}p.updatePosition(f,c),p.updatePositionWrapPiece(f+20*(t-1),c),p.setIndex(t),p.drawPiece()},e}(Phaser.GameObjects.Container),bM=or.default.GAMEPLAY,TM=bM.KEY,wM=bM.FRAME,MM=or.default.DEFAULT,CM=MM.KEY,PM=MM.FRAME,IM=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.pieces=void 0,n.debugButton=void 0,n.textExist=void 0,n.scene=e,n.setSize(n.scene.gameZone.width,85),e.add.existing((0,nr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.createPieces(),this.createDebugButton()},n.createBackground=function(){var t=this.scene.make.image({key:CM,frame:PM.FOOTER}),e=this.scene.gameZone.width;t.setWorldSize(e,this.height),this.add(t),Phaser.Display.Align.In.BottomCenter(t,this)},n.createPieces=function(){this.pieces=new xM(this.scene)},n.createDebugButton=function(){GameCore.Utils.Valid.isDebugger()&&this.createDebugButtonNextPieces()},n.createDebugButtonNextPieces=function(){this.debugButton=new _r.default(this.scene,TM,wM.BUTTON_WOOD_SMALL,100,30),this.debugButton.setName("Debug");var t=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Next pieces",origin:{x:.5,y:.5}});this.debugButton.add([t]),this.debugButton.onClick=this.clickButtonNextPieces.bind(this),this.add(this.debugButton),Phaser.Display.Align.In.BottomLeft(this.debugButton,this),this.textExist=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(30),text:"Exist",origin:{x:.5,y:.5}}),this.debugButton.add([this.textExist]),Phaser.Display.Align.In.Center(this.textExist,this,80,0)},n.clickButtonNextPieces=function(){this.scene.footer.pieces.debuggerNextPieces()},e}(Phaser.GameObjects.Container),kM=IM,RM=function(){function t(t){this.scene=void 0,this.currentLevel=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){var t=this.scene.storage.getState(),e=eu(t)||1;this.currentLevel=e},e.setLevel=function(t){this.currentLevel=t},e.getLevel=function(){return this.currentLevel},e.getLevelConfig=function(){return Gu[this.currentLevel]},e.getNextLevel=function(){return this.currentLevel+1},e.getNextLevelConfig=function(){return Gu[this.currentLevel+1]},e.increaseLevel=function(){this.currentLevel++},t}(),OM=function(){function t(t){this.scene=void 0,this.map=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.initMap()},e.initMap=function(){var t=this.scene.levelManager.getLevelConfig();this.map=this.scene.make.tilemap({key:t.key})},e.getTileMap=function(){return De()(this)},e.reloadMap=function(){var t,e=this.scene.levelManager.getLevelConfig();null==(t=De()(this))||t.destroy(),this.map=this.scene.make.tilemap({key:e.key})},t}(),_M=function(){function t(){this.targetType=void 0,this.targetValue=void 0,this.init()}var e=t.prototype;return e.init=function(){},e.setTargetType=function(t){this.targetType=t},e.setTargetValue=function(t){this.targetValue=t},e.getTargetType=function(){return this.targetType},e.getTargetValue=function(){return this.targetValue},t}(),DM=or.default.GAMEPLAY_32.KEY,BM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textWellDone=void 0,s.listTargetFrame=[],s.listAnim=[],s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.runPopupEntrancesAnimation(0,300)},s.close=function(){t.prototype.close.call((0,nr.default)(s))},s.scene=e,s.setDepth(kr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){},n.createContent=function(){this.createText()},n.createText=function(){this.textWellDone=new $S(this.scene,{text:"WELL DONE!",font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textWellDone),Phaser.Display.Align.In.Center(this.textWellDone,this)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=0;e<3;e++){var n=this.scene.make.image({key:DM});n.setWorldSize(30,30),n.setFrame(t[e]||t[0]),n.setVisible(!1).setAlpha(0),this.listTargetFrame.push(n)}this.add(this.listTargetFrame)}},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length)for(var e=0;e<3;e++){var n=this.listTargetFrame[e];n.setWorldSize(30,30),n.setFrame(t[e]||t[0]),n.setVisible(!1).setAlpha(0)}},n.createAnimTargetItems=function(){for(var t=[100,500,700],e=[-120,0,120],n=[-100,-150,-100],i=[.7,1,.7],a=0;a<3;a++){this.listTargetFrame[a].setAlpha(0).setVisible(!0);var s=this.scene.add.tween({targets:this.listTargetFrame[a],delay:t[a],x:{from:0,to:e[a]},y:{from:300,to:n[a]},alpha:{from:0,to:1},scale:{from:0,to:i[a]},rotation:{from:-180,to:0},duration:500});this.listAnim.push(s)}},n.playAnimTargetItems=function(){for(var t=0;t<3;t++){this.listTargetFrame[t].setAlpha(0).setVisible(!0),this.listAnim[t].play()}},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.listTargetFrame.forEach((function(t){t.setAlpha(0)})),this.textWellDone.restart(),this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.textWellDone.start(),0===n.listTargetFrame.length?(n.createTargetItems(),n.createAnimTargetItems()):(n.updateTargetItems(),n.playAnimTargetItems()),n.handleDelegate(),n.runAnim()}})),this.background.setAlpha(0),this.tweenBackground.play()},e}(GameCore.Screen),LM=or.default.DEFAULT,FM=LM.KEY,NM=LM.FRAME,GM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textLevel=void 0,s.textLevelComplete=void 0,s.backgroundContent=void 0,s.listTargets=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var t=this.scene.levelManager.getLevel();this.textLevel.setText("Level "+t)},n.createPopup=function(){this.popup=new no(this.scene,0,0,310,300),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:FM,frame:NM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(280,200),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-55)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:FM,frame:NM.TEXT_CONGRATULATION});t.setWorldSize(236,20),this.buttonClose=new _r.default(this.scene,FM,NM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,150,-15),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"Level 1",origin:{x:.5,y:.5}}),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-60)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(60),text:"COMPLETED",origin:{x:.5,y:.5}}),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,-20)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.scene.make.image({key:or.default.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){this.popup.remove(this.listTargets);for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:or.default.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(t){for(var e=[],n=310/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var t=this.scene.make.image({key:FM,frame:NM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new _r.default(this.scene,FM,NM.BUTTON_MINOR,70,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-88,55)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))},n.createButtonContinue=function(){var t=this.scene.make.image({key:FM,frame:NM.TEXT_NEXT_LEVEL});t.setWorldSize(113,15),this.buttonContinue=new _r.default(this.scene,FM,NM.BUTTON_GREEN,172,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,37,55)},n.clickButtonContinue=function(){var t=this,e=this.scene.storage.getState();if(gv(e)<1)return this.setVisible(!1),void this.scene.screen.open(Ir);this.scene.storage.dispatch(wv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.startGame()}))},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),UM=or.default.DEFAULT,VM=UM.KEY,YM=UM.FRAME,zM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonContinue=void 0,s.contents=void 0,s.textLevel=void 0,s.textLevelComplete=void 0,s.backgroundContent=void 0,s.livesTimer=void 0,s.listTargets=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonClose=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.createLivesTimer(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.updateInfo(),this.runOpenAnimation()},n.updateInfo=function(){var t=this.scene.levelManager.getLevel();t<Gu.length-1&&(t-=1),this.textLevel.setText("Level "+t)},n.createPopup=function(){this.popup=new no(this.scene,0,0,290,234),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:VM,frame:YM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(260,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-66)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:VM,frame:YM.TEXT_CONGRATULATION});t.setWorldSize(236,20),this.buttonClose=new _r.default(this.scene,VM,YM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,30),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextLevel(),this.createTextLevelComplete()},n.createTextLevel=function(){this.textLevel=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(40),text:"Level 1",origin:{x:.5,y:.5}}),this.popup.add(this.textLevel),Phaser.Display.Align.In.Center(this.textLevel,this.popup,0,-23)},n.createTextLevelComplete=function(){this.textLevelComplete=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(44),text:"Completed",origin:{x:.5,y:.5}}),this.popup.add(this.textLevelComplete),Phaser.Display.Align.In.Center(this.textLevelComplete,this.popup,0,3)},n.createTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.scene.make.image({key:or.default.GAMEPLAY.KEY});i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n]),this.listTargets.push(i)}this.popup.add(this.listTargets)}},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))},n.updateTargetItems=function(){var t=this.scene.header.collectItems.getTargetKeys();if(t&&0!==t.length){this.popup.remove(this.listTargets);for(var e=this.calcPosition(t.length),n=0;n<t.length;n++){var i=this.listTargets[n];i||(i=this.scene.make.image({key:or.default.GAMEPLAY.KEY}),this.listTargets.push(i)),i.setWorldSize(50,50),i.setFrame(t[n]||t[0]),i.setX(e[n])}this.popup.add(this.listTargets)}},n.calcPosition=function(t){for(var e=[],n=310/(t+1),i=n*(t-1)/2,a=0;a<t;a++)e.push(n*a-i);return e},n.createButtons=function(){this.createButtonBack(),this.createButtonContinue()},n.createButtonBack=function(){var t=this.scene.make.image({key:VM,frame:YM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new _r.default(this.scene,VM,YM.BUTTON_MINOR,62,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-90,52)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))},n.createButtonContinue=function(){var t=this.scene.make.image({key:VM,frame:YM.TEXT_NEXT_LEVEL});t.setWorldSize(113,15),this.buttonContinue=new _r.default(this.scene,VM,YM.BUTTON_GREEN,178,54),this.buttonContinue.setName("Continue"),this.buttonContinue.add(t),this.popup.add(this.buttonContinue),this.buttonContinue.onClick=this.clickButtonContinue.bind(this),Phaser.Display.Align.In.Center(this.buttonContinue,this.popup,33,52)},n.clickButtonContinue=function(){var t=this,e=this.scene.storage.getState();if(gv(e)<1)return this.runCloseAnimation(),void this.scene.screen.open(Ir,{onClose:function(){t.scene.screen.open(Er)}});eu(e)>=Gu.length-1?this.scene.game.globalScene.screen.open(cr,{message:"You reached limit level...",duration:3e3}):(this.scene.storage.dispatch(wv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.analytics.levelStart(t.scene.levelManager.getLevel(),void 0,t.scene.getLevelName());var e=t.scene.main.board.fadeOut();e?e.on("complete",(function(){t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.startGame()})):(t.scene.header.progressBar.reset(),t.scene.clearFen(),t.scene.startGame())})))},n.createLivesTimer=function(){this.livesTimer=new eb(this.scene),this.livesTimer.startIntervalTimer(),this.livesTimer.setFrameLivesTimeBlock2(),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),HM=or.default.GAMEPLAY,WM=(HM.KEY,HM.FRAME,function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.textNoSpaceLeft=void 0,s.closeTimerEvent=void 0,s.tweenBackground=void 0,s.open=function(e){t.prototype.open.call((0,nr.default)(s),e),s.runPopupEntrancesAnimation(300,300),s.handleDelegate()},s.close=function(){t.prototype.close.call((0,nr.default)(s))},s.scene=e,s.setDepth(kr),s.background.setAlpha(0),s.createContent(),s}(0,Kt.default)(e,t);var n=e.prototype;return n.handleDelegate=function(){var t,e=this,n=this.getData(["duration","onClose"]),i=n[0],a=void 0===i?0:i,s=n[1];null==(t=this.closeTimerEvent)||t.remove(),a>0&&(this.closeTimerEvent=this.scene.time.addEvent({delay:a,callback:function(){e.textNoSpaceLeft.setVisible(!1),e.textNoSpaceLeft.restart(),e.visible&&e.scene.screen.close(e.name),s&&s()}}))},n.runAnim=function(){this.textNoSpaceLeft.setVisible(!0),this.textNoSpaceLeft.start(300)},n.createContent=function(){this.createText()},n.createText=function(){this.textNoSpaceLeft=new $S(this.scene,{text:"NO SPACE LEFT!",font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(80)}),this.add(this.textNoSpaceLeft),Phaser.Display.Align.In.Center(this.textNoSpaceLeft,this)},n.runPopupEntrancesAnimation=function(t,e){var n=this;this.tweenBackground||(this.tweenBackground=this.scene.tweens.addCounter({paused:!0,from:0,to:.6,delay:t,duration:e,onUpdate:function(t){var e=t.getValue();n.background.setAlpha(e)},onComplete:function(){n.runAnim()}})),this.tweenBackground.play()},e}(GameCore.Screen)),XM=or.default.DEFAULT,KM=XM.KEY,jM=XM.FRAME,qM=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonBack=void 0,s.buttonRetry=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textLevelFail=void 0,s.buttonClose=void 0,s.livesTimer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.scene=e,s.createPopup(),s.createContentBackground(),s.createTitle(),s.createTexts(),s.createButtons(),s.createLivesTimer(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){t.prototype.open.call(this),this.scene.enableInput(),this.runOpenAnimation()},n.createPopup=function(){this.popup=new no(this.scene,0,0,290,234),this.add(this.popup),this.popup.setFrameTop(jM.POPUP_TOP_DARK),Phaser.Display.Align.In.Center(this.popup,this.zone,0,-20)},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:KM,frame:jM.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(260,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-66)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:KM,frame:jM.TEXT_LOSE});t.setWorldSize(121,20),this.buttonClose=new _r.default(this.scene,KM,jM.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.buttonClose.onClick=this.clickButtonClose.bind(this),this.title.add([t,this.buttonClose]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,30),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,5),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.createTexts=function(){this.createTextLevelFail()},n.createTextLevelFail=function(){this.textLevelFail=this.scene.make.image({key:KM,frame:jM.TEXT_LEVEL_FAIL}),this.textLevelFail.setWorldSize(112,16),this.popup.add(this.textLevelFail),Phaser.Display.Align.In.Center(this.textLevelFail,this.popup,0,-10)},n.createButtons=function(){this.createButtonBack(),this.createButtonRetry()},n.createButtonBack=function(){var t=this.scene.make.image({key:KM,frame:jM.ICON_BACK});t.setWorldSize(30,30),this.buttonBack=new _r.default(this.scene,KM,jM.BUTTON_MINOR,62,54),this.buttonBack.setName("Back"),this.buttonBack.add(t),this.popup.add(this.buttonBack),this.buttonBack.onClick=this.clickButtonBack.bind(this),Phaser.Display.Align.In.Center(this.buttonBack,this.popup,-90,52)},n.clickButtonBack=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))},n.createButtonRetry=function(){var t=this.scene.make.image({key:KM,frame:jM.TEXT_RETRY});t.setWorldSize(81,20);var e=this.scene.make.image({key:KM,frame:jM.ICON_RETRY});e.setWorldSize(33,35),this.buttonRetry=new _r.default(this.scene,KM,jM.BUTTON_GREEN,178,54),this.buttonRetry.setName("Retry"),this.buttonRetry.add(t),this.buttonRetry.add(e),Phaser.Display.Align.In.Center(t,this.buttonRetry,25,-3),Phaser.Display.Align.In.Center(e,this.buttonRetry,-42,-3),this.popup.add(this.buttonRetry),this.buttonRetry.onClick=this.clickButtonRetry.bind(this),Phaser.Display.Align.In.Center(this.buttonRetry,this.popup,33,52)},n.clickButtonClose=function(){var t=this;this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.clearFen(),t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))},n.clickButtonRetry=function(){var t=this,e=this.scene.storage.getState();gv(e)<1?this.scene.screen.open(Ir,{currentScreen:this}):(this.scene.storage.dispatch(wv()),this.runCloseAnimation(),this.scene.time.delayedCall(300,(function(){t.scene.handleRetryLevel()})))},n.createLivesTimer=function(){this.livesTimer=new eb(this.scene),this.livesTimer.startIntervalTimer(),this.livesTimer.setFrameLivesTimeBlock2(),this.add(this.livesTimer),Phaser.Display.Align.In.TopCenter(this.livesTimer,this,0,-62)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.livesTimer.startIntervalTimer(),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.livesTimer.stopIntervalTimer(),this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),ZM=or.default.DEFAULT,JM=ZM.KEY,QM=ZM.FRAME,$M=function(t){function e(e){var n;return(n=t.call(this,e,JM,QM.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:JM,frame:QM.ICON_HOME});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),tC=$M,eC=or.default.DEFAULT,nC=eC.KEY,iC=eC.FRAME,aC=function(t){function e(e){var n;return(n=t.call(this,e,nC,iC.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Journey"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:nC,frame:iC.ICON_BROWN_JOURNEY});t.setWorldSize(30,28),this.add(t),Phaser.Display.Align.In.Center(t,this,-.25,-1.5)},e}(_r.default),sC=aC,rC=or.default.DEFAULT,oC=rC.KEY,hC=rC.FRAME,cC=function(t){function e(e){var n;return(n=t.call(this,e,oC,hC.BUTTON_DARK_BLUE)||this).button.setWorldSize(246,53),n.setName("PlayWithFriends"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:oC,frame:hC.ICON_SWORD_BLUE});t.setWorldSize(31,25),this.add(t),Phaser.Display.Align.In.Center(t,this,-60)},n.createText=function(){var t=this.scene.make.image({key:oC,frame:hC.TEXT_PLAY_WITH_BLUE});t.setWorldSize(102,16),this.add(t),Phaser.Display.Align.In.Center(t,this,20)},e}(_r.default),lC=cC,uC=or.default.DEFAULT,dC=uC.KEY,pC=uC.FRAME,fC=function(t){function e(e){var n;return(n=t.call(this,e,dC,pC.BUTTON_BROWN)||this).button.setWorldSize(246,53),n.setName("Replay"),n.createIcon(),n.createText(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.createIcon=function(){var t=this.scene.make.image({key:dC,frame:pC.ICON_REPLAY});t.setWorldSize(26,31),this.add(t),Phaser.Display.Align.In.Center(t,this,-45,-2)},n.createText=function(){var t=this.scene.make.image({key:dC,frame:pC.TEXT_REPLAY});t.setWorldSize(79,16),this.add(t),Phaser.Display.Align.In.Center(t,this,20,-1)},e}(_r.default),gC=fC,mC=or.default.DEFAULT,vC=mC.KEY,yC=mC.FRAME,SC=function(t){function e(e){var n;return(n=t.call(this,e,vC,yC.BUTTON_MINOR)||this).button.setWorldSize(64,55),n.setName("Share"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:vC,frame:yC.ICON_SHARE});t.setWorldSize(24,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),AC=SC,EC=or.default.DEFAULT,xC=EC.KEY,bC=EC.FRAME,TC=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.buttonClose=void 0,s.contents=void 0,s.backgroundContent=void 0,s.settingMusic=void 0,s.settingSound=void 0,s.settingVibrate=void 0,s.settingSoundContainer=void 0,s.settingMusicContainer=void 0,s.settingVibrateContainer=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.buttonReplay=void 0,s.buttonPlayWithFriend=void 0,s.buttonHome=void 0,s.buttonJourney=void 0,s.buttonShare=void 0,s.debuggerCurrentLevelText=void 0,s.debuggerCurrentLevel=0,s.handleClose=function(){s.runCloseAnimation()},s.handleMusicSetting=function(t){s.scene.player.setSetting("music",t),t?s.scene.audio.playMusic():s.scene.audio.pauseMusic()},s.handleSoundSetting=function(t){s.scene.player.setSetting("sound",t)},s.handleVibrateSetting=function(t){t&&jg(199),s.scene.player.setSetting("vibrate",t)},s.clickReplay=function(){var t=s.scene.storage.getState();if(gv(t)<1)return s.setVisible(!1),void s.scene.screen.open(Ir);s.scene.storage.dispatch(wv()),s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.screen.close(s.name),s.scene.handleRetryLevel();case 2:case"end":return t.stop()}}),t)}))))},s.clickButtonPlayWithFriends=function(){s.scene.storage.dispatch(Ld()),s.scene.screen.close(s.name)},s.clickButtonHome=function(){s.runCloseAnimation(),s.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.scene.scene.switch(qs.SceneKeys.DASHBOARD_SCENE);case 1:case"end":return t.stop()}}),t)}))))},s.clickButtonLeaderboard=function(){s.scene.screen.open(mr)},s.clickButtonShare=function(){s.scene.storage.dispatch(Au())},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.createSwitchButtons(),s.createButtons(),s.addItem(),s.arrangeItems(),s.createInput(),s.createDebuggerInputLevel(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(){var e;t.prototype.open.call(this);var n=this.scene.player.getPlayerSettings(),i=n.sound,a=n.vibrate;this.settingSound.updateStatus(i),null==(e=this.settingVibrate)||e.updateStatus(a),this.runOpenAnimation()},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:xC,frame:bC.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,147),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-48)},n.createInput=function(){this.buttonClose.onClick=this.handleClose,this.settingSound.onClick=this.handleSoundSetting,this.settingVibrate&&(this.settingVibrate.onClick=this.handleVibrateSetting)},n.createPopup=function(){this.popup=new no(this.scene,0,0,290,390),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:xC,frame:bC.TEXT_SETTING});t.setWorldSize(141,23),this.buttonClose=new _r.default(this.scene,xC,bC.BUTTON_CLOSE,35,35),this.buttonClose.setName("Close"),this.title.add([t,this.buttonClose]),Phaser.Display.Align.In.Center(t,this.title,0,11),Phaser.Display.Align.In.Center(this.buttonClose,this.title,135,-14)},n.createButtons=function(){this.createReplayButton(),this.createHomeButton(),this.createJourneyButton(),this.createShareButton()},n.createReplayButton=function(){this.buttonReplay=new gC(this.scene),this.popup.add(this.buttonReplay),this.buttonReplay.onClick=this.clickReplay,Phaser.Display.Align.In.Center(this.buttonReplay,this.popup,0,43)},n.createPlayWithFriendButton=function(){this.buttonPlayWithFriend=new lC(this.scene),this.popup.add(this.buttonPlayWithFriend),this.buttonPlayWithFriend.onClick=this.clickButtonPlayWithFriends,Phaser.Display.Align.In.Center(this.buttonPlayWithFriend,this.buttonReplay,0,65)},n.createHomeButton=function(){this.buttonHome=new tC(this.scene),this.popup.add(this.buttonHome),this.buttonHome.onClick=this.clickButtonHome,Phaser.Display.Align.In.Center(this.buttonHome,this.buttonReplay,-90,72)},n.createJourneyButton=function(){this.buttonJourney=new sC(this.scene),this.popup.add(this.buttonJourney),this.buttonJourney.onClick=this.clickButtonJourney.bind(this),Phaser.Display.Align.In.Center(this.buttonJourney,this.buttonReplay,0,72)},n.clickButtonJourney=function(){var t=this;this.runCloseAnimation(),this.popupFadeOutAnimation.next((0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.scene.scene.switch(qs.SceneKeys.LEVEL_SCENE);case 1:case"end":return e.stop()}}),e)}))))},n.createShareButton=function(){this.buttonShare=new AC(this.scene),this.popup.add(this.buttonShare),this.buttonShare.onClick=this.clickButtonShare,Phaser.Display.Align.In.Center(this.buttonShare,this.buttonReplay,90,72)},n.createSwitchButtons=function(){var t=this.scene.player.getPlayerSettings(),e=(t.music,t.sound),n=t.vibrate;this.createSoundButton(e),Wg()?(this.createVibrateButton(n),Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,-33),Phaser.Display.Align.In.Center(this.settingVibrateContainer,this.backgroundContent,0,28)):Phaser.Display.Align.In.Center(this.settingSoundContainer,this.backgroundContent,0,0)},n.createMusicButton=function(t){this.settingMusicContainer=this.scene.make.container({});var e=this.scene.make.image({key:xC,frame:bC.ICON_MUSIC});e.setWorldSize(37,40),this.settingMusic=new xA(this.scene,{enable:t,width:89,height:31}),this.settingMusic.setName("Music"),Phaser.Display.Align.In.Center(e,this.settingMusicContainer,-60),Phaser.Display.Align.In.Center(this.settingMusic,this.settingMusicContainer,40),this.settingMusicContainer.add([e,this.settingMusic]),this.popup.add(this.settingMusicContainer),Phaser.Display.Align.In.Center(this.settingMusicContainer,this.backgroundContent,0,60)},n.createVibrateButton=function(t){this.settingVibrateContainer=this.scene.make.container({});var e=this.scene.make.image({key:xC,frame:bC.ICON_VIBRATE});e.setWorldSize(41,48),this.settingVibrate=new xA(this.scene,{enable:t,width:89,height:31}),this.settingVibrate.setName("Vibrate"),this.settingVibrateContainer.add([e,this.settingVibrate]),Phaser.Display.Align.In.Center(e,this.settingVibrateContainer,-60),Phaser.Display.Align.In.Center(this.settingVibrate,this.settingVibrateContainer,35),this.popup.add(this.settingVibrateContainer)},n.createSoundButton=function(t){this.settingSoundContainer=this.scene.make.container({});var e=this.scene.make.image({key:xC,frame:bC.ICON_SOUND});e.setWorldSize(41,36),this.settingSound=new xA(this.scene,{enable:t,width:89,height:31}),this.settingSound.setName("Sound"),this.settingSoundContainer.add([e,this.settingSound]),Phaser.Display.Align.In.Center(e,this.settingSoundContainer,-58),Phaser.Display.Align.In.Center(this.settingSound,this.settingSoundContainer,35),this.popup.add(this.settingSoundContainer)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.arrangeItems=function(){Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name)}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},n.createDebuggerInputLevel=function(){var t=this;if(GameCore.Utils.Valid.isDebugger()){for(var e=this.scene.make.container({}),n=function(n){var i=t.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:t.scene.fontSize(34),origin:{x:.5,y:.5},text:""+n});e.add(i),i.setInteractive(),i.on("pointerdown",(function(){t.debuggerHandleClick(n)})),Phaser.Display.Align.In.Center(i,e,20*n)},i=0;i<10;i++)n(i);this.add(e),Phaser.Display.Align.In.Center(e,this.popup,-100,190),this.debuggerCurrentLevelText=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Level 0"}),this.add(this.debuggerCurrentLevelText),Phaser.Display.Align.In.Center(this.debuggerCurrentLevelText,this.popup,0,210);var a=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Go"});this.add(a),a.setInteractive(),a.on("pointerdown",(function(){t.close(),t.scene.time.delayedCall(300,(function(){t.scene.levelManager.setLevel(t.debuggerCurrentLevel),t.scene.startGame()}))})),Phaser.Display.Align.In.Center(a,this.popup,0,230);var s=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(34),origin:{x:.5,y:.5},text:"Clear"});s.setInteractive(),s.on("pointerdown",(function(){t.debuggerCurrentLevel=0,t.debuggerCurrentLevelText.setText("Level "+String(t.debuggerCurrentLevel))})),this.add(s),Phaser.Display.Align.In.Center(s,this.popup,50,230)}},n.debuggerHandleClick=function(t){var e=this.debuggerCurrentLevel+""+t;this.debuggerCurrentLevel=Hx()(e),this.debuggerCurrentLevelText.setText("Level "+String(this.debuggerCurrentLevel))},e}(GameCore.Screen),wC=TC,MC=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).name="InvalidTileMap",i.message=e||"This tile is not valid",i.payload=n,i}return(0,Kt.default)(e,t),e}((0,re.default)(Error)),CC=or.default.DEFAULT,PC=(CC.KEY,CC.FRAME,or.default.GAMEPLAY_32.KEY),IC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.imageGem=void 0,n.text=void 0,n.scene=e,n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createImageGem(),this.createText()},n.createImageGem=function(){this.imageGem=this.scene.make.image({key:PC}),this.imageGem.setWorldSize(35,35),this.add(this.imageGem),Phaser.Display.Align.In.Center(this.imageGem,this,0,-10.5)},n.createText=function(){this.text=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(42),origin:{x:.5,y:.5},text:"0"}),this.add(this.text),Phaser.Display.Align.In.Center(this.text,this,0,29)},n.updateGem=function(t){this.imageGem.setFrame(t)},n.updateText=function(t){this.text.setText("x"+t)},n.getFrame=function(){return this.imageGem.frame.name},e}(Phaser.GameObjects.Container),kC=or.default.DEFAULT,RC=kC.KEY,OC=kC.FRAME,_C=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.backgroundContent=void 0,s.listItems=[],s.targetImages=[],s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.listAnimCollectionItem=[],s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.addItem(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.getData(["duration"])[0];this.hideAllCollectionItems(),this.createCollectionItems(),this.alginCollectionItems(),this.runOpenAnimation(),this.scene.time.delayedCall(i,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:RC,frame:OC.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createCollectionItems=function(){for(var t=this.getData(["jsonTarget"])[0],e=Y()(t),n=0;n<e.length;n++){var i=e[n],a=this.getCollectionItemFree(n);a.updateGem(i),a.updateText(t[i])}},n.getCollectionItemFree=function(t){var e=this.listItems[t];return e||(e=new IC(this.scene),this.popup.add(e),this.listItems.push(e)),e.setVisible(!0),e},n.alginCollectionItems=function(){var t;this.targetImages=[];for(var e=c()(t=this.listItems).call(t,(function(t){return t.visible})),n=e.length,i=263/(n+1)+5,a=-i*(n-1)/2,s=0;s<n;s++){var r=e[s];Phaser.Display.Align.In.Center(r,this.backgroundContent,a+i*s);var o=r.getFrame(),h=this.scene.make.image({key:or.default.GAMEPLAY_32.KEY,frame:o});h.setWorldSize(22,22),h.setVisible(!1),this.targetImages.push(h),Phaser.Display.Align.In.Center(h,this.backgroundContent,a+i*s+this.scene.gameZone.width/2,this.scene.gameZone.height/2)}},n.hideAllCollectionItems=function(){for(var t=0;t<this.listItems.length;t++){this.listItems[t].setVisible(!1)}},n.moveGemsToCollectItems=function(){var t=this;this.resetPositionTargetImages();for(var e=this.scene.header.collectItems,n=e.getTargetKeys(),i=this.scene.gameZone.width/2,a=function(a){var s=n[a],r=e.getPositionCollectionItem(s),o=i+r.x,h=r.y-23;t.targetImages[a].setAlpha(1),t.targetImages[a].setVisible(!0);var c=t.getFreeAnim(),l=Phaser.Math.Between(500,1e3);c.setTarget(t.targetImages[a]),c.runGemMoveToPosition(0,l,o,h).on(Phaser.Tweens.Events.TWEEN_COMPLETE,(function(){t.scene.header.collectItems.showCollectItemByKey(s),t.targetImages[a].setVisible(!1),a==t.targetImages.length-1&&t.scene.main.board.handleTweenStartMission()}))},s=0;s<n.length;s++)a(s)},n.resetPositionTargetImages=function(){for(var t,e=c()(t=this.listItems).call(t,(function(t){return t.visible})),n=263/(e.length+1)+5,i=-n*(e.length-1)/2,a=0;a<e.length;a++){var s;this.targetImages[a]&&(null==(s=this.targetImages[a])||s.setVisible(!1),Phaser.Display.Align.In.Center(this.targetImages[a],this.backgroundContent,i+n*a+this.scene.gameZone.width/2,this.scene.gameZone.height/2))}},n.getFreeAnim=function(){var t=new LT(this.scene);return this.listAnimCollectionItem.push(t),t},n.createPopup=function(){this.popup=new no(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container();var t=this.scene.make.image({key:RC,frame:OC.TEXT_MISSION});t.setWorldSize(105,21),this.title.add([t]),this.popup.add(this.title),Phaser.Display.Align.In.Center(t,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e,n=this;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.scene.time.delayedCall(50,(function(){n.moveGemsToCollectItems()})),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup,i=(n.y,n.scale);this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:i}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),DC=_C,BC=Lr.STATUS,LC=or.default.GAMEPLAY,FC=LC.KEY,NC=LC.FRAME,GC=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.step=void 0,n.listPositionStart=void 0,n.listPositionTo=void 0,n.positionStart=void 0,n.positionTo=void 0,n.handFrame=void 0,n.tweenHand=void 0,n.validTargetPosition=function(t){var e={x:0,y:0};switch(n.step){case 0:case 1:e={x:3,y:3}}return e.x===t.x&&e.y===t.y},n.scene=e,n.step=0,n.initPosition(),n.createHand(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.start=function(){this.isRunning()||(this.setState(BC.RUNNING),this.handleStep())},n.initPosition=function(){var t=this.scene.gameZone,e=t.width,n=t.height,i=n/2+200,a=i+(n-85-i)/2;this.listPositionStart=[{x:e/2-90,y:a},{x:e/2+30,y:a+10}],this.listPositionTo=[{x:e/2-15,y:n/2-30},{x:e/2+55,y:n/2+30}]},n.createHand=function(){this.handFrame=this.scene.make.image({key:FC,frame:NC.HAND,origin:{x:.5,y:.5}}),this.handFrame.setVisible(!1).setDepth(Dr.default.ON_TOP),this.handFrame.setWorldSize(64,55)},n.createTweenHand=function(){this.tweenHand=this.scene.add.tween({paused:!0,repeatDelay:500,targets:this.handFrame,repeat:-1,x:{from:this.positionStart.x,to:this.positionTo.x},y:{from:this.positionStart.y,to:this.positionTo.y},duration:1500,ease:Phaser.Math.Easing.Sine.InOut}),this.tweenHand.play()},n.handleStep=function(){switch(this.positionStart=this.listPositionStart[this.step],this.positionTo=this.listPositionTo[this.step],this.handFrame.setVisible(!0),this.handFrame.setPosition(this.positionStart.x,this.positionStart.y),this.createTweenHand(),this.step){case 0:this.handleStep1();break;case 1:this.handleStep2()}},n.handleStep1=function(){this.scene.main.board.dataBoard[3][3].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][4].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][3].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleStep2=function(){this.scene.main.board.dataBoard[5][3].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][4].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[5][5].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[3][5].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0),this.scene.main.board.dataBoard[4][5].cell.setFrame(or.default.GAMEPLAY_32.FRAME.GEM_HIGHT_LIGHT).setVisible(!0)},n.handleCompleteTutorial=function(){this.setState(BC.STOPPED),this.stopAnimHand()},n.nextStep=function(){this.handFrame.setVisible(!1),this.step++,this.step>=2?this.handleCompleteTutorial():this.handleStep()},n.stopAnimHand=function(){var t;this.handFrame.setVisible(!1),null==(t=this.tweenHand)||t.stop()},n.runAnimHand=function(){this.handFrame.setVisible(!0),this.tweenHand.play()},n.validStep=function(t){return this.step===t},n.reset=function(){this.setState(BC.STOPPED),this.stopAnimHand(),this.step=0},e}(Ur),UC=GC,VC=or.default.DEFAULT,YC=VC.KEY,zC=VC.FRAME,HC=function(t){function e(e,n,i,a){var s;return(s=t.call(this,e,n,i,a)||this).scene=void 0,s.popup=void 0,s.title=void 0,s.contents=void 0,s.backgroundContent=void 0,s.textTargetScore=void 0,s.textScore=void 0,s.titleFrame=void 0,s.popupShowUpAnimation=void 0,s.popupFadeOutAnimation=void 0,s.contentShowUpAnimation=void 0,s.popupFadeInMaskAnimation=void 0,s.popupFadeOutMaskAnimation=void 0,s.handleClose=function(){s.runCloseAnimation()},s.scene=e,s.createPopup(),s.createTitle(),s.createContentBackground(),s.createTextTargetScore(),s.createTextScore(),s.addItem(),s.setDepth(kr),s.background.setAlpha(.5),s}(0,Kt.default)(e,t);var n=e.prototype;return n.open=function(e){var n=this;t.prototype.open.call(this,e);var i=this.scene.targetMissionManager.getTargetValue();this.textScore.setText(""+i);var a=this.getData(["duration"])[0];this.runOpenAnimation(),this.scene.time.delayedCall(a,(function(){n.handleClose()}))},n.createContentBackground=function(){this.backgroundContent=this.scene.make.image({key:YC,frame:zC.POPUP_CONTENT_BACKGROUND}),this.backgroundContent.setWorldSize(263,135),this.popup.add(this.backgroundContent),Phaser.Display.Align.In.TopCenter(this.backgroundContent,this.popup,0,-24)},n.createTextTargetScore=function(){this.textTargetScore=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(50),text:"Target Score",origin:{x:.5,y:.5}}),this.popup.add(this.textTargetScore),Phaser.Display.Align.In.Center(this.textTargetScore,this.backgroundContent,0,-30)},n.createTextScore=function(){this.textScore=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(80),text:"0",origin:{x:.5,y:.5}}),this.popup.add(this.textScore),Phaser.Display.Align.In.Center(this.textScore,this.backgroundContent,0,15)},n.createPopup=function(){this.popup=new no(this.scene,0,-19,290,218,{forceHeightTop:55}),this.add(this.popup),Phaser.Display.Align.In.Center(this.popup,this.zone)},n.createTitle=function(){this.title=this.scene.add.container(),this.titleFrame=this.scene.make.image({key:YC,frame:zC.TEXT_MISSION}),this.titleFrame.setWorldSize(105,21),this.title.add([this.titleFrame]),this.popup.add(this.title),Phaser.Display.Align.In.Center(this.titleFrame,this.title,0,-10),Phaser.Display.Align.In.TopCenter(this.title,this.popup)},n.addItem=function(){this.popup.add([this.title]),this.contents=this.scene.add.group(),this.contents.addMultiple([])},n.runOpenAnimation=function(){var t,e;null!=(t=this.popupShowUpAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.scene.audio.playSound(Or.default.POPUP_SHOW),this.runPopupEntrancesAnimation(0,300),this.runFadeInMaskAnimation(100,300),this.runPopupContentEntrancesAnimation(200,300))},n.runCloseAnimation=function(){var t,e;null!=(t=this.popupFadeOutAnimation)&&null!=(e=t.tween)&&e.isPlaying()||(this.runPopupExitsAnimation(50,200),this.runFadeOutMaskAnimation(0,200))},n.runPopupEntrancesAnimation=function(t,e){if(!this.popupShowUpAnimation){var n=this.popup.scale;this.popupShowUpAnimation=new Jr({targets:[this.popup],delay:t,duration:e,props:{y:0,alpha:{start:1,from:1,to:1},scale:{start:0,from:0,to:n}}})}this.popupShowUpAnimation.play()},n.runPopupContentEntrancesAnimation=function(t,e){var n;null==(n=this.contentShowUpAnimation)||n.remove(),this.contentShowUpAnimation=new jr({targets:this.contents.getChildren(),duration:e,delay:t,props:{alpha:{start:0,from:0,to:1}}}),this.contentShowUpAnimation.play()},n.runPopupExitsAnimation=function(t,e){var n=this;this.popupFadeOutAnimation||(this.popupFadeOutAnimation=new Hr({targets:[this.popup],delay:t,duration:e,props:{scale:0},onComplete:function(){n.popup.setY(0),n.scene.screen.close(n.name),n.scene.startGameAfterCollectionItemsScreenClose()}})),this.popupFadeOutAnimation.play()},n.runFadeInMaskAnimation=function(t,e){if(!this.popupFadeInMaskAnimation){var n=this.background.alpha;this.popupFadeInMaskAnimation=new gc({targets:[this.background],delay:t,duration:e,props:{alpha:{start:0,from:0,to:n}}})}this.popupFadeInMaskAnimation.play()},n.runFadeOutMaskAnimation=function(t,e){if(!this.popupFadeOutMaskAnimation){var n=this.background.alpha;this.popupFadeOutMaskAnimation=new Hr({targets:[this.background],delay:t,duration:e,props:{alpha:{start:n,from:n,to:0}}})}this.popupFadeOutMaskAnimation.play()},e}(GameCore.Screen),WC=HC,XC=or.default.DEFAULT,KC=XC.KEY,jC=XC.FRAME,qC=function(){function t(t){this.scene=void 0,this.x=void 0,this.y=void 0,this.background=void 0,this.text=void 0,this.tweenStep1=void 0,this.tweenStep2=void 0,this.tweenStep3=void 0,this.tweenStep4=void 0,this.tweenStep5=void 0,this.tweenStep6=void 0,this.tweenTextStep1=void 0,this.tweenTextStep2=void 0,this.tweenTextStep5=void 0,this.tweenTextStep6=void 0,this.scene=t,this.init()}var e=t.prototype;return e.init=function(){this.createBackground(),this.createText(),this.createTween()},e.createBackground=function(){this.background=this.scene.make.image({key:KC,frame:jC.BG_STREAK}),this.background.setWorldSize(106,38),this.background.setVisible(!1)},e.createText=function(){this.text=this.scene.make.bitmapText({font:Br.default.PRIMARY_LIGHT.KEY,size:this.scene.fontSize(50),origin:{x:.5,y:.5},text:"3X STREAK!"}),this.text.setVisible(!1)},e.createTween=function(){var t=this,e=this.background.scale+.3;this.tweenStep1=this.scene.tweens.add({targets:[this.background],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:0,from:0,to:e}},paused:!0,onComplete:function(){t.tweenStep2.play()}}),this.tweenTextStep1=this.scene.tweens.add({targets:[this.text],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{start:.3,from:.3,to:1.4}},paused:!0,onComplete:function(){t.tweenTextStep2.play()}}),this.tweenStep2=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:e-.3}},paused:!0,onComplete:function(){t.tweenStep3.play()}}),this.tweenTextStep2=this.scene.tweens.add({targets:[this.text],duration:100,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1.4,to:1}},paused:!0,onComplete:function(){t.tweenTextStep5.play()}}),this.tweenStep3=this.scene.tweens.addCounter({from:0,to:20,paused:!0,duration:533,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y-n),t.background.setPosition(t.x,t.y-n)},onComplete:function(){t.y=t.y-20,t.tweenStep4.play()}}),this.tweenStep4=this.scene.tweens.addCounter({from:0,to:5,paused:!0,duration:333,ease:Phaser.Math.Easing.Sine.InOut,onUpdate:function(e){var n=e.getValue();t.text.setPosition(t.x,t.y+n),t.background.setPosition(t.x,t.y+n)},onComplete:function(){t.y=t.y+5,t.tweenStep5.play(),t.tweenTextStep5.play()}}),this.tweenStep5=this.scene.tweens.add({targets:[this.background],delay:567,duration:67,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e-.3,to:e}},paused:!0,onComplete:function(){t.tweenStep6.play()}}),this.tweenTextStep5=this.scene.tweens.add({targets:[this.text],delay:467,duration:133,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:1,to:.8}},paused:!0,onComplete:function(){t.tweenTextStep6.play()}}),this.tweenStep6=this.scene.tweens.add({targets:[this.background],duration:200,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:e,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.background.setVisible(!1),t.text.setScale(0),t.background.setScale(0)}}),this.tweenTextStep6=this.scene.tweens.add({targets:[this.text],duration:167,ease:Phaser.Math.Easing.Sine.InOut,props:{scale:{from:.8,to:1.7},alpha:{from:1,to:0}},paused:!0,onComplete:function(){t.text.setVisible(!1),t.text.setScale(0)}})},e.playAnim=function(t,e){(this.tweenTextStep1.isPlaying()||this.tweenTextStep2.isPlaying()||this.tweenTextStep5.isPlaying()||this.tweenTextStep6.isPlaying())&&(this.tweenTextStep1.stop(),this.tweenTextStep2.stop(),this.tweenTextStep5.stop(),this.tweenTextStep6.stop(),this.text.setScale(0),this.text.setVisible(!1),this.background.setScale(0),this.background.setVisible(!1)),this.x=t,this.y=e,this.text.setScale(0).setAlpha(1),this.background.setScale(0),this.text.setPosition(t,e),this.background.setPosition(t,e),this.text.setVisible(!0),this.tweenTextStep1.play()},e.setTextCombo=function(t){this.text.setText(t+"X COMBO!")},e.setTextStreak=function(t){this.text.setText(t+"X STREAK!")},e.setBgFrame=function(t){this.background.setFrame(t)},t}(),ZC=function(){function t(t){this.scene=void 0,this.streakBreak=void 0,this.scene=t,this.init()}return t.prototype.init=function(){this.streakBreak=new qC(this.scene)},t}(),JC=GameCore.Configs,QC=JC.Board,$C=JC.Network,tP=or.default.GAMEPLAY_32.FRAME,eP=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).lastTimeInputEnabled=0,n.tutorialManager=void 0,n.levelManager=void 0,n.mapManager=void 0,n.targetMissionManager=void 0,n.effectManager=void 0,n.header=void 0,n.main=void 0,n.footer=void 0,n.isGameOver=void 0,n.isLevelComplete=void 0,n.restartCurrentLevel=0,n.run=function(){var t=n.storage.getState();!0!==xl(t)&&n.storage.dispatch(Rd(!0)),n.updateCurrentBestScore(),n.preloadNextLevel(),n.startGame(),n.analytics.levelStart(n.levelManager.getLevel(),void 0,n.getLevelName())},n.create=function(){t.prototype.create.call((0,nr.default)(n)),n.createBackground(Bs.default.BACKGROUND.KEY),n.createTutorialManager(),n.createLevelManager(),n.createMapManager(),n.createTargetMissionManager(),n.createHeader(),n.createMain(),n.createFooter(),n.createEffectManager(),n.createScreens(),n.createInput(),n.input.setTopOnly(!0),n.preLoadAds()},n.handlePauseGame=function(){n.isGameOver||n.isLevelComplete||(0,nr.default)(n).screen.open(ur)},n.handleShowInterstitialAd=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.audio.pauseMusic(),n.ads.canbeShowInterstitialAd()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.ads.showInterstitialAdAsync();case 6:n.analytics.showInterstitialAd(n.getSceneName()),t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return");case 12:return t.prev=12,n.audio.playMusic(),n.ads.preloadInterstitialAdAsync().catch(Ht.sendException),n.audio.playMusic(),t.finish(12);case 17:case"end":return t.stop()}}),t,null,[[0,9,12,17]])}))),n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.preLoadAds=function(){this.ads.preloadInterstitialAdAsync().catch((function(t){})),this.ads.preloadRewardedVideoAsync().catch((function(t){}))},n.createHeader=function(){this.header=new Yw(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone)},n.createTutorialManager=function(){this.tutorialManager=new UC(this)},n.createLevelManager=function(){this.levelManager=new RM(this)},n.createMapManager=function(){this.mapManager=new OM(this)},n.createEffectManager=function(){this.effectManager=new ZC(this)},n.createTargetMissionManager=function(){this.targetMissionManager=new _M},n.createMain=function(){this.main=new ow(this)},n.createFooter=function(){this.footer=new kM(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone)},n.createInput=function(){this.isGameOver||(this.header.buttonSetting.onClick=this.handlePauseGame)},n.createScreens=function(){this.createMissionScoreCompleteScreen(),this.createMissionCollectionCompleteScreen(),this.createCollectionCompletedScreen(),this.createNoSpaceLeftScreen(),this.createMissionFailScreen(),this.createSettingScreen(),this.createCollectionItemsScreen(),this.createLeaderboardScreeen(),this.createTargetScoreScreen(),this.createClaimHeartScreen()},n.createLeaderboardScreeen=function(){this.screen.add(mr,Sp)},n.createCollectionCompletedScreen=function(){this.screen.add(br,BM)},n.createMissionScoreCompleteScreen=function(){this.screen.add(Ar,GM)},n.createMissionCollectionCompleteScreen=function(){this.screen.add(Er,zM)},n.createMissionFailScreen=function(){this.screen.add(xr,qM)},n.createNoSpaceLeftScreen=function(){this.screen.add(Tr,WM)},n.createSettingScreen=function(){this.screen.add(ur,wC)},n.createCollectionItemsScreen=function(){this.screen.add(Cr,DC)},n.createTargetScoreScreen=function(){this.screen.add(Pr,WC)},n.createClaimHeartScreen=function(){this.screen.add(Ir,Ab)},n.updateCurrentBestScore=function(){var t=this.player.getBestScore(),e=this.storage.getState(),n=au(e).bestScore,i=void 0===n?0:n,a=t>i?t:i;this.header.bestScoreBlock.setScoreText(a)},n.openLevelScreen=function(){this.screen.open(Sr)},n.handleNextLevel=function(){var t=this.levelManager.getNextLevelConfig();if(t){var e=t.key;this.cache.tilemap.exists(e)?this.handleLoadMapComplete():(this.preloadNextLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadMapComplete.bind(this)))}},n.handleLoadMapComplete=function(){this.levelManager.increaseLevel();var t=this.levelManager.getLevel();FBInstant.player.setDataAsync({level:t}),this.mapManager.reloadMap()},n.handleGuideIfLevel1=function(){1===this.levelManager.getLevel()&&this.tutorialManager.start()},n.startGame=function(){try{var t;this.isGameOver=!1,this.isLevelComplete=!1,this.mapManager.reloadMap(),null==(t=this.tutorialManager)||t.reset(),this.main.board.clearBoard(),this.footer.pieces.clearPieces(),this.loadTargetByMap(),this.header.start(),this.loadBoardAndPieces(),this.loadTargetAmountByFen();var e=this.levelManager.getLevel();this.header.bestScoreBlock.setScoreText(e),this.restartCurrentLevel=0,this.openMissionScreen()}catch(n){this.handleRestartLevel(),(0,Ht.sendExceptionWithScope)(n,{scene:"Journey scene"})}},n.startGameAfterCollectionItemsScreenClose=function(){var t,e=this.storage.getState(),n=((null==(t=$l(e))?void 0:t.data)||{}).fen;n?this.loadPiecesByFen(n):(this.footer.pieces.start(),this.handleGuideIfLevel1())},n.openMissionScreen=function(){switch(this.targetMissionManager.getTargetType()){case tw:this.openCollectionItemsScreen();break;case $T:this.openTargetScoreScreen()}},n.openCollectionItemsScreen=function(){var t=this,e=this.header.collectItems.getJsonTarget();this.header.collectItems.hideListCollectItems(),this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Cr,{jsonTarget:e,duration:1500})}))},n.openTargetScoreScreen=function(){var t=this;this.disableInput(),this.time.delayedCall(500,(function(){t.enableInput(),t.screen.open(Pr,{duration:1500})}))},n.showCollectItems=function(){this.header.collectItems.showListCollectItems()},n.loadBoardAndPieces=function(){var t,e=this.storage.getState(),n=((null==(t=$l(e))?void 0:t.data)||{}).fen,i=null,a=null;if(n){var s=this.main.board.getBoardByFen(n);return i=this.handleDynamicFenSize(s),a=this.footer.pieces.getPiecesByFen(n),this.isFenGameOver(i,a)?(this.clearFen(),this.loadBoardByMap(),void this.loadPiecesByMap()):void this.loadBoardByFen(n)}this.loadBoardByMap(),this.loadPiecesByMap()},n.loadBoardByFen=function(t){var e=this.main.board.getBoardByFen(t);this.main.board.startGame(e,t)},n.loadBoardByMap=function(){for(var t=this.mapManager.getTileMap().layers,e=t.length,n=0;n<e;n++)for(var i=t[n].data,a=0;a<i.length;a++)for(var s=i[a],r=0;r<s.length;r++){var o=s[r];if(!(o.index<0)){var h=this.main.board.getFrameByMapItemIndex(o.index-1);h&&h!==tP.GEM_TRANSPARENT||(h=this.main.board.getFrameByMapItemIndex(1),(0,Ht.sendExceptionWithScope)(new Error("MapByBoardError"),{index:o.index,level:this.levelManager.getLevel(),row:a,col:r})),this.main.board.setFrameBoardByIndex(a,r,h)}}this.main.board.fadeIn()},n.loadPiecesByFen=function(t){var e=this.footer.pieces.getPiecesByFen(t);this.footer.pieces.showAvailablePieces(e),this.loadListPieceMapByFen()},n.loadListPieceMapByFen=function(){var t=this.storage.getState(),e=$l(t).listPieceMap;e&&0!==e.length&&this.footer.pieces.setListPieceMap(e)},n.loadPiecesByMap=function(){this.footer.pieces.buildPiecesByMap();var t=this.mapManager.getTileMap().getObjectLayer("spawnOrder");if(t)for(var e=t.objects,n=0;n<e.length;n++){var i=e[n],a=i.type,s=i.properties,r=this.footer.pieces.getPieceDataByType(a);s&&(r=(0,wt.default)({},r,{properties:s})),r&&this.footer.pieces.addItemPieceMap(r)}},n.loadTargetByMap=function(){var t=this.mapManager.getTileMap().properties;if(!t||!(0,Pv.isArray)(t)||t.length<2)throw new MC;var e=t[0].value,n=t[1].value;this.targetMissionManager.setTargetValue(e),this.targetMissionManager.setTargetType(n)},n.loadTargetAmountByFen=function(){var t;this.header.collectItems.resetTextAmount();var e=this.storage.getState(),n=((null==(t=$l(e))?void 0:t.data)||{}).jsonAmount;n&&0!==Y()(n).length&&this.header.collectItems.updateJsonAmountByFen(n)},n.getFen=function(){return this.main.board.getFenByBoard()+" "+this.footer.pieces.getFenByPieces()},n.handleRestartLevel=function(){this.restartCurrentLevel>0||(this.game.globalScene.screen.open(cr,{message:"Some thing went wrong. Restart map...",duration:$C.Timeout,loading:!0}),this.restartCurrentLevel++,this.preloadCurrentLevel(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this)),this.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR),this.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.handleLoadCurrentMapError.bind(this)))},n.handleGameOver=function(){this.isGameOver=!0,this.screen.open(fr)},n.handleRequestFinishGame=function(){var t=this;this.isGameOver=!0,this.clearFen(),this.analytics.levelFail(this.levelManager.getLevel(),void 0,this.getLevelName()),this.screen.open(Tr,{duration:3e3,onClose:function(){t.handleShowInterstitialAd().catch(Ht.sendException),t.screen.open(xr)}})},n.checkAnimPlaying=function(){var t=this.tweens.getAllTweens();return!(!t||0===t.length)},n.disableInput=function(){this.input.enabled=!1,this.footer.pieces.allPieces.forEach((function(t){return t.piece.cancelDrag()}))},n.enableInput=function(){this.input.enabled=!0},n.handleUpdateScore=function(t){var e=this.header.mainScoreBlock.score+t;this.storage.dispatch(function(t){return{type:ra,payload:{score:t}}}(e))},n.handleAddScoreAnim=function(t){this.header.mainScoreBlock.animAddScore(t)},n.updateProgressTargetScore=function(t){var e=this.header.progressBar.getTargetScore();this.header.progressBar.setPercent(t/e)},n.handleCompleteScoreMission=function(){this.isGameOver||this.targetMissionManager.getTargetType()!==$T||(this.header.mainScoreBlock.score<Hx()(this.targetMissionManager.getTargetValue())||(this.handleNextLevel(),this.screen.open(Ar)))},n.canUpdateFenMatch=function(){return!this.isGameOver&&!this.isLevelComplete},n.updateMatchData=function(){var t;if(this.canUpdateFenMatch()){var e=this.getFen(),n=this.storage.getState(),i=$l(n).data||{},a=tu(n),s=nu(n)||0,r=this.levelManager.getLevel(),o=this.header.collectItems.getJsonAmount(),h=this.footer.pieces.getListPieceMap();this.storage.dispatch(cd(a,{score:s,data:(0,wt.default)({},i,{fen:e,jsonAmount:(0,wt.default)({},o)}),level:r,updateAt:Date.now(),listPieceMap:et()(t=[]).call(t,h)}))}},n.clearFen=function(){var t=this.storage.getState(),e=tu(t),n=au(t).score,i=void 0===n?0:n,a=this.levelManager.getLevel();this.storage.dispatch(cd(e,{score:i,data:{fen:"",jsonAmount:{}},level:a,listPieceMap:[],updateAt:Date.now()}))},n.update=function(t){this.input.enabled||this.checkAnimPlaying()?this.lastTimeInputEnabled=t:t-this.lastTimeInputEnabled>=3e3&&(this.enableInput(),this.lastTimeInputEnabled=t)},n.isFenGameOver=function(t,e){for(var n=[],i=0;i<e.length;i++){var a=e[i],s=a.type,r=a.direction,o=a.isReverse;switch(s){case Jv:case Qv:case $v:n.push({data:Jw.getData(s,r,o)});break;case ty:case ey:case ny:case iy:n.push({data:$w.getData(s,r)});break;case ay:case sy:case ry:n.push({data:eM.getData(s)});break;case hy:n.push({data:iM.getData(r)});break;case cy:n.push({data:oM.getData(r)});break;case gy:n.push({data:pM.getData(r)});break;case uy:case dy:case py:case fy:n.push({data:uM.getData(s,r)});break;case oy:n.push({data:sM.getData(r)});break;case ly:n.push({data:cM.getData()})}}return CS(t,n)},n.handleDynamicFenSize=function(t){var e,n,i=0;if((n=t.length)&&(i=t[0].length),0===n||0===i)return t;var a=et()(e=[]).call(e,t);if(n>QC.rows)ar()(a).call(a,QC.rows,n-QC.rows);else if(i<QC.rows)for(var s=0;s<QC.rows-n;s++){var r;a.push(A()(r=new Array(n)).call(r,{value:0,frame:tP.GEM_TRANSPARENT}))}return i>QC.cols?a.forEach((function(t){ar()(t).call(t,QC.cols,i-QC.cols)})):i<QC.cols&&a.forEach((function(t){for(var e=0;e<QC.cols-i;e++)t.push({value:0,frame:tP.GEM_TRANSPARENT})})),a},n.handleCollectionItemsComplete=function(){var t=this;if(this.targetMissionManager.getTargetType()!==$T&&this.header.collectItems.checkCompleteMission()){this.clearFen(),this.audio.playSound(Or.default.TARGET_REACHED);var e=this.levelManager.getLevel();this.analytics.levelComplete(e,void 0,this.getLevelName()),this.handleNextLevel(),e>Gu.length-1&&this.time.delayedCall(2e3,(function(){t.game.globalScene.screen.open(cr,{message:"UPDATING NEW LEVELS...",duration:1e3}),t.time.delayedCall(1e3,(function(){t.scene.switch(qs.SceneKeys.LEVEL_SCENE)}))})),this.screen.open(br,{duration:3e3,onClose:function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.isLevelComplete=!1,t.handleShowInterstitialAd().catch(Ht.sendException),t.screen.open(Er);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},n.setLevelCompleted=function(t){this.targetMissionManager.getTargetType()!==$T&&(this.isLevelComplete=t)},n.handleRetryLevel=function(){this.analytics.levelStart(this.levelManager.getLevel(),void 0,this.getLevelName()),this.header.progressBar.reset(),this.clearFen(),this.startGame()},n.preloadNextLevel=function(){var t=this.levelManager.getNextLevelConfig();if(t){var e=t.key,n=t.mapJson;"level-from-json"!==e&&(this.cache.tilemap.exists(e)||(this.load.tilemapTiledJSON(e,n),this.load.start()))}},n.preloadCurrentLevel=function(){var t=this.levelManager.getLevelConfig();if(t){var e=t.key,n=t.mapJson;this.cache.tilemap.exists(e)?this.handleLoadCurrentMapComplete():(this.load.tilemapTiledJSON(e,n),this.load.start())}},n.handleLoadCurrentMapComplete=function(){var t=this.game.globalScene;this.mapManager.reloadMap(),this.clearFen(),this.startGame(),t.screen.close(cr)},n.handleLoadCurrentMapError=function(t){var e=this.game.globalScene,n=new NE("Load resources at LoadScene failed.");(0,Ht.sendExceptionWithScope)(n,{file:null==t?void 0:t.url}),e.screen.close(cr)},n.getLevelName=function(){var t,e=this.levelManager.getLevel();return"journey_"+rr()(t=GameCore.Utils.Number).call(t,e,4,"0")},e}(Ap.default),nP=eP;null==(CT=void 0)||CT.accept(GameCore.LiveUpdate.Scene(qs.SceneKeys.JOURNEY_SCENE));var iP,aP=nP,sP=or.default.GAMEPLAY,rP=sP.KEY,oP=sP.FRAME,hP=function(t){function e(e){var n;return(n=t.call(this,e,rP,oP.BUTTON_WOOD_SMALL)||this).button.setWorldSize(64,55),n.setName("AddFriends"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:rP,frame:oP.ICON_ADD_FRIEND});t.setWorldSize(31,28),this.add(t),Phaser.Display.Align.In.Center(t,this,.25,-2.5)},e}(_r.default),cP=hP,lP=or.default.GAMEPLAY,uP=lP.KEY,dP=lP.FRAME,pP=function(t){function e(e){var n;return(n=t.call(this,e,uP,dP.BUTTON_WOOD_SMALL)||this).button.setWorldSize(64,55),n.setName("Home"),n.createIcon(),n}return(0,Kt.default)(e,t),e.prototype.createIcon=function(){var t=this.scene.make.image({key:uP,frame:dP.ICON_HOME});t.setWorldSize(34,31),this.add(t),Phaser.Display.Align.In.Center(t,this,0,-2)},e}(_r.default),fP=pP,gP=or.default.DEFAULT,mP=gP.KEY,vP=gP.FRAME,yP=function(t){function e(e){var n;return(n=t.call(this,e,mP,vP.BUTTON_GREEN)||this).nextLevel=void 0,n.button.setWorldSize(182,55),n.setName("Play Level"),n.createText(),n}return(0,Kt.default)(e,t),e.prototype.createText=function(){this.nextLevel=this.scene.make.image({key:mP,frame:vP.TEXT_NEXT_LEVEL}),this.nextLevel.setWorldSize(136,17),this.add(this.nextLevel),Phaser.Display.Align.In.Center(this.nextLevel,this,0,-1)},e}(_r.default),SP=yP,AP=(GameCore.Configs.Match,function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.buttonPlay=void 0,n.buttonHome=void 0,n.buttonInviteFriends=void 0,n.scene=e,n.init(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createButton()},n.createButton=function(){this.createButtonPlay(),this.createButtonHome(),this.createButtonAddFriends()},n.createButtonPlay=function(){this.buttonPlay=new SP(this.scene),this.add(this.buttonPlay),Phaser.Display.Align.In.Center(this.buttonPlay,this,0,1)},n.createButtonHome=function(){this.buttonHome=new fP(this.scene),this.add(this.buttonHome),Phaser.Display.Align.In.Center(this.buttonHome,this,-131,1)},n.createButtonAddFriends=function(){this.buttonInviteFriends=new cP(this.scene),this.add(this.buttonInviteFriends),Phaser.Display.Align.In.Center(this.buttonInviteFriends,this,131,1)},n.updateTextButtonPlay=function(){var t=this.scene.storage.getState();1===eu(t)?(this.buttonPlay.nextLevel.setFrame(or.default.DEFAULT.FRAME.TEXT_PLAY),this.buttonPlay.nextLevel.setWorldSize(83,25)):(this.buttonPlay.nextLevel.setFrame(or.default.DEFAULT.FRAME.TEXT_NEXT_LEVEL),this.buttonPlay.nextLevel.setWorldSize(136,17))},e}(Phaser.GameObjects.Container)),EP=AP,xP=or.default.DEFAULT,bP=xP.KEY,TP=xP.FRAME,wP=function(t){function e(e){var n,i=(n=t.call(this,e,0,0,bP,TP.LEAF)||this).scene.gameZone.width,a=i*n.height/n.width;return n.setWorldSize(i,a),n.scene.add.existing((0,nr.default)(n)),n}return(0,Kt.default)(e,t),e}(Phaser.GameObjects.Image),MP=wP,CP=or.default.DEFAULT,PP=CP.KEY,IP=CP.FRAME,kP=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.livesTimer=void 0,n.scene=e,e.add.existing((0,nr.default)(n)),n.init(),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createText(),this.createLeaf(),this.createLivesTimer()},n.createText=function(){var t=this.scene.make.image({key:PP,frame:IP.TEXT_JOURNEY});t.setWorldSize(113,20),this.add(t),Phaser.Display.Align.In.Center(t,this,0,14)},n.createLeaf=function(){var t=new MP(this.scene);this.add(t),Phaser.Display.Align.In.TopCenter(t,this,0,t.displayHeight/2-30)},n.createLivesTimer=function(){this.livesTimer=new eb(this.scene),this.livesTimer.startIntervalTimer(),this.add(this.livesTimer),Phaser.Display.Align.In.Center(this.livesTimer,this,0,50)},n.updateTextLives=function(){var t=this.scene.storage.getState(),e=gv(t);this.livesTimer.setLives(e)},e}(Phaser.GameObjects.Container),RP=kP;!function(t){t.PASSED="passed",t.READY="ready",t.WAITING="waiting"}(iP||(iP={}));var OP,_P=or.default.DEFAULT,DP=_P.KEY,BP=_P.FRAME,LP=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).scene=void 0,i.levelBackground=void 0,i.tick=void 0,i.levelNumber=void 0,i.level=void 0,i.tweenClick=void 0,i.payload=void 0,i.scene=e,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,nr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){var t=this;this.createLevelBackground(),this.createImageCheck(),this.createText(),this.updateSize(),this.alignLevelItem(),this.setInteractive(),this.on(Phaser.Input.Events.POINTER_DOWN,(function(){t.scene.audio.playSound(Or.default.BUTTON_CLICK),t.tweenClick?t.tweenClick.play():t.scene.handlePlay()}))},n.createLevelBackground=function(){this.levelBackground=this.scene.make.image({key:DP,frame:BP.LEVEL_PLAYING}),this.levelBackground.setWorldSize(75,60),this.levelBackground.setVisible(!1),this.add(this.levelBackground)},n.updateSize=function(){var t=this.levelBackground,e=t.width,n=t.height;this.setSize(e,n)},n.createImageCheck=function(){this.tick=this.scene.make.image({key:DP,frame:BP.ICON_CHECK}),this.tick.setWorldSize(30,23),this.tick.setVisible(!1),this.add(this.tick)},n.createText=function(){this.levelNumber=this.scene.make.bitmapText({font:Br.default.PRIMARY.KEY,size:this.scene.fontSize(40),text:""+this.level,origin:{x:.2,y:.5}}),this.levelNumber.setAlpha(.7),this.levelNumber.setTint(7813671),this.add(this.levelNumber)},n.getLevel=function(){return this.level},n.updateInfoLevel=function(){switch(this.disableInteractive(),this.payload.status){case iP.PASSED:this.levelNumber.setAlpha(.7),this.levelBackground.setFrame(BP.LEVEL_PLAYED),this.tick.setVisible(!0);break;case iP.READY:this.levelNumber.setAlpha(.7),this.setInteractive(),this.createTweenClick(),this.levelBackground.setFrame(BP.LEVEL_PLAYING),this.tick.setVisible(!1);break;case iP.WAITING:this.levelNumber.setAlpha(.5),this.levelBackground.setFrame(BP.LEVEL_LOCKED),this.tick.setVisible(!1)}},n.updateInfo=function(t){this.payload=(0,wt.default)({},t),this.updateInfoLevel(),this.updateText(),this.updateBackground(),this.alignLevelItem()},n.createTweenClick=function(){var t=this,e=this.scale;this.tweenClick=this.scene.tweens.add({targets:[this],duration:100,paused:!0,yoyo:!0,scale:{from:e,to:e-.1},onComplete:function(){t.scene.handlePlay()}})},n.updateBackground=function(){this.levelBackground.setVisible(!0)},n.updateText=function(){this.levelNumber.setText(""+this.payload.level),Phaser.Display.Align.In.Center(this.levelNumber,this.levelBackground,0,0)},n.alignLevelItem=function(){Phaser.Display.Align.In.Center(this.tick,this.levelBackground,25,10),Phaser.Display.Align.In.Center(this.levelNumber,this.levelBackground,0,0)},n.setStatus=function(t){this.payload.status=t},n.setTextLevel=function(t){this.payload.level=t},e}(Phaser.GameObjects.Container),FP=or.default.DEFAULT,NP=FP.KEY,GP=FP.FRAME,UP=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).scene=void 0,i.background=void 0,i.levelItem1=void 0,i.levelItem2=void 0,i.levelItem3=void 0,i.levelItem4=void 0,i.payload=void 0,i.scene=e,i.init(),n&&i.updateInfo(n),i.scene.add.existing((0,nr.default)(i)),i}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackground(),this.updateSize(),this.createLevelItem()},n.createBackground=function(){this.background=this.scene.make.image({key:NP,frame:GP.BG_DARK}),this.background.setWorldSize(325,64),this.background.setVisible(!1),this.add(this.background)},n.updateSize=function(){var t=this.background,e=t.width,n=t.height;this.setSize(e,n)},n.updateInfo=function(t){this.payload=(0,wt.default)({levelItem2:{level:0,status:""},levelItem3:{level:0,status:""},levelItem4:{level:0,status:""}},t),this.updateLevelItem()},n.createLevelItem=function(){this.levelItem1=new LP(this.scene,{level:1,status:iP.WAITING}),this.add(this.levelItem1),Phaser.Display.Align.In.Center(this.levelItem1,this,-120,0),this.levelItem2=new LP(this.scene,{level:2,status:iP.WAITING}),this.add(this.levelItem2),this.levelItem2.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem2,this,-40,0),this.levelItem3=new LP(this.scene,{level:3,status:iP.WAITING}),this.add(this.levelItem3),this.levelItem3.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem3,this,40,0),this.levelItem4=new LP(this.scene,{level:4,status:iP.WAITING}),this.add(this.levelItem4),this.levelItem4.setVisible(!1),Phaser.Display.Align.In.Center(this.levelItem4,this,120,0)},n.updateLevelItem=function(){if(this.levelItem1.setStatus(this.payload.levelItem1.status),this.levelItem1.updateInfoLevel(),this.levelItem1.setTextLevel(this.payload.levelItem1.level),this.levelItem1.updateText(),this.levelItem2){if(""==this.payload.levelItem2.status)return this.levelItem2.setVisible(!1),this.levelItem3&&this.levelItem3.setVisible(!1),void(this.levelItem4&&this.levelItem4.setVisible(!1));this.levelItem2.setStatus(this.payload.levelItem2.status),this.levelItem2.updateInfoLevel(),this.levelItem2.setVisible(!0),this.levelItem2.setTextLevel(this.payload.levelItem2.level),this.levelItem2.updateText()}if(this.levelItem3){if(""==this.payload.levelItem3.status)return this.levelItem3.setVisible(!1),void(this.levelItem4&&this.levelItem4.setVisible(!1));this.levelItem3.setStatus(this.payload.levelItem3.status),this.levelItem3.updateInfoLevel(),this.levelItem3.setVisible(!0),this.levelItem3.setTextLevel(this.payload.levelItem3.level),this.levelItem3.updateText()}if(this.levelItem4){if(""==this.payload.levelItem4.status)return void this.levelItem4.setVisible(!1);this.levelItem4.setStatus(this.payload.levelItem4.status),this.levelItem4.updateInfoLevel(),this.levelItem4.setVisible(!0),this.levelItem4.setTextLevel(this.payload.levelItem4.level),this.levelItem4.updateText()}},e}(Phaser.GameObjects.Container),VP=or.default.DEFAULT,YP=VP.KEY,zP=VP.FRAME,HP=function(t){function e(e){var n;return(n=t.call(this,e)||this).scene=void 0,n.backgroundContent=void 0,n.scroller=void 0,n.scene=e,n.init(),n.createReuseScroller(),n.scene.add.existing((0,nr.default)(n)),n}(0,Kt.default)(e,t);var n=e.prototype;return n.init=function(){this.createBackgroundContent()},n.createReuseScroller=function(){this.scroller=new ip(this.scene,{classType:UP,listConfigs:[],width:325,height:385,padding:0,marginTop:0,marginBottom:0,maxScrollOver:.3,scrollingBackRate:5,useMask:!1}),this.scroller.setVisible(!1),this.scene.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&this.scroller.createBound(or.default.DEFAULT.KEY,or.default.DEFAULT.FRAME.BLANK,40,1528359),this.scroller.createMask(),this.scroller.setPosition(0,0),this.add(this.scroller)},n.setSizeBackground=function(t){var e=t*this.backgroundContent.displayWidth/this.backgroundContent.displayHeight;this.backgroundContent.setWorldSize(e,t)},n.updateData=function(){for(var t=this.scene.storage.getState(),e=eu(t),n=[],i={levelItem1:{status:"",level:0}},a={levelItem1:{status:"",level:0}},s=1;s<Gu.length;s++){var r="";r=s>e?iP.WAITING:s<e?iP.PASSED:iP.READY;var o="";switch(s%4){case 1:o="levelItem1";break;case 2:o="levelItem2";break;case 3:o="levelItem3";break;case 0:o="levelItem4"}i[o]={level:s,status:r},a[o]={level:s,status:r},s%4===0&&(n.push((0,wt.default)({},i)),a={levelItem1:{status:"",level:0}})}(Gu.length-1)%4>0&&n.push((0,wt.default)({},a)),this.scroller.updateConfig(n);var h=this.scroller.getChildren()[0].height;if(this.scroller.value=-h*this.showDefaultLevel(e),e>Gu.length)return this.scene.game.globalScene.screen.open(cr,{message:"UPDATING NEW LEVELS...",duration:3e3});this.showLeaders()},n.showDefaultLevel=function(t){var e=Math.floor((t-1)/4),n=Math.floor((Gu.length-1)/4);return n-e<3?n-5:e<3?0:e-2},n.removeLevelItems=function(){this.scroller.updateConfig([])},n.getLevelItems=function(){return this.scroller.getChildren()},n.showLeaders=function(){var t=this.getLevelItems();if(!(t.length<1)){for(var e=t.length>8?8:t.length,n=0;n<e;n++){var i=t[n];if(!i)return;i.setVisible(!0)}this.scroller.setEnable(!0)}},n.createBackgroundContent=function(){this.backgroundContent=this.scene.make.image({key:YP,frame:zP.BG_DARK}),this.backgroundContent.setWorldSize(340,399),this.add(this.backgroundContent)},e}(Phaser.GameObjects.Container),WP=HP,XP=GameCore.Configs.Network,KP=or.default.DEFAULT,jP=KP.KEY,qP=KP.FRAME,ZP=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).header=void 0,n.mainContent=void 0,n.footer=void 0,n.run=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.checkReceiveLevelFromFb();case 2:n.header.updateTextLives(),n.loadLevelConfig();case 4:case"end":return t.stop()}}),t)}))),n.create=function(){t.prototype.create.call((0,nr.default)(n)),n.createMainContent(),n.createBackground1(),n.createHeader(),n.createFooter(),n.createClaimHeartScreen()},n.createMainContent=function(){n.mainContent=new WP((0,nr.default)(n)),Phaser.Display.Align.In.Center(n.mainContent,n.gameZone,0,-24)},n.createBackground1=function(){var t=n.make.container({}),e=(n.gameZone.height-385)/2+20,i=n.make.image({key:jP,frame:qP.BG_TOP});i.setWorldSize(375,e);var a=n.make.image({key:jP,frame:qP.BG_BOTTOM});a.setWorldSize(375,e);var s=n.make.image({key:jP,frame:qP.BG_MIDDLE});s.setWorldSize(375,415),t.add([i,s,a]),Phaser.Display.Align.In.Center(s,t,0,0),Phaser.Display.Align.In.Center(i,s,0,-s.displayHeight/2-i.displayHeight/2),Phaser.Display.Align.In.Center(a,s,0,s.displayHeight/2+a.displayHeight/2),Phaser.Display.Align.In.Center(t,n.gameZone,0,-24),n.mainContent.setSizeBackground(i.displayHeight+s.displayHeight+a.displayHeight)},n.clickButtonHome=function(){n.scene.switch(qs.SceneKeys.DASHBOARD_SCENE)},n}(0,Kt.default)(e,t);var n=e.prototype;return n.preload=function(){this.events.on(Phaser.Scenes.Events.WAKE,this.run),this.events.on(Phaser.Scenes.Events.CREATE,this.run)},n.startGame=function(){this.mainContent.updateData(),this.footer.updateTextButtonPlay(),this.mainContent.scroller.setVisible(!0)},n.createClaimHeartScreen=function(){this.screen.add(Ir,Ab)},n.createHeader=function(){this.header=new RP(this),Phaser.Display.Align.In.TopCenter(this.header,this.gameZone,0,-15)},n.createFooter=function(){this.footer=new EP(this),Phaser.Display.Align.In.BottomCenter(this.footer,this.gameZone,0,-90),this.footer.buttonHome.onClick=this.clickButtonHome.bind(this),this.footer.buttonPlay.onClick=this.handlePlay.bind(this),this.footer.buttonInviteFriends.onClick=this.handleInviteFriends.bind(this)},n.handlePlay=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.storage.getState(),!(gv(e)<1)){t.next=5;break}return this.screen.open(Ir),t.abrupt("return");case 5:if(this.storage.dispatch(wv()),!((n=eu(e))>Gu.length)){t.next=11;break}return this.game.globalScene.screen.open(cr,{message:"You reached limit level...",duration:3e3}),t.abrupt("return");case 11:this.analytics.levelStart(n,void 0,this.getLevelName(n)),this.storage.dispatch(Dd());case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.checkReceiveLevelFromFb=function(){var t=(0,Xt.default)(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.storage.getState(),!eu(e)){t.next=5;break}return t.abrupt("return");case 5:return this.showLoadingScreen(),t.next=8,this.storage.dispatch(Ed());case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),(0,Ht.sendException)(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),n.showLoadingScreen=function(){this.game.globalScene.screen.open(cr,{message:"Loading level...",duration:XP.Timeout,loading:!0})},n.hideLoadingScreen=function(){this.game.globalScene.screen.close(cr)},n.loadLevelConfig=function(){try{var t=this.storage.getState(),e=eu(t),n=Gu[e];n||(n=Gu[Gu.length-1]);var i=n,a=i.key,s=i.mapJson;if(this.cache.tilemap.exists(a))return void this.handleLoadCurrentMapComplete();this.load.tilemapTiledJSON(a,s),this.load.start(),this.load.off(Phaser.Loader.Events.COMPLETE),this.load.once(Phaser.Loader.Events.COMPLETE,this.handleLoadCurrentMapComplete.bind(this))}catch(r){(0,Ht.sendException)(r)}},n.handleLoadCurrentMapComplete=function(){this.hideLoadingScreen(),this.startGame()},n.handleInviteFriends=function(){this.storage.dispatch(Wx())},n.getLevelName=function(t){var e;return"journey_"+rr()(e=GameCore.Utils.Number).call(e,t,4,"0")},e}(Ap.default),JP=ZP;null==(OP=void 0)||OP.accept(GameCore.LiveUpdate.Scene(qs.SceneKeys.LEVEL_SCENE));var QP=JP,$P=function(t){function e(e,n,i){var a;return(a=t.call(this)||this).game=void 0,a.options=void 0,a.performance=void 0,a.isRunning=!1,a.checkTimer=void 0,a.fpsHistory=void 0,a.start=function(){if(!a.isRunning){a.isRunning=!0;var t=a.options.checkInterval;a.checkTimer=t,a.fpsHistory=[],a.game.events.on(Phaser.Core.Events.POST_STEP,a.onPostStep)}},a.stop=function(){a.isRunning&&(a.isRunning=!1,a.game.events.off(Phaser.Core.Events.POST_STEP,a.onPostStep),a.options.onlyUpdateWhenSwitchScene&&a.checkFps())},a.onPostStep=function(t,e){if(a.checkTimer-=e,!(a.checkTimer>0)){var n=a.options,i=n.checkInterval,s=n.onlyUpdateWhenSwitchScene;a.checkTimer+=i,a.fpsHistory.push(a.game.loop.actualFps),!1===s&&a.fpsHistory.length>=5&&a.checkFps()}},a.game=e,a.options=i,a.performance=n,a}(0,Kt.default)(e,t);var n=e.prototype;return n.checkFps=function(){if(0!==this.fpsHistory.length){var t=this.options.autoUpgradeQuality,e=!1;this.isLowFps()?e=this.performance.downgradeGraphicsQuality():t&&this.isHighFps()&&(e=this.performance.upgradeGraphicsQuality()),e&&(this.fpsHistory=[])}},n.getFpsMedian=function(){return Phaser.Math.Median(this.fpsHistory)},n.isLowFps=function(){return this.getFpsMedian()<this.options.fpsThreshold},n.isHighFps=function(){return this.getFpsMedian()>1.2*this.options.fpsThreshold},e}(Phaser.Events.EventEmitter),tI=$P,eI=["pixelRatio","minQuality","maxQuality","qualityAdjustStep","trackingSceneKeys"],nI=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).fpsTracker=void 0,n.pixelRatio=void 0,n.minQuality=void 0,n.maxQuality=void 0,n.qualityAdjustStep=void 0,n.trackingSceneKeys=[],n.trackingScene=function(t){var e;if(u()(e=n.trackingSceneKeys).call(e,t)){var i=n.game.scene.getScene(t);i.events.once(Phaser.Scenes.Events.UPDATE,n.fpsTracker.start),i.events.once(Phaser.Scenes.Events.SLEEP,n.fpsTracker.stop)}},n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){var e=t.pixelRatio,n=t.minQuality,i=t.maxQuality,a=t.qualityAdjustStep,s=t.trackingSceneKeys,r=(0,Wt.default)(t,eI);this.pixelRatio=e,this.minQuality=n,this.maxQuality=i,this.qualityAdjustStep=a,this.trackingSceneKeys=s,this.fpsTracker=new tI(this.game,this,r)},n.active=function(){this.game.events.on(Phaser.Scenes.Events.WAKE,this.trackingScene),this.game.events.on(Phaser.Scenes.Events.START,this.trackingScene)},n.downgradeGraphicsQuality=function(){var t=this.pixelRatio;if(t<=this.minQuality)return!1;var e=+(t-this.qualityAdjustStep).toFixed(2);return!(e<this.minQuality)&&(this.pixelRatio=e,this.game.world.resize(this.pixelRatio),!0)},n.upgradeGraphicsQuality=function(){var t=this.pixelRatio;if(t>=this.maxQuality)return!1;var e=+(t+this.qualityAdjustStep).toFixed(2);return!(e>this.maxQuality)&&(this.pixelRatio=e,this.game.world.resize(this.pixelRatio),!0)},e}(Phaser.Plugins.BasePlugin),iI=nI,aI=function(t){function e(e,n){var i;return(i=t.call(this,e)||this).instance=void 0,i.placementId=void 0,i.instance=null,i.placementId=n,i}(0,Kt.default)(e,t),e.setGame=function(t){self.game=t};var n=e.prototype;return n.loadAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.status===GameCore.Ads.Status.IDLE){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this.status=GameCore.Ads.Status.LOADING,t.next=6,this.createInstanceByType(this.type);case 6:if(this.instance=t.sent,null!==this.instance){t.next=9;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 9:return t.next=11,this.instance.loadAsync();case 11:this.status=GameCore.Ads.Status.FILLED,t.next=19;break;case 14:throw t.prev=14,t.t0=t.catch(2),this.status=GameCore.Ads.Status.IDLE,this.instance=null,t.t0;case 19:case"end":return t.stop()}}),t,this,[[2,14]])})));return function(){return t.apply(this,arguments)}}(),n.showAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.status===GameCore.Ads.Status.FILLED){t.next=3;break}throw new GameCore.Ads.AdError("AD_NOT_FILLED","Ads no fill.");case 3:if(this.status=GameCore.Ads.Status.SHOWING,null!==this.instance){t.next=6;break}throw new GameCore.Ads.AdError("AD_INSTANCE_NOT_INITIATED","Ad instance didn't initiated.");case 6:return t.next=8,this.instance.showAsync();case 8:this.status=GameCore.Ads.Status.IDLE,this.instance=null,t.next=16;break;case 12:throw t.prev=12,t.t0=t.catch(0),t.t0 instanceof Object&&GameCore.Utils.Object.hasOwn(t.t0,"code")&&"ADS_NOT_LOADED"===t.t0.code?this.status=GameCore.Ads.Status.FILLED:(this.status=GameCore.Ads.Status.IDLE,this.instance=null),t.t0;case 16:case"end":return t.stop()}}),t,this,[[0,12]])})));return function(){return t.apply(this,arguments)}}(),n.getStatus=function(){return this.status},n.createInstanceByType=function(){var t=(0,Xt.default)(qt().mark((function t(e){var n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=self.game.facebook,t.t0=e,t.next=t.t0===GameCore.Ads.Types.REWARDED?4:t.t0===GameCore.Ads.Types.INTERSTITIAL?7:10;break;case 4:return t.next=6,n.getRewardedVideoAsync(this.placementId);case 6:case 9:return t.abrupt("return",t.sent);case 7:return t.next=9,n.getInterstitialAdAsync(this.placementId);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e}(GameCore.Ads.AdInstance),sI=aI,rI='<div id="mockads"> <div style="color:#fff;display:flex;align-content:space-between;justify-content:space-between;flex-direction:column;flex-wrap:nowrap;position:absolute;width:100vw;height:100vh;top:0;left:0;font-family:sans-serif;background:#063b4d;background:linear-gradient(0deg,#063b4d 30%,#0e6171 100%)"> <div style="display:flex;height:6vh;background-color:#0b4d5b;flex-direction:row;justify-content:space-between;align-items:center;align-content:center;font-size:larger" id="ad-header"> <div style="width:80px;display:flex;align-items:center;justify-content:center;margin:0 10px;cursor:pointer" id="close-btn"> Close </div> <div style="width:80px;display:flex;align-items:center;justify-content:center;margin:0 10px;cursor:pointer" id="reward-btn"> Reward </div> </div> <div style="display:flex;flex-direction:column;flex-wrap:nowrap;align-content:center;justify-content:center;height:100%;align-items:center" id="ad-content"> <div style="display:flex;width:200px;height:50px;background-color:#1f7888;align-items:center;justify-content:center;border-radius:100vw;margin:10px;text-transform:uppercase"> <span>AD {AD_TYPE}</span> </div> <div style="background-color:#1f7888;display:flex;align-items:center;justify-content:center;width:80vw;border-radius:16px"> <img src="{AD_CONTENT}" style="position:relative;width:inherit;border-radius:6px"/> </div> </div> <div style="display:flex;height:3vh;flex-direction:row;justify-content:flex-start;align-items:center;background-color:#063f51" id="ad-footer"></div> </div> </div>',oI=GameCore.Configs.Ads.Mockup,hI=oI.ErrorRate,cI=oI.GiphyApiKey,lI=function(t){return function(e){e.preventDefault();var n=document.getElementById("popup-ads");null==n||n.remove(),t()}},uI=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new(mt())((function(t,n){var i=new Image;i.onload=function(){return t()},i.onerror=function(){return n()},i.src=e})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),dI=function(){var t=(0,Xt.default)(qt().mark((function t(e,n,i,a){var s,r,o,h;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=rI.markup||rI,(r=document.createElement("div")).id="popup-ads",r.innerHTML=s.replace("{AD_TYPE}",e).replace("{AD_CONTENT}",n),document.body.appendChild(r),(o=document.getElementById("close-btn"))&&(e===GameCore.Ads.Types.REWARDED?(o.innerHTML="Skip",o.onclick=lI((function(){a({code:"USER_INPUT",message:"Skip ads mock error"})}))):o.onclick=lI(i)),(h=document.getElementById("reward-btn"))&&(e===GameCore.Ads.Types.REWARDED?h.onclick=lI(i):h.remove());case 9:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),pI=function(){function t(t){this.type=void 0,this.adContent=void 0,this.apiAdContent=void 0,this.loadTimer=void 0,this.showTimer=void 0,this.type=t,this.adContent="",this.apiAdContent="https://api.giphy.com/v1/gifs/random?api_key="+cI+"&rate=pg"}var e=t.prototype;return e.loadAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Phaser.Math.RND.between(0,100)<=hI){t.next=13;break}return t.next=4,this.getAdContentAsync();case 4:return this.adContent=t.sent,t.prev=5,t.next=8,uI(this.adContent);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5);case 13:return t.abrupt("return",new(mt())((function(t,i){clearTimeout(n.loadTimer),e?i({code:"NETWORK_FAILURE",message:"Load ads mock error"}):t()})));case 14:case"end":return t.stop()}}),t,this,[[5,10]])})));return function(){return t.apply(this,arguments)}}(),e.showAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n=this;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Phaser.Math.RND.between(0,100)<=hI,t.abrupt("return",new(mt())((function(t,i){e?i({code:"RATE_LIMITED",message:"Show ads mock error"}):dI(n.type,n.adContent,t,i)})));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e.getPlacementID=function(){return"123"},e.getAdContentAsync=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,n,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.apiAdContent,{method:"GET"});case 2:return e=t.sent,t.next=5,e.json();case 5:if(n=t.sent,GameCore.Utils.Valid.isObject(n)){t.next=8;break}return t.abrupt("return","");case 8:return i=n.data,t.abrupt("return",null==i?void 0:i.images.downsized.url);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),t}(),fI=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.createInstanceByType=function(){var t=(0,Xt.default)(qt().mark((function t(e){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new pI(e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}(sI),gI=fI,mI=function(t){function e(){for(var e,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(n=t.call.apply(t,et()(e=[this]).call(e,a))||this).Text=void 0,n.Texture=void 0,n.currentLocale=void 0,n.supportedLanguages=void 0,n.data=void 0,n.options=void 0,n}(0,Kt.default)(e,t);var n=e.prototype;return n.configure=function(t){this.applyOptions(t)},n.getCurrentLanguage=function(){return this.currentLocale},n.switchLanguage=function(t){void 0===t&&(t="en");var e=this.getCorrectLocale(t);this.currentLocale=e,this.Text=this.data[e].Text,this.Texture=this.data[e].Texture},n.getText=function(t){if("object"==typeof t){var e=t.key,n=t.variables,i=void 0===n?[]:n,a=t.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Text[e];return this.replaceVariables(o,i)}return this.Text[t]},n.getTexture=function(t){if("object"==typeof t){var e=t.key,n=t.variables,i=void 0===n?[]:n,a=t.locale,s=void 0===a?this.currentLocale:a,r=this.getCorrectLocale(s),o=this.data[r].Texture[e];return this.replaceVariables(o,i)}return this.Texture[t]},n.isSupportLanguage=function(t){var e;return g()(e=this.supportedLanguages).call(e,t)>=0},n.applyOptions=function(t){this.options=(0,wt.default)({},t);var e=t.data,n=t.locale,i=void 0===n?"en":n,a=t.upperCaseText,s=void 0!==a&&a;this.data=e,this.supportedLanguages=Y()(e);var r=this.getCorrectLocale(i);if(this.currentLocale=r,this.Text=e[r].Text,this.Texture=e[r].Texture,s)for(var o in this.Text)this.Text[o]=this.Text[o].toUpperCase()},n.replaceVariables=function(t,e){var n=e.length;if(0==n)return t;var i=0;return t.replace(/{.*}/,(function(){return String(e[Math.min(i++,n-1)])}))},n.getCorrectLocale=function(t){var e=t;return this.isSupportLanguage(t)||(e="en"),e},e}(Phaser.Plugins.BasePlugin),vI={en:JSON.parse('{"Text":{"POP JEWELS":"POP JEWELS","DAILY_REWARDS":"DAILY REWARDS","CLAIM":"CLAIM","CLAIM_X2":"CLAIM X2","DAY_{X}":"DAY {X}","PLAY_NOW":"PLAY NOW","PLAY_WITH_FRIENDS":"PLAY WITH FRIENDS","RANK":"RANK","DAILY":"DAILY","GIFT":"GIFT","SETTINGS":"SETTINGS","LEADERBOARDS":"LEADERBOARDS","PLAY":"PLAY","WITH_FRIENDS":"WITH FRIENDS","FRIENDS":"FRIENDS","WORLD":"WORLD","DAILY_MISSION":"DAILY MISSIONS","PASS_10_LEVELS":"PASS 10 LEVELS","COLLECT_300_DIAMONDS":"COLLECT 300 DIAMONDS","INVITE_2_FRIENDS":"INVITE 2 FRIENDS","REACH_TOTAL_SCORES":"REACH TOTAL SCORES","WATCH_A_VIDEO_TO_GET_{X}_DIAMONDS!":"WATCH A VIDEO TO GET\\\\n{X} DIAMONDS!","GET_NOW":"GET NOW!","TARGET":"TARGET","MISSION":"MISSION","YOUR_SCORE":"YOUR SCORE","LEVEL":"LEVEL","REQUESTING":"REQUESTING...","LOADING_INTERSTITIAL_AD":"LOADING INTERSTITIAL AD...","HAMMER":"HAMMER","HAMMER_DESCRIPTION":"USE HAMMER TO SMASH ANY GEM","MAGIC_BOTTLE":"MAGIC BOTTLE","MAGIC_BOTTLE_DESCRIPTION":"USE MAGIC BOTTLE TO CHANGE A GEM COLOR","LEVEL_FAILED":"LEVEL FAILED","FAILED_TEXT":"YOU DID NOT REACH THE TARGET SCORE","CONTINUE":"CONTINUE","BEST_SCORE":"BEST SCORE","GLOBAL":"GLOBAL","JOIN":"JOIN","REPLAY":"REPLAY","HOME":"HOME","TODAY_RECORD":"TODAY RECORD","SHARE":"SHARE","WAITING":"WAITING","WAITING_FOR_OPPONENT":"WAITING FOR OPPONENT","RESTART":"RESTART","DRAW":"DRAW","YOU_LOSE":"YOU LOSE","YOU_WIN":"YOU WIN","VS":"VS","GUIDE_TEXT_GEM":"TAP ON TWO OR MORE GEMS OF THE SAME COLOR TO DESTROY THEM","GUIDE_TEXT_CURRENT_SCORE":"THIS IS YOUR CURRENT SCORE","GUIDE_TEXT_TARGET_SCORE":"THIS IS THE TARGET SCORE FOR EACH LEVEL YOU NEED TO PASS","GUIDE_TEXT_RAINBOW_GEM":"RAINBOW GEM CAN CLEAR THE GEMS SURROUNDING IT","GUIDE_TEXT_HAMMER":"THIS IS A HAMMER, USE IT TO SMASH ANY GEM!","GUIDE_TEXT_SHUFFLE":"THIS IS A SHUFFLE TILE, USE IT TO SHUFFLE ALL GEMS","GUIDE_TEXT_MAGIC_BOTTLE":"THIS IS A MAGIC BOTTLE, USE IT TO CHANGE A GEM COLOUR","NO_ADS_TO_DISPLAY":"NO ADS TO DISPLAY!","NO_REWARDS":"SORRY, NO REWARDS!","CANCELLED_AD":"YOU HAVE CANCELLED THE AD!","LOADING":"LOADING...","LOADING_AD":"LOADING AD ...","YOU_HAVE_JUST_RECEIVED_{X}_DIAMONDS":"YOU HAVE JUST RECEIVED\\\\n{X} DIAMONDS","CLOSE":"CLOSE","LEADERBOARD_EMPTY":"Leaderboard is empty!","MESSAGE_INVITE":"{playerName} challenges you","MESSAGE_FINISH_MATCH":"{playerName} just finished. Check them now.","MESSAGE_BEST_SCORE":"{playerName} beat your high score. Their score: {playerScore}","MESSAGE_FINISH_TURN":"{playerName} got {score} scores. So easy! Can you?","SHARE_LEADERBOARDS":"A ha, I\'m the best!","SHARE_GAME_RESULTS":"Pheww, a great match!","SHARE_BEST_SCORE":"Great! I have a best score!"},"Texture":{"NO_THANKS":"texts/no-thank","COOL":"texts/cool","CONGRATULATIONS":"texts/congratulation","EXCELLENT":"texts/excellent","GOOD":"texts/good","GREAT":"texts/great","LOGO":"logo","CONTINUE":"texts/continue"}}')},yI=function(t){function e(){return t.apply(this,arguments)||this}return(0,Kt.default)(e,t),e.prototype.configure=function(e){t.prototype.configure.call(this,(0,wt.default)({data:vI,locale:"en",upperCaseText:!1},e))},e}(mI),SI=yI,AI=0,EI=0,xI=function(){function t(t){this.game=void 0,this.progressFbTimeEvent=void 0,this.game=t}var e=t.prototype;return e.loadingProgressFbBootScene=function(){var t=this,e=100;EI=30;!function n(){e<=0?clearTimeout(t.progressFbTimeEvent):t.progressFbTimeEvent=setTimeout((function(){t.game.facebook.setLoadingProgress(Math.round(EI)),EI+=30/e,e--,n()}),50)}()},e.finishLoadingProgressFbBootScene=function(){clearTimeout(this.progressFbTimeEvent)},e.loadingProgressFbLoadScene=function(){var t=this;(!EI||EI<30)&&(EI=60),AI=EI;!function e(){t.progressFbTimeEvent=setTimeout((function(){t.game.facebook.setLoadingProgress(Math.round(EI)),EI+=.1,e()}),50)}()},e.onProgress=function(t){var e=100-EI,n=Math.round(t*e+EI);n>AI&&clearTimeout(this.progressFbTimeEvent),this.game.facebook.setLoadingProgress(n)},t}(),bI=xI,TI=n(250),wI=n.n(TI),MI=n(412),CI=n.n(MI),PI=n(321),II=n.n(PI),kI=n(318),RI=n.n(kI),OI=n(296),_I=n.n(OI),DI=n(297),BI=n.n(DI),LI=n(299),FI=n.n(LI),NI=n(294),GI=n.n(NI),UI=n(415),VI=n.n(UI),YI=n(420),zI=n.n(YI),HI=n(160),WI=n.n(HI),XI=n(248),KI=n.n(XI);window.SpinePlugin=function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||wI()(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof vc()&&CI()&&wI()(t,CI(),{value:"Module"}),wI()(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),wI()(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=63)}([function(t,e){function n(t,e,n,i){for(var s in e)if(e.hasOwnProperty(s)){var r=(l=e,u=s,f=p=void 0,f=(d=n)?l[u]:II()(l,u),!d&&f.value&&"object"==typeof f.value&&(f=f.value),!(!f||!((p=f).get&&"function"==typeof p.get||p.set&&"function"==typeof p.set))&&(void 0===f.enumerable&&(f.enumerable=!0),void 0===f.configurable&&(f.configurable=!0),f));if(!1!==r){if(o=(i||t).prototype,h=s,c=void 0,(c=II()(o,h))&&(c.value&&"object"==typeof c.value&&(c=c.value),!1===c.configurable)){if(a.ignoreFinals)continue;throw new Error("cannot override final property '"+s+"', set Class.ignoreFinals = true to skip")}wI()(t.prototype,s,r)}else t.prototype[s]=e[s]}var o,h,c,l,u,d,p,f}function i(t,e){if(e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)n(t,e[i].prototype||e[i])}}function a(t){var e,a,s;if((t=t||{}).initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");s=t.initialize,delete t.initialize}else s=t.Extends?(a=t.Extends,function(){a.apply(this,arguments)}):function(){};t.Extends?(s.prototype=Object.create(t.Extends.prototype),s.prototype.constructor=s,e=t.Extends,delete t.Extends):s.prototype.constructor=s;var r=null;return t.Mixins&&(r=t.Mixins,delete t.Mixins),i(s,r),n(s,t,!0,e),s}a.extend=n,a.mixin=i,a.ignoreFinals=!1,t.exports=a},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(0),a=n(32),s=new i({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new s(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,e){return a(this.x,t.x,e)&&a(this.y,t.y,e)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,n=t*t+e*e;return 0<n&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},transformMat3:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},transformMat4:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[4]*n+i[12],this.y=i[1]*e+i[5]*n+i[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&t<e&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e*this.x-n*this.y,n*this.x+e*this.y)}});s.ZERO=new s,s.RIGHT=new s(1,0),s.LEFT=new s(-1,0),s.UP=new s(0,-1),s.DOWN=new s(0,1),s.ONE=new s(1,1),t.exports=s},function(t,e){t.exports=function(t,e,n){return Math.max(e,Math.min(n,t))}},function(t,e){var n={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:RI()||-9007199254740991,MAX_SAFE_INTEGER:_I()||9007199254740991};t.exports=n},function(t,e){t.exports=function(t,e,n,i){var a=t.length;if(e<0||a<e||n<=e||a<n||a<e+n){if(i)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}},function(t,e){t.exports=function(t,e,n){var i=n-e;return e+((t-e)%i+i)%i}},function(t,e){t.exports=function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}},function(t,e,n){var i=n(4);t.exports=function(t){return t>Math.PI&&(t-=i.PI2),Math.abs(((t+i.TAU)%i.PI2-i.PI2)%i.PI2)}},function(t,e,n){var i=n(4);t.exports=function(t){return t*i.RAD_TO_DEG}},function(t,e){t.exports=function(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1===g()(e).call(e,"."))return n;for(var i=e.split("."),a=t,s=n,r=0;r<i.length;r++){if(!a.hasOwnProperty(i[r])){s=n;break}s=a[i[r]],a=a[i[r]]}return s}return n}},function(t,e){t.exports=function(t,e,n){var i=typeof t;return t&&"number"!=i&&"string"!=i&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:n}},function(t,e){t.exports=function(t,e){if(!(e>=t.length)){for(var n=t.length-1,i=t[e],a=e;a<n;a++)t[a]=t[a+1];return t.length=n,i}}},function(t,e,n){var i=n(0),a=n(26),s=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.type=a.POINT,this.x=t,this.y=e},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});t.exports=s},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new i(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},crossVectors:function(t,e){var n=t.x,i=t.y,a=t.z,s=e.x,r=e.y,o=e.z;return this.x=i*o-a*r,this.y=a*s-n*o,this.z=n*r-i*s,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return Math.sqrt(e*e+n*n+i*i)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return e*e+n*n+i*i},length:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},lengthSq:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},normalize:function(){var t=this.x,e=this.y,n=this.z,i=t*t+e*e+n*n;return 0<i&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i,this.z=n*i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,s=t.y,r=t.z;return this.x=n*r-i*s,this.y=i*a-e*r,this.z=e*s-n*a,this},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=a+e*(t.z-a),this},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=a[0]*e+a[3]*n+a[6]*i,this.y=a[1]*e+a[4]*n+a[7]*i,this.z=a[2]*e+a[5]*n+a[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,s=1/(a[3]*e+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*e+a[4]*n+a[8]*i+a[12])*s,this.y=(a[1]*e+a[5]*n+a[9]*i+a[13])*s,this.z=(a[2]*e+a[6]*n+a[10]*i+a[14])*s,this},transformMat3:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=e*a[0]+n*a[3]+i*a[6],this.y=e*a[1]+n*a[4]+i*a[7],this.z=e*a[2]+n*a[5]+i*a[8],this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,a=t.val;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12],this.y=a[1]*e+a[5]*n+a[9]*i+a[13],this.z=a[2]*e+a[6]*n+a[10]*i+a[14],this},transformCoordinates:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,s=e*a[0]+n*a[4]+i*a[8]+a[12],r=e*a[1]+n*a[5]+i*a[9]+a[13],o=e*a[2]+n*a[6]+i*a[10]+a[14],h=e*a[3]+n*a[7]+i*a[11]+a[15];return this.x=s/h,this.y=r/h,this.z=o/h,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,s=t.y,r=t.z,o=t.w,h=o*e+s*i-r*n,c=o*n+r*e-a*i,l=o*i+a*n-s*e,u=-a*e-s*n-r*i;return this.x=h*o+u*-a+c*-r-l*-s,this.y=c*o+u*-s+l*-a-h*-r,this.z=l*o+u*-r+h*-s-c*-a,this},project:function(t){var e=this.x,n=this.y,i=this.z,a=t.val,s=a[0],r=a[1],o=a[2],h=a[3],c=a[4],l=a[5],u=a[6],d=a[7],p=a[8],f=a[9],g=a[10],m=a[11],v=a[12],y=a[13],S=a[14],A=1/(e*h+n*d+i*m+a[15]);return this.x=(e*s+n*c+i*p+v)*A,this.y=(e*r+n*l+i*f+y)*A,this.z=(e*o+n*u+i*g+S)*A,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var n=t.x,i=t.y,a=t.z,s=t.w,r=this.x-n,o=s-this.y-1-i,h=this.z;return this.x=2*r/a-1,this.y=2*o/s-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0,0),i.LEFT=new i(-1,0,0),i.UP=new i(0,-1,0),i.DOWN=new i(0,1,0),i.FORWARD=new i(0,0,1),i.BACK=new i(0,0,-1),i.ONE=new i(1,1,1),t.exports=i},function(t,e){t.exports={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19}},function(t,e,n){var i=n(24),a=n(57);t.exports=function(t,e){var n;if(void 0===e&&(e=90),!i(t))return null;if("string"!=typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)BI()(n=t=a(t)).call(n);else if(-90===e||270===e||"rotateRight"===e)BI()(t).call(t),t=a(t);else if(180===Math.abs(e)||"rotate180"===e){for(var s=0;s<t.length;s++){var r;BI()(r=t[s]).call(r)}BI()(t).call(t)}return t}},function(t,e){t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}},function(t,e){t.exports=function(t,e){return Math.random()*(e-t)+t}},function(t,e,n){var i=n(4);t.exports=function(t){return t*i.DEG_TO_RAD}},function(t,e,n){var i=n(0),a=n(14),s=new i({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new s(this)},set:function(t){return this.copy(t)},setValues:function(t,e,n,i,a,s,r,o,h,c,l,u,d,p,f,g){var m=this.val;return m[0]=t,m[1]=e,m[2]=n,m[3]=i,m[4]=a,m[5]=s,m[6]=r,m[7]=o,m[8]=h,m[9]=c,m[10]=l,m[11]=u,m[12]=d,m[13]=p,m[14]=f,m[15]=g,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,n){var i=r.fromQuat(n).val,a=e.x,s=e.y,o=e.z;return this.setValues(i[0]*a,i[1]*a,i[2]*a,0,i[4]*s,i[5]*s,i[6]*s,0,i[8]*o,i[9]*o,i[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,n){this.identity();var i=this.val;return i[12]=t,i[13]=e,i[14]=n,this},scaling:function(t,e,n){this.zero();var i=this.val;return i[0]=t,i[5]=e,i[10]=n,i[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[3],a=t[6],s=t[7],r=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=a,t[11]=t[14],t[12]=i,t[13]=s,t[14]=r,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15],v=e*r-n*s,y=e*o-i*s,S=e*h-a*s,A=n*o-i*r,E=n*h-a*r,x=i*h-a*o,b=c*f-l*p,T=c*g-u*p,w=c*m-d*p,M=l*g-u*f,C=l*m-d*f,P=u*m-d*g,I=v*P-y*C+S*M+A*w-E*T+x*b;return I?(I=1/I,this.setValues((r*P-o*C+h*M)*I,(i*C-n*P-a*M)*I,(f*x-g*E+m*A)*I,(u*E-l*x-d*A)*I,(o*w-s*P-h*T)*I,(e*P-i*w+a*T)*I,(g*S-p*x-m*y)*I,(c*x-u*S+d*y)*I,(s*C-r*w+h*b)*I,(n*w-e*C-a*b)*I,(p*E-f*S+m*v)*I,(l*S-c*E-d*v)*I,(r*T-s*M-o*b)*I,(e*M-n*T+i*b)*I,(f*y-p*A-g*v)*I,(c*A-l*y+u*v)*I)):this},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15];return this.setValues(r*(u*m-d*g)-l*(o*m-h*g)+f*(o*d-h*u),-(n*(u*m-d*g)-l*(i*m-a*g)+f*(i*d-a*u)),n*(o*m-h*g)-r*(i*m-a*g)+f*(i*h-a*o),-(n*(o*d-h*u)-r*(i*d-a*u)+l*(i*h-a*o)),-(s*(u*m-d*g)-c*(o*m-h*g)+p*(o*d-h*u)),e*(u*m-d*g)-c*(i*m-a*g)+p*(i*d-a*u),-(e*(o*m-h*g)-s*(i*m-a*g)+p*(i*h-a*o)),e*(o*d-h*u)-s*(i*d-a*u)+c*(i*h-a*o),s*(l*m-d*f)-c*(r*m-h*f)+p*(r*d-h*l),-(e*(l*m-d*f)-c*(n*m-a*f)+p*(n*d-a*l)),e*(r*m-h*f)-s*(n*m-a*f)+p*(n*h-a*r),-(e*(r*d-h*l)-s*(n*d-a*l)+c*(n*h-a*r)),-(s*(l*g-u*f)-c*(r*g-o*f)+p*(r*u-o*l)),e*(l*g-u*f)-c*(n*g-i*f)+p*(n*u-i*l),-(e*(r*g-o*f)-s*(n*g-i*f)+p*(n*o-i*r)),e*(r*u-o*l)-s*(n*u-i*l)+c*(n*o-i*r))},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],g=t[14],m=t[15];return(e*r-n*s)*(u*m-d*g)-(e*o-i*s)*(l*m-d*f)+(e*h-a*s)*(l*g-u*f)+(n*o-i*r)*(c*m-d*p)-(n*h-a*r)*(c*g-u*p)+(i*h-a*o)*(c*f-l*p)},multiply:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],s=e[3],r=e[4],o=e[5],h=e[6],c=e[7],l=e[8],u=e[9],d=e[10],p=e[11],f=e[12],g=e[13],m=e[14],v=e[15],y=t.val,S=y[0],A=y[1],E=y[2],x=y[3];return e[0]=S*n+A*r+E*l+x*f,e[1]=S*i+A*o+E*u+x*g,e[2]=S*a+A*h+E*d+x*m,e[3]=S*s+A*c+E*p+x*v,S=y[4],A=y[5],E=y[6],x=y[7],e[4]=S*n+A*r+E*l+x*f,e[5]=S*i+A*o+E*u+x*g,e[6]=S*a+A*h+E*d+x*m,e[7]=S*s+A*c+E*p+x*v,S=y[8],A=y[9],E=y[10],x=y[11],e[8]=S*n+A*r+E*l+x*f,e[9]=S*i+A*o+E*u+x*g,e[10]=S*a+A*h+E*d+x*m,e[11]=S*s+A*c+E*p+x*v,S=y[12],A=y[13],E=y[14],x=y[15],e[12]=S*n+A*r+E*l+x*f,e[13]=S*i+A*o+E*u+x*g,e[14]=S*a+A*h+E*d+x*m,e[15]=S*s+A*c+E*p+x*v,this},multiplyLocal:function(t){var e=this.val,n=t.val;return this.setValues(e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12],e[0]*n[1]+e[1]*n[5]+e[2]*n[9]+e[3]*n[13],e[0]*n[2]+e[1]*n[6]+e[2]*n[10]+e[3]*n[14],e[0]*n[3]+e[1]*n[7]+e[2]*n[11]+e[3]*n[15],e[4]*n[0]+e[5]*n[4]+e[6]*n[8]+e[7]*n[12],e[4]*n[1]+e[5]*n[5]+e[6]*n[9]+e[7]*n[13],e[4]*n[2]+e[5]*n[6]+e[6]*n[10]+e[7]*n[14],e[4]*n[3]+e[5]*n[7]+e[6]*n[11]+e[7]*n[15],e[8]*n[0]+e[9]*n[4]+e[10]*n[8]+e[11]*n[12],e[8]*n[1]+e[9]*n[5]+e[10]*n[9]+e[11]*n[13],e[8]*n[2]+e[9]*n[6]+e[10]*n[10]+e[11]*n[14],e[8]*n[3]+e[9]*n[7]+e[10]*n[11]+e[11]*n[15],e[12]*n[0]+e[13]*n[4]+e[14]*n[8]+e[15]*n[12],e[12]*n[1]+e[13]*n[5]+e[14]*n[9]+e[15]*n[13],e[12]*n[2]+e[13]*n[6]+e[14]*n[10]+e[15]*n[14],e[12]*n[3]+e[13]*n[7]+e[14]*n[11]+e[15]*n[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.val,i=e.val,a=n[0],s=n[4],r=n[8],o=n[12],h=n[1],c=n[5],l=n[9],u=n[13],d=n[2],p=n[6],f=n[10],g=n[14],m=n[3],v=n[7],y=n[11],S=n[15],A=i[0],E=i[4],x=i[8],b=i[12],T=i[1],w=i[5],M=i[9],C=i[13],P=i[2],I=i[6],k=i[10],R=i[14],O=i[3],_=i[7],D=i[11],B=i[15];return this.setValues(a*A+s*T+r*P+o*O,h*A+c*T+l*P+u*O,d*A+p*T+f*P+g*O,m*A+v*T+y*P+S*O,a*E+s*w+r*I+o*_,h*E+c*w+l*I+u*_,d*E+p*w+f*I+g*_,m*E+v*w+y*I+S*_,a*x+s*M+r*k+o*D,h*x+c*M+l*k+u*D,d*x+p*M+f*k+g*D,m*x+v*M+y*k+S*D,a*b+s*C+r*R+o*B,h*b+c*C+l*R+u*B,d*b+p*C+f*R+g*B,m*b+v*C+y*R+S*B)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,n){var i=this.val;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,n){var i=this.val;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),a=1-n,s=t.x,r=t.y,o=t.z,h=a*s,c=a*r;return this.setValues(h*s+n,h*r-i*o,h*o+i*r,0,h*r+i*o,c*r+n,c*o-i*s,0,h*o-i*r,c*o+i*s,a*o*o+n,0,0,0,0,1)},rotate:function(t,e){var n=this.val,i=e.x,a=e.y,s=e.z,r=Math.sqrt(i*i+a*a+s*s);if(Math.abs(r)<1e-6)return this;i*=r=1/r,a*=r,s*=r;var o=Math.sin(t),h=Math.cos(t),c=1-h,l=n[0],u=n[1],d=n[2],p=n[3],f=n[4],g=n[5],m=n[6],v=n[7],y=n[8],S=n[9],A=n[10],E=n[11],x=n[12],b=n[13],T=n[14],w=n[15],M=i*i*c+h,C=a*i*c+s*o,P=s*i*c-a*o,I=i*a*c-s*o,k=a*a*c+h,R=s*a*c+i*o,O=i*s*c+a*o,_=a*s*c-i*o,D=s*s*c+h;return this.setValues(l*M+f*C+y*P,u*M+g*C+S*P,d*M+m*C+A*P,p*M+v*C+E*P,l*I+f*k+y*R,u*I+g*k+S*R,d*I+m*k+A*R,p*I+v*k+E*R,l*O+f*_+y*D,u*O+g*_+S*D,d*O+m*_+A*D,p*O+v*_+E*D,x,b,T,w)},rotateX:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],r=e[6],o=e[7],h=e[8],c=e[9],l=e[10],u=e[11];return e[4]=a*i+h*n,e[5]=s*i+c*n,e[6]=r*i+l*n,e[7]=o*i+u*n,e[8]=h*i-a*n,e[9]=c*i-s*n,e[10]=l*i-r*n,e[11]=u*i-o*n,this},rotateY:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],r=e[2],o=e[3],h=e[8],c=e[9],l=e[10],u=e[11];return e[0]=a*i-h*n,e[1]=s*i-c*n,e[2]=r*i-l*n,e[3]=o*i-u*n,e[8]=a*n+h*i,e[9]=s*n+c*i,e[10]=r*n+l*i,e[11]=o*n+u*i,this},rotateZ:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],r=e[2],o=e[3],h=e[4],c=e[5],l=e[6],u=e[7];return e[0]=a*i+h*n,e[1]=s*i+c*n,e[2]=r*i+l*n,e[3]=o*i+u*n,e[4]=h*i-a*n,e[5]=c*i-s*n,e[6]=l*i-r*n,e[7]=u*i-o*n,this},fromRotationTranslation:function(t,e){var n=t.x,i=t.y,a=t.z,s=t.w,r=n+n,o=i+i,h=a+a,c=n*r,l=n*o,u=n*h,d=i*o,p=i*h,f=a*h,g=s*r,m=s*o,v=s*h;return this.setValues(1-(d+f),l+v,u-m,0,l-v,1-(c+f),p+g,0,u+m,p-g,1-(c+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,a=t.w,s=e+e,r=n+n,o=i+i,h=e*s,c=e*r,l=e*o,u=n*r,d=n*o,p=i*o,f=a*s,g=a*r,m=a*o;return this.setValues(1-(u+p),c+m,l-g,0,c-m,1-(h+p),d+f,0,l+g,d-f,1-(h+u),0,0,0,0,1)},frustum:function(t,e,n,i,a,s){var r=1/(e-t),o=1/(i-n),h=1/(a-s);return this.setValues(2*a*r,0,0,0,0,2*a*o,0,0,(e+t)*r,(i+n)*o,(s+a)*h,-1,0,0,s*a*2*h,0)},perspective:function(t,e,n,i){var a=1/Math.tan(t/2),s=1/(n-i);return this.setValues(a/e,0,0,0,0,a,0,0,0,0,(i+n)*s,-1,0,0,2*i*n*s,0)},perspectiveLH:function(t,e,n,i){return this.setValues(2*n/t,0,0,0,0,2*n/e,0,0,0,0,-i/(n-i),1,0,0,n*i/(n-i),0)},ortho:function(t,e,n,i,a,s){var r=0===(r=t-e)?r:1/r,o=0===(o=n-i)?o:1/o,h=0===(h=a-s)?h:1/h;return this.setValues(-2*r,0,0,0,0,-2*o,0,0,0,0,2*h,0,(t+e)*r,(i+n)*o,(s+a)*h,1)},lookAtRH:function(t,e,n){var i=this.val;return l.subVectors(t,e),0===l.getLengthSquared()&&(l.z=1),l.normalize(),h.crossVectors(n,l),0===h.getLengthSquared()&&(1===Math.abs(n.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),h.crossVectors(n,l)),h.normalize(),c.crossVectors(l,h),i[0]=h.x,i[1]=h.y,i[2]=h.z,i[4]=c.x,i[5]=c.y,i[6]=c.z,i[8]=l.x,i[9]=l.y,i[10]=l.z,this},lookAt:function(t,e,n){var i=t.x,a=t.y,s=t.z,r=n.x,o=n.y,h=n.z,c=e.x,l=e.y,u=e.z;if(Math.abs(i-c)<1e-6&&Math.abs(a-l)<1e-6&&Math.abs(s-u)<1e-6)return this.identity();var d=i-c,p=a-l,f=s-u,g=1/Math.sqrt(d*d+p*p+f*f),m=o*(f*=g)-h*(p*=g),v=h*(d*=g)-r*f,y=r*p-o*d;(g=Math.sqrt(m*m+v*v+y*y))?(m*=g=1/g,v*=g,y*=g):y=v=m=0;var S=p*y-f*v,A=f*m-d*y,E=d*v-p*m;return(g=Math.sqrt(S*S+A*A+E*E))?(S*=g=1/g,A*=g,E*=g):E=A=S=0,this.setValues(m,S,d,0,v,A,p,0,y,E,f,0,-(m*i+v*a+y*s),-(S*i+A*a+E*s),-(d*i+p*a+f*s),1)},yawPitchRoll:function(t,e,n){this.zero(),r.zero(),o.zero();var i=this.val,a=r.val,s=o.val,h=Math.sin(n),c=Math.cos(n);return i[10]=1,i[15]=1,i[0]=c,i[1]=h,i[4]=-h,i[5]=c,h=Math.sin(e),c=Math.cos(e),a[0]=1,a[15]=1,a[5]=c,a[10]=c,a[9]=-h,a[6]=h,h=Math.sin(t),c=Math.cos(t),s[5]=1,s[15]=1,s[0]=c,s[2]=-h,s[8]=h,s[10]=c,this.multiplyLocal(r),this.multiplyLocal(o),this},setWorldMatrix:function(t,e,n,i,a){return this.yawPitchRoll(t.y,t.x,t.z),r.scaling(n.x,n.y,n.z),o.xyz(e.x,e.y,e.z),this.multiplyLocal(r),this.multiplyLocal(o),i&&this.multiplyLocal(i),a&&this.multiplyLocal(a),this},multiplyToMat4:function(t,e){var n=this.val,i=t.val,a=n[0],s=n[1],r=n[2],o=n[3],h=n[4],c=n[5],l=n[6],u=n[7],d=n[8],p=n[9],f=n[10],g=n[11],m=n[12],v=n[13],y=n[14],S=n[15],A=i[0],E=i[1],x=i[2],b=i[3],T=i[4],w=i[5],M=i[6],C=i[7],P=i[8],I=i[9],k=i[10],R=i[11],O=i[12],_=i[13],D=i[14],B=i[15];return e.setValues(A*a+E*h+x*d+b*m,E*s+E*c+x*p+b*v,x*r+E*l+x*f+b*y,b*o+E*u+x*g+b*S,T*a+w*h+M*d+C*m,T*s+w*c+M*p+C*v,T*r+w*l+M*f+C*y,T*o+w*u+M*g+C*S,P*a+I*h+k*d+R*m,P*s+I*c+k*p+R*v,P*r+I*l+k*f+R*y,P*o+I*u+k*g+R*S,O*a+_*h+D*d+B*m,O*s+_*c+D*p+B*v,O*r+_*l+D*f+B*y,O*o+_*u+D*g+B*S)},fromRotationXYTranslation:function(t,e,n){var i=e.x,a=e.y,s=e.z,r=Math.sin(t.x),o=Math.cos(t.x),h=Math.sin(t.y),c=Math.cos(t.y),l=i,u=a,d=s,p=-r,f=0-p*h,g=0-o*h,m=p*c,v=o*c;return n||(l=c*i+h*s,u=f*i+o*a+m*s,d=g*i+r*a+v*s),this.setValues(c,f,g,0,0,o,r,0,h,m,v,0,l,u,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}}),r=new s,o=new s,h=new a,c=new a,l=new a;t.exports=s},function(t,e,n){var i=n(0),a=n(15),s=n(205),r=n(11),o=n(216),h=n(45),c=n(217),l=n(46),u=new i({initialize:function(t,e){this.loader=t,this.cache=r(e,"cache",!1),this.type=r(e,"type",!1),this.key=r(e,"key",!1);var n=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+n),!this.type||!this.key)throw new Error("Invalid Loader."+this.type+" key");var i=r(e,"url");void 0===i?i=t.path+n+"."+r(e,"extension",""):"string"!=typeof i||i.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)||(i=t.path+i),this.url=i,this.src="",this.xhrSettings=l(r(e,"responseType",void 0)),r(e,"xhrSettings",!1)&&(this.xhrSettings=h(this.xhrSettings,r(e,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?a.FILE_POPULATED:a.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=r(e,"config",{}),this.multiFile,this.linkFile},setLink:function(t){(this.linkFile=t).linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){var t;this.state===a.FILE_POPULATED?this.loader.nextFile(this,!0):(this.state=a.FILE_LOADING,this.src=o(this,this.loader.baseURL),0===g()(t=this.src).call(t,"data:")||(this.xhrLoader=c(this,this.loader.xhr)))},onLoad:function(t,e){var n,i=t.responseURL&&0===g()(n=t.responseURL).call(n,"file://")&&0===e.target.status,s=!(e.target&&200!==e.target.status)||i;4===t.readyState&&400<=t.status&&t.status<=599&&(s=!1),this.state=a.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,s)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=a.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=a.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=a.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.cache.add(this.key,this.data),this.pendingDestroy()},pendingDestroy:function(t){void 0===t&&(t=this.data);var e=this.key,n=this.type;this.loader.emit(s.FILE_COMPLETE,e,n,t),this.loader.emit(s.FILE_KEY_COMPLETE+n+"-"+e,e,n,t),this.loader.flagForRemoval(this)},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});u.createObjectURL=function(t,e,n){var i;"function"==typeof FI()?t.src=FI().createObjectURL(e):((i=new FileReader).onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=t.onerror,i.readAsDataURL(e))},u.revokeObjectURL=function(t){"function"==typeof FI()&&FI().revokeObjectURL(t.src)},t.exports=u},function(t,e){var n={},i={install:function(t){for(var e in n)t[e]=n[e]},register:function(t,e){n[t]=e},destroy:function(){n={}}};t.exports=i},function(t,e,n){var i=n(0),a=n(4),s=n(2),r=new i({initialize:function(t,e,n,i,a,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===a&&(a=0),void 0===s&&(s=0),this.matrix=new Float32Array([t,e,n,i,a,s,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],s=t[3];return e||n?0<n?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):i||s?a.TAU-(0<s?Math.acos(-i/this.scaleY):-Math.acos(i/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var n=this.matrix;return n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this},scale:function(t,e){var n=this.matrix;return n[0]*=t,n[1]*=t,n[2]*=e,n[3]*=e,this},rotate:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.matrix,a=i[0],s=i[1],r=i[2],o=i[3];return i[0]=a*n+r*e,i[1]=s*n+o*e,i[2]=a*-e+r*n,i[3]=s*-e+o*n,this},multiply:function(t,e){var n=this.matrix,i=t.matrix,a=n[0],s=n[1],r=n[2],o=n[3],h=n[4],c=n[5],l=i[0],u=i[1],d=i[2],p=i[3],f=i[4],g=i[5],m=void 0===e?this:e;return m.a=l*a+u*r,m.b=l*s+u*o,m.c=d*a+p*r,m.d=d*s+p*o,m.e=f*a+g*r+h,m.f=f*s+g*o+c,m},multiplyWithOffset:function(t,e,n){var i=this.matrix,a=t.matrix,s=i[0],r=i[1],o=i[2],h=i[3],c=e*s+n*o+i[4],l=e*r+n*h+i[5],u=a[0],d=a[1],p=a[2],f=a[3],g=a[4],m=a[5];return i[0]=u*s+d*o,i[1]=u*r+d*h,i[2]=p*s+f*o,i[3]=p*r+f*h,i[4]=g*s+m*o+c,i[5]=g*r+m*h+l,this},transform:function(t,e,n,i,a,s){var r=this.matrix,o=r[0],h=r[1],c=r[2],l=r[3],u=r[4],d=r[5];return r[0]=t*o+e*c,r[1]=t*h+e*l,r[2]=n*o+i*c,r[3]=n*h+i*l,r[4]=a*o+s*c+u,r[5]=a*h+s*l+d,this},transformPoint:function(t,e,n){void 0===n&&(n={x:0,y:0});var i=this.matrix,a=i[0],s=i[1],r=i[2],o=i[3],h=i[4],c=i[5];return n.x=t*a+e*r+h,n.y=t*s+e*o+c,n},invert:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=e*a-n*i;return t[0]=a/o,t[1]=-n/o,t[2]=-i/o,t[3]=e/o,t[4]=(i*r-a*s)/o,t[5]=-(e*r-n*s)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){var e=this.matrix;return t.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,n,i,a,s){var r=this.matrix;return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r[4]=a,r[5]=s,this},decomposeMatrix:function(){var t,e,n=this.decomposedMatrix,i=this.matrix,a=i[0],s=i[1],r=i[2],o=i[3],h=a*o-s*r;return n.translateX=i[4],n.translateY=i[5],a||s?(t=Math.sqrt(a*a+s*s),n.rotation=0<s?Math.acos(a/t):-Math.acos(a/t),n.scaleX=t,n.scaleY=h/t):r||o?(e=Math.sqrt(r*r+o*o),n.rotation=.5*Math.PI-(0<o?Math.acos(-r/e):-Math.acos(r/e)),n.scaleX=h/e,n.scaleY=e):(n.rotation=0,n.scaleX=0,n.scaleY=0),n},applyITRS:function(t,e,n,i,a){var s=this.matrix,r=Math.sin(n),o=Math.cos(n);return s[4]=t,s[5]=e,s[0]=o*i,s[1]=r*i,s[2]=-r*a,s[3]=o*a,this},applyInverse:function(t,e,n){void 0===n&&(n=new s);var i=this.matrix,a=i[0],r=i[1],o=i[2],h=i[3],c=i[4],l=i[5],u=1/(a*h+o*-r);return n.x=h*u*t+-o*u*e+(l*o-c*h)*u,n.y=a*u*e+-r*u*t+(-l*a+c*r)*u,n},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,n){var i=this.getX(t,e);return n&&(i=Math.round(i)),i},getYRound:function(t,e,n){var i=this.getY(t,e);return n&&(i=Math.round(i)),i},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.decomposedMatrix=null}});t.exports=r},function(t,e){t.exports=function(t){if(!Array.isArray(t)||t.length<2||!Array.isArray(t[0]))return!1;for(var e=t[0].length,n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0}},function(t,e,n){var i=n(0),a=n(299),s=n(61),r=n(300),o=n(26),h=n(301),c=n(306),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=o.RECTANGLE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return a(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return r(this,t,e,n)},getRandomPoint:function(t){return c(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new h),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new h),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new h),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new h),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=l},function(t,e){t.exports={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}},function(t,e,n){var i=n(7);t.exports=function t(){var e,n,a,s,r,o,h=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof h&&(u=h,h=arguments[1]||{},c=2),l===c&&(h=this,--c);c<l;c++)if(null!=(e=arguments[c]))for(n in e)a=h[n],h!==(s=e[n])&&(u&&s&&(i(s)||(r=Array.isArray(s)))?(o=r?(r=!1,a&&Array.isArray(a)?a:[]):a&&i(a)?a:{},h[n]=t(u,o,s)):void 0!==s&&(h[n]=s));return h}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(i-e,n-t)}},function(t,e){t.exports=function(t){return 0<=(t%=2*Math.PI)?t:t+2*Math.PI}},function(t,e,n){var i=n(6);t.exports=function(t){return i(t,-Math.PI,Math.PI)}},function(t,e,n){var i=n(6);t.exports=function(t){return i(t,-180,180)}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}},function(t,e,n){var i=n(34);t.exports=function(t,e){return i(t)/i(e)/i(t-e)}},function(t,e){t.exports=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}},function(t,e){t.exports=function(t,e,n,i,a){var s=.5*(i-e),r=.5*(a-n),o=t*t;return(2*n-2*i+s+r)*(t*o)+(-3*n+3*i-2*s-r)*o+s*t+n}},function(t,e){t.exports=function(t,e,n){return(e-t)*n+t}},function(t,e){t.exports=function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)}},function(t,e){t.exports=function(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}},function(t,e){t.exports=function(t,e,n,i){var a=Math.cos(i),s=Math.sin(i),r=t.x-e,o=t.y-n;return t.x=r*a-o*s+e,t.y=r*s+o*a+n,t}},function(t,e){t.exports=function(t){return 0<t?Math.ceil(t):Math.floor(t)}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,a,s,r,o,h){void 0===h&&(h=new i);var c=Math.sin(s),l=Math.cos(s),u=l*r,d=c*r,p=-c*o,f=l*o,g=1/(u*f+p*-d);return h.x=f*g*t+-p*g*e+(a*p-n*f)*g,h.y=u*g*e+-d*g*t+(-a*u+n*d)*g,h}},function(t,e,n){var i=new(n(0))({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},fromMat4:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],h=t[7],c=t[8],l=c*s-r*h,u=-c*a+r*o,d=h*a-s*o,p=e*l+n*u+i*d;return p?(p=1/p,t[0]=l*p,t[1]=(-c*n+i*h)*p,t[2]=(r*n-i*s)*p,t[3]=u*p,t[4]=(c*e-i*o)*p,t[5]=(-r*e+i*a)*p,t[6]=d*p,t[7]=(-h*e+n*o)*p,t[8]=(s*e-n*a)*p,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],h=t[7],c=t[8];return t[0]=s*c-r*h,t[1]=i*h-n*c,t[2]=n*r-i*s,t[3]=r*o-a*c,t[4]=e*c-i*o,t[5]=i*a-e*r,t[6]=a*h-s*o,t[7]=n*o-e*h,t[8]=e*s-n*a,this},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],a=t[3],s=t[4],r=t[5],o=t[6],h=t[7],c=t[8];return e*(c*s-r*h)+n*(-c*a+r*o)+i*(h*a-s*o)},multiply:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],s=e[3],r=e[4],o=e[5],h=e[6],c=e[7],l=e[8],u=t.val,d=u[0],p=u[1],f=u[2],g=u[3],m=u[4],v=u[5],y=u[6],S=u[7],A=u[8];return e[0]=d*n+p*s+f*h,e[1]=d*i+p*r+f*c,e[2]=d*a+p*o+f*l,e[3]=g*n+m*s+v*h,e[4]=g*i+m*r+v*c,e[5]=g*a+m*o+v*l,e[6]=y*n+S*s+A*h,e[7]=y*i+S*r+A*c,e[8]=y*a+S*o+A*l,this},translate:function(t){var e=this.val,n=t.x,i=t.y;return e[6]=n*e[0]+i*e[3]+e[6],e[7]=n*e[1]+i*e[4]+e[7],e[8]=n*e[2]+i*e[5]+e[8],this},rotate:function(t){var e=this.val,n=e[0],i=e[1],a=e[2],s=e[3],r=e[4],o=e[5],h=Math.sin(t),c=Math.cos(t);return e[0]=c*n+h*s,e[1]=c*i+h*r,e[2]=c*a+h*o,e[3]=c*s-h*n,e[4]=c*r-h*i,e[5]=c*o-h*a,this},scale:function(t){var e=this.val,n=t.x,i=t.y;return e[0]=n*e[0],e[1]=n*e[1],e[2]=n*e[2],e[3]=i*e[3],e[4]=i*e[4],e[5]=i*e[5],this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,a=t.w,s=e+e,r=n+n,o=i+i,h=e*s,c=e*r,l=e*o,u=n*r,d=n*o,p=i*o,f=a*s,g=a*r,m=a*o,v=this.val;return v[0]=1-(u+p),v[3]=c+m,v[6]=l-g,v[1]=c-m,v[4]=1-(h+p),v[7]=d+f,v[2]=l+g,v[5]=d-f,v[8]=1-(h+u),this},normalFromMat4:function(t){var e=t.val,n=this.val,i=e[0],a=e[1],s=e[2],r=e[3],o=e[4],h=e[5],c=e[6],l=e[7],u=e[8],d=e[9],p=e[10],f=e[11],g=e[12],m=e[13],v=e[14],y=e[15],S=i*h-a*o,A=i*c-s*o,E=i*l-r*o,x=a*c-s*h,b=a*l-r*h,T=s*l-r*c,w=u*m-d*g,M=u*v-p*g,C=u*y-f*g,P=d*v-p*m,I=d*y-f*m,k=p*y-f*v,R=S*k-A*I+E*P+x*C-b*M+T*w;return R?(R=1/R,n[0]=(h*k-c*I+l*P)*R,n[1]=(c*C-o*k-l*M)*R,n[2]=(o*I-h*C+l*w)*R,n[3]=(s*I-a*k-r*P)*R,n[4]=(i*k-s*C+r*M)*R,n[5]=(a*C-i*I-r*w)*R,n[6]=(m*T-v*b+y*x)*R,n[7]=(v*E-g*T-y*A)*R,n[8]=(g*b-m*E+y*S)*R,this):null}});t.exports=i},function(t,e,n){var i=n(0),a=n(42),s=n(1),r=n(14),o=new Int8Array([1,2,0]),h=new Float32Array([0,0,0]),c=new r(1,0,0),l=new r(0,1,0),u=new r,d=new a,p=new i({initialize:function(t,e,n,i){this.onChangeCallback=s,this.set(t,e,n,i)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,n,i,a){return void 0===a&&(a=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=n||0,this._w=i||0),a&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i;return 0<a&&(a=1/Math.sqrt(a),this._x=t*a,this._y=e*a,this._z=n*a,this._w=i*a),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z,s=this.w;return this.set(n+e*(t.x-n),i+e*(t.y-i),a+e*(t.z-a),s+e*(t.w-s))},rotationTo:function(t,e){var n=t.x*e.x+t.y*e.y+t.z*e.z;return n<-.999999?(u.copy(c).cross(t).length()<1e-6&&u.copy(l).cross(t),u.normalize(),this.setAxisAngle(u,Math.PI)):.999999<n?this.set(0,0,0,1):(u.copy(t).cross(e),this._x=u.x,this._y=u.y,this._z=u.z,this._w=1+n,this.normalize())},setAxes:function(t,e,n){var i=d.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=n.x,i[4]=n.y,i[7]=n.z,i[2]=-t.x,i[5]=-t.y,i[8]=-t.z,this.fromMat3(d).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var n=Math.sin(e);return this.set(n*t.x,n*t.y,n*t.z,Math.cos(e))},multiply:function(t){var e=this.x,n=this.y,i=this.z,a=this.w,s=t.x,r=t.y,o=t.z,h=t.w;return this.set(e*h+a*s+n*o-i*r,n*h+a*r+i*s-e*o,i*h+a*o+e*r-n*s,a*h-e*s-n*r-i*o)},slerp:function(t,e){var n=this.x,i=this.y,a=this.z,s=this.w,r=t.x,o=t.y,h=t.z,c=t.w,l=n*r+i*o+a*h+s*c;l<0&&(l=-l,r=-r,o=-o,h=-h,c=-c);var u,d,p=1-e,f=e;return 1e-6<1-l&&(u=Math.acos(l),d=Math.sin(u),p=Math.sin((1-e)*u)/d,f=Math.sin(e*u)/d),this.set(p*n+f*r,p*i+f*o,p*a+f*h,p*s+f*c)},invert:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i,s=a?1/a:0;return this.set(-t*s,-e*s,-n*s,i*s)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,s=Math.sin(t),r=Math.cos(t);return this.set(e*r+a*s,n*r+i*s,i*r-n*s,a*r-e*s)},rotateY:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,s=Math.sin(t),r=Math.cos(t);return this.set(e*r-i*s,n*r+a*s,i*r+e*s,a*r-n*s)},rotateZ:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,a=this.w,s=Math.sin(t),r=Math.cos(t);return this.set(e*r+n*s,n*r-e*s,i*r+a*s,a*r-i*s)},calculateW:function(){var t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(1-t*t-e*e-n*n),this},setFromEuler:function(t,e){var n=t.x/2,i=t.y/2,a=t.z/2,s=Math.cos(n),r=Math.cos(i),o=Math.cos(a),h=Math.sin(n),c=Math.sin(i),l=Math.sin(a);switch(t.order){case"XYZ":this.set(h*r*o+s*c*l,s*c*o-h*r*l,s*r*l+h*c*o,s*r*o-h*c*l,e);break;case"YXZ":this.set(h*r*o+s*c*l,s*c*o-h*r*l,s*r*l-h*c*o,s*r*o+h*c*l,e);break;case"ZXY":this.set(h*r*o-s*c*l,s*c*o+h*r*l,s*r*l+h*c*o,s*r*o-h*c*l,e);break;case"ZYX":this.set(h*r*o-s*c*l,s*c*o+h*r*l,s*r*l-h*c*o,s*r*o+h*c*l,e);break;case"YZX":this.set(h*r*o+s*c*l,s*c*o+h*r*l,s*r*l-h*c*o,s*r*o-h*c*l,e);break;case"XZY":this.set(h*r*o-s*c*l,s*c*o-h*r*l,s*r*l+h*c*o,s*r*o+h*c*l,e)}return this},setFromRotationMatrix:function(t){var e,n=t.val,i=n[0],a=n[4],s=n[8],r=n[1],o=n[5],h=n[9],c=n[2],l=n[6],u=n[10],d=i+o+u;return 0<d?(e=.5/Math.sqrt(d+1),this.set((l-h)*e,(s-c)*e,(r-a)*e,.25/e)):o<i&&u<i?(e=2*Math.sqrt(1+i-o-u),this.set(.25*e,(a+r)/e,(s+c)/e,(l-h)/e)):u<o?(e=2*Math.sqrt(1+o-i-u),this.set((a+r)/e,.25*e,(h+l)/e,(s-c)/e)):(e=2*Math.sqrt(1+u-i-o),this.set((s+c)/e,(h+l)/e,.25*e,(r-a)/e)),this},fromMat3:function(t){var e,n,i,a,s=t.val,r=s[0]+s[4]+s[8];return 0<r?(a=Math.sqrt(r+1),this.w=.5*a,a=.5/a,this._x=(s[7]-s[5])*a,this._y=(s[2]-s[6])*a,this._z=(s[3]-s[1])*a):(e=0,s[4]>s[0]&&(e=1),s[8]>s[3*e+e]&&(e=2),n=o[e],i=o[n],a=Math.sqrt(s[3*e+e]-s[3*n+n]-s[3*i+i]+1),h[e]=.5*a,a=.5/a,h[n]=(s[3*n+e]+s[3*e+n])*a,h[i]=(s[3*i+e]+s[3*e+i])*a,this._x=h[0],this._y=h[1],this._z=h[2],this._w=(s[3*i+n]-s[3*n+i])*a),this.onChangeCallback(this),this}});t.exports=p},function(t,e,n){t.exports={ADDED_TO_SCENE:n(180),BOOT:n(181),CREATE:n(182),DESTROY:n(183),PAUSE:n(184),POST_UPDATE:n(185),PRE_RENDER:n(186),PRE_UPDATE:n(187),READY:n(188),REMOVED_FROM_SCENE:n(189),RENDER:n(190),RESUME:n(191),SHUTDOWN:n(192),SLEEP:n(193),START:n(194),TRANSITION_COMPLETE:n(195),TRANSITION_INIT:n(196),TRANSITION_OUT:n(197),TRANSITION_START:n(198),TRANSITION_WAKE:n(199),UPDATE:n(200),WAKE:n(201)}},function(t,e,n){var i=n(27),a=n(46);t.exports=function(t,e){var n=void 0===t?a():i({},t);if(e)for(var s in e)void 0!==e[s]&&(n[s]=e[s]);return n}},function(t,e){t.exports=function(t,e,n,i,a,s){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=""),void 0===i&&(i=""),void 0===a&&(a=0),void 0===s&&(s=!1),{responseType:t,async:e,user:n,password:i,timeout:a,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:s}}},function(t,e){t.exports={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}},function(t,e){t.exports={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this}}},function(t,e){t.exports={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}},function(t,e){t.exports={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}},function(t,e,n){var i=n(4),a=n(23),s=n(41),r=n(30),o=n(31),h=n(2),c={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,0===(this._scaleY=t)?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){0===(this._scaleX=t)?this.renderFlags&=-5:this.renderFlags|=4}},scaleY:{get:function(){return this._scaleY},set:function(t){0===(this._scaleY=t)?this.renderFlags&=-5:this.renderFlags|=4}},angle:{get:function(){return o(this._rotation*i.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=r(t)}},setPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.w=i,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),this.x=t+Math.random()*n,this.y=e+Math.random()*i,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new a),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){void 0===t&&(t=new a),void 0===e&&(e=new a);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);for(t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)e.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),e.multiply(t,t),n=n.parentContainer;return t},getLocalPoint:function(t,e,n,i){n=n||new h;var a=(i=i||this.scene.sys.cameras.main).scrollX,r=i.scrollY,o=t+a*this.scrollFactorX-a,c=e+r*this.scrollFactorY-r;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(o,c,n):s(o,c,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};t.exports=c},function(t,e){t.exports={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}}},function(t,e,n){var i=n(0),a=n(54),s=n(222),r=n(229),o=n(55),h=n(44),c=new i({Extends:r,initialize:function(t,e){r.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(o.ADDED_TO_SCENE,this.addedToScene,this),this.on(o.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(t,e,n){return this.scene.sys.input.enable(this,t,e,n),this},disableInteractive:function(){return this.input&&(this.input.enabled=!1),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return a(this)},willRender:function(t){return!(c.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),(t=e).parentContainer);)e=e.parentContainer;return this.displayList?n.unshift(this.displayList.getIndex(t)):n.unshift(this.scene.sys.displayList.getIndex(t)),n},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||((this.displayList=t).add(this,!0),t.queueDepthSort(),this.emit(o.ADDED_TO_SCENE,this,this.scene),t.events.emit(h.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(o.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(h.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},destroy:function(){this.scene&&!this.ignoreDestroy&&(this.preDestroy&&this.preDestroy.call(this),this.emit(o.DESTROY,this),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});c.RENDER_MASK=15,t.exports=c},function(t,e){t.exports=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}},function(t,e,n){t.exports={ADDED_TO_SCENE:n(230),DESTROY:n(231),REMOVED_FROM_SCENE:n(232),VIDEO_COMPLETE:n(233),VIDEO_CREATED:n(234),VIDEO_ERROR:n(235),VIDEO_LOOP:n(236),VIDEO_PLAY:n(237),VIDEO_SEEKED:n(238),VIDEO_SEEKING:n(239),VIDEO_STOP:n(240),VIDEO_TIMEOUT:n(241),VIDEO_UNLOCKED:n(242)}},function(t,e,n){var i=n(23),a=new i,s=new i,r=new i,o={camera:a,sprite:s,calc:r};t.exports=function(t,e,n){var i=a,h=s,c=r;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=e.scrollX*t.scrollFactorX,h.f-=e.scrollY*t.scrollFactorY),i.multiply(h,c),o}},function(t,e){t.exports=function(t){for(var e=t.length,n=t[0].length,i=new Array(n),a=0;a<n;a++){i[a]=new Array(e);for(var s=e-1;-1<s;s--)i[a][s]=t[s][a]}return i}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.shift(),t.push(n);return n}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.pop(),t.unshift(n);return n}},function(t,e){t.exports=function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}},function(t,e,n){var i=n(62),a=n(13);t.exports=function(t,e,n){if(void 0===n&&(n=new a),e<=0||1<=e)return n.x=t.x,n.y=t.y,n;var s=i(t)*e;return.5<e?(s-=t.width+t.height)<=t.width?(n.x=t.right-s,n.y=t.bottom):(n.x=t.x,n.y=t.bottom-(s-t.width)):s<=t.width?(n.x=t.x+s,n.y=t.y):(n.x=t.right,n.y=t.y+(s-t.width)),n}},function(t,e){t.exports=function(t){return 2*(t.width+t.height)}},function(t,e,n){var i,a=n(64),s=n(0),r=n(10),o=n(177),h=n(178),c=n(202),l=n(203),u=n(221),d=n(254),p=n(1),f=new s({Extends:h,initialize:function(t,e,n){h.call(this,t,e,n);var i=e.game;this.isWebGL=2===i.config.renderType,this.cache=i.cache.addCustom("spine"),this.spineTextures=i.cache.addCustom("spineTextures"),this.json=i.cache.json,this.textures=i.textures,this.drawDebug=!1,this.gl,this.renderer,this.sceneRenderer,this.skeletonRenderer,this.skeletonDebugRenderer,this.plugin=c,this.temp1,this.temp2,this.isWebGL?(this.runtime=c.webgl,this.renderer=i.renderer,this.gl=i.renderer.gl,this.getAtlas=this.getAtlasWebGL):(this.runtime=c.canvas,this.renderer=i.renderer,this.getAtlas=this.getAtlasCanvas),this.renderer||(this.renderer={width:i.scale.width,height:i.scale.height,preRender:p,postRender:p,render:p,destroy:p}),e.registerFileType("spine",this.spineFileCallback,t),e.registerGameObject("spine",(function(t,e,i,a,s){var r=this.scene.sys[n],o=new u(this.scene,r,t,e,i,a,s);return this.displayList.add(o),this.updateList.add(o),o}),(function(t,e){void 0===t&&(t={});var i=r(t,"key",null),s=r(t,"animationName",null),o=r(t,"loop",!1),h=this.scene.sys[n],c=new u(this.scene,h,0,0,i,s,o);void 0!==e&&(t.add=e),a(this.scene,c,t);var l=r(t,"skinName",!1);l&&c.setSkinByName(l);var d=r(t,"slotName",!1),p=r(t,"attachmentName",null);return d&&c.setAttachment(d,p),c.refresh()})),e.registerGameObject("spineContainer",(function(t,e,i){var a=this.scene.sys[n],s=new d(this.scene,a,t,e,i);return this.displayList.add(s),s}),(function(t,e){void 0===t&&(t={});var i=r(t,"x",0),s=r(t,"y",0),o=r(t,"children",null),h=this.scene.sys[n],c=new d(this.scene,h,i,s,o);return void 0!==e&&(t.add=e),a(this.scene,c,t),c}))},boot:function(){this.isWebGL?(this.bootWebGL(),this.onResize(),this.game.scale.on(o,this.onResize,this)):this.bootCanvas();var t=this.systems.events;t.once("shutdown",this.shutdown,this),t.once("destroy",this.destroy,this),this.game.events.once("destroy",this.gameDestroy,this)},bootCanvas:function(){this.skeletonRenderer=new c.canvas.SkeletonRenderer(this.scene.sys.context)},bootWebGL:function(){function t(t,e){var n;t===this.srcBlend&&e===this.dstBlend||(n=this.context.gl,this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend)))}i||((i=new c.webgl.SceneRenderer(this.renderer.canvas,this.gl,!0)).batcher.setBlendMode=t,i.shapes.setBlendMode=t),this.sceneRenderer=i,this.skeletonRenderer=i.skeletonRenderer,this.skeletonDebugRenderer=i.skeletonDebugRenderer,this.temp1=new c.webgl.Vector3(0,0,0),this.temp2=new c.webgl.Vector3(0,0,0)},getAtlasCanvas:function(t){var e=this.cache.get(t);if(e){var n,i=this.spineTextures;return i.has(t)?i.get(t):(n=this.textures,new c.TextureAtlas(e.data,(function(t){return new c.canvas.CanvasTexture(n.get(e.prefix+t).getSourceImage())})))}},getAtlasWebGL:function(t){var e=this.cache.get(t);if(e){var n,i,a=this.spineTextures,s=a.has(t)?a.get(t):(n=this.textures,(i=this.sceneRenderer.context.gl).pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),new c.TextureAtlas(e.data,(function(t){return new c.webgl.GLTexture(i,n.get(e.prefix+t).getSourceImage(),!1)})));return s}},spineFileCallback:function(t,e,n,i,a,s){var r;if(Array.isArray(t))for(var o=0;o<t.length;o++)r=new l(this,t[o]),this.addFile(r.files);else r=new l(this,t,e,n,i,a,s),this.addFile(r.files);return this},worldToLocal:function(t,e,n,i){var a=this.temp1,s=this.temp2,r=this.sceneRenderer.camera;a.set(t+n.x,e-n.y,0);var o=r.viewportWidth,h=r.viewportHeight;return r.screenToWorld(a,o,h),i&&null!==i.parent?(i.parent.worldToLocal(s.set(a.x-n.x,a.y-n.y,0)),new c.Vector2(s.x,s.y)):i?new c.Vector2(a.x-n.x,a.y-n.y):new c.Vector2(a.x,a.y)},getVector2:function(t,e){return new c.Vector2(t,e)},getVector3:function(t,e,n){return new c.webgl.Vector3(t,e,n)},setDebugBones:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawBones=t,this},setDebugRegionAttachments:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawRegionAttachments=t,this},setDebugBoundingBoxes:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawBoundingBoxes=t,this},setDebugMeshHull:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawMeshHull=t,this},setDebugMeshTriangles:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawMeshTriangles=t,this},setDebugPaths:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawPaths=t,this},setDebugSkeletonXY:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawSkeletonXY=t,this},setDebugClipping:function(t){return void 0===t&&(t=!0),this.skeletonDebugRenderer.drawClipping=t,this},setEffect:function(t){return this.sceneRenderer.skeletonRenderer.vertexEffect=t,this},createSkeleton:function(t,e){var n,i=t,a=t,s=-1!==g()(t).call(t,".");s&&(i=(n=t.split(".")).shift(),a=n.join("."));var o=this.cache.get(i),h=this.getAtlas(i);if(!h)return null;this.spineTextures.has(i)||this.spineTextures.add(i,h);var l,u,d=o.preMultipliedAlpha,p=new c.AtlasAttachmentLoader(h),f=new c.SkeletonJson(p);if(u=e||(l=this.json.get(i),s?r(l,a):l)){var m=f.readSkeletonData(u);return{skeletonData:m,skeleton:new c.Skeleton(m),preMultipliedAlpha:d}}return null},createAnimationState:function(t){var e=new c.AnimationStateData(t.data);return{stateData:e,state:new c.AnimationState(e)}},getBounds:function(t){var e=new c.Vector2,n=new c.Vector2;return t.getBounds(e,n,[]),{offset:e,size:n}},onResize:function(){var t=this.renderer,e=this.sceneRenderer,n=t.width,i=t.height;e.camera.position.x=n/2,e.camera.position.y=i/2,e.camera.setViewport(n,i)},shutdown:function(){this.systems.events.off("shutdown",this.shutdown,this),this.isWebGL&&this.game.scale.off(o,this.onResize,this)},destroy:function(){this.shutdown(),this.game=null,this.scene=null,this.systems=null,this.cache=null,this.spineTextures=null,this.json=null,this.textures=null,this.skeletonRenderer=null,this.gl=null},gameDestroy:function(){this.pluginManager.removeGameObject("spine",!0,!0),this.pluginManager.removeGameObject("spineContainer",!0,!0),this.pluginManager=null,i&&(i.dispose(),i=null),this.sceneRenderer=null}});f.SpineGameObject=u,f.SpineContainer=d,t.exports=f},function(t,e,n){var i=n(17),a=n(65);t.exports=function(t,e,n){e.x=a(n,"x",0),e.y=a(n,"y",0),e.depth=a(n,"depth",0),e.flipX=a(n,"flipX",!1),e.flipY=a(n,"flipY",!1);var s=a(n,"scale",null);"number"==typeof s?e.setScale(s):null!==s&&(e.scaleX=a(s,"x",1),e.scaleY=a(s,"y",1));var r=a(n,"scrollFactor",null);"number"==typeof r?e.setScrollFactor(r):null!==r&&(e.scrollFactorX=a(r,"x",1),e.scrollFactorY=a(r,"y",1)),e.rotation=a(n,"rotation",0);var o=a(n,"angle",null);null!==o&&(e.angle=o),e.alpha=a(n,"alpha",1);var h,c,l=a(n,"origin",null);return"number"==typeof l?e.setOrigin(l):null!==l&&(h=a(l,"x",.5),c=a(l,"y",.5),e.setOrigin(h,c)),e.blendMode=a(n,"blendMode",i.NORMAL),e.visible=a(n,"visible",!0),a(n,"add",!0)&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e}},function(t,e,n){var i=n(66),a=n(10);t.exports=function(t,e,n){var s=a(t,e,null);if(null===s)return n;if(Array.isArray(s))return i.RND.pick(s);if("object"==typeof s){if(s.hasOwnProperty("randInt"))return i.RND.integerInRange(s.randInt[0],s.randInt[1]);if(s.hasOwnProperty("randFloat"))return i.RND.realInRange(s.randFloat[0],s.randFloat[1])}else if("function"==typeof s)return s(e);return s}},function(t,e,n){var i=n(4),a=n(27)(!1,a={Angle:n(67),Distance:n(76),Easing:n(84),Fuzzy:n(129),Interpolation:n(134),Pow2:n(142),Snap:n(146),RandomDataGenerator:n(150),Average:n(151),Bernstein:n(33),Between:n(152),CatmullRom:n(35),CeilTo:n(153),Clamp:n(3),DegToRad:n(19),Difference:n(154),Euler:n(155),Factorial:n(34),FloatBetween:n(18),FloorTo:n(156),FromPercent:n(157),GetSpeed:n(158),IsEven:n(159),IsEvenStrict:n(160),Linear:n(36),MaxAdd:n(161),Median:n(162),MinSub:n(163),Percent:n(164),RadToDeg:n(9),RandomXY:n(165),RandomXYZ:n(166),RandomXYZW:n(167),Rotate:n(168),RotateAround:n(39),RotateAroundDistance:n(169),RotateTo:n(170),RoundAwayFromZero:n(40),RoundTo:n(171),SinCosTableGenerator:n(172),SmootherStep:n(38),SmoothStep:n(37),ToXY:n(173),TransformXY:n(41),Within:n(174),Wrap:n(6),Vector2:n(2),Vector3:n(14),Vector4:n(175),Matrix3:n(42),Matrix4:n(20),Quaternion:n(43),RotateVec3:n(176)},i);t.exports=a},function(t,e,n){t.exports={Between:n(28),BetweenPoints:n(68),BetweenPointsY:n(69),BetweenY:n(70),CounterClockwise:n(8),Normalize:n(29),Random:n(71),RandomDegrees:n(72),Reverse:n(73),RotateTo:n(74),ShortestBetween:n(75),Wrap:n(30),WrapDegrees:n(31)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(n-t,i-e)}},function(t,e,n){var i=n(18);t.exports=function(){return i(-Math.PI,Math.PI)}},function(t,e,n){var i=n(18);t.exports=function(){return i(-180,180)}},function(t,e,n){var i=n(29);t.exports=function(t){return i(t+Math.PI)}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=i.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=i.PI2:e-=i.PI2),t<e?t+=n:e<t&&(t-=n))),t}},function(t,e){t.exports=function(t,e){var n=e-t;return 0==n?0:n-360*Math.floor((n+180)/360)}},function(t,e,n){t.exports={Between:n(77),BetweenPoints:n(78),BetweenPointsSquared:n(79),Chebyshev:n(80),Power:n(81),Snake:n(82),Squared:n(83)}},function(t,e){t.exports=function(t,e,n,i){var a=t-n,s=e-i;return Math.sqrt(a*a+s*s)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},function(t,e){t.exports=function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},function(t,e){t.exports=function(t,e,n,i){return Math.max(Math.abs(t-n),Math.abs(e-i))}},function(t,e){t.exports=function(t,e,n,i,a){return void 0===a&&(a=2),Math.sqrt(Math.pow(n-t,a)+Math.pow(i-e,a))}},function(t,e){t.exports=function(t,e,n,i){return Math.abs(t-n)+Math.abs(e-i)}},function(t,e){t.exports=function(t,e,n,i){var a=t-n,s=e-i;return a*a+s*s}},function(t,e,n){t.exports={Back:n(85),Bounce:n(89),Circular:n(93),Cubic:n(97),Elastic:n(101),Expo:n(105),Linear:n(109),Quadratic:n(111),Quartic:n(115),Quintic:n(119),Sine:n(123),Stepped:n(127)}},function(t,e,n){t.exports={In:n(86),Out:n(87),InOut:n(88)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((1+n)*t-n)*.5:.5*((t-=2)*t*((1+n)*t+n)+2)}},function(t,e,n){t.exports={In:n(90),Out:n(91),InOut:n(92)}},function(t,e){t.exports=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}},function(t,e){t.exports=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},function(t,e){t.exports=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}},function(t,e,n){t.exports={In:n(94),Out:n(95),InOut:n(96)}},function(t,e){t.exports=function(t){return 1-Math.sqrt(1-t*t)}},function(t,e){t.exports=function(t){return Math.sqrt(1- --t*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},function(t,e,n){t.exports={In:n(98),Out:n(99),InOut:n(100)}},function(t,e){t.exports=function(t){return t*t*t}},function(t,e){t.exports=function(t){return--t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},function(t,e,n){t.exports={In:n(102),Out:n(103),InOut:n(104)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/n)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*--t)*Math.sin((t-i)*(2*Math.PI)/n)*.5+1}},function(t,e,n){t.exports={In:n(106),Out:n(107),InOut:n(108)}},function(t,e){t.exports=function(t){return Math.pow(2,10*(t-1))-.001}},function(t,e){t.exports=function(t){return 1-Math.pow(2,-10*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}},function(t,e,n){t.exports=n(110)},function(t,e){t.exports=function(t){return t}},function(t,e,n){t.exports={In:n(112),Out:n(113),InOut:n(114)}},function(t,e){t.exports=function(t){return t*t}},function(t,e){t.exports=function(t){return t*(2-t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},function(t,e,n){t.exports={In:n(116),Out:n(117),InOut:n(118)}},function(t,e){t.exports=function(t){return t*t*t*t}},function(t,e){t.exports=function(t){return 1- --t*t*t*t}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},function(t,e,n){t.exports={In:n(120),Out:n(121),InOut:n(122)}},function(t,e){t.exports=function(t){return t*t*t*t*t}},function(t,e){t.exports=function(t){return--t*t*t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},function(t,e,n){t.exports={In:n(124),Out:n(125),InOut:n(126)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},function(t,e,n){t.exports=n(128)},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t<=0?0:1<=t?1:1/e*(1+(e*t|0))}},function(t,e,n){t.exports={Ceil:n(130),Equal:n(32),Floor:n(131),GreaterThan:n(132),LessThan:n(133)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),e-n<t}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}},function(t,e,n){t.exports={Bezier:n(135),CatmullRom:n(136),CubicBezier:n(137),Linear:n(138),QuadraticBezier:n(139),SmoothStep:n(140),SmootherStep:n(141)}},function(t,e,n){var i=n(33);t.exports=function(t,e){for(var n=0,a=t.length-1,s=0;s<=a;s++)n+=Math.pow(1-e,a-s)*Math.pow(e,s)*t[s]*i(a,s);return n}},function(t,e,n){var i=n(35);t.exports=function(t,e){var n=t.length-1,a=n*e,s=Math.floor(a);return t[0]===t[n]?(e<0&&(s=Math.floor(a=n*(1+e))),i(a-s,t[(s-1+n)%n],t[s],t[(s+1)%n],t[(s+2)%n])):e<0?t[0]-(i(-a,t[0],t[0],t[1],t[1])-t[0]):1<e?t[n]-(i(a-n,t[n],t[n],t[n-1],t[n-1])-t[n]):i(a-s,t[s?s-1:0],t[s],t[n<s+1?n:s+1],t[n<s+2?n:s+2])}},function(t,e){t.exports=function(t,e,n,i,a){return(c=1-t)*c*c*e+3*(h=1-(o=t))*h*o*n+3*(1-(r=t))*r*r*i+(s=t)*s*s*a;var s,r,o,h,c}},function(t,e,n){var i=n(36);t.exports=function(t,e){var n=t.length-1,a=n*e,s=Math.floor(a);return e<0?i(t[0],t[1],a):1<e?i(t[n],t[n-1],n-a):i(t[s],t[n<s+1?n:s+1],a-s)}},function(t,e){t.exports=function(t,e,n,i){return(r=1-t)*r*e+2*(1-(s=t))*s*n+(a=t)*a*i;var a,s,r}},function(t,e,n){var i=n(37);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){var i=n(38);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){t.exports={GetNext:n(143),IsSize:n(144),IsValue:n(145)}},function(t,e){t.exports=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}},function(t,e){t.exports=function(t,e){return 0<t&&0==(t&t-1)&&0<e&&0==(e&e-1)}},function(t,e){t.exports=function(t){return 0<t&&0==(t&t-1)}},function(t,e,n){t.exports={Ceil:n(147),Floor:n(148),To:n(149)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.ceil(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.floor(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.round(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,n=this.n;t=t.toString();for(var i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return 2.3283064365386963e-10*((this.n=n)>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var n=t[e];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=GI()(t[1]),this.s0=GI()(t[2]),this.s1=GI()(t[3]),this.s2=GI()(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(this.frac()*(e+1)),i=t[n];t[n]=t[e],t[e]=i}return t}});t.exports=i},function(t,e){t.exports=function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length}},function(t,e){t.exports=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.ceil(t*i)/i}},function(t,e){t.exports=function(t,e){return Math.abs(t-e)}},function(t,e,n){var i=n(3),a=n(0),s=n(20),r=n(1),o=new s,h=new a({initialize:function t(e,n,i,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=t.DefaultOrder),this._x=e,this._y=n,this._z=i,this._order=a,this.onChangeCallback=r},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,n,i){return void 0===i&&(i=this._order),this._x=t,this._y=e,this._z=n,this._order=i,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,n){return void 0===e&&(e=this._order),void 0===n&&(n=!1),o.fromQuat(t),this.setFromRotationMatrix(o,e,n)},setFromRotationMatrix:function(t,e,n){void 0===e&&(e=this._order),void 0===n&&(n=!1);var a=t.val,s=a[0],r=a[4],o=a[8],h=a[1],c=a[5],l=a[9],u=a[2],d=a[6],p=a[10],f=0,g=0,m=0,v=.99999;switch(e){case"XYZ":g=Math.asin(i(o,-1,1)),Math.abs(o)<v?(f=Math.atan2(-l,p),m=Math.atan2(-r,s)):f=Math.atan2(d,c);break;case"YXZ":f=Math.asin(-i(l,-1,1)),Math.abs(l)<v?(g=Math.atan2(o,p),m=Math.atan2(h,c)):g=Math.atan2(-u,s);break;case"ZXY":f=Math.asin(i(d,-1,1)),m=Math.abs(d)<v?(g=Math.atan2(-u,p),Math.atan2(-r,c)):Math.atan2(h,s);break;case"ZYX":g=Math.asin(-i(u,-1,1)),m=Math.abs(u)<v?(f=Math.atan2(d,p),Math.atan2(h,s)):Math.atan2(-r,c);break;case"YZX":m=Math.asin(i(h,-1,1)),g=Math.abs(h)<v?(f=Math.atan2(-l,c),Math.atan2(-u,s)):Math.atan2(o,p);break;case"XZY":m=Math.asin(-i(r,-1,1)),Math.abs(r)<v?(f=Math.atan2(d,c),g=Math.atan2(o,s)):f=Math.atan2(-l,p)}return this._x=f,this._y=g,this._z=m,this._order=e,n&&this.onChangeCallback(this),this}});h.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],h.DefaultOrder="XYZ",t.exports=h},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.floor(t*i)/i}},function(t,e,n){var i=n(3);t.exports=function(t,e,n){return(n-e)*(t=i(t,0,1))+e}},function(t,e){t.exports=function(t,e){return t/e/1e3}},function(t,e){t.exports=function(t){return t==GI()(t)?!(t%2):void 0}},function(t,e){t.exports=function(t){return t===GI()(t)?!(t%2):void 0}},function(t,e){t.exports=function(t,e,n){return Math.min(t+e,n)}},function(t,e){t.exports=function(t){var e=t.length;if(0===e)return 0;Ba()(t).call(t,(function(t,e){return t-e}));var n=Math.floor(e/2);return e%2==0?(t[n]+t[n-1])/2:t[n]}},function(t,e){t.exports=function(t,e,n){return Math.max(t-e,n)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=e+1);var a=(t-e)/(n-e);return 1<a?void 0!==i?(a=(i-t)/(i-n))<0&&(a=0):a=1:a<0&&(a=0),a}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI;return t.x=Math.cos(n)*e,t.y=Math.sin(n)*e,t}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI,i=2*Math.random()-1,a=Math.sqrt(1-i*i)*e;return t.x=Math.cos(n)*a,t.y=Math.sin(n)*a,t.z=i*e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}},function(t,e){t.exports=function(t,e){var n=t.x,i=t.y;return t.x=n*Math.cos(e)-i*Math.sin(e),t.y=n*Math.sin(e)+i*Math.cos(e),t}},function(t,e){t.exports=function(t,e,n,i,a){var s=i+Math.atan2(t.y-n,t.x-e);return t.x=e+a*Math.cos(s),t.y=n+a*Math.sin(s),t}},function(t,e){t.exports=function(t,e,n,i,a){return t.x=e+a*Math.cos(i),t.y=n+a*Math.sin(i),t}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.round(t*i)/i}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),i*=Math.PI/t;for(var a=[],s=[],r=0;r<t;r++)e+=(n-=e*i)*i,a[r]=n,s[r]=e;return{sin:s,cos:a,length:t}}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,a){void 0===a&&(a=new i);var s=0,r=0;return 0<t&&t<=e*n&&(s=e-1<t?t-(r=Math.floor(t/e))*e:t,a.set(s,r)),a}},function(t,e){t.exports=function(t,e,n){return Math.abs(t-e)<=n}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,n,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,a=t*t+e*e+n*n+i*i;return 0<a&&(a=1/Math.sqrt(a),this.x=t*a,this.y=e*a,this.z=n*a,this.w=i*a),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,a=this.z,s=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=a+e*(t.z-a),this.w=s+e*(t.w-s),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,a=t.w-this.w||0;return Math.sqrt(e*e+n*n+i*i+a*a)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,a=t.w-this.w||0;return e*e+n*n+i*i+a*a},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,a=this.w,s=t.val;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*a,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*a,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*a,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*a,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,a=t.x,s=t.y,r=t.z,o=t.w,h=o*e+s*i-r*n,c=o*n+r*e-a*i,l=o*i+a*n-s*e,u=-a*e-s*n-r*i;return this.x=h*o+u*-a+c*-r-l*-s,this.y=c*o+u*-s+l*-a-h*-r,this.z=l*o+u*-r+h*-s-c*-a,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.distSq=i.prototype.distanceSq,i.prototype.len=i.prototype.length,i.prototype.lenSq=i.prototype.lengthSq,t.exports=i},function(t,e,n){var i=n(14),a=n(20),s=n(43),r=new a,o=new s,h=new i;t.exports=function(t,e,n){return o.setAxisAngle(e,n),r.fromRotationTranslation(o,h.set(0,0,0)),t.transformMat4(r)}},function(t,e){t.exports="resize"},function(t,e,n){var i=n(179),a=n(0),s=n(44),r=new a({Extends:i,initialize:function(t,e,n){i.call(this,e),this.scene=t,this.systems=t.sys,this.pluginKey=n,t.sys.events.once(s.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=r},function(t,e,n){var i=new(n(0))({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=i},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="boot"},function(t,e){t.exports="create"},function(t,e){t.exports="destroy"},function(t,e){t.exports="pause"},function(t,e){t.exports="postupdate"},function(t,e){t.exports="prerender"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="ready"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="render"},function(t,e){t.exports="resume"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="sleep"},function(t,e){t.exports="start"},function(t,e){t.exports="transitioncomplete"},function(t,e){t.exports="transitioninit"},function(t,e){t.exports="transitionout"},function(t,e){t.exports="transitionstart"},function(t,e){t.exports="transitionwake"},function(t,e){t.exports="update"},function(t,e){t.exports="wake"},function(t,e){(function(){var e,n,i,a,s,r,o,h,c,l,u,d,p,f,m,v,y,S,A,E,x,b,T,w,M,C,P,I,k,R,O,_,D,B,L,F,N,G,U,V,z,H,W,X,K,j,q,Z,J,Q,$,tt,et,nt,at,st,rt,ot,ht,ct,lt,ut,dt,pt,ft,gt,mt,vt,yt,St,At,Et,xt,bt,Tt,wt,Mt,Ct,Pt,It,kt,Rt,Ot,_t,Dt,Bt,Lt,Ft,Nt,Gt,Ut,Vt,Yt,zt,Ht,Wt,Xt,Kt,jt,qt,Zt,Jt,Qt,$t,te,ee,ne,ie,ae,se,re,oe,he,ce,le,ue,de,pe,fe,ge,me,ve,ye,Se,Ae,Ee=this&&this.__extends||(e=function(t,n){return(e=VI()||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)});function xe(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}function be(t,e){void 0===e&&(e=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.rawDataUris={},this.textureLoader=t,this.pathPrefix=e}function Te(t){this.atlas=t}function we(t,e,n){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}function Me(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}function Ce(t){var e=S.call(this,t,0,!1)||this;return e.bones=new Array,e.bendDirection=1,e.compress=!1,e.stretch=!1,e.uniform=!1,e.mix=1,e.softness=0,e}function Pe(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var n=0,i=t.bones.length;n<i;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}function Ie(t){var e=T.call(this,t,0,!1)||this;return e.bones=new Array,e}function ke(t){this.toLoad=new Array,this.assets={},this.clientId=t}function Re(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}function Oe(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(var e=0;e<t.bones.length;e++){var n,i=t.bones[e],a=void 0;null==i.parent?a=new O.Bone(i,this,null):(n=this.bones[i.parent.index],a=new O.Bone(i,this,n),n.children.push(a)),this.bones.push(a)}for(this.slots=new Array,this.drawOrder=new Array,e=0;e<t.slots.length;e++){var s=t.slots[e],r=(a=this.bones[s.boneData.index],new O.Slot(s,a));this.slots.push(r),this.drawOrder.push(r)}for(this.ikConstraints=new Array,e=0;e<t.ikConstraints.length;e++){var o=t.ikConstraints[e];this.ikConstraints.push(new O.IkConstraint(o,this))}for(this.transformConstraints=new Array,e=0;e<t.transformConstraints.length;e++){var h=t.transformConstraints[e];this.transformConstraints.push(new O.TransformConstraint(h,this))}for(this.pathConstraints=new Array,e=0;e<t.pathConstraints.length;e++){var c=t.pathConstraints[e];this.pathConstraints.push(new O.PathConstraint(c,this))}this.color=new O.Color(1,1,1,1),this.updateCache()}function _e(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new D.Pool((function(){return D.Utils.newFloatArray(16)}))}function De(){this.triangulator=new L.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}function Be(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}function Le(t,e){if(this.deform=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new U.Color,this.darkColor=null==t.darkColor?null:new U.Color,this.setToSetupPose()}function Fe(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new H.Vector2,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}function Ne(t){var e=K.call(this,t,0,!1)||this;return e.bones=new Array,e.rotateMix=0,e.translateMix=0,e.scaleMix=0,e.shearMix=0,e.offsetRotation=0,e.offsetX=0,e.offsetY=0,e.offsetScaleX=0,e.offsetScaleY=0,e.offsetShearY=0,e.relative=!1,e.local=!1,e}function Ge(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new q.Pool((function(){return new Array})),this.polygonIndicesPool=new q.Pool((function(){return new Array}))}function Ue(t){var e=et.call(this,t)||this;return e.color=new tt.Color(1,1,1,1),e}function Ve(t){var e=st.call(this,t)||this;return e.color=new at.Color(.2275,.2275,.8078,1),e}function Ye(t){var e=ht.call(this,t)||this;return e.color=new ot.Color(1,1,1,1),e.tempColor=new ot.Color(0,0,0,0),e}function ze(t){var e=ut.call(this,t)||this;return e.closed=!1,e.constantSpeed=!1,e.color=new lt.Color(1,1,1,1),e}function He(t){var e=ft.call(this,t)||this;return e.color=new pt.Color(.38,.94,0,1),e}function We(t){var e=vt.call(this,t)||this;return e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,e.rotation=0,e.width=0,e.height=0,e.color=new mt.Color(1,1,1,1),e.offset=mt.Utils.newFloatArray(8),e.uvs=mt.Utils.newFloatArray(8),e.tempColor=new mt.Color(1,1,1,1),e}function Xe(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}function Ke(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}function je(t){return void 0===t&&(t=""),wt.call(this,(function(t){return new bt.canvas.CanvasTexture(t)}),t)||this}function qe(t){return It.call(this,t)||this}function Ze(t){this.triangleRendering=!1,this.debugRendering=!1,this.vertices=Rt.Utils.newFloatArray(8192),this.tempColor=new Rt.Color,this.ctx=t}function Je(t,e){return void 0===e&&(e=""),Lt.call(this,(function(e){return new Dt.webgl.GLTexture(t,e)}),e)||this}function Qe(t,e){this.position=new Gt.Vector3(0,0,0),this.direction=new Gt.Vector3(0,0,-1),this.up=new Gt.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new Gt.Matrix4,this.inverseProjectionView=new Gt.Matrix4,this.projection=new Gt.Matrix4,this.view=new Gt.Matrix4,this.tmp=new Gt.Vector3,this.viewportWidth=t,this.viewportHeight=e,this.update()}function $e(t,e,n){void 0===n&&(n=!1);var i=zt.call(this,e)||this;return i.texture=null,i.boundUnit=0,i.useMipMaps=!1,i.context=t instanceof Yt.ManagedWebGLRenderingContext?t:new Yt.ManagedWebGLRenderingContext(t),i.useMipMaps=n,i.restore(),i.context.addRestorable(i),i}function tn(t,e,n){if(void 0===e&&(e=!0),void 0===n&&(n=10920),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,10920<n)throw new Error("Can't have more than 10920 triangles per batch: "+n);this.context=t instanceof jt.ManagedWebGLRenderingContext?t:new jt.ManagedWebGLRenderingContext(t);var i=e?[new jt.Position2Attribute,new jt.ColorAttribute,new jt.TexCoordAttribute,new jt.Color2Attribute]:[new jt.Position2Attribute,new jt.ColorAttribute,new jt.TexCoordAttribute];this.mesh=new jt.Mesh(t,i,n,3*n),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}function en(t,e,n){void 0===n&&(n=!0),this.twoColorTint=!1,this.activeRenderer=null,this.QUAD=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],this.QUAD_TRIANGLES=[0,1,2,2,3,0],this.WHITE=new Zt.Color(1,1,1,1),this.canvas=t,this.context=e instanceof Jt.ManagedWebGLRenderingContext?e:new Jt.ManagedWebGLRenderingContext(e),this.twoColorTint=n,this.camera=new Jt.OrthoCamera(t.width,t.height),this.batcherShader=n?Jt.Shader.newTwoColoredTextured(this.context):Jt.Shader.newColoredTextured(this.context),this.batcher=new Jt.PolygonBatcher(this.context,n),this.shapesShader=Jt.Shader.newColored(this.context),this.shapes=new Jt.ShapeRenderer(this.context),this.skeletonRenderer=new Jt.SkeletonRenderer(this.context,n),this.skeletonDebugRenderer=new Jt.SkeletonDebugRenderer(this.context)}function nn(t,e,n){this.vertexShader=e,this.fragmentShader=n,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=e,this.fsSource=n,this.context=t instanceof ne.ManagedWebGLRenderingContext?t:new ne.ManagedWebGLRenderingContext(t),this.context.addRestorable(this),this.compile()}function an(t,e){if(void 0===e&&(e=10920),this.isDrawing=!1,this.shapeType=re.Filled,this.color=new ae.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new ae.Vector2,10920<e)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof se.ManagedWebGLRenderingContext?t:new se.ManagedWebGLRenderingContext(t),this.mesh=new se.Mesh(t,[new se.Position2Attribute,new se.ColorAttribute],e,0),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}function sn(t){this.boneLineColor=new ce.Color(1,0,0,1),this.boneOriginColor=new ce.Color(0,1,0,1),this.attachmentLineColor=new ce.Color(0,0,1,.5),this.triangleLineColor=new ce.Color(1,.64,0,.5),this.pathColor=(new ce.Color).setFromString("FF7F00"),this.clipColor=new ce.Color(.8,0,0,2),this.aabbColor=new ce.Color(0,1,0,.5),this.drawBones=!0,this.drawRegionAttachments=!0,this.drawBoundingBoxes=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawPaths=!0,this.drawSkeletonXY=!1,this.drawClipping=!0,this.premultipliedAlpha=!1,this.scale=1,this.boneWidth=2,this.bounds=new ce.SkeletonBounds,this.temp=new Array,this.vertices=ce.Utils.newFloatArray(2048),this.context=t instanceof le.ManagedWebGLRenderingContext?t:new le.ManagedWebGLRenderingContext(t)}function rn(t,e){void 0===e&&(e=!0),this.premultipliedAlpha=!1,this.vertexEffect=null,this.tempColor=new de.Color,this.tempColor2=new de.Color,this.vertexSize=8,this.twoColorTint=!1,this.renderable=new fe(null,0,0),this.clipper=new de.SkeletonClipping,this.temp=new de.Vector2,this.temp2=new de.Vector2,this.temp3=new de.Color,this.temp4=new de.Color,(this.twoColorTint=e)&&(this.vertexSize+=4),this.vertices=de.Utils.newFloatArray(1024*this.vertexSize)}function on(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=n}!function(t){var e,n,i,a,s,r,o=(h.prototype.hasTimeline=function(t){return 1==this.timelineIds[t]},h.prototype.apply=function(t,e,n,i,a,s,r,o){if(null==t)throw new Error("skeleton cannot be null.");i&&0!=this.duration&&(n%=this.duration,0<e&&(e%=this.duration));for(var h=this.timelines,c=0,l=h.length;c<l;c++)h[c].apply(t,e,n,a,s,r,o)},h.binarySearch=function(t,e,n){void 0===n&&(n=1);var i=0,a=t.length/n-2;if(0==a)return n;for(var s=a>>>1;;){if(t[(s+1)*n]<=e?i=s+1:a=s,i==a)return(i+1)*n;s=i+a>>>1}},h.linearSearch=function(t,e,n){for(var i=0,a=t.length-n;i<=a;i+=n)if(t[i]>e)return i;return-1},h);function h(t,e,n){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var i=0;i<e.length;i++)this.timelineIds[e[i].getPropertyId()]=!0;this.duration=n}t.Animation=o,(n=e=t.MixBlend||(t.MixBlend={}))[n.setup=0]="setup",n[n.first=1]="first",n[n.replace=2]="replace",n[n.add=3]="add",(a=i=t.MixDirection||(t.MixDirection={}))[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut",(r=s=t.TimelineType||(t.TimelineType={}))[r.rotate=0]="rotate",r[r.translate=1]="translate",r[r.scale=2]="scale",r[r.shear=3]="shear",r[r.attachment=4]="attachment",r[r.color=5]="color",r[r.deform=6]="deform",r[r.event=7]="event",r[r.drawOrder=8]="drawOrder",r[r.ikConstraint=9]="ikConstraint",r[r.transformConstraint=10]="transformConstraint",r[r.pathConstraintPosition=11]="pathConstraintPosition",r[r.pathConstraintSpacing=12]="pathConstraintSpacing",r[r.pathConstraintMix=13]="pathConstraintMix",r[r.twoColor=14]="twoColor";var c=(l.prototype.getFrameCount=function(){return this.curves.length/l.BEZIER_SIZE+1},l.prototype.setLinear=function(t){this.curves[t*l.BEZIER_SIZE]=l.LINEAR},l.prototype.setStepped=function(t){this.curves[t*l.BEZIER_SIZE]=l.STEPPED},l.prototype.getCurveType=function(t){var e=t*l.BEZIER_SIZE;if(e==this.curves.length)return l.LINEAR;var n=this.curves[e];return n==l.LINEAR?l.LINEAR:n==l.STEPPED?l.STEPPED:l.BEZIER},l.prototype.setCurve=function(t,e,n,i,a){var s=.03*(2*-e+i),r=.03*(2*-n+a),o=.006*(3*(e-i)+1),h=.006*(3*(n-a)+1),c=2*s+o,u=2*r+h,d=.3*e+s+.16666667*o,p=.3*n+r+.16666667*h,f=t*l.BEZIER_SIZE,g=this.curves;g[f++]=l.BEZIER;for(var m=d,v=p,y=f+l.BEZIER_SIZE-1;f<y;f+=2)g[f]=m,g[f+1]=v,d+=c,p+=u,c+=o,u+=h,m+=d,v+=p},l.prototype.getCurvePercent=function(e,n){n=t.MathUtils.clamp(n,0,1);var i=this.curves,a=e*l.BEZIER_SIZE,s=i[a];if(s==l.LINEAR)return n;if(s==l.STEPPED)return 0;for(var r=0,o=++a,h=a+l.BEZIER_SIZE-1;a<h;a+=2)if(n<=(r=i[a])){var c,u=void 0;return(c=a==o?u=0:(u=i[a-2],i[a-1]))+(i[a+1]-c)*(n-u)/(r-u)}var d=i[a-1];return d+(1-d)*(n-r)/(1-r)},l.LINEAR=0,l.STEPPED=1,l.BEZIER=2,l.BEZIER_SIZE=19,l);function l(e){if(e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=t.Utils.newFloatArray((e-1)*l.BEZIER_SIZE)}t.CurveTimeline=c;var u,d=(Ee(p,u=c),p.prototype.getPropertyId=function(){return(s.rotate<<24)+this.boneIndex},p.prototype.setFrame=function(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+p.ROTATION]=n},p.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<c[0])switch(r){case e.setup:return void(l.rotation=l.data.rotation);case e.first:var u=l.data.rotation-l.rotation;l.rotation+=(u-360*(16384-(16384.499999999996-u/360|0)))*s}else if(i>=c[c.length-p.ENTRIES]){var d=c[c.length+p.PREV_ROTATION];switch(r){case e.setup:l.rotation=l.data.rotation+d*s;break;case e.first:case e.replace:d+=l.data.rotation-l.rotation,d-=360*(16384-(16384.499999999996-d/360|0));case e.add:l.rotation+=d*s}}else{var f=o.binarySearch(c,i,p.ENTRIES),g=c[f+p.PREV_ROTATION],m=c[f],v=this.getCurvePercent((f>>1)-1,1-(i-m)/(c[f+p.PREV_TIME]-m)),y=g+((y=c[f+p.ROTATION]-g)-360*(16384-(16384.499999999996-y/360|0)))*v;switch(r){case e.setup:l.rotation=l.data.rotation+(y-360*(16384-(16384.499999999996-y/360|0)))*s;break;case e.first:case e.replace:y+=l.data.rotation-l.rotation;case e.add:l.rotation+=(y-360*(16384-(16384.499999999996-y/360|0)))*s}}},p.ENTRIES=2,p.PREV_TIME=-2,p.PREV_ROTATION=-1,p.ROTATION=1,p);function p(e){var n=u.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e<<1),n}t.RotateTimeline=d;var f,g=(Ee(m,f=c),m.prototype.getPropertyId=function(){return(s.translate<<24)+this.boneIndex},m.prototype.setFrame=function(t,e,n,i){t*=m.ENTRIES,this.frames[t]=e,this.frames[t+m.X]=n,this.frames[t+m.Y]=i},m.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<c[0])switch(r){case e.setup:return l.x=l.data.x,void(l.y=l.data.y);case e.first:l.x+=(l.data.x-l.x)*s,l.y+=(l.data.y-l.y)*s}else{var u,d,p,f=0,g=0;switch(i>=c[c.length-m.ENTRIES]?(f=c[c.length+m.PREV_X],g=c[c.length+m.PREV_Y]):(f=c[(u=o.binarySearch(c,i,m.ENTRIES))+m.PREV_X],g=c[u+m.PREV_Y],d=c[u],p=this.getCurvePercent(u/m.ENTRIES-1,1-(i-d)/(c[u+m.PREV_TIME]-d)),f+=(c[u+m.X]-f)*p,g+=(c[u+m.Y]-g)*p),r){case e.setup:l.x=l.data.x+f*s,l.y=l.data.y+g*s;break;case e.first:case e.replace:l.x+=(l.data.x+f-l.x)*s,l.y+=(l.data.y+g-l.y)*s;break;case e.add:l.x+=f*s,l.y+=g*s}}},m.ENTRIES=3,m.PREV_TIME=-3,m.PREV_X=-2,m.PREV_Y=-1,m.X=1,m.Y=2,m);function m(e){var n=f.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*m.ENTRIES),n}t.TranslateTimeline=g;var v,y=(Ee(S,v=g),S.prototype.getPropertyId=function(){return(s.scale<<24)+this.boneIndex},S.prototype.apply=function(n,a,s,r,h,c,l){var u=this.frames,d=n.bones[this.boneIndex];if(d.active)if(s<u[0])switch(c){case e.setup:return d.scaleX=d.data.scaleX,void(d.scaleY=d.data.scaleY);case e.first:d.scaleX+=(d.data.scaleX-d.scaleX)*h,d.scaleY+=(d.data.scaleY-d.scaleY)*h}else{var p,f,g,m=0,v=0;if(v=s>=u[u.length-S.ENTRIES]?(m=u[u.length+S.PREV_X]*d.data.scaleX,u[u.length+S.PREV_Y]*d.data.scaleY):(m=u[(p=o.binarySearch(u,s,S.ENTRIES))+S.PREV_X],v=u[p+S.PREV_Y],f=u[p],g=this.getCurvePercent(p/S.ENTRIES-1,1-(s-f)/(u[p+S.PREV_TIME]-f)),m=(m+(u[p+S.X]-m)*g)*d.data.scaleX,(v+(u[p+S.Y]-v)*g)*d.data.scaleY),1==h)c==e.add?(d.scaleX+=m-d.data.scaleX,d.scaleY+=v-d.data.scaleY):(d.scaleX=m,d.scaleY=v);else{var y=0,A=0;if(l==i.mixOut)switch(c){case e.setup:y=d.data.scaleX,A=d.data.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-y)*h,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-A)*h;break;case e.first:case e.replace:y=d.scaleX,A=d.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-y)*h,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-A)*h;break;case e.add:y=d.scaleX,A=d.scaleY,d.scaleX=y+(Math.abs(m)*t.MathUtils.signum(y)-d.data.scaleX)*h,d.scaleY=A+(Math.abs(v)*t.MathUtils.signum(A)-d.data.scaleY)*h}else switch(c){case e.setup:y=Math.abs(d.data.scaleX)*t.MathUtils.signum(m),A=Math.abs(d.data.scaleY)*t.MathUtils.signum(v),d.scaleX=y+(m-y)*h,d.scaleY=A+(v-A)*h;break;case e.first:case e.replace:y=Math.abs(d.scaleX)*t.MathUtils.signum(m),A=Math.abs(d.scaleY)*t.MathUtils.signum(v),d.scaleX=y+(m-y)*h,d.scaleY=A+(v-A)*h;break;case e.add:y=t.MathUtils.signum(m),A=t.MathUtils.signum(v),d.scaleX=Math.abs(d.scaleX)*y+(m-Math.abs(d.data.scaleX)*y)*h,d.scaleY=Math.abs(d.scaleY)*A+(v-Math.abs(d.data.scaleY)*A)*h}}}},S);function S(t){return v.call(this,t)||this}t.ScaleTimeline=y;var A,E=(Ee(x,A=g),x.prototype.getPropertyId=function(){return(s.shear<<24)+this.boneIndex},x.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.bones[this.boneIndex];if(l.active)if(i<c[0])switch(r){case e.setup:return l.shearX=l.data.shearX,void(l.shearY=l.data.shearY);case e.first:l.shearX+=(l.data.shearX-l.shearX)*s,l.shearY+=(l.data.shearY-l.shearY)*s}else{var u,d,p,f=0,g=0;switch(i>=c[c.length-x.ENTRIES]?(f=c[c.length+x.PREV_X],g=c[c.length+x.PREV_Y]):(f=c[(u=o.binarySearch(c,i,x.ENTRIES))+x.PREV_X],g=c[u+x.PREV_Y],d=c[u],p=this.getCurvePercent(u/x.ENTRIES-1,1-(i-d)/(c[u+x.PREV_TIME]-d)),f+=(c[u+x.X]-f)*p,g+=(c[u+x.Y]-g)*p),r){case e.setup:l.shearX=l.data.shearX+f*s,l.shearY=l.data.shearY+g*s;break;case e.first:case e.replace:l.shearX+=(l.data.shearX+f-l.shearX)*s,l.shearY+=(l.data.shearY+g-l.shearY)*s;break;case e.add:l.shearX+=f*s,l.shearY+=g*s}}},x);function x(t){return A.call(this,t)||this}t.ShearTimeline=E;var b,T=(Ee(w,b=c),w.prototype.getPropertyId=function(){return(s.color<<24)+this.slotIndex},w.prototype.setFrame=function(t,e,n,i,a,s){t*=w.ENTRIES,this.frames[t]=e,this.frames[t+w.R]=n,this.frames[t+w.G]=i,this.frames[t+w.B]=a,this.frames[t+w.A]=s},w.prototype.apply=function(t,n,i,a,s,r,h){var c=t.slots[this.slotIndex];if(c.bone.active){var l=this.frames;if(i<l[0])switch(r){case e.setup:return void c.color.setFromColor(c.data.color);case e.first:var u=c.color,d=c.data.color;u.add((d.r-u.r)*s,(d.g-u.g)*s,(d.b-u.b)*s,(d.a-u.a)*s)}else{var p,f,g,m,v=0,y=0,S=0,A=0;i>=l[l.length-w.ENTRIES]?(v=l[(p=l.length)+w.PREV_R],y=l[p+w.PREV_G],S=l[p+w.PREV_B],A=l[p+w.PREV_A]):(v=l[(f=o.binarySearch(l,i,w.ENTRIES))+w.PREV_R],y=l[f+w.PREV_G],S=l[f+w.PREV_B],A=l[f+w.PREV_A],g=l[f],m=this.getCurvePercent(f/w.ENTRIES-1,1-(i-g)/(l[f+w.PREV_TIME]-g)),v+=(l[f+w.R]-v)*m,y+=(l[f+w.G]-y)*m,S+=(l[f+w.B]-S)*m,A+=(l[f+w.A]-A)*m),1==s?c.color.set(v,y,S,A):(u=c.color,r==e.setup&&u.setFromColor(c.data.color),u.add((v-u.r)*s,(y-u.g)*s,(S-u.b)*s,(A-u.a)*s))}}},w.ENTRIES=5,w.PREV_TIME=-5,w.PREV_R=-4,w.PREV_G=-3,w.PREV_B=-2,w.PREV_A=-1,w.R=1,w.G=2,w.B=3,w.A=4,w);function w(e){var n=b.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*w.ENTRIES),n}t.ColorTimeline=T;var M,C=(Ee(P,M=c),P.prototype.getPropertyId=function(){return(s.twoColor<<24)+this.slotIndex},P.prototype.setFrame=function(t,e,n,i,a,s,r,o,h){t*=P.ENTRIES,this.frames[t]=e,this.frames[t+P.R]=n,this.frames[t+P.G]=i,this.frames[t+P.B]=a,this.frames[t+P.A]=s,this.frames[t+P.R2]=r,this.frames[t+P.G2]=o,this.frames[t+P.B2]=h},P.prototype.apply=function(t,n,i,a,s,r,h){var c=t.slots[this.slotIndex];if(c.bone.active){var l=this.frames;if(i<l[0])switch(r){case e.setup:return c.color.setFromColor(c.data.color),void c.darkColor.setFromColor(c.data.darkColor);case e.first:var u=c.color,d=c.darkColor,p=c.data.color,f=c.data.darkColor;u.add((p.r-u.r)*s,(p.g-u.g)*s,(p.b-u.b)*s,(p.a-u.a)*s),d.add((f.r-d.r)*s,(f.g-d.g)*s,(f.b-d.b)*s,0)}else{var g,m,v,y,S=0,A=0,E=0,x=0,b=0,T=0,w=0;i>=l[l.length-P.ENTRIES]?(S=l[(g=l.length)+P.PREV_R],A=l[g+P.PREV_G],E=l[g+P.PREV_B],x=l[g+P.PREV_A],b=l[g+P.PREV_R2],T=l[g+P.PREV_G2],w=l[g+P.PREV_B2]):(S=l[(m=o.binarySearch(l,i,P.ENTRIES))+P.PREV_R],A=l[m+P.PREV_G],E=l[m+P.PREV_B],x=l[m+P.PREV_A],b=l[m+P.PREV_R2],T=l[m+P.PREV_G2],w=l[m+P.PREV_B2],v=l[m],y=this.getCurvePercent(m/P.ENTRIES-1,1-(i-v)/(l[m+P.PREV_TIME]-v)),S+=(l[m+P.R]-S)*y,A+=(l[m+P.G]-A)*y,E+=(l[m+P.B]-E)*y,x+=(l[m+P.A]-x)*y,b+=(l[m+P.R2]-b)*y,T+=(l[m+P.G2]-T)*y,w+=(l[m+P.B2]-w)*y),1==s?(c.color.set(S,A,E,x),c.darkColor.set(b,T,w,1)):(u=c.color,d=c.darkColor,r==e.setup&&(u.setFromColor(c.data.color),d.setFromColor(c.data.darkColor)),u.add((S-u.r)*s,(A-u.g)*s,(E-u.b)*s,(x-u.a)*s),d.add((b-d.r)*s,(T-d.g)*s,(w-d.b)*s,0))}}},P.ENTRIES=8,P.PREV_TIME=-8,P.PREV_R=-7,P.PREV_G=-6,P.PREV_B=-5,P.PREV_A=-4,P.PREV_R2=-3,P.PREV_G2=-2,P.PREV_B2=-1,P.R=1,P.G=2,P.B=3,P.A=4,P.R2=5,P.G2=6,P.B2=7,P);function P(e){var n=M.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*P.ENTRIES),n}t.TwoColorTimeline=C;var I=(k.prototype.getPropertyId=function(){return(s.attachment<<24)+this.slotIndex},k.prototype.getFrameCount=function(){return this.frames.length},k.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},k.prototype.apply=function(t,n,a,s,r,h,c){var l,u,d,p=t.slots[this.slotIndex];p.bone.active&&(c!=i.mixOut?a<(l=this.frames)[0]?h!=e.setup&&h!=e.first||this.setAttachment(t,p,p.data.attachmentName):(0,u=a>=l[l.length-1]?l.length-1:o.binarySearch(l,a,1)-1,d=this.attachmentNames[u],t.slots[this.slotIndex].setAttachment(null==d?null:t.getAttachment(this.slotIndex,d))):h==e.setup&&this.setAttachment(t,p,p.data.attachmentName))},k.prototype.setAttachment=function(t,e,n){e.attachment=null==n?null:t.getAttachment(this.slotIndex,n)},k);function k(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}t.AttachmentTimeline=I;var R,O=null,_=(Ee(D,R=c),D.prototype.getPropertyId=function(){return(s.deform<<27)+ +this.attachment.id+this.slotIndex},D.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.frameVertices[t]=n},D.prototype.apply=function(n,i,a,s,r,h,c){var l=n.slots[this.slotIndex];if(l.bone.active){var u=l.getAttachment();if(u instanceof t.VertexAttachment&&u.deformAttachment==this.attachment){var d=l.deform;0==d.length&&(h=e.setup);var p=this.frameVertices,f=p[0].length,g=this.frames;if(a<g[0]){var m=u;switch(h){case e.setup:return void(d.length=0);case e.first:if(1==r){d.length=0;break}var v=t.Utils.setArraySize(d,f);if(null==m.bones)for(var y=m.vertices,S=0;S<f;S++)v[S]+=(y[S]-v[S])*r;else for(r=1-r,S=0;S<f;S++)v[S]*=r}}else{var A=t.Utils.setArraySize(d,f);if(a>=g[g.length-1]){var E=p[g.length-1];if(1==r)if(h==e.add)if(null==(m=u).bones){y=m.vertices;for(var x=0;x<f;x++)A[x]+=E[x]-y[x]}else for(var b=0;b<f;b++)A[b]+=E[b];else t.Utils.arrayCopy(E,0,A,0,f);else switch(h){case e.setup:if(null==u.bones){y=u.vertices;for(var T=0;T<f;T++){var w=y[T];A[T]=w+(E[T]-w)*r}}else for(var M=0;M<f;M++)A[M]=E[M]*r;break;case e.first:case e.replace:for(var C=0;C<f;C++)A[C]+=(E[C]-A[C])*r;break;case e.add:if(null==(m=u).bones){y=m.vertices;for(var P=0;P<f;P++)A[P]+=(E[P]-y[P])*r}else for(var I=0;I<f;I++)A[I]+=E[I]*r}}else{var k=o.binarySearch(g,a),R=p[k-1],O=p[k],_=g[k],D=this.getCurvePercent(k-1,1-(a-_)/(g[k-1]-_));if(1==r)if(h==e.add)if(null==(m=u).bones){y=m.vertices;for(var B=0;B<f;B++){var L=R[B];A[B]+=L+(O[B]-L)*D-y[B]}}else for(var F=0;F<f;F++)L=R[F],A[F]+=L+(O[F]-L)*D;else for(var N=0;N<f;N++)L=R[N],A[N]=L+(O[N]-L)*D;else switch(h){case e.setup:if(null==u.bones){y=u.vertices;for(var G=0;G<f;G++)L=R[G],w=y[G],A[G]=w+(L+(O[G]-L)*D-w)*r}else for(var U=0;U<f;U++)L=R[U],A[U]=(L+(O[U]-L)*D)*r;break;case e.first:case e.replace:for(var V=0;V<f;V++)L=R[V],A[V]+=(L+(O[V]-L)*D-A[V])*r;break;case e.add:if(null==(m=u).bones){y=m.vertices;for(var Y=0;Y<f;Y++)L=R[Y],A[Y]+=(L+(O[Y]-L)*D-y[Y])*r}else for(var z=0;z<f;z++)L=R[z],A[z]+=(L+(O[z]-L)*D)*r}}}}}},D);function D(e){var n=R.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e),n.frameVertices=new Array(e),null==O&&(O=t.Utils.newFloatArray(64)),n}t.DeformTimeline=_;var B=(L.prototype.getPropertyId=function(){return s.event<<24},L.prototype.getFrameCount=function(){return this.frames.length},L.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},L.prototype.apply=function(t,e,n,i,a,s,r){if(null!=i){var h=this.frames,c=this.frames.length;if(n<e)this.apply(t,e,Number.MAX_VALUE,i,a,s,r),e=-1;else if(e>=h[c-1])return;if(!(n<h[0])){var l=0;if(e<h[0])l=0;else for(var u=h[l=o.binarySearch(h,e)];0<l&&h[l-1]==u;)l--;for(;l<c&&n>=h[l];l++)i.push(this.events[l])}}},L);function L(e){this.frames=t.Utils.newFloatArray(e),this.events=new Array(e)}t.EventTimeline=B;var F=(N.prototype.getPropertyId=function(){return s.drawOrder<<24},N.prototype.getFrameCount=function(){return this.frames.length},N.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.drawOrders[t]=n},N.prototype.apply=function(n,a,s,r,h,c,l){var u=n.drawOrder,d=n.slots;if(l!=i.mixOut){var p=this.frames;if(s<p[0])c!=e.setup&&c!=e.first||t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{var f=s>=p[p.length-1]?p.length-1:o.binarySearch(p,s)-1,g=this.drawOrders[f];if(null==g)t.Utils.arrayCopy(d,0,u,0,d.length);else for(var m=0,v=g.length;m<v;m++)u[m]=d[g[m]]}}else c==e.setup&&t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length)},N);function N(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}t.DrawOrderTimeline=F;var G,U=(Ee(V,G=c),V.prototype.getPropertyId=function(){return(s.ikConstraint<<24)+this.ikConstraintIndex},V.prototype.setFrame=function(t,e,n,i,a,s,r){t*=V.ENTRIES,this.frames[t]=e,this.frames[t+V.MIX]=n,this.frames[t+V.SOFTNESS]=i,this.frames[t+V.BEND_DIRECTION]=a,this.frames[t+V.COMPRESS]=s?1:0,this.frames[t+V.STRETCH]=r?1:0},V.prototype.apply=function(t,n,a,s,r,h,c){var l,u,d,p,f,g=this.frames,m=t.ikConstraints[this.ikConstraintIndex];if(m.active)if(a<g[0])switch(h){case e.setup:return m.mix=m.data.mix,m.softness=m.data.softness,m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,void(m.stretch=m.data.stretch);case e.first:m.mix+=(m.data.mix-m.mix)*r,m.softness+=(m.data.softness-m.softness)*r,m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch}else a>=g[g.length-V.ENTRIES]?h==e.setup?(m.mix=m.data.mix+(g[g.length+V.PREV_MIX]-m.data.mix)*r,m.softness=m.data.softness+(g[g.length+V.PREV_SOFTNESS]-m.data.softness)*r,c==i.mixOut?(m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch):(m.bendDirection=g[g.length+V.PREV_BEND_DIRECTION],m.compress=0!=g[g.length+V.PREV_COMPRESS],m.stretch=0!=g[g.length+V.PREV_STRETCH])):(m.mix+=(g[g.length+V.PREV_MIX]-m.mix)*r,m.softness+=(g[g.length+V.PREV_SOFTNESS]-m.softness)*r,c==i.mixIn&&(m.bendDirection=g[g.length+V.PREV_BEND_DIRECTION],m.compress=0!=g[g.length+V.PREV_COMPRESS],m.stretch=0!=g[g.length+V.PREV_STRETCH])):(u=g[(l=o.binarySearch(g,a,V.ENTRIES))+V.PREV_MIX],d=g[l+V.PREV_SOFTNESS],p=g[l],f=this.getCurvePercent(l/V.ENTRIES-1,1-(a-p)/(g[l+V.PREV_TIME]-p)),h==e.setup?(m.mix=m.data.mix+(u+(g[l+V.MIX]-u)*f-m.data.mix)*r,m.softness=m.data.softness+(d+(g[l+V.SOFTNESS]-d)*f-m.data.softness)*r,c==i.mixOut?(m.bendDirection=m.data.bendDirection,m.compress=m.data.compress,m.stretch=m.data.stretch):(m.bendDirection=g[l+V.PREV_BEND_DIRECTION],m.compress=0!=g[l+V.PREV_COMPRESS],m.stretch=0!=g[l+V.PREV_STRETCH])):(m.mix+=(u+(g[l+V.MIX]-u)*f-m.mix)*r,m.softness+=(d+(g[l+V.SOFTNESS]-d)*f-m.softness)*r,c==i.mixIn&&(m.bendDirection=g[l+V.PREV_BEND_DIRECTION],m.compress=0!=g[l+V.PREV_COMPRESS],m.stretch=0!=g[l+V.PREV_STRETCH])))},V.ENTRIES=6,V.PREV_TIME=-6,V.PREV_MIX=-5,V.PREV_SOFTNESS=-4,V.PREV_BEND_DIRECTION=-3,V.PREV_COMPRESS=-2,V.PREV_STRETCH=-1,V.MIX=1,V.SOFTNESS=2,V.BEND_DIRECTION=3,V.COMPRESS=4,V.STRETCH=5,V);function V(e){var n=G.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*V.ENTRIES),n}t.IkConstraintTimeline=U;var Y,z=(Ee(H,Y=c),H.prototype.getPropertyId=function(){return(s.transformConstraint<<24)+this.transformConstraintIndex},H.prototype.setFrame=function(t,e,n,i,a,s){t*=H.ENTRIES,this.frames[t]=e,this.frames[t+H.ROTATE]=n,this.frames[t+H.TRANSLATE]=i,this.frames[t+H.SCALE]=a,this.frames[t+H.SHEAR]=s},H.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.transformConstraints[this.transformConstraintIndex];if(l.active)if(i<c[0]){var u=l.data;switch(r){case e.setup:return l.rotateMix=u.rotateMix,l.translateMix=u.translateMix,l.scaleMix=u.scaleMix,void(l.shearMix=u.shearMix);case e.first:l.rotateMix+=(u.rotateMix-l.rotateMix)*s,l.translateMix+=(u.translateMix-l.translateMix)*s,l.scaleMix+=(u.scaleMix-l.scaleMix)*s,l.shearMix+=(u.shearMix-l.shearMix)*s}}else{var d,p,f,g,m=0,v=0,y=0,S=0;i>=c[c.length-H.ENTRIES]?(m=c[(d=c.length)+H.PREV_ROTATE],v=c[d+H.PREV_TRANSLATE],y=c[d+H.PREV_SCALE],S=c[d+H.PREV_SHEAR]):(m=c[(p=o.binarySearch(c,i,H.ENTRIES))+H.PREV_ROTATE],v=c[p+H.PREV_TRANSLATE],y=c[p+H.PREV_SCALE],S=c[p+H.PREV_SHEAR],f=c[p],g=this.getCurvePercent(p/H.ENTRIES-1,1-(i-f)/(c[p+H.PREV_TIME]-f)),m+=(c[p+H.ROTATE]-m)*g,v+=(c[p+H.TRANSLATE]-v)*g,y+=(c[p+H.SCALE]-y)*g,S+=(c[p+H.SHEAR]-S)*g),r==e.setup?(u=l.data,l.rotateMix=u.rotateMix+(m-u.rotateMix)*s,l.translateMix=u.translateMix+(v-u.translateMix)*s,l.scaleMix=u.scaleMix+(y-u.scaleMix)*s,l.shearMix=u.shearMix+(S-u.shearMix)*s):(l.rotateMix+=(m-l.rotateMix)*s,l.translateMix+=(v-l.translateMix)*s,l.scaleMix+=(y-l.scaleMix)*s,l.shearMix+=(S-l.shearMix)*s)}},H.ENTRIES=5,H.PREV_TIME=-5,H.PREV_ROTATE=-4,H.PREV_TRANSLATE=-3,H.PREV_SCALE=-2,H.PREV_SHEAR=-1,H.ROTATE=1,H.TRANSLATE=2,H.SCALE=3,H.SHEAR=4,H);function H(e){var n=Y.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*H.ENTRIES),n}t.TransformConstraintTimeline=z;var W,X=(Ee(K,W=c),K.prototype.getPropertyId=function(){return(s.pathConstraintPosition<<24)+this.pathConstraintIndex},K.prototype.setFrame=function(t,e,n){t*=K.ENTRIES,this.frames[t]=e,this.frames[t+K.VALUE]=n},K.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<c[0])switch(r){case e.setup:return void(l.position=l.data.position);case e.first:l.position+=(l.data.position-l.position)*s}else{var u,d,p,f=0;i>=c[c.length-K.ENTRIES]?f=c[c.length+K.PREV_VALUE]:(f=c[(u=o.binarySearch(c,i,K.ENTRIES))+K.PREV_VALUE],d=c[u],p=this.getCurvePercent(u/K.ENTRIES-1,1-(i-d)/(c[u+K.PREV_TIME]-d)),f+=(c[u+K.VALUE]-f)*p),r==e.setup?l.position=l.data.position+(f-l.data.position)*s:l.position+=(f-l.position)*s}},K.ENTRIES=2,K.PREV_TIME=-2,K.PREV_VALUE=-1,K.VALUE=1,K);function K(e){var n=W.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*K.ENTRIES),n}t.PathConstraintPositionTimeline=X;var j,q=(Ee(Z,j=X),Z.prototype.getPropertyId=function(){return(s.pathConstraintSpacing<<24)+this.pathConstraintIndex},Z.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<c[0])switch(r){case e.setup:return void(l.spacing=l.data.spacing);case e.first:l.spacing+=(l.data.spacing-l.spacing)*s}else{var u,d,p,f=0;i>=c[c.length-Z.ENTRIES]?f=c[c.length+Z.PREV_VALUE]:(f=c[(u=o.binarySearch(c,i,Z.ENTRIES))+Z.PREV_VALUE],d=c[u],p=this.getCurvePercent(u/Z.ENTRIES-1,1-(i-d)/(c[u+Z.PREV_TIME]-d)),f+=(c[u+Z.VALUE]-f)*p),r==e.setup?l.spacing=l.data.spacing+(f-l.data.spacing)*s:l.spacing+=(f-l.spacing)*s}},Z);function Z(t){return j.call(this,t)||this}t.PathConstraintSpacingTimeline=q;var J,Q=(Ee($,J=c),$.prototype.getPropertyId=function(){return(s.pathConstraintMix<<24)+this.pathConstraintIndex},$.prototype.setFrame=function(t,e,n,i){t*=$.ENTRIES,this.frames[t]=e,this.frames[t+$.ROTATE]=n,this.frames[t+$.TRANSLATE]=i},$.prototype.apply=function(t,n,i,a,s,r,h){var c=this.frames,l=t.pathConstraints[this.pathConstraintIndex];if(l.active)if(i<c[0])switch(r){case e.setup:return l.rotateMix=l.data.rotateMix,void(l.translateMix=l.data.translateMix);case e.first:l.rotateMix+=(l.data.rotateMix-l.rotateMix)*s,l.translateMix+=(l.data.translateMix-l.translateMix)*s}else{var u,d,p,f=0,g=0;i>=c[c.length-$.ENTRIES]?(f=c[c.length+$.PREV_ROTATE],g=c[c.length+$.PREV_TRANSLATE]):(f=c[(u=o.binarySearch(c,i,$.ENTRIES))+$.PREV_ROTATE],g=c[u+$.PREV_TRANSLATE],d=c[u],p=this.getCurvePercent(u/$.ENTRIES-1,1-(i-d)/(c[u+$.PREV_TIME]-d)),f+=(c[u+$.ROTATE]-f)*p,g+=(c[u+$.TRANSLATE]-g)*p),r==e.setup?(l.rotateMix=l.data.rotateMix+(f-l.data.rotateMix)*s,l.translateMix=l.data.translateMix+(g-l.data.translateMix)*s):(l.rotateMix+=(f-l.rotateMix)*s,l.translateMix+=(g-l.translateMix)*s)}},$.ENTRIES=3,$.PREV_TIME=-3,$.PREV_ROTATE=-2,$.PREV_TRANSLATE=-1,$.ROTATE=1,$.TRANSLATE=2,$);function $(e){var n=J.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*$.ENTRIES),n}t.PathConstraintMixTimeline=Q}(Se=Se||{}),function(t){var e=(n.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,n=0,i=e.length;n<i;n++){var a=e[n];if(null!=a){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var s=t*a.timeScale;if(0<a.delay){if(a.delay-=s,0<a.delay)continue;s=-a.delay,a.delay=0}var r=a.next;if(null!=r){var o=a.trackLast-r.delay;if(0<=o){for(r.delay=0,r.trackTime+=0==a.timeScale?0:(o/a.timeScale+t)*r.timeScale,a.trackTime+=s,this.setCurrent(n,r,!0);null!=r.mixingFrom;)r.mixTime+=t,r=r.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&null==a.mixingFrom){e[n]=null,this.queue.end(a),this.disposeNext(a);continue}if(null!=a.mixingFrom&&this.updateMixingFrom(a,t)){var h=a.mixingFrom;for((a.mixingFrom=null)!=h&&(h.mixingTo=null);null!=h;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=s}}this.queue.drain()},n.prototype.updateMixingFrom=function(t,e){var n=t.mixingFrom;if(null==n)return!0;var i=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,0<t.mixTime&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,null!=n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),i):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)},n.prototype.apply=function(e){if(null==e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var i=this.events,a=this.tracks,s=!1,r=0,o=a.length;r<o;r++){var h=a[r];if(!(null==h||0<h.delay)){s=!0;var c=0==r?t.MixBlend.first:h.mixBlend,l=h.alpha;null!=h.mixingFrom?l*=this.applyMixingFrom(h,e,c):h.trackTime>=h.trackEnd&&null==h.next&&(l=0);var u=h.animationLast,d=h.getAnimationTime(),p=h.animation.timelines.length,f=h.animation.timelines;if(0==r&&1==l||c==t.MixBlend.add)for(var g=0;g<p;g++){t.Utils.webkit602BugfixHelper(l,c);var m=f[g];m instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(m,e,d,c,!0):m.apply(e,u,d,i,l,c,t.MixDirection.mixIn)}else{var v=h.timelineMode,y=0==h.timelinesRotation.length;y&&t.Utils.setArraySize(h.timelinesRotation,p<<1,null);var S=h.timelinesRotation;for(g=0;g<p;g++){var A=f[g],E=v[g]==n.SUBSEQUENT?c:t.MixBlend.setup;A instanceof t.RotateTimeline?this.applyRotateTimeline(A,e,d,l,E,S,g<<1,y):A instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(A,e,d,c,!0):(t.Utils.webkit602BugfixHelper(l,c),A.apply(e,u,d,i,l,E,t.MixDirection.mixIn))}}this.queueEvents(h,d),i.length=0,h.nextAnimationLast=d,h.nextTrackLast=h.trackTime}}for(var x=this.unkeyedState+n.SETUP,b=e.slots,T=0,w=e.slots.length;T<w;T++){var M,C=b[T];C.attachmentState==x&&(M=C.data.attachmentName,C.attachment=null==M?null:e.getAttachment(C.data.index,M))}return this.unkeyedState+=2,this.queue.drain(),s},n.prototype.applyMixingFrom=function(e,i,a){var s=e.mixingFrom;null!=s.mixingFrom&&this.applyMixingFrom(s,i,a);var r=0;0==e.mixDuration?(r=1,a==t.MixBlend.first&&(a=t.MixBlend.setup)):(1<(r=e.mixTime/e.mixDuration)&&(r=1),a!=t.MixBlend.first&&(a=s.mixBlend));var o=r<s.eventThreshold?this.events:null,h=r<s.attachmentThreshold,c=r<s.drawOrderThreshold,l=s.animationLast,u=s.getAnimationTime(),d=s.animation.timelines.length,p=s.animation.timelines,f=s.alpha*e.interruptAlpha,g=f*(1-r);if(a==t.MixBlend.add)for(var m=0;m<d;m++)p[m].apply(i,l,u,o,g,a,t.MixDirection.mixOut);else{var v=s.timelineMode,y=s.timelineHoldMix,S=0==s.timelinesRotation.length;S&&t.Utils.setArraySize(s.timelinesRotation,d<<1,null);var A=s.timelinesRotation;for(m=s.totalAlpha=0;m<d;m++){var E=p[m],x=t.MixDirection.mixOut,b=void 0,T=0;switch(v[m]){case n.SUBSEQUENT:if(!c&&E instanceof t.DrawOrderTimeline)continue;b=a,T=g;break;case n.FIRST:b=t.MixBlend.setup,T=g;break;case n.HOLD_SUBSEQUENT:b=a,T=f;break;case n.HOLD_FIRST:b=t.MixBlend.setup,T=f;break;default:b=t.MixBlend.setup;var w=y[m];T=f*Math.max(0,1-w.mixTime/w.mixDuration)}s.totalAlpha+=T,E instanceof t.RotateTimeline?this.applyRotateTimeline(E,i,u,T,b,A,m<<1,S):E instanceof t.AttachmentTimeline?this.applyAttachmentTimeline(E,i,u,b,h):(t.Utils.webkit602BugfixHelper(T,a),c&&E instanceof t.DrawOrderTimeline&&b==t.MixBlend.setup&&(x=t.MixDirection.mixIn),E.apply(i,l,u,o,T,b,x))}}return 0<e.mixDuration&&this.queueEvents(s,u),this.events.length=0,s.nextAnimationLast=u,s.nextTrackLast=s.trackTime,r},n.prototype.applyAttachmentTimeline=function(e,i,a,s,r){var o,h,c=i.slots[e.slotIndex];c.bone.active&&(a<(o=e.frames)[0]?s!=t.MixBlend.setup&&s!=t.MixBlend.first||this.setAttachment(i,c,c.data.attachmentName,r):(h=a>=o[o.length-1]?o.length-1:t.Animation.binarySearch(o,a)-1,this.setAttachment(i,c,e.attachmentNames[h],r)),c.attachmentState<=this.unkeyedState&&(c.attachmentState=this.unkeyedState+n.SETUP))},n.prototype.setAttachment=function(t,e,i,a){e.attachment=null==i?null:t.getAttachment(e.data.index,i),a&&(e.attachmentState=this.unkeyedState+n.CURRENT)},n.prototype.applyRotateTimeline=function(e,n,i,a,s,r,o,h){if(h&&(r[o]=0),1!=a){var c=e,l=c.frames,u=n.bones[c.boneIndex];if(u.active){var d=0,p=0;if(i<l[0])switch(s){case t.MixBlend.setup:u.rotation=u.data.rotation;default:return;case t.MixBlend.first:d=u.rotation,p=u.data.rotation}else{var f,g,m,v;d=s==t.MixBlend.setup?u.data.rotation:u.rotation;i>=l[l.length-t.RotateTimeline.ENTRIES]?p=u.data.rotation+l[l.length+t.RotateTimeline.PREV_ROTATION]:(g=l[(f=t.Animation.binarySearch(l,i,t.RotateTimeline.ENTRIES))+t.RotateTimeline.PREV_ROTATION],m=l[f],v=c.getCurvePercent((f>>1)-1,1-(i-m)/(l[f+t.RotateTimeline.PREV_TIME]-m)),p=l[f+t.RotateTimeline.ROTATION]-g,p=g+(p-=360*(16384-(16384.499999999996-p/360|0)))*v+u.data.rotation,p-=360*(16384-(16384.499999999996-p/360|0)))}var y,S,A,E,x=0,b=p-d;0==(b-=360*(16384-(16384.499999999996-b/360|0)))?x=r[o]:(y=0,S=h?(y=0,b):(y=r[o],r[o+1]),A=0<b,E=0<=y,t.MathUtils.signum(S)!=t.MathUtils.signum(b)&&Math.abs(S)<=90&&(180<Math.abs(y)&&(y+=360*t.MathUtils.signum(y)),E=A),x=b+y-y%360,E!=A&&(x+=360*t.MathUtils.signum(y)),r[o]=x),r[o+1]=b,d+=x*a,u.rotation=d-360*(16384-(16384.499999999996-d/360|0))}}else e.apply(n,0,i,null,1,s,t.MixDirection.mixIn)},n.prototype.queueEvents=function(t,e){for(var n=t.animationStart,i=t.animationEnd,a=i-n,s=t.trackLast%a,r=this.events,o=0,h=r.length;o<h;o++){var c=r[o];if(c.time<s)break;c.time>i||this.queue.event(t,c)}for((t.loop?0==a||s>t.trackTime%a:i<=e&&t.animationLast<i)&&this.queue.complete(t);o<h;o++)r[o].time<n||this.queue.event(t,r[o])},n.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},n.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var n=e;;){var i=n.mixingFrom;if(null==i)break;this.queue.end(i),n.mixingFrom=null,n.mixingTo=null,n=i}this.tracks[e.trackIndex]=null,this.queue.drain()}}},n.prototype.setCurrent=function(t,e,n){var i=this.expandToIndex(t);this.tracks[t]=e,null!=i&&(n&&this.queue.interrupt(i),((e.mixingFrom=i).mixingTo=e).mixTime=0,null!=i.mixingFrom&&0<i.mixDuration&&(e.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(e)},n.prototype.setAnimation=function(t,e,n){var i=this.data.skeletonData.findAnimation(e);if(null==i)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,i,n)},n.prototype.setAnimationWith=function(t,e,n){if(null==e)throw new Error("animation cannot be null.");var i=!0,a=this.expandToIndex(t);null!=a&&(-1==a.nextTrackLast?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,i=!1):this.disposeNext(a));var s=this.trackEntry(t,e,n,a);return this.setCurrent(t,s,i),this.queue.drain(),s},n.prototype.addAnimation=function(t,e,n,i){var a=this.data.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,n,i)},n.prototype.addAnimationWith=function(t,e,n,i){if(null==e)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(null!=a)for(;null!=a.next;)a=a.next;var s,r=this.trackEntry(t,e,n,a);return null==a?(this.setCurrent(t,r,!0),this.queue.drain()):(a.next=r,i<=0&&(0!=(s=a.animationEnd-a.animationStart)?(a.loop?i+=s*(1+(a.trackTime/s|0)):i+=Math.max(s,a.trackTime),i-=this.data.getMix(a.animation,e)):i=a.trackTime)),r.delay=i,r},n.prototype.setEmptyAnimation=function(t,e){var i=this.setAnimationWith(t,n.emptyAnimation,!1);return i.mixDuration=e,i.trackEnd=e,i},n.prototype.addEmptyAnimation=function(t,e,i){i<=0&&(i-=e);var a=this.addAnimationWith(t,n.emptyAnimation,!1,i);return a.mixDuration=e,a.trackEnd=e,a},n.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var n=0,i=this.tracks.length;n<i;n++){var a=this.tracks[n];null!=a&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},n.prototype.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(t.Utils.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)},n.prototype.trackEntry=function(e,n,i,a){var s=this.trackEntryPool.obtain();return s.trackIndex=e,s.animation=n,s.loop=i,s.holdPrevious=!1,s.eventThreshold=0,s.attachmentThreshold=0,s.drawOrderThreshold=0,s.animationStart=0,s.animationEnd=n.duration,s.animationLast=-1,s.nextAnimationLast=-1,s.delay=0,s.trackTime=0,s.trackLast=-1,s.nextTrackLast=-1,s.trackEnd=Number.MAX_VALUE,s.timeScale=1,s.alpha=1,s.interruptAlpha=1,s.mixTime=0,s.mixDuration=null==a?0:this.data.getMix(a.animation,n),s.mixBlend=t.MixBlend.replace,s},n.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},n.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=0,n=this.tracks.length;e<n;e++){var i=this.tracks[e];if(null!=i){for(;null!=i.mixingFrom;)i=i.mixingFrom;for(;null!=i.mixingFrom&&i.mixBlend==t.MixBlend.add||this.computeHold(i),null!=(i=i.mixingTo););}}},n.prototype.computeHold=function(e){var i=e.mixingTo,a=e.animation.timelines,s=e.animation.timelines.length,r=t.Utils.setArraySize(e.timelineMode,s);e.timelineHoldMix.length=0;var o=t.Utils.setArraySize(e.timelineHoldMix,s),h=this.propertyIDs;if(null!=i&&i.holdPrevious)for(var c=0;c<s;c++)r[c]=h.add(a[c].getPropertyId())?n.HOLD_FIRST:n.HOLD_SUBSEQUENT;else t:for(c=0;c<s;c++){var l=a[c],u=l.getPropertyId();if(h.add(u))if(null==i||l instanceof t.AttachmentTimeline||l instanceof t.DrawOrderTimeline||l instanceof t.EventTimeline||!i.animation.hasTimeline(u))r[c]=n.FIRST;else{for(var d=i.mixingTo;null!=d;d=d.mixingTo)if(!d.animation.hasTimeline(u)){if(0<e.mixDuration){r[c]=n.HOLD_MIX,o[c]=d;continue t}break}r[c]=n.HOLD_FIRST}else r[c]=n.SUBSEQUENT}},n.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},n.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},n.prototype.removeListener=function(t){var e,n,i=g()(e=this.listeners).call(e,t);0<=i&&ar()(n=this.listeners).call(n,i,1)},n.prototype.clearListeners=function(){this.listeners.length=0},n.prototype.clearListenerNotifications=function(){this.queue.clear()},n.emptyAnimation=new t.Animation("<empty>",[],0),n.SUBSEQUENT=0,n.FIRST=1,n.HOLD_SUBSEQUENT=2,n.HOLD_FIRST=3,n.HOLD_MIX=4,n.SETUP=1,n.CURRENT=2,n);function n(e){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new o(this),this.propertyIDs=new t.IntSet,this.animationsChanged=!1,this.trackEntryPool=new t.Pool((function(){return new i})),this.data=e}t.AnimationState=e;var i=(a.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},a.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},a.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},a.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},a.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},a);function a(){this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}t.TrackEntry=i;var s,r,o=(h.prototype.start=function(t){this.objects.push(s.start),this.objects.push(t),this.animState.animationsChanged=!0},h.prototype.interrupt=function(t){this.objects.push(s.interrupt),this.objects.push(t)},h.prototype.end=function(t){this.objects.push(s.end),this.objects.push(t),this.animState.animationsChanged=!0},h.prototype.dispose=function(t){this.objects.push(s.dispose),this.objects.push(t)},h.prototype.complete=function(t){this.objects.push(s.complete),this.objects.push(t)},h.prototype.event=function(t,e){this.objects.push(s.event),this.objects.push(t),this.objects.push(e)},h.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,n=0;n<t.length;n+=2){var i=t[n],a=t[n+1];switch(i){case s.start:null!=a.listener&&a.listener.start&&a.listener.start(a);for(var r=0;r<e.length;r++)e[r].start&&e[r].start(a);break;case s.interrupt:for(null!=a.listener&&a.listener.interrupt&&a.listener.interrupt(a),r=0;r<e.length;r++)e[r].interrupt&&e[r].interrupt(a);break;case s.end:for(null!=a.listener&&a.listener.end&&a.listener.end(a),r=0;r<e.length;r++)e[r].end&&e[r].end(a);case s.dispose:for(null!=a.listener&&a.listener.dispose&&a.listener.dispose(a),r=0;r<e.length;r++)e[r].dispose&&e[r].dispose(a);this.animState.trackEntryPool.free(a);break;case s.complete:for(null!=a.listener&&a.listener.complete&&a.listener.complete(a),r=0;r<e.length;r++)e[r].complete&&e[r].complete(a);break;case s.event:var o=t[2+n++];for(null!=a.listener&&a.listener.event&&a.listener.event(a,o),r=0;r<e.length;r++)e[r].event&&e[r].event(a,o)}}this.clear(),this.drainDisabled=!1}},h.prototype.clear=function(){this.objects.length=0},h);function h(t){this.objects=[],this.drainDisabled=!1,this.animState=t}t.EventQueue=o,(r=s=t.EventType||(t.EventType={}))[r.start=0]="start",r[r.interrupt=1]="interrupt",r[r.end=2]="end",r[r.dispose=3]="dispose",r[r.complete=4]="complete",r[r.event=5]="event";var c=(l.prototype.start=function(t){},l.prototype.interrupt=function(t){},l.prototype.end=function(t){},l.prototype.dispose=function(t){},l.prototype.complete=function(t){},l.prototype.event=function(t,e){},l);function l(){}t.AnimationStateAdapter=c}(Se=Se||{}),n=Se=Se||{},xe.prototype.setMix=function(t,e,n){var i=this.skeletonData.findAnimation(t);if(null==i)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);this.setMixWith(i,a,n)},xe.prototype.setMixWith=function(t,e,n){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var i=t.name+"."+e.name;this.animationToMixTime[i]=n},xe.prototype.getMix=function(t,e){var n=t.name+"."+e.name,i=this.animationToMixTime[n];return void 0===i?this.defaultMix:i},i=xe,n.AnimationStateData=i,a=Se=Se||{},be.prototype.downloadText=function(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType("text/html"),this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.open("GET",t,!0),i.onload=function(){200==i.status?e(i.responseText):n(i.status,i.responseText)},i.onerror=function(){n(i.status,i.responseText)},i.send()},be.prototype.downloadBinary=function(t,e,n){var i=new XMLHttpRequest;this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status?e(new Uint8Array(i.response)):n(i.status,i.responseText)},i.onerror=function(){n(i.status,i.responseText)},i.send()},be.prototype.setRawDataURI=function(t,e){this.rawDataUris[this.pathPrefix+t]=e},be.prototype.loadBinary=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,this.downloadBinary(t,(function(n){i.assets[t]=n,e&&e(t,n),i.toLoad--,i.loaded++}),(function(e,a){i.errors[t]="Couldn't load binary "+t+": status "+status+", "+a,n&&n(t,"Couldn't load binary "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.loadText=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(n){i.assets[t]=n,e&&e(t,n),i.toLoad--,i.loaded++}),(function(e,a){i.errors[t]="Couldn't load text "+t+": status "+status+", "+a,n&&n(t,"Couldn't load text "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.loadTexture=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var a=t=this.pathPrefix+t;this.toLoad++;var s=new Image;s.crossOrigin="anonymous",s.onload=function(n){var r=i.textureLoader(s);i.assets[a]=r,i.toLoad--,i.loaded++,e&&e(t,s)},s.onerror=function(e){i.errors[t]="Couldn't load image "+t,i.toLoad--,i.loaded++,n&&n(t,"Couldn't load image "+t)},this.rawDataUris[t]&&(t=this.rawDataUris[t]),s.src=t},be.prototype.loadTextureAtlas=function(t,e,n){var i=this;void 0===e&&(e=null),void 0===n&&(n=null);var s=0<=it()(t).call(t,"/")?t.substring(0,it()(t).call(t,"/")):"";t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(r){var o={count:0},h=new Array;try{new a.TextureAtlas(r,(function(t){h.push(""==s?t:s+"/"+t);var e=document.createElement("img");return e.width=16,e.height=16,new a.FakeTexture(e)}))}catch(l){var c=l;return i.errors[t]="Couldn't load texture atlas "+t+": "+c.message,n&&n(t,"Couldn't load texture atlas "+t+": "+c.message),i.toLoad--,void i.loaded++}for(var l=0,u=h;l<u.length;l++)!function(c){var l=!1;i.loadTexture(c,(function(c,u){if(o.count++,o.count==h.length)if(l)i.errors[t]="Couldn't load texture atlas page "+c+"} of atlas "+t,n&&n(t,"Couldn't load texture atlas page "+c+" of atlas "+t),i.toLoad--,i.loaded++;else try{var d=new a.TextureAtlas(r,(function(t){return i.get(""==s?t:s+"/"+t)}));i.assets[t]=d,e&&e(t,d),i.toLoad--,i.loaded++}catch(c){var p=c;i.errors[t]="Couldn't load texture atlas "+t+": "+p.message,n&&n(t,"Couldn't load texture atlas "+t+": "+p.message),i.toLoad--,i.loaded++}}),(function(e,a){l=!0,o.count++,o.count==h.length&&(i.errors[t]="Couldn't load texture atlas page "+e+"} of atlas "+t,n&&n(t,"Couldn't load texture atlas page "+e+" of atlas "+t),i.toLoad--,i.loaded++)}))}(u[l])}),(function(e,a){i.errors[t]="Couldn't load texture atlas "+t+": status "+status+", "+a,n&&n(t,"Couldn't load texture atlas "+t+": status "+status+", "+a),i.toLoad--,i.loaded++}))},be.prototype.get=function(t){return t=this.pathPrefix+t,this.assets[t]},be.prototype.remove=function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},be.prototype.removeAll=function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}},be.prototype.isLoadingComplete=function(){return 0==this.toLoad},be.prototype.getToLoad=function(){return this.toLoad},be.prototype.getLoaded=function(){return this.loaded},be.prototype.dispose=function(){this.removeAll()},be.prototype.hasErrors=function(){return 0<Y()(this.errors).length},be.prototype.getErrors=function(){return this.errors},s=be,a.AssetManager=s,r=Se=Se||{},Te.prototype.newRegionAttachment=function(t,e,n){var i=this.atlas.findRegion(n);if(null==i)throw new Error("Region not found in atlas: "+n+" (region attachment: "+e+")");i.renderObject=i;var a=new r.RegionAttachment(e);return a.setRegion(i),a},Te.prototype.newMeshAttachment=function(t,e,n){var i=this.atlas.findRegion(n);if(null==i)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+e+")");i.renderObject=i;var a=new r.MeshAttachment(e);return a.region=i,a},Te.prototype.newBoundingBoxAttachment=function(t,e){return new r.BoundingBoxAttachment(e)},Te.prototype.newPathAttachment=function(t,e){return new r.PathAttachment(e)},Te.prototype.newPointAttachment=function(t,e){return new r.PointAttachment(e)},Te.prototype.newClippingAttachment=function(t,e){return new r.ClippingAttachment(e)},o=Te,r.AtlasAttachmentLoader=o,(c=(h=Se=Se||{}).BlendMode||(h.BlendMode={}))[c.Normal=0]="Normal",c[c.Additive=1]="Additive",c[c.Multiply=2]="Multiply",c[c.Screen=3]="Screen",l=Se=Se||{},we.prototype.isActive=function(){return this.active},we.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},we.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},we.prototype.updateWorldTransformWith=function(t,e,n,i,a,s,r){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=i,this.ascaleY=a,this.ashearX=s,this.ashearY=r,this.appliedValid=!0;var o=this.parent;if(null==o){var h=this.skeleton,c=n+90+r,u=h.scaleX,d=h.scaleY;return this.a=l.MathUtils.cosDeg(n+s)*i*u,this.b=l.MathUtils.cosDeg(c)*a*u,this.c=l.MathUtils.sinDeg(n+s)*i*d,this.d=l.MathUtils.sinDeg(c)*a*d,this.worldX=t*u+h.x,void(this.worldY=e*d+h.y)}var p=o.a,f=o.b,g=o.c,m=o.d;switch(this.worldX=p*t+f*e+o.worldX,this.worldY=g*t+m*e+o.worldY,this.data.transformMode){case l.TransformMode.Normal:c=n+90+r;var v=l.MathUtils.cosDeg(n+s)*i,y=l.MathUtils.cosDeg(c)*a,S=l.MathUtils.sinDeg(n+s)*i,A=l.MathUtils.sinDeg(c)*a;return this.a=p*v+f*S,this.b=p*y+f*A,this.c=g*v+m*S,void(this.d=g*y+m*A);case l.TransformMode.OnlyTranslation:c=n+90+r,this.a=l.MathUtils.cosDeg(n+s)*i,this.b=l.MathUtils.cosDeg(c)*a,this.c=l.MathUtils.sinDeg(n+s)*i,this.d=l.MathUtils.sinDeg(c)*a;break;case l.TransformMode.NoRotationOrReflection:var E,x=n+s-(E=1e-4<(T=p*p+g*g)?(T=Math.abs(p*m-f*g)/T,p/=this.skeleton.scaleX,f=(g/=this.skeleton.scaleY)*T,m=p*T,Math.atan2(g,p)*l.MathUtils.radDeg):(g=p=0,90-Math.atan2(m,f)*l.MathUtils.radDeg)),b=n+r-E+90;v=l.MathUtils.cosDeg(x)*i,y=l.MathUtils.cosDeg(b)*a,S=l.MathUtils.sinDeg(x)*i,A=l.MathUtils.sinDeg(b)*a;this.a=p*v-f*S,this.b=p*y-f*A,this.c=g*v+m*S,this.d=g*y+m*A;break;case l.TransformMode.NoScale:case l.TransformMode.NoScaleOrReflection:var T,w=l.MathUtils.cosDeg(n),M=l.MathUtils.sinDeg(n),C=(p*w+f*M)/this.skeleton.scaleX,P=(g*w+m*M)/this.skeleton.scaleY;1e-5<(T=Math.sqrt(C*C+P*P))&&(T=1/T),C*=T,P*=T,T=Math.sqrt(C*C+P*P),this.data.transformMode==l.TransformMode.NoScale&&p*m-f*g<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(T=-T);var I=Math.PI/2+Math.atan2(P,C),k=Math.cos(I)*T,R=Math.sin(I)*T;v=l.MathUtils.cosDeg(s)*i,y=l.MathUtils.cosDeg(90+r)*a,S=l.MathUtils.sinDeg(s)*i,A=l.MathUtils.sinDeg(90+r)*a;this.a=C*v+k*S,this.b=C*y+k*A,this.c=P*v+R*S,this.d=P*y+R*A}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY},we.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},we.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*l.MathUtils.radDeg},we.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*l.MathUtils.radDeg},we.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},we.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},we.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var t=this.parent;if(null==t)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*l.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*l.MathUtils.radDeg);var e=t.a,n=t.b,i=t.c,a=t.d,s=1/(e*a-n*i),r=this.worldX-t.worldX,o=this.worldY-t.worldY;this.ax=r*a*s-o*n*s,this.ay=o*e*s-r*i*s;var h,c=s*a,u=s*e,d=s*n,p=s*i,f=c*this.a-d*this.c,g=c*this.b-d*this.d,m=u*this.c-p*this.a,v=u*this.d-p*this.b;this.ashearX=0,this.ascaleX=Math.sqrt(f*f+m*m),1e-4<this.ascaleX?(h=f*v-g*m,this.ascaleY=h/this.ascaleX,this.ashearY=Math.atan2(f*g+m*v,h)*l.MathUtils.radDeg,this.arotation=Math.atan2(m,f)*l.MathUtils.radDeg):(this.ascaleX=0,this.ascaleY=Math.sqrt(g*g+v*v),this.ashearY=0,this.arotation=90-Math.atan2(v,g)*l.MathUtils.radDeg)},we.prototype.worldToLocal=function(t){var e=this.a,n=this.b,i=this.c,a=this.d,s=1/(e*a-n*i),r=t.x-this.worldX,o=t.y-this.worldY;return t.x=r*a*s-o*n*s,t.y=o*e*s-r*i*s,t},we.prototype.localToWorld=function(t){var e=t.x,n=t.y;return t.x=e*this.a+n*this.b+this.worldX,t.y=e*this.c+n*this.d+this.worldY,t},we.prototype.worldToLocalRotation=function(t){var e=l.MathUtils.sinDeg(t),n=l.MathUtils.cosDeg(t);return Math.atan2(this.a*e-this.c*n,this.d*n-this.b*e)*l.MathUtils.radDeg+this.rotation-this.shearX},we.prototype.localToWorldRotation=function(t){t-=this.rotation-this.shearX;var e=l.MathUtils.sinDeg(t),n=l.MathUtils.cosDeg(t);return Math.atan2(n*this.c+e*this.d,n*this.a+e*this.b)*l.MathUtils.radDeg},we.prototype.rotateWorld=function(t){var e=this.a,n=this.b,i=this.c,a=this.d,s=l.MathUtils.cosDeg(t),r=l.MathUtils.sinDeg(t);this.a=s*e-r*i,this.b=s*n-r*a,this.c=r*e+s*i,this.d=r*n+s*a,this.appliedValid=!1},u=we,l.Bone=u,(d=Se=Se||{}).BoneData=function(t,e,n){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=p.Normal,this.skinRequired=!1,this.color=new d.Color,t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n},(f=p=d.TransformMode||(d.TransformMode={}))[f.Normal=0]="Normal",f[f.OnlyTranslation=1]="OnlyTranslation",f[f.NoRotationOrReflection=2]="NoRotationOrReflection",f[f.NoScale=3]="NoScale",f[f.NoScaleOrReflection=4]="NoScaleOrReflection",(Se||(Se={})).ConstraintData=function(t,e,n){this.name=t,this.order=e,this.skinRequired=n},(Se||(Se={})).Event=function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e},(Se||(Se={})).EventData=function(t){this.name=t},m=Se=Se||{},Me.prototype.isActive=function(){return this.active},Me.prototype.apply=function(){this.update()},Me.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}},Me.prototype.apply1=function(t,e,n,i,a,s,r){t.appliedValid||t.updateAppliedTransform();var o=t.parent,h=o.a,c=o.b,l=o.c,u=o.d,d=-t.ashearX-t.arotation,p=0,f=0;switch(t.data.transformMode){case m.TransformMode.OnlyTranslation:p=e-t.worldX,f=n-t.worldY;break;case m.TransformMode.NoRotationOrReflection:var g=Math.abs(h*u-c*l)/(h*h+l*l),v=h/t.skeleton.scaleX,y=l/t.skeleton.scaleY;c=-y*g*t.skeleton.scaleX,u=v*g*t.skeleton.scaleY;d+=Math.atan2(y,v)*m.MathUtils.radDeg;default:var S=e-o.worldX,A=n-o.worldY,E=h*u-c*l;p=(S*u-A*c)/E-t.ax,f=(A*h-S*l)/E-t.ay}d+=Math.atan2(f,p)*m.MathUtils.radDeg,t.ascaleX<0&&(d+=180),180<d?d-=360:d<-180&&(d+=360);var x=t.ascaleX,b=t.ascaleY;if(i||a){switch(t.data.transformMode){case m.TransformMode.NoScale:case m.TransformMode.NoScaleOrReflection:p=e-t.worldX,f=n-t.worldY}var T=t.data.length*x,w=Math.sqrt(p*p+f*f);(i&&w<T||a&&T<w&&1e-4<T)&&(x*=g=(w/T-1)*r+1,s&&(b*=g))}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*r,x,b,t.ashearX,t.ashearY)},Me.prototype.apply2=function(t,e,n,i,a,s,r,o){if(0!=o){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var h,c=t.ax,l=t.ay,u=t.ascaleX,d=u,p=t.ascaleY,f=e.ascaleX,g=0,v=0;v=u<0?(u=-u,g=180,-1):(g=0,1);p<0&&(p=-p,v=-v),h=f<0?(f=-f,180):0;var y=e.ax,S=0,A=0,E=t.a,x=t.b,b=t.c,T=t.d,w=Math.abs(u-p)<=1e-4,M=w?(A=E*y+x*(S=e.ay)+t.worldX,b*y+T*S+t.worldY):(S=0,A=E*y+t.worldX,b*y+t.worldY),C=t.parent;E=C.a,x=C.b;b=C.c;var P,I=1/(E*(T=C.d)-x*b),k=A-C.worldX,R=M-C.worldY,O=(k*T-R*x)*I-c,_=(R*E-k*b)*I-l,D=Math.sqrt(O*O+_*_),B=e.data.length*f;if(D<1e-4)return this.apply1(t,n,i,!1,s,!1,o),void e.updateWorldTransformWith(y,S,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var L,F,N,G=((k=n-C.worldX)*T-(R=i-C.worldY)*x)*I-c,U=(R*E-k*b)*I-l,V=G*G+U*U;0!=r&&(r*=u*(f+1)/2,0<(F=(L=Math.sqrt(V))-D-B*u+r)&&(V=(G-=(N=(F-r*(1-(N=Math.min(1,F/(2*r))-1)*N))/L)*G)*G+(U-=N*U)*U));t:if(w){var Y=(V-D*D-(B*=u)*B)/(2*D*B);Y<-1?Y=-1:1<Y&&(Y=1,s&&(d*=(Math.sqrt(V)/(D+B)-1)*o+1)),P=Math.acos(Y)*a,E=D+B*Y,x=B*Math.sin(P),rt=Math.atan2(U*E-G*x,G*E+U*x)}else{var z=(E=u*B)*E,H=(x=p*B)*x,W=Math.atan2(U,G),X=-2*H*D,K=H-z;if(0<=(T=X*X-4*K*(b=H*D*D+z*V-z*H))){var j=Math.sqrt(T);X<0&&(j=-j);var q=(j=-(X+j)/2)/K,Z=b/j,J=Math.abs(q)<Math.abs(Z)?q:Z;if(J*J<=V){R=Math.sqrt(V-J*J)*a,rt=W-Math.atan2(R,J),P=Math.atan2(R/p,(J-D)/u);break t}}var Q=m.MathUtils.PI,$=D-E,tt=$*$,et=0,nt=0,it=D+E,at=it*it,st=0;-1<=(b=-E*D/(z-H))&&b<=1&&(b=Math.acos(b),(T=(k=E*Math.cos(b)+D)*k+(R=x*Math.sin(b))*R)<tt&&(Q=b,tt=T,$=k,et=R),at<T&&(nt=b,at=T,it=k,st=R)),P=V<=(tt+at)/2?(rt=W-Math.atan2(et*a,$),Q*a):(rt=W-Math.atan2(st*a,it),nt*a)}var rt,ot=Math.atan2(S,y)*v,ht=t.arotation;180<(rt=(rt-ot)*m.MathUtils.radDeg+g-ht)?rt-=360:rt<-180&&(rt+=360),t.updateWorldTransformWith(c,l,ht+rt*o,d,t.ascaleY,0,0),ht=e.arotation,180<(P=((P+ot)*m.MathUtils.radDeg-e.ashearX)*v+h-ht)?P-=360:P<-180&&(P+=360),e.updateWorldTransformWith(y,S,ht+P*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()},v=Me,m.IkConstraint=v,y=Se=Se||{},S=y.ConstraintData,Ee(Ce,S),A=Ce,y.IkConstraintData=A,E=Se=Se||{},Pe.prototype.isActive=function(){return this.active},Pe.prototype.apply=function(){this.update()},Pe.prototype.update=function(){var t=this.target.getAttachment();if(t instanceof E.PathAttachment){var e=this.rotateMix,n=this.translateMix,i=0<e;if(0<n||i){var a=this.data,s=a.spacingMode==E.SpacingMode.Percent,r=a.rotateMode,o=r==E.RotateMode.Tangent,h=r==E.RotateMode.ChainScale,c=this.bones.length,l=o?c:c+1,u=this.bones,d=E.Utils.setArraySize(this.spaces,l),p=null,f=this.spacing;if(h||!s){h&&(p=E.Utils.setArraySize(this.lengths,c));for(var g=a.spacingMode==E.SpacingMode.Length,m=0,v=l-1;m<v;){var y,S,A=(C=u[m]).data.length;A<Pe.epsilon?(h&&(p[m]=0),d[++m]=0):s?(h&&(I=A*C.a,k=A*C.c,y=Math.sqrt(I*I+k*k),p[m]=y),d[++m]=f):(I=A*C.a,k=A*C.c,S=Math.sqrt(I*I+k*k),h&&(p[m]=S),d[++m]=(g?A+f:f)*S/A)}}else for(m=1;m<l;m++)d[m]=f;var x=this.computeWorldPositions(t,l,o,a.positionMode==E.PositionMode.Percent,s),b=x[0],T=x[1],w=a.offsetRotation,M=!1;0==w?M=r==E.RotateMode.Chain:(M=!1,w*=0<(P=this.target.bone).a*P.d-P.b*P.c?E.MathUtils.degRad:-E.MathUtils.degRad);m=0;for(var C,P=3;m<c;m++,P+=3){(C=u[m]).worldX+=(b-C.worldX)*n,C.worldY+=(T-C.worldY)*n;var I,k,R,O,_,D,B,L,F,N,G,U,V=(I=x[P])-b,Y=(k=x[P+1])-T;!h||0!=(R=p[m])&&(O=(Math.sqrt(V*V+Y*Y)/R-1)*e+1,C.a*=O,C.c*=O),b=I,T=k,i&&(_=C.a,D=C.b,B=C.c,L=C.d,N=F=U=0,U=o?x[P-1]:0==d[m+1]?x[P+2]:Math.atan2(Y,V),U-=Math.atan2(B,_),M?(F=Math.cos(U),N=Math.sin(U),b+=((G=C.data.length)*(F*_-N*B)-V)*e,T+=(G*(N*_+F*B)-Y)*e):U+=w,U>E.MathUtils.PI?U-=E.MathUtils.PI2:U<-E.MathUtils.PI&&(U+=E.MathUtils.PI2),U*=e,F=Math.cos(U),N=Math.sin(U),C.a=F*_-N*B,C.b=F*D-N*L,C.c=N*_+F*B,C.d=N*D+F*L),C.appliedValid=!1}}}},Pe.prototype.computeWorldPositions=function(t,e,n,i,a){var s=this.target,r=this.position,o=this.spaces,h=E.Utils.setArraySize(this.positions,3*e+2),c=null,l=t.closed,u=t.worldVerticesLength,d=u/6,p=Pe.NONE;if(!t.constantSpeed){var f=t.lengths,g=f[d-=l?1:2];if(i&&(r*=g),a)for(var m=1;m<e;m++)o[m]*=g;c=E.Utils.setArraySize(this.world,8);m=0;for(var v=0,y=0;m<e;m++,v+=3){var S=r+=H=o[m];if(l)(S%=g)<0&&(S+=g),y=0;else{if(S<0){p!=Pe.BEFORE&&(p=Pe.BEFORE,t.computeWorldVertices(s,2,4,c,0,2)),this.addBeforePosition(S,c,0,h,v);continue}if(g<S){p!=Pe.AFTER&&(p=Pe.AFTER,t.computeWorldVertices(s,u-6,4,c,0,2)),this.addAfterPosition(S-g,c,0,h,v);continue}}for(;;y++){var A=f[y];if(!(A<S)){0==y?S/=A:S=(S-(K=f[y-1]))/(A-K);break}}y!=p&&(p=y,l&&y==d?(t.computeWorldVertices(s,u-4,4,c,0,2),t.computeWorldVertices(s,0,4,c,4,2)):t.computeWorldVertices(s,6*y+2,8,c,0,2)),this.addCurvePosition(S,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,v,n||0<m&&0==H)}return h}l?(u+=2,c=E.Utils.setArraySize(this.world,u),t.computeWorldVertices(s,2,u-4,c,0,2),t.computeWorldVertices(s,0,2,c,u-4,2),c[u-2]=c[0],c[u-1]=c[1]):(d--,u-=4,c=E.Utils.setArraySize(this.world,u),t.computeWorldVertices(s,2,u,c,0,2));for(var x=E.Utils.setArraySize(this.curves,d),b=0,T=c[0],w=c[1],M=0,C=0,P=0,I=0,k=0,R=0,O=0,_=0,D=0,B=0,L=0,F=0,N=0,G=0,U=(m=0,2);m<d;m++,U+=6)M=c[U],C=c[U+1],P=c[U+2],I=c[U+3],L=2*(O=.1875*(T-2*M+P))+(D=.09375*(3*(M-P)-T+(k=c[U+4]))),F=2*(_=.1875*(w-2*C+I))+(B=.09375*(3*(C-I)-w+(R=c[U+5]))),N=.75*(M-T)+O+.16666667*D,G=.75*(C-w)+_+.16666667*B,b+=Math.sqrt(N*N+G*G),N+=L,G+=F,L+=D,F+=B,b+=Math.sqrt(N*N+G*G),N+=L,G+=F,b+=Math.sqrt(N*N+G*G),N+=L+D,G+=F+B,b+=Math.sqrt(N*N+G*G),x[m]=b,T=k,w=R;if(r*=i?b:b/t.lengths[d-1],a)for(m=1;m<e;m++)o[m]*=b;for(var V=this.segments,Y=0,z=(m=0,v=0,y=0,0);m<e;m++,v+=3){var H;S=r+=H=o[m];if(l)(S%=b)<0&&(S+=b),y=0;else{if(S<0){this.addBeforePosition(S,c,0,h,v);continue}if(b<S){this.addAfterPosition(S-b,c,u-4,h,v);continue}}for(;;y++){var W=x[y];if(!(W<S)){0==y?S/=W:S=(S-(K=x[y-1]))/(W-K);break}}if(y!=p){var X=6*(p=y);T=c[X],w=c[X+1],M=c[X+2],C=c[X+3],P=c[X+4],I=c[X+5],L=2*(O=.03*(T-2*M+P))+(D=.006*(3*(M-P)-T+(k=c[X+6]))),F=2*(_=.03*(w-2*C+I))+(B=.006*(3*(C-I)-w+(R=c[X+7]))),N=.3*(M-T)+O+.16666667*D,G=.3*(C-w)+_+.16666667*B,Y=Math.sqrt(N*N+G*G);for(V[0]=Y,X=1;X<8;X++)N+=L,G+=F,L+=D,F+=B,Y+=Math.sqrt(N*N+G*G),V[X]=Y;N+=L,G+=F,Y+=Math.sqrt(N*N+G*G),V[8]=Y,N+=L+D,G+=F+B,Y+=Math.sqrt(N*N+G*G),V[9]=Y,z=0}for(S*=Y;;z++){var K,j=V[z];if(!(j<S)){0==z?S/=j:S=z+(S-(K=V[z-1]))/(j-K);break}}this.addCurvePosition(.1*S,T,w,M,C,P,I,k,R,h,v,n||0<m&&0==H)}return h},Pe.prototype.addBeforePosition=function(t,e,n,i,a){var s=e[n],r=e[n+1],o=e[n+2]-s,h=e[n+3]-r,c=Math.atan2(h,o);i[a]=s+t*Math.cos(c),i[a+1]=r+t*Math.sin(c),i[a+2]=c},Pe.prototype.addAfterPosition=function(t,e,n,i,a){var s=e[n+2],r=e[n+3],o=s-e[n],h=r-e[n+1],c=Math.atan2(h,o);i[a]=s+t*Math.cos(c),i[a+1]=r+t*Math.sin(c),i[a+2]=c},Pe.prototype.addCurvePosition=function(t,e,n,i,a,s,r,o,h,c,l,u){if(0==t||isNaN(t))return c[l]=e,c[l+1]=n,void(c[l+2]=Math.atan2(a-n,i-e));var d=t*t,p=d*t,f=1-t,g=f*f,m=g*f,v=f*t,y=3*v,S=f*y,A=y*t,E=e*m+i*S+s*A+o*p,x=n*m+a*S+r*A+h*p;c[l]=E,c[l+1]=x,u&&(c[l+2]=t<.001?Math.atan2(a-n,i-e):Math.atan2(x-(n*g+a*v*2+r*d),E-(e*g+i*v*2+s*d)))},Pe.NONE=-1,Pe.BEFORE=-2,Pe.AFTER=-3,Pe.epsilon=1e-5,x=Pe,E.PathConstraint=x,b=Se=Se||{},T=b.ConstraintData,Ee(Ie,T),P=Ie,b.PathConstraintData=P,(w=b.PositionMode||(b.PositionMode={}))[w.Fixed=0]="Fixed",w[w.Percent=1]="Percent",(M=b.SpacingMode||(b.SpacingMode={}))[M.Length=0]="Length",M[M.Fixed=1]="Fixed",M[M.Percent=2]="Percent",(C=b.RotateMode||(b.RotateMode={}))[C.Tangent=0]="Tangent",C[C.Chain=1]="Chain",C[C.ChainScale=2]="ChainScale",I=Se=Se||{},ke.prototype.loaded=function(){var t=0;for(var e in this.assets)t++;return t},k=ke,Re.prototype.queueAsset=function(t,e,n){var i=this.clientAssets[t];return null==i&&(i=new k(t),this.clientAssets[t]=i),null!==e&&(i.textureLoader=e),i.toLoad.push(n),this.queuedAssets[n]!==n&&(this.queuedAssets[n]=n,!0)},Re.prototype.loadText=function(t,e){var n,i=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((n=new XMLHttpRequest).overrideMimeType("text/html"),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200<=n.status&&n.status<300?i.rawAssets[e]=n.responseText:i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send())},Re.prototype.loadJson=function(t,e){var n,i=this;e=this.pathPrefix+e,this.queueAsset(t,null,e)&&((n=new XMLHttpRequest).overrideMimeType("text/html"),n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200<=n.status&&n.status<300?i.rawAssets[e]=JSON.parse(n.responseText):i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send())},Re.prototype.loadTexture=function(t,e,n){var i,a=this;n=this.pathPrefix+n,this.queueAsset(t,e,n)&&("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document||"undefined"==typeof importScripts?((i=new Image).crossOrigin="anonymous",i.onload=function(t){a.rawAssets[n]=i},i.onerror=function(t){a.errors[n]="Couldn't load image "+n},i.src=n):fetch(n,{mode:"cors"}).then((function(t){return t.ok||(a.errors[n]="Couldn't load image "+n),t.blob()})).then((function(t){return createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"})})).then((function(t){a.rawAssets[n]=t})))},Re.prototype.get=function(t,e){e=this.pathPrefix+e;var n=this.clientAssets[t];return null==n||n.assets[e]},Re.prototype.updateClientAssets=function(t){for(var e=!("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document)&&"undefined"!=typeof importScripts,n=0;n<t.toLoad.length;n++){var i=t.toLoad[n];if(null==t.assets[i]){var a=this.rawAssets[i];if(null==a)continue;e?a instanceof ImageBitmap?t.assets[i]=t.textureLoader(a):t.assets[i]=a:a instanceof HTMLImageElement?t.assets[i]=t.textureLoader(a):t.assets[i]=a}}},Re.prototype.isLoadingComplete=function(t){var e=this.clientAssets[t];return null==e||(this.updateClientAssets(e),e.toLoad.length==e.loaded())},Re.prototype.dispose=function(){},Re.prototype.hasErrors=function(){return 0<Y()(this.errors).length},Re.prototype.getErrors=function(){return this.errors},R=Re,I.SharedAssetManager=R,O=Se=Se||{},Oe.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,n=t.length;e<n;e++)(a=t[e]).sorted=a.data.skinRequired,a.active=!a.sorted;if(null!=this.skin){var i=this.skin.bones;for(e=0,n=this.skin.bones.length;e<n;e++)for(var a=this.bones[i[e].index];a.sorted=!1,a.active=!0,null!=(a=a.parent););}var s=this.ikConstraints,r=this.transformConstraints,o=this.pathConstraints,h=s.length,c=r.length,l=o.length,u=h+c+l;t:for(e=0;e<u;e++){for(var d=0;d<h;d++)if((p=s[d]).data.order==e){this.sortIkConstraint(p);continue t}for(d=0;d<c;d++)if((p=r[d]).data.order==e){this.sortTransformConstraint(p);continue t}var p;for(d=0;d<l;d++)if((p=o[d]).data.order==e){this.sortPathConstraint(p);continue t}}for(e=0,n=t.length;e<n;e++)this.sortBone(t[e])},Oe.prototype.sortIkConstraint=function(t){var e,n,i,a,s;t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&O.Utils.contains(this.skin.constraints,t.data,!0)),t.active&&(n=t.target,this.sortBone(n),a=(i=t.bones)[0],this.sortBone(a),1<i.length&&(s=i[i.length-1],-1<g()(e=this._updateCache).call(e,s)||this.updateCacheReset.push(s)),this._updateCache.push(t),this.sortReset(a.children),i[i.length-1].sorted=!0)},Oe.prototype.sortPathConstraint=function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&O.Utils.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,n=e.data.index,i=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,i),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,i);for(var a=0,s=this.data.skins.length;a<s;a++)this.sortPathConstraintAttachment(this.data.skins[a],n,i);var r=e.getAttachment();r instanceof O.PathAttachment&&this.sortPathConstraintAttachmentWith(r,i);var o=t.bones,h=o.length;for(a=0;a<h;a++)this.sortBone(o[a]);for(this._updateCache.push(t),a=0;a<h;a++)this.sortReset(o[a].children);for(a=0;a<h;a++)o[a].sorted=!0}},Oe.prototype.sortTransformConstraint=function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&O.Utils.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,n=e.length;if(t.data.local)for(var i=0;i<n;i++){var a,s=e[i];this.sortBone(s.parent),-1<g()(a=this._updateCache).call(a,s)||this.updateCacheReset.push(s)}else for(i=0;i<n;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var r=0;r<n;r++)this.sortReset(e[r].children);for(r=0;r<n;r++)e[r].sorted=!0}},Oe.prototype.sortPathConstraintAttachment=function(t,e,n){var i=t.attachments[e];if(i)for(var a in i)this.sortPathConstraintAttachmentWith(i[a],n)},Oe.prototype.sortPathConstraintAttachmentWith=function(t,e){if(t instanceof O.PathAttachment){var n=t.bones;if(null==n)this.sortBone(e);else for(var i=this.bones,a=0;a<n.length;)for(var s=n[a++],r=a+s;a<r;a++){var o=n[a];this.sortBone(i[o])}}},Oe.prototype.sortBone=function(t){var e;t.sorted||(null!=(e=t.parent)&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t))},Oe.prototype.sortReset=function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}},Oe.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,n=t.length;e<n;e++){var i=t[e];i.ax=i.x,i.ay=i.y,i.arotation=i.rotation,i.ascaleX=i.scaleX,i.ascaleY=i.scaleY,i.ashearX=i.shearX,i.ashearY=i.shearY,i.appliedValid=!0}var a=this._updateCache;for(e=0,n=a.length;e<n;e++)a[e].update()},Oe.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},Oe.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,n=t.length;e<n;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(e=0,n=i.length;e<n;e++)(o=i[e]).mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;var a=this.transformConstraints;for(e=0,n=a.length;e<n;e++){var s=(o=a[e]).data;o.rotateMix=s.rotateMix,o.translateMix=s.translateMix,o.scaleMix=s.scaleMix,o.shearMix=s.shearMix}var r=this.pathConstraints;for(e=0,n=r.length;e<n;e++){var o;s=(o=r[e]).data;o.position=s.position,o.spacing=s.spacing,o.rotateMix=s.rotateMix,o.translateMix=s.translateMix}},Oe.prototype.setSlotsToSetupPose=function(){var t=this.slots;O.Utils.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,n=t.length;e<n;e++)t[e].setToSetupPose()},Oe.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},Oe.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},Oe.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].data.name==t)return n;return-1},Oe.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},Oe.prototype.setSkin=function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,n=0,i=e.length;n<i;n++){var a,s=e[n],r=s.data.attachmentName;null==r||null!=(a=t.getAttachment(n,r))&&s.setAttachment(a)}this.skin=t,this.updateCache()}},Oe.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},Oe.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var n=this.skin.getAttachment(t,e);if(null!=n)return n}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},Oe.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var n=this.slots,i=0,a=n.length;i<a;i++){var s=n[i];if(s.data.name==t){var r=null;if(null!=e&&null==(r=this.getAttachment(i,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void s.setAttachment(r)}}throw new Error("Slot not found: "+t)},Oe.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.data.name==t)return a}return null},Oe.prototype.getBounds=function(t,e,n){if(void 0===n&&(n=new Array(2)),null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var i=this.drawOrder,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,h=0,c=i.length;h<c;h++){var l=i[h];if(l.bone.active){var u,d=0,p=null,f=l.getAttachment();if(f instanceof O.RegionAttachment?(d=8,p=O.Utils.setArraySize(n,d,0),f.computeWorldVertices(l.bone,p,0,2)):f instanceof O.MeshAttachment&&(d=(u=f).worldVerticesLength,p=O.Utils.setArraySize(n,d,0),u.computeWorldVertices(l,0,d,p,0,2)),null!=p)for(var g=0,m=p.length;g<m;g+=2){var v=p[g],y=p[g+1];a=Math.min(a,v),s=Math.min(s,y),r=Math.max(r,v),o=Math.max(o,y)}}}t.set(a,s),e.set(r-a,o-s)},Oe.prototype.update=function(t){this.time+=t},_=Oe,O.Skeleton=_,function(t){var e=(n.prototype.readSkeletonData=function(e){var a=this.scale,s=new t.SkeletonData;s.name="";var r=new i(e);if(s.hash=r.readString(),s.version=r.readString(),"3.8.75"==s.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");s.x=r.readFloat(),s.y=r.readFloat(),s.width=r.readFloat(),s.height=r.readFloat();var o=r.readBoolean();o&&(s.fps=r.readFloat(),s.imagesPath=r.readString(),s.audioPath=r.readString());for(var h=0,c=(h=r.readInt(!0),0);c<h;c++)r.strings.push(r.readString());for(h=r.readInt(!0),c=0;c<h;c++){var l=r.readString(),u=0==c?null:s.bones[r.readInt(!0)];(f=new t.BoneData(c,l,u)).rotation=r.readFloat(),f.x=r.readFloat()*a,f.y=r.readFloat()*a,f.scaleX=r.readFloat(),f.scaleY=r.readFloat(),f.shearX=r.readFloat(),f.shearY=r.readFloat(),f.length=r.readFloat()*a,f.transformMode=n.TransformModeValues[r.readInt(!0)],f.skinRequired=r.readBoolean(),o&&t.Color.rgba8888ToColor(f.color,r.readInt32()),s.bones.push(f)}for(h=r.readInt(!0),c=0;c<h;c++){var d=r.readString(),p=s.bones[r.readInt(!0)],f=new t.SlotData(c,d,p);t.Color.rgba8888ToColor(f.color,r.readInt32());var g=r.readInt32();-1!=g&&t.Color.rgb888ToColor(f.darkColor=new t.Color,g),f.attachmentName=r.readStringRef(),f.blendMode=n.BlendModeValues[r.readInt(!0)],s.slots.push(f)}h=r.readInt(!0);c=0;for(var m=void 0;c<h;c++){(f=new t.IkConstraintData(r.readString())).order=r.readInt(!0),f.skinRequired=r.readBoolean(),m=r.readInt(!0);for(var v=0;v<m;v++)f.bones.push(s.bones[r.readInt(!0)]);f.target=s.bones[r.readInt(!0)],f.mix=r.readFloat(),f.softness=r.readFloat()*a,f.bendDirection=r.readByte(),f.compress=r.readBoolean(),f.stretch=r.readBoolean(),f.uniform=r.readBoolean(),s.ikConstraints.push(f)}for(h=r.readInt(!0),m=void(c=0);c<h;c++){for((f=new t.TransformConstraintData(r.readString())).order=r.readInt(!0),f.skinRequired=r.readBoolean(),m=r.readInt(!0),v=0;v<m;v++)f.bones.push(s.bones[r.readInt(!0)]);f.target=s.bones[r.readInt(!0)],f.local=r.readBoolean(),f.relative=r.readBoolean(),f.offsetRotation=r.readFloat(),f.offsetX=r.readFloat()*a,f.offsetY=r.readFloat()*a,f.offsetScaleX=r.readFloat(),f.offsetScaleY=r.readFloat(),f.offsetShearY=r.readFloat(),f.rotateMix=r.readFloat(),f.translateMix=r.readFloat(),f.scaleMix=r.readFloat(),f.shearMix=r.readFloat(),s.transformConstraints.push(f)}for(h=r.readInt(!0),m=void(c=0);c<h;c++){for((f=new t.PathConstraintData(r.readString())).order=r.readInt(!0),f.skinRequired=r.readBoolean(),m=r.readInt(!0),v=0;v<m;v++)f.bones.push(s.bones[r.readInt(!0)]);f.target=s.slots[r.readInt(!0)],f.positionMode=n.PositionModeValues[r.readInt(!0)],f.spacingMode=n.SpacingModeValues[r.readInt(!0)],f.rotateMode=n.RotateModeValues[r.readInt(!0)],f.offsetRotation=r.readFloat(),f.position=r.readFloat(),f.positionMode==t.PositionMode.Fixed&&(f.position*=a),f.spacing=r.readFloat(),f.spacingMode!=t.SpacingMode.Length&&f.spacingMode!=t.SpacingMode.Fixed||(f.spacing*=a),f.rotateMix=r.readFloat(),f.translateMix=r.readFloat(),s.pathConstraints.push(f)}var y=this.readSkin(r,s,!0,o);for(null!=y&&(s.defaultSkin=y,s.skins.push(y)),c=s.skins.length,t.Utils.setArraySize(s.skins,h=c+r.readInt(!0));c<h;c++)s.skins[c]=this.readSkin(r,s,!1,o);for(h=this.linkedMeshes.length,c=0;c<h;c++){var S=this.linkedMeshes[c],A=null==S.skin?s.defaultSkin:s.findSkin(S.skin);if(null==A)throw new Error("Skin not found: "+S.skin);var E=A.getAttachment(S.slotIndex,S.parent);if(null==E)throw new Error("Parent mesh not found: "+S.parent);S.mesh.deformAttachment=S.inheritDeform?E:S.mesh,S.mesh.setParentMesh(E),S.mesh.updateUVs()}for(this.linkedMeshes.length=0,h=r.readInt(!0),c=0;c<h;c++)(f=new t.EventData(r.readStringRef())).intValue=r.readInt(!1),f.floatValue=r.readFloat(),f.stringValue=r.readString(),f.audioPath=r.readString(),null!=f.audioPath&&(f.volume=r.readFloat(),f.balance=r.readFloat()),s.events.push(f);for(h=r.readInt(!0),c=0;c<h;c++)s.animations.push(this.readAnimation(r,r.readString(),s));return s},n.prototype.readSkin=function(e,n,i,a){var s=null,r=0;if(i){if(0==(r=e.readInt(!0)))return null;s=new t.Skin("default")}else{(s=new t.Skin(e.readStringRef())).bones.length=e.readInt(!0);for(var o=0,h=s.bones.length;o<h;o++)s.bones[o]=n.bones[e.readInt(!0)];for(o=0,h=e.readInt(!0);o<h;o++)s.constraints.push(n.ikConstraints[e.readInt(!0)]);for(o=0,h=e.readInt(!0);o<h;o++)s.constraints.push(n.transformConstraints[e.readInt(!0)]);for(o=0,h=e.readInt(!0);o<h;o++)s.constraints.push(n.pathConstraints[e.readInt(!0)]);r=e.readInt(!0)}for(o=0;o<r;o++)for(var c=e.readInt(!0),l=0,u=e.readInt(!0);l<u;l++){var d=e.readStringRef(),p=this.readAttachment(e,n,s,c,d,a);null!=p&&s.setAttachment(c,d,p)}return s},n.prototype.readAttachment=function(e,i,a,r,o,h){var c=this.scale,l=e.readStringRef();null==l&&(l=o);var u=e.readByte();switch(n.AttachmentTypeValues[u]){case t.AttachmentType.Region:var d=e.readStringRef(),p=e.readFloat(),f=e.readFloat(),g=e.readFloat(),m=e.readFloat(),v=e.readFloat(),y=e.readFloat(),S=e.readFloat(),A=e.readInt32();null==d&&(d=l);var E=this.attachmentLoader.newRegionAttachment(a,l,d);return null==E?null:(E.path=d,E.x=f*c,E.y=g*c,E.scaleX=m,E.scaleY=v,E.rotation=p,E.width=y*c,E.height=S*c,t.Color.rgba8888ToColor(E.color,A),E.updateOffset(),E);case t.AttachmentType.BoundingBox:var x=e.readInt(!0),b=this.readVertices(e,x),T=(A=h?e.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(a,l));return null==T?null:(T.worldVerticesLength=x<<1,T.vertices=b.vertices,T.bones=b.bones,h&&t.Color.rgba8888ToColor(T.color,A),T);case t.AttachmentType.Mesh:d=e.readStringRef(),A=e.readInt32(),x=e.readInt(!0);var w=this.readFloatArray(e,x<<1,1),M=this.readShortArray(e),C=(b=this.readVertices(e,x),e.readInt(!0)),P=null;y=0,S=0;return h&&(P=this.readShortArray(e),y=e.readFloat(),S=e.readFloat()),null==d&&(d=l),null==(I=this.attachmentLoader.newMeshAttachment(a,l,d))?null:(I.path=d,t.Color.rgba8888ToColor(I.color,A),I.bones=b.bones,I.vertices=b.vertices,I.worldVerticesLength=x<<1,I.triangles=M,I.regionUVs=w,I.updateUVs(),I.hullLength=C<<1,h&&(I.edges=P,I.width=y*c,I.height=S*c),I);case t.AttachmentType.LinkedMesh:d=e.readStringRef(),A=e.readInt32();var I,k=e.readStringRef(),R=e.readStringRef(),O=e.readBoolean();y=0,S=0;return h&&(y=e.readFloat(),S=e.readFloat()),null==d&&(d=l),null==(I=this.attachmentLoader.newMeshAttachment(a,l,d))?null:(I.path=d,t.Color.rgba8888ToColor(I.color,A),h&&(I.width=y*c,I.height=S*c),this.linkedMeshes.push(new s(I,k,r,R,O)),I);case t.AttachmentType.Path:for(var _=e.readBoolean(),D=e.readBoolean(),B=(x=e.readInt(!0),b=this.readVertices(e,x),t.Utils.newArray(x/3,0)),L=0,F=B.length;L<F;L++)B[L]=e.readFloat()*c;return A=h?e.readInt32():0,null==(d=this.attachmentLoader.newPathAttachment(a,l))?null:(d.closed=_,d.constantSpeed=D,d.worldVerticesLength=x<<1,d.vertices=b.vertices,d.bones=b.bones,d.lengths=B,h&&t.Color.rgba8888ToColor(d.color,A),d);case t.AttachmentType.Point:p=e.readFloat(),f=e.readFloat(),g=e.readFloat(),A=h?e.readInt32():0;var N=this.attachmentLoader.newPointAttachment(a,l);return null==N?null:(N.x=f*c,N.y=g*c,N.rotation=p,h&&t.Color.rgba8888ToColor(N.color,A),N);case t.AttachmentType.Clipping:var G=e.readInt(!0),U=(x=e.readInt(!0),b=this.readVertices(e,x),A=h?e.readInt32():0,this.attachmentLoader.newClippingAttachment(a,l));return null==U?null:(U.endSlot=i.slots[G],U.worldVerticesLength=x<<1,U.vertices=b.vertices,U.bones=b.bones,h&&t.Color.rgba8888ToColor(U.color,A),U)}return null},n.prototype.readVertices=function(e,n){var i=n<<1,a=new r,s=this.scale;if(!e.readBoolean())return a.vertices=this.readFloatArray(e,i,s),a;for(var o=new Array,h=new Array,c=0;c<n;c++){var l=e.readInt(!0);h.push(l);for(var u=0;u<l;u++)h.push(e.readInt(!0)),o.push(e.readFloat()*s),o.push(e.readFloat()*s),o.push(e.readFloat())}return a.vertices=t.Utils.toFloatArray(o),a.bones=h,a},n.prototype.readFloatArray=function(t,e,n){var i=new Array(e);if(1==n)for(var a=0;a<e;a++)i[a]=t.readFloat();else for(a=0;a<e;a++)i[a]=t.readFloat()*n;return i},n.prototype.readShortArray=function(t){for(var e=t.readInt(!0),n=new Array(e),i=0;i<e;i++)n[i]=t.readShort();return n},n.prototype.readAnimation=function(e,i,a){for(var s=new Array,r=this.scale,o=0,h=new t.Color,c=new t.Color,l=0,u=e.readInt(!0);l<u;l++)for(var d=e.readInt(!0),p=0,f=e.readInt(!0);p<f;p++){var g=e.readByte(),m=e.readInt(!0);switch(g){case n.SLOT_ATTACHMENT:(A=new t.AttachmentTimeline(m)).slotIndex=d;for(var v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readStringRef());s.push(A),o=Math.max(o,A.frames[m-1]);break;case n.SLOT_COLOR:for((A=new t.ColorTimeline(m)).slotIndex=d,v=0;v<m;v++){var y=e.readFloat();t.Color.rgba8888ToColor(h,e.readInt32()),A.setFrame(v,y,h.r,h.g,h.b,h.a),v<m-1&&this.readCurve(e,v,A)}s.push(A),o=Math.max(o,A.frames[(m-1)*t.ColorTimeline.ENTRIES]);break;case n.SLOT_TWO_COLOR:for((A=new t.TwoColorTimeline(m)).slotIndex=d,v=0;v<m;v++)y=e.readFloat(),t.Color.rgba8888ToColor(h,e.readInt32()),t.Color.rgb888ToColor(c,e.readInt32()),A.setFrame(v,y,h.r,h.g,h.b,h.a,c.r,c.g,c.b),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.TwoColorTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var S=e.readInt(!0);for(p=0,f=e.readInt(!0);p<f;p++)switch(g=e.readByte(),m=e.readInt(!0),g){case n.BONE_ROTATE:for((A=new t.RotateTimeline(m)).boneIndex=S,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.RotateTimeline.ENTRIES]);break;case n.BONE_TRANSLATE:case n.BONE_SCALE:case n.BONE_SHEAR:var A=void 0,E=1;for(g==n.BONE_SCALE?A=new t.ScaleTimeline(m):g==n.BONE_SHEAR?A=new t.ShearTimeline(m):(A=new t.TranslateTimeline(m),E=r),A.boneIndex=S,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()*E,e.readFloat()*E),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.TranslateTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var x=e.readInt(!0);m=e.readInt(!0);for((A=new t.IkConstraintTimeline(m)).ikConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat()*r,e.readByte(),e.readBoolean(),e.readBoolean()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.IkConstraintTimeline.ENTRIES])}for(l=0,u=e.readInt(!0);l<u;l++){for(x=e.readInt(!0),m=e.readInt(!0),(A=new t.TransformConstraintTimeline(m)).transformConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.TransformConstraintTimeline.ENTRIES])}for(l=0,u=e.readInt(!0);l<u;l++){x=e.readInt(!0);var b=a.pathConstraints[x];for(p=0,f=e.readInt(!0);p<f;p++)switch(g=e.readByte(),m=e.readInt(!0),g){case n.PATH_POSITION:case n.PATH_SPACING:A=void 0,E=1;for(g==n.PATH_SPACING?(A=new t.PathConstraintSpacingTimeline(m),b.spacingMode!=t.SpacingMode.Length&&b.spacingMode!=t.SpacingMode.Fixed||(E=r)):(A=new t.PathConstraintPositionTimeline(m),b.positionMode==t.PositionMode.Fixed&&(E=r)),A.pathConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat()*E),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.PathConstraintPositionTimeline.ENTRIES]);break;case n.PATH_MIX:for((A=new t.PathConstraintMixTimeline(m)).pathConstraintIndex=x,v=0;v<m;v++)A.setFrame(v,e.readFloat(),e.readFloat(),e.readFloat()),v<m-1&&this.readCurve(e,v,A);s.push(A),o=Math.max(o,A.frames[(m-1)*t.PathConstraintMixTimeline.ENTRIES])}}for(l=0,u=e.readInt(!0);l<u;l++){var T=a.skins[e.readInt(!0)];for(p=0,f=e.readInt(!0);p<f;p++){d=e.readInt(!0);for(var w=0,M=e.readInt(!0);w<M;w++){var C=T.getAttachment(d,e.readStringRef()),P=null!=C.bones,I=C.vertices,k=P?I.length/3*2:I.length;m=e.readInt(!0);for((A=new t.DeformTimeline(m)).slotIndex=d,A.attachment=C,v=0;v<m;v++){y=e.readFloat();var R=void 0,O=e.readInt(!0);if(0==O)R=P?t.Utils.newFloatArray(k):I;else{R=t.Utils.newFloatArray(k);var _=e.readInt(!0);if(O+=_,1==r)for(var D=_;D<O;D++)R[D]=e.readFloat();else for(D=_;D<O;D++)R[D]=e.readFloat()*r;if(!P){D=0;for(var B=R.length;D<B;D++)R[D]+=I[D]}}A.setFrame(v,y,R),v<m-1&&this.readCurve(e,v,A)}s.push(A),o=Math.max(o,A.frames[m-1])}}}var L=e.readInt(!0);if(0<L){A=new t.DrawOrderTimeline(L);var F=a.slots.length;for(l=0;l<L;l++){y=e.readFloat();var N=e.readInt(!0),G=t.Utils.newArray(F,0);for(p=F-1;0<=p;p--)G[p]=-1;var U=t.Utils.newArray(F-N,0),V=0,Y=0;for(p=0;p<N;p++){for(d=e.readInt(!0);V!=d;)U[Y++]=V++;G[V+e.readInt(!0)]=V++}for(;V<F;)U[Y++]=V++;for(p=F-1;0<=p;p--)-1==G[p]&&(G[p]=U[--Y]);A.setFrame(l,y,G)}s.push(A),o=Math.max(o,A.frames[L-1])}var z=e.readInt(!0);if(0<z){for(A=new t.EventTimeline(z),l=0;l<z;l++){y=e.readFloat();var H=a.events[e.readInt(!0)],W=new t.Event(y,H);W.intValue=e.readInt(!1),W.floatValue=e.readFloat(),W.stringValue=e.readBoolean()?e.readString():H.stringValue,null!=W.data.audioPath&&(W.volume=e.readFloat(),W.balance=e.readFloat()),A.setFrame(l,W)}s.push(A),o=Math.max(o,A.frames[z-1])}return new t.Animation(i,s,o)},n.prototype.readCurve=function(t,e,i){switch(t.readByte()){case n.CURVE_STEPPED:i.setStepped(e);break;case n.CURVE_BEZIER:this.setCurve(i,e,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}},n.prototype.setCurve=function(t,e,n,i,a,s){t.setCurve(e,n,i,a,s)},n.AttachmentTypeValues=[0,1,2,3,4,5,6],n.TransformModeValues=[t.TransformMode.Normal,t.TransformMode.OnlyTranslation,t.TransformMode.NoRotationOrReflection,t.TransformMode.NoScale,t.TransformMode.NoScaleOrReflection],n.PositionModeValues=[t.PositionMode.Fixed,t.PositionMode.Percent],n.SpacingModeValues=[t.SpacingMode.Length,t.SpacingMode.Fixed,t.SpacingMode.Percent],n.RotateModeValues=[t.RotateMode.Tangent,t.RotateMode.Chain,t.RotateMode.ChainScale],n.BlendModeValues=[t.BlendMode.Normal,t.BlendMode.Additive,t.BlendMode.Multiply,t.BlendMode.Screen],n.BONE_ROTATE=0,n.BONE_TRANSLATE=1,n.BONE_SCALE=2,n.BONE_SHEAR=3,n.SLOT_ATTACHMENT=0,n.SLOT_COLOR=1,n.SLOT_TWO_COLOR=2,n.PATH_POSITION=0,n.PATH_SPACING=1,n.PATH_MIX=2,n.CURVE_LINEAR=0,n.CURVE_STEPPED=1,n.CURVE_BEZIER=2,n);function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}t.SkeletonBinary=e;var i=(a.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},a.prototype.readShort=function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t},a.prototype.readInt32=function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t},a.prototype.readInt=function(t){var e=this.readByte(),n=127&e;return 0!=(128&e)&&(n|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(n|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(n|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(n|=(127&this.readByte())<<28)))),t?n:n>>>1^-(1&n)},a.prototype.readStringRef=function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]},a.prototype.readString=function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",n=0;n<t;){var i=this.readByte();switch(i>>4){case 12:case 13:e+=String.fromCharCode((31&i)<<6|63&this.readByte()),n+=2;break;case 14:e+=String.fromCharCode((15&i)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:e+=String.fromCharCode(i),n++}}return e},a.prototype.readFloat=function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t},a.prototype.readBoolean=function(){return 0!=this.readByte()},a);function a(t,e,n,i){void 0===e&&(e=new Array),void 0===n&&(n=0),void 0===i&&(i=new DataView(t.buffer)),this.strings=e,this.index=n,this.buffer=i}var s=function(t,e,n,i,a){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=a},r=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.bones=t,this.vertices=e}}(Se=Se||{}),D=Se=Se||{},_e.prototype.update=function(t,e){if(null==t)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,i=this.polygons,a=this.polygonPool,s=t.slots,r=s.length;n.length=0,a.freeAll(i);for(var o=i.length=0;o<r;o++){var h,c,l,u=s[o];u.bone.active&&(h=u.getAttachment())instanceof D.BoundingBoxAttachment&&(c=h,n.push(c),(l=a.obtain()).length!=c.worldVerticesLength&&(l=D.Utils.newFloatArray(c.worldVerticesLength)),i.push(l),c.computeWorldVertices(u,0,c.worldVerticesLength,l,0,2))}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},_e.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.polygons,s=0,r=a.length;s<r;s++)for(var o=a[s],h=o,c=0,l=o.length;c<l;c+=2){var u=h[c],d=h[c+1];t=Math.min(t,u),e=Math.min(e,d),n=Math.max(n,u),i=Math.max(i,d)}this.minX=t,this.minY=e,this.maxX=n,this.maxY=i},_e.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},_e.prototype.aabbIntersectsSegment=function(t,e,n,i){var a=this.minX,s=this.minY,r=this.maxX,o=this.maxY;if(t<=a&&n<=a||e<=s&&i<=s||r<=t&&r<=n||o<=e&&o<=i)return!1;var h=(i-e)/(n-t),c=h*(a-t)+e;if(s<c&&c<o)return!0;if(s<(c=h*(r-t)+e)&&c<o)return!0;var l=(s-e)/h+t;return a<l&&l<r||a<(l=(o-e)/h+t)&&l<r},_e.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},_e.prototype.containsPoint=function(t,e){for(var n=this.polygons,i=0,a=n.length;i<a;i++)if(this.containsPointPolygon(n[i],t,e))return this.boundingBoxes[i];return null},_e.prototype.containsPointPolygon=function(t,e,n){for(var i=t,a=t.length,s=a-2,r=!1,o=0;o<a;o+=2){var h,c=i[o+1],l=i[s+1];!(c<n&&n<=l||l<n&&n<=c)||(h=i[o])+(n-c)/(l-c)*(i[s]-h)<e&&(r=!r),s=o}return r},_e.prototype.intersectsSegment=function(t,e,n,i){for(var a=this.polygons,s=0,r=a.length;s<r;s++)if(this.intersectsSegmentPolygon(a[s],t,e,n,i))return this.boundingBoxes[s];return null},_e.prototype.intersectsSegmentPolygon=function(t,e,n,i,a){for(var s=t,r=t.length,o=e-i,h=n-a,c=e*a-n*i,l=s[r-2],u=s[r-1],d=0;d<r;d+=2){var p=s[d],f=s[d+1],g=l*f-u*p,m=l-p,v=u-f,y=o*v-h*m,S=(c*m-o*g)/y;if((l<=S&&S<=p||p<=S&&S<=l)&&(e<=S&&S<=i||i<=S&&S<=e)){var A=(c*v-h*g)/y;if((u<=A&&A<=f||f<=A&&A<=u)&&(n<=A&&A<=a||a<=A&&A<=n))return!0}l=p,u=f}return!1},_e.prototype.getPolygon=function(t){var e;if(null==t)throw new Error("boundingBox cannot be null.");var n=g()(e=this.boundingBoxes).call(e,t);return-1==n?null:this.polygons[n]},_e.prototype.getWidth=function(){return this.maxX-this.minX},_e.prototype.getHeight=function(){return this.maxY-this.minY},B=_e,D.SkeletonBounds=B,L=Se=Se||{},De.prototype.clipStart=function(t,e){if(null!=this.clipAttachment)return 0;var n=(this.clipAttachment=e).worldVerticesLength,i=L.Utils.setArraySize(this.clippingPolygon,n);e.computeWorldVertices(t,0,n,i,0,2);var a=this.clippingPolygon;De.makeClockwise(a);for(var s=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a)),r=0,o=s.length;r<o;r++){var h=s[r];De.makeClockwise(h),h.push(h[0]),h.push(h[1])}return s.length},De.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},De.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},De.prototype.isClipping=function(){return null!=this.clipAttachment},De.prototype.clipTriangles=function(t,e,n,i,a,s,r,o){var h=this.clipOutput,c=this.clippedVertices,l=this.clippedTriangles,u=this.clippingPolygons,d=this.clippingPolygons.length,p=o?12:8,f=0;c.length=0;t:for(var g=l.length=0;g<i;g+=3)for(var m=n[g]<<1,v=t[m],y=t[1+m],S=a[m],A=a[1+m],E=t[m=n[g+1]<<1],x=t[1+m],b=a[m],T=a[1+m],w=t[m=n[g+2]<<1],M=t[1+m],C=a[m],P=a[1+m],I=0;I<d;I++){var k=c.length;if(!this.clip(v,y,E,x,w,M,u[I],h)){(U=L.Utils.setArraySize(c,k+3*p))[k]=v,U[k+1]=y,U[k+2]=s.r,U[k+3]=s.g,U[k+4]=s.b,U[k+5]=s.a,o?(U[k+6]=S,U[k+7]=A,U[k+8]=r.r,U[k+9]=r.g,U[k+10]=r.b,U[k+11]=r.a,U[k+12]=E,U[k+13]=x,U[k+14]=s.r,U[k+15]=s.g,U[k+16]=s.b,U[k+17]=s.a,U[k+18]=b,U[k+19]=T,U[k+20]=r.r,U[k+21]=r.g,U[k+22]=r.b,U[k+23]=r.a,U[k+24]=w,U[k+25]=M,U[k+26]=s.r,U[k+27]=s.g,U[k+28]=s.b,U[k+29]=s.a,U[k+30]=C,U[k+31]=P,U[k+32]=r.r,U[k+33]=r.g,U[k+34]=r.b,U[k+35]=r.a):(U[k+6]=S,U[k+7]=A,U[k+8]=E,U[k+9]=x,U[k+10]=s.r,U[k+11]=s.g,U[k+12]=s.b,U[k+13]=s.a,U[k+14]=b,U[k+15]=T,U[k+16]=w,U[k+17]=M,U[k+18]=s.r,U[k+19]=s.g,U[k+20]=s.b,U[k+21]=s.a,U[k+22]=C,U[k+23]=P),k=l.length,(q=L.Utils.setArraySize(l,k+3))[k]=f,q[k+1]=f+1,q[k+2]=f+2,f+=3;continue t}var R=h.length;if(0!=R){for(var O=x-M,_=w-E,D=v-w,B=M-y,F=1/(O*D+_*(y-M)),N=R>>1,G=this.clipOutput,U=L.Utils.setArraySize(c,k+N*p),V=0;V<R;V+=2){var Y=G[V],z=G[V+1];U[k]=Y,U[k+1]=z,U[k+2]=s.r,U[k+3]=s.g,U[k+4]=s.b,U[k+5]=s.a;var H=Y-w,W=z-M,X=(O*H+_*W)*F,K=(B*H+D*W)*F,j=1-X-K;U[k+6]=S*X+b*K+C*j,U[k+7]=A*X+T*K+P*j,o&&(U[k+8]=r.r,U[k+9]=r.g,U[k+10]=r.b,U[k+11]=r.a),k+=p}k=l.length;var q=L.Utils.setArraySize(l,k+3*(N-2));for(N--,V=1;V<N;V++)q[k]=f,q[k+1]=f+V,q[k+2]=f+V+1,k+=3;f+=1+N}}},De.prototype.clip=function(t,e,n,i,a,s,r,o){var h=o,c=!1,l=null;2<=r.length%4?(l=o,o=this.scratch):l=this.scratch,l.length=0,l.push(t),l.push(e),l.push(n),l.push(i),l.push(a),l.push(s),l.push(t),l.push(e),o.length=0;for(var u=r,d=r.length-4,p=0;;p+=2){for(var f=u[p],g=u[p+1],m=u[p+2],v=u[p+3],y=f-m,S=g-v,A=l,E=l.length-2,x=o.length,b=0;b<E;b+=2){var T=A[b],w=A[b+1],M=A[b+2],C=A[b+3],P=0<y*(C-v)-S*(M-m);if(0<y*(w-v)-S*(T-m)){if(P){o.push(M),o.push(C);continue}var I,k,R,O=(I=C-w)*(m-f)-(k=M-T)*(v-g);1e-6<Math.abs(O)?(R=(k*(g-w)-I*(f-T))/O,o.push(f+(m-f)*R),o.push(g+(v-g)*R)):(o.push(f),o.push(g))}else P&&(O=(I=C-w)*(m-f)-(k=M-T)*(v-g),1e-6<Math.abs(O)?(R=(k*(g-w)-I*(f-T))/O,o.push(f+(m-f)*R),o.push(g+(v-g)*R)):(o.push(f),o.push(g)),o.push(M),o.push(C));c=!0}if(x==o.length)return!(h.length=0);if(o.push(o[0]),o.push(o[1]),p==d)break;var _=o;(o=l).length=0,l=_}if(h!=o){p=h.length=0;for(var D=o.length-2;p<D;p++)h[p]=o[p]}else h.length=h.length-2;return c},De.makeClockwise=function(t){for(var e,n,i,a=t,s=t.length,r=a[s-2]*a[1]-a[0]*a[s-1],o=0,h=s-3;o<h;o+=2)e=a[o],n=a[o+1],i=a[o+2],r+=e*a[o+3]-i*n;if(!(r<0)){o=0;var c=s-2;for(h=s>>1;o<h;o+=2){var l=a[o],u=a[o+1],d=c-o;a[o]=a[d],a[o+1]=a[1+d],a[d]=l,a[1+d]=u}}},F=De,L.SkeletonClipping=F,N=Se=Se||{},Be.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},Be.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},Be.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++){var a=e[n];if(a.name==t)return a}return null},Be.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,n=0,i=e.length;n<i;n++)if(e[n].name==t)return n;return-1},G=Be,N.SkeletonData=G,function(t){var e=(n.prototype.readSkeletonData=function(e){var i=this.scale,a=new t.SkeletonData,s="string"==typeof e?JSON.parse(e):e,r=s.skeleton;if(null!=r){if(a.hash=r.hash,a.version=r.spine,"3.8.75"==a.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");a.x=r.x,a.y=r.y,a.width=r.width,a.height=r.height,a.fps=r.fps,a.imagesPath=r.images}if(s.bones)for(var o=0;o<s.bones.length;o++){var h=s.bones[o],c=null,l=this.getValue(h,"parent",null);if(null!=l&&null==(c=a.findBone(l)))throw new Error("Parent bone not found: "+l);(f=new t.BoneData(a.bones.length,h.name,c)).length=this.getValue(h,"length",0)*i,f.x=this.getValue(h,"x",0)*i,f.y=this.getValue(h,"y",0)*i,f.rotation=this.getValue(h,"rotation",0),f.scaleX=this.getValue(h,"scaleX",1),f.scaleY=this.getValue(h,"scaleY",1),f.shearX=this.getValue(h,"shearX",0),f.shearY=this.getValue(h,"shearY",0),f.transformMode=n.transformModeFromString(this.getValue(h,"transform","normal")),f.skinRequired=this.getValue(h,"skin",!1),a.bones.push(f)}if(s.slots)for(o=0;o<s.slots.length;o++){var u=(M=s.slots[o]).name,d=M.bone,p=a.findBone(d);if(null==p)throw new Error("Slot bone not found: "+d);var f=new t.SlotData(a.slots.length,u,p),g=this.getValue(M,"color",null);null!=g&&f.color.setFromString(g);var m=this.getValue(M,"dark",null);null!=m&&(f.darkColor=new t.Color(1,1,1,1),f.darkColor.setFromString(m)),f.attachmentName=this.getValue(M,"attachment",null),f.blendMode=n.blendModeFromString(this.getValue(M,"blend","normal")),a.slots.push(f)}if(s.ik)for(o=0;o<s.ik.length;o++){var v=s.ik[o];(f=new t.IkConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1);for(var y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(x=a.findBone(d)))throw new Error("IK bone not found: "+d);f.bones.push(x)}var S=v.target;if(f.target=a.findBone(S),null==f.target)throw new Error("IK target bone not found: "+S);f.mix=this.getValue(v,"mix",1),f.softness=this.getValue(v,"softness",0)*i,f.bendDirection=this.getValue(v,"bendPositive",!0)?1:-1,f.compress=this.getValue(v,"compress",!1),f.stretch=this.getValue(v,"stretch",!1),f.uniform=this.getValue(v,"uniform",!1),a.ikConstraints.push(f)}if(s.transform)for(o=0;o<s.transform.length;o++){for(v=s.transform[o],(f=new t.TransformConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1),y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(x=a.findBone(d)))throw new Error("Transform constraint bone not found: "+d);f.bones.push(x)}if(S=v.target,f.target=a.findBone(S),null==f.target)throw new Error("Transform constraint target bone not found: "+S);f.local=this.getValue(v,"local",!1),f.relative=this.getValue(v,"relative",!1),f.offsetRotation=this.getValue(v,"rotation",0),f.offsetX=this.getValue(v,"x",0)*i,f.offsetY=this.getValue(v,"y",0)*i,f.offsetScaleX=this.getValue(v,"scaleX",0),f.offsetScaleY=this.getValue(v,"scaleY",0),f.offsetShearY=this.getValue(v,"shearY",0),f.rotateMix=this.getValue(v,"rotateMix",1),f.translateMix=this.getValue(v,"translateMix",1),f.scaleMix=this.getValue(v,"scaleMix",1),f.shearMix=this.getValue(v,"shearMix",1),a.transformConstraints.push(f)}if(s.path)for(o=0;o<s.path.length;o++){for(v=s.path[o],(f=new t.PathConstraintData(v.name)).order=this.getValue(v,"order",0),f.skinRequired=this.getValue(v,"skin",!1),y=0;y<v.bones.length;y++){if(d=v.bones[y],null==(x=a.findBone(d)))throw new Error("Transform constraint bone not found: "+d);f.bones.push(x)}if(S=v.target,f.target=a.findSlot(S),null==f.target)throw new Error("Path target slot not found: "+S);f.positionMode=n.positionModeFromString(this.getValue(v,"positionMode","percent")),f.spacingMode=n.spacingModeFromString(this.getValue(v,"spacingMode","length")),f.rotateMode=n.rotateModeFromString(this.getValue(v,"rotateMode","tangent")),f.offsetRotation=this.getValue(v,"rotation",0),f.position=this.getValue(v,"position",0),f.positionMode==t.PositionMode.Fixed&&(f.position*=i),f.spacing=this.getValue(v,"spacing",0),f.spacingMode!=t.SpacingMode.Length&&f.spacingMode!=t.SpacingMode.Fixed||(f.spacing*=i),f.rotateMix=this.getValue(v,"rotateMix",1),f.translateMix=this.getValue(v,"translateMix",1),a.pathConstraints.push(f)}if(s.skins)for(o=0;o<s.skins.length;o++){var A=s.skins[o],E=new t.Skin(A.name);if(A.bones)for(var x,b=0;b<A.bones.length;b++){if(null==(x=a.findBone(A.bones[b])))throw new Error("Skin bone not found: "+A.bones[o]);E.bones.push(x)}if(A.ik)for(b=0;b<A.ik.length;b++){if(null==(T=a.findIkConstraint(A.ik[b])))throw new Error("Skin IK constraint not found: "+A.ik[o]);E.constraints.push(T)}if(A.transform)for(b=0;b<A.transform.length;b++){if(null==(T=a.findTransformConstraint(A.transform[b])))throw new Error("Skin transform constraint not found: "+A.transform[o]);E.constraints.push(T)}if(A.path){var T;for(b=0;b<A.path.length;b++){if(null==(T=a.findPathConstraint(A.path[b])))throw new Error("Skin path constraint not found: "+A.path[o]);E.constraints.push(T)}}for(var u in A.attachments){var w=a.findSlot(u);if(null==w)throw new Error("Slot not found: "+u);var M=A.attachments[u];for(var C in M){var P=this.readAttachment(M[C],E,w.index,C,a);null!=P&&E.setAttachment(w.index,C,P)}}a.skins.push(E),"default"==E.name&&(a.defaultSkin=E)}o=0;for(var I=this.linkedMeshes.length;o<I;o++){var k=this.linkedMeshes[o];if(null==(E=null==k.skin?a.defaultSkin:a.findSkin(k.skin)))throw new Error("Skin not found: "+k.skin);var R=E.getAttachment(k.slotIndex,k.parent);if(null==R)throw new Error("Parent mesh not found: "+k.parent);k.mesh.deformAttachment=k.inheritDeform?R:k.mesh,k.mesh.setParentMesh(R),k.mesh.updateUVs()}if(this.linkedMeshes.length=0,s.events)for(var O in s.events){var _=s.events[O];(f=new t.EventData(O)).intValue=this.getValue(_,"int",0),f.floatValue=this.getValue(_,"float",0),f.stringValue=this.getValue(_,"string",""),f.audioPath=this.getValue(_,"audio",null),null!=f.audioPath&&(f.volume=this.getValue(_,"volume",1),f.balance=this.getValue(_,"balance",0)),a.events.push(f)}if(s.animations)for(var D in s.animations){var B=s.animations[D];this.readAnimation(B,D,a)}return a},n.prototype.readAttachment=function(e,n,a,s,r){var o=this.scale;switch(s=this.getValue(e,"name",s),this.getValue(e,"type","region")){case"region":var h=this.getValue(e,"path",s),c=this.attachmentLoader.newRegionAttachment(n,s,h);return null==c?null:(c.path=h,c.x=this.getValue(e,"x",0)*o,c.y=this.getValue(e,"y",0)*o,c.scaleX=this.getValue(e,"scaleX",1),c.scaleY=this.getValue(e,"scaleY",1),c.rotation=this.getValue(e,"rotation",0),c.width=e.width*o,c.height=e.height*o,null!=(E=this.getValue(e,"color",null))&&c.color.setFromString(E),c.updateOffset(),c);case"boundingbox":var l=this.attachmentLoader.newBoundingBoxAttachment(n,s);return null==l?null:(this.readVertices(e,l,e.vertexCount<<1),null!=(E=this.getValue(e,"color",null))&&l.color.setFromString(E),l);case"mesh":case"linkedmesh":h=this.getValue(e,"path",s);var u=this.attachmentLoader.newMeshAttachment(n,s,h);if(null==u)return null;u.path=h,null!=(E=this.getValue(e,"color",null))&&u.color.setFromString(E),u.width=this.getValue(e,"width",0)*o,u.height=this.getValue(e,"height",0)*o;var d=this.getValue(e,"parent",null);if(null!=d)return this.linkedMeshes.push(new i(u,this.getValue(e,"skin",null),a,d,this.getValue(e,"deform",!0))),u;var p=e.uvs;return this.readVertices(e,u,p.length),u.triangles=e.triangles,u.regionUVs=p,u.updateUVs(),u.edges=this.getValue(e,"edges",null),u.hullLength=2*this.getValue(e,"hull",0),u;case"path":if(null==(h=this.attachmentLoader.newPathAttachment(n,s)))return null;h.closed=this.getValue(e,"closed",!1),h.constantSpeed=this.getValue(e,"constantSpeed",!0);var f=e.vertexCount;this.readVertices(e,h,f<<1);for(var g=t.Utils.newArray(f/3,0),m=0;m<e.lengths.length;m++)g[m]=e.lengths[m]*o;return h.lengths=g,null!=(E=this.getValue(e,"color",null))&&h.color.setFromString(E),h;case"point":var v=this.attachmentLoader.newPointAttachment(n,s);return null==v?null:(v.x=this.getValue(e,"x",0)*o,v.y=this.getValue(e,"y",0)*o,v.rotation=this.getValue(e,"rotation",0),null!=(E=this.getValue(e,"color",null))&&v.color.setFromString(E),v);case"clipping":var y=this.attachmentLoader.newClippingAttachment(n,s);if(null==y)return null;var S=this.getValue(e,"end",null);if(null!=S){var A=r.findSlot(S);if(null==A)throw new Error("Clipping end slot not found: "+S);y.endSlot=A}var E;f=e.vertexCount;return this.readVertices(e,y,f<<1),null!=(E=this.getValue(e,"color",null))&&y.color.setFromString(E),y}return null},n.prototype.readVertices=function(e,n,i){var a=this.scale;n.worldVerticesLength=i;var s=e.vertices;if(i!=s.length){for(var r=new Array,o=new Array,h=0,c=s.length;h<c;){var l=s[h++];o.push(l);for(var u=h+4*l;h<u;h+=4)o.push(s[h]),r.push(s[h+1]*a),r.push(s[h+2]*a),r.push(s[h+3])}n.bones=o,n.vertices=t.Utils.toFloatArray(r)}else{var d=t.Utils.toFloatArray(s);if(1!=a)for(h=0,c=s.length;h<c;h++)d[h]*=a;n.vertices=d}},n.prototype.readAnimation=function(e,n,i){var a=this.scale,s=new Array,r=0;if(e.slots)for(var o in e.slots){var h=e.slots[o];if(-1==($=i.findSlotIndex(o)))throw new Error("Slot not found: "+o);for(var c in h){var l=h[c];if("attachment"==c){(E=new t.AttachmentTimeline(l.length)).slotIndex=$;for(var u=0,d=0;d<l.length;d++){var p=l[d];E.setFrame(u++,this.getValue(p,"time",0),p.name)}s.push(E),r=Math.max(r,E.frames[E.getFrameCount()-1])}else if("color"==c){for((E=new t.ColorTimeline(l.length)).slotIndex=$,d=u=0;d<l.length;d++){p=l[d];var f=new t.Color;f.setFromString(p.color),E.setFrame(u,this.getValue(p,"time",0),f.r,f.g,f.b,f.a),this.readCurve(p,E,u),u++}s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if("twoColor"!=c)throw new Error("Invalid timeline type for a slot: "+c+" ("+o+")");for((E=new t.TwoColorTimeline(l.length)).slotIndex=$,d=u=0;d<l.length;d++){p=l[d];var m=new t.Color,v=new t.Color;m.setFromString(p.light),v.setFromString(p.dark),E.setFrame(u,this.getValue(p,"time",0),m.r,m.g,m.b,m.a,v.r,v.g,v.b),this.readCurve(p,E,u),u++}s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.TwoColorTimeline.ENTRIES])}}}if(e.bones)for(var y in e.bones){var S=e.bones[y],A=i.findBoneIndex(y);if(-1==A)throw new Error("Bone not found: "+y);for(var c in S)if(l=S[c],"rotate"===c){for((E=new t.RotateTimeline(l.length)).boneIndex=A,d=u=0;d<l.length;d++)p=l[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"angle",0)),this.readCurve(p,E,u),u++;s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.RotateTimeline.ENTRIES])}else{if("translate"!==c&&"scale"!==c&&"shear"!==c)throw new Error("Invalid timeline type for a bone: "+c+" ("+y+")");var E=null,x=1,b=0;for("scale"===c?(E=new t.ScaleTimeline(l.length),b=1):"shear"===c?E=new t.ShearTimeline(l.length):(E=new t.TranslateTimeline(l.length),x=a),E.boneIndex=A,d=u=0;d<l.length;d++){p=l[d];var T=this.getValue(p,"x",b),w=this.getValue(p,"y",b);E.setFrame(u,this.getValue(p,"time",0),T*x,w*x),this.readCurve(p,E,u),u++}s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.TranslateTimeline.ENTRIES])}}if(e.ik)for(var M in e.ik){var C=e.ik[M],P=i.findIkConstraint(M);for((E=new t.IkConstraintTimeline(C.length)).ikConstraintIndex=g()(I=i.ikConstraints).call(I,P),d=u=0;d<C.length;d++){var I;p=C[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"mix",1),this.getValue(p,"softness",0)*a,this.getValue(p,"bendPositive",!0)?1:-1,this.getValue(p,"compress",!1),this.getValue(p,"stretch",!1)),this.readCurve(p,E,u),u++}s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.IkConstraintTimeline.ENTRIES])}if(e.transform)for(var M in e.transform){for(C=e.transform[M],P=i.findTransformConstraint(M),(E=new t.TransformConstraintTimeline(C.length)).transformConstraintIndex=g()(k=i.transformConstraints).call(k,P),d=u=0;d<C.length;d++){var k;p=C[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1),this.getValue(p,"scaleMix",1),this.getValue(p,"shearMix",1)),this.readCurve(p,E,u),u++}s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.TransformConstraintTimeline.ENTRIES])}if(e.path)for(var M in e.path){C=e.path[M];var R=i.findPathConstraintIndex(M);if(-1==R)throw new Error("Path constraint not found: "+M);var O=i.pathConstraints[R];for(var c in C)if(l=C[c],"position"===c||"spacing"===c){E=null,x=1;for("spacing"===c?(E=new t.PathConstraintSpacingTimeline(l.length),O.spacingMode!=t.SpacingMode.Length&&O.spacingMode!=t.SpacingMode.Fixed||(x=a)):(E=new t.PathConstraintPositionTimeline(l.length),O.positionMode==t.PositionMode.Fixed&&(x=a)),E.pathConstraintIndex=R,d=u=0;d<l.length;d++)p=l[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,c,0)*x),this.readCurve(p,E,u),u++;s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===c){for((E=new t.PathConstraintMixTimeline(l.length)).pathConstraintIndex=R,d=u=0;d<l.length;d++)p=l[d],E.setFrame(u,this.getValue(p,"time",0),this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1)),this.readCurve(p,E,u),u++;s.push(E),r=Math.max(r,E.frames[(E.getFrameCount()-1)*t.PathConstraintMixTimeline.ENTRIES])}}if(e.deform)for(var _ in e.deform){var D=e.deform[_],B=i.findSkin(_);if(null==B)throw new Error("Skin not found: "+_);for(var o in D){if(h=D[o],-1==($=i.findSlotIndex(o)))throw new Error("Slot not found: "+h.name);for(var c in h){l=h[c];var L=B.getAttachment($,c);if(null==L)throw new Error("Deform attachment not found: "+l.name);var F=null!=L.bones,N=L.vertices,G=F?N.length/3*2:N.length;(E=new t.DeformTimeline(l.length)).slotIndex=$,E.attachment=L;u=0;for(var U=0;U<l.length;U++){p=l[U];var V=void 0,Y=this.getValue(p,"vertices",null);if(null==Y)V=F?t.Utils.newFloatArray(G):N;else{V=t.Utils.newFloatArray(G);var z=this.getValue(p,"offset",0);if(t.Utils.arrayCopy(Y,0,V,z,Y.length),1!=a)for(var H=(d=z)+Y.length;d<H;d++)V[d]*=a;if(!F)for(d=0;d<G;d++)V[d]+=N[d]}E.setFrame(u,this.getValue(p,"time",0),V),this.readCurve(p,E,u),u++}s.push(E),r=Math.max(r,E.frames[E.getFrameCount()-1])}}}var W=e.drawOrder;if(null==W&&(W=e.draworder),null!=W){E=new t.DrawOrderTimeline(W.length);var X=i.slots.length;for(u=0,U=0;U<W.length;U++){var K=W[U],j=null,q=this.getValue(K,"offsets",null);if(null!=q){j=t.Utils.newArray(X,-1);var Z=t.Utils.newArray(X-q.length,0),J=0,Q=0;for(d=0;d<q.length;d++){var $,tt=q[d];if(-1==($=i.findSlotIndex(tt.slot)))throw new Error("Slot not found: "+tt.slot);for(;J!=$;)Z[Q++]=J++;j[J+tt.offset]=J++}for(;J<X;)Z[Q++]=J++;for(d=X-1;0<=d;d--)-1==j[d]&&(j[d]=Z[--Q])}E.setFrame(u++,this.getValue(K,"time",0),j)}s.push(E),r=Math.max(r,E.frames[E.getFrameCount()-1])}if(e.events){for(E=new t.EventTimeline(e.events.length),d=u=0;d<e.events.length;d++){var et=e.events[d],nt=i.findEvent(et.name);if(null==nt)throw new Error("Event not found: "+et.name);var it=new t.Event(t.Utils.toSinglePrecision(this.getValue(et,"time",0)),nt);it.intValue=this.getValue(et,"int",nt.intValue),it.floatValue=this.getValue(et,"float",nt.floatValue),it.stringValue=this.getValue(et,"string",nt.stringValue),null!=it.data.audioPath&&(it.volume=this.getValue(et,"volume",1),it.balance=this.getValue(et,"balance",0)),E.setFrame(u++,it)}s.push(E),r=Math.max(r,E.frames[E.getFrameCount()-1])}if(isNaN(r))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new t.Animation(n,s,r))},n.prototype.readCurve=function(t,e,n){var i;t.hasOwnProperty("curve")&&("stepped"==t.curve?e.setStepped(n):(i=t.curve,e.setCurve(n,i,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))))},n.prototype.getValue=function(t,e,n){return void 0!==t[e]?t[e]:n},n.blendModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.BlendMode.Normal;if("additive"==e)return t.BlendMode.Additive;if("multiply"==e)return t.BlendMode.Multiply;if("screen"==e)return t.BlendMode.Screen;throw new Error("Unknown blend mode: "+e)},n.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},n.spacingModeFromString=function(e){if("length"==(e=e.toLowerCase()))return t.SpacingMode.Length;if("fixed"==e)return t.SpacingMode.Fixed;if("percent"==e)return t.SpacingMode.Percent;throw new Error("Unknown position mode: "+e)},n.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},n.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},n);function n(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}t.SkeletonJson=e;var i=function(t,e,n,i,a){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=i,this.inheritDeform=a}}(Se=Se||{}),function(t){var e=function(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n};t.SkinEntry=e;var n=(i.prototype.setAttachment=function(t,e,n){if(null==n)throw new Error("attachment cannot be null.");var i=this.attachments;t>=i.length&&(i.length=t+1),i[t]||(i[t]={}),i[t][e]=n},i.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var n=t.bones[e],i=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==n){i=!0;break}i||this.bones.push(n)}for(e=0;e<t.constraints.length;e++){var s=t.constraints[e];for(i=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){i=!0;break}i||this.constraints.push(s)}var r=t.getAttachments();for(e=0;e<r.length;e++){var o=r[e];this.setAttachment(o.slotIndex,o.name,o.attachment)}},i.prototype.copySkin=function(e){for(var n=0;n<e.bones.length;n++){for(var i=e.bones[n],a=!1,s=0;s<this.bones.length;s++)if(this.bones[s]==i){a=!0;break}a||this.bones.push(i)}for(n=0;n<e.constraints.length;n++){var r=e.constraints[n];for(a=!1,s=0;s<this.constraints.length;s++)if(this.constraints[s]==r){a=!0;break}a||this.constraints.push(r)}var o=e.getAttachments();for(n=0;n<o.length;n++){var h=o[n];null!=h.attachment&&(h.attachment instanceof t.MeshAttachment?h.attachment=h.attachment.newLinkedMesh():h.attachment=h.attachment.copy(),this.setAttachment(h.slotIndex,h.name,h.attachment))}},i.prototype.getAttachment=function(t,e){var n=this.attachments[t];return n?n[e]:null},i.prototype.removeAttachment=function(t,e){var n=this.attachments[t];n&&(n[e]=null)},i.prototype.getAttachments=function(){for(var t=new Array,n=0;n<this.attachments.length;n++){var i=this.attachments[n];if(i)for(var a in i){var s=i[a];s&&t.push(new e(n,a,s))}}return t},i.prototype.getAttachmentsForSlot=function(t,n){var i=this.attachments[t];if(i)for(var a in i){var s=i[a];s&&n.push(new e(t,a,s))}},i.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},i.prototype.attachAll=function(t,e){for(var n=0,i=0;i<t.slots.length;i++){var a=t.slots[i],s=a.getAttachment();if(s&&n<e.attachments.length){var r=e.attachments[n];for(var o in r)if(s==r[o]){var h=this.getAttachment(n,o);null!=h&&a.setAttachment(h);break}}n++}},i);function i(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==t)throw new Error("name cannot be null.");this.name=t}t.Skin=n}(Se=Se||{}),U=Se=Se||{},Le.prototype.getSkeleton=function(){return this.bone.skeleton},Le.prototype.getAttachment=function(){return this.attachment},Le.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},Le.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},Le.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},Le.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},V=Le,U.Slot=V,(z=Se=Se||{}).SlotData=function(t,e,n){if(this.color=new z.Color(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(null==e)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n},function(t){var e,n,i,a,s=(r.prototype.getImage=function(){return this._image},r.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return e.Nearest;case"linear":return e.Linear;case"mipmap":return e.MipMap;case"mipmapnearestnearest":return e.MipMapNearestNearest;case"mipmaplinearnearest":return e.MipMapLinearNearest;case"mipmapnearestlinear":return e.MipMapNearestLinear;case"mipmaplinearlinear":return e.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},r.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return i.MirroredRepeat;case"clamptoedge":return i.ClampToEdge;case"repeat":return i.Repeat;default:throw new Error("Unknown texture wrap "+t)}},r);function r(t){this._image=t}t.Texture=s,(n=e=t.TextureFilter||(t.TextureFilter={}))[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear",(a=i=t.TextureWrap||(t.TextureWrap={}))[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat",t.TextureRegion=function(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0};var o,h=(Ee(c,o=s),c.prototype.setFilters=function(t,e){},c.prototype.setWraps=function(t,e){},c.prototype.dispose=function(){},c);function c(){return null!==o&&o.apply(this,arguments)||this}t.FakeTexture=h}(Se=Se||{}),function(t){var e=(n.prototype.load=function(e,n){if(null==n)throw new Error("textureLoader cannot be null.");for(var a=new i(e),r=new Array(4),h=null;;){var c,l,u,d,p,f,g,m=a.readLine();if(null==m)break;0==(m=Yp()(m).call(m)).length?h=null:h?((c=new o).name=m,c.page=h,"true"==(l=a.readValue()).toLocaleLowerCase()?c.degrees=90:"false"==l.toLocaleLowerCase()?c.degrees=0:c.degrees=GI()(l),c.rotate=90==c.degrees,a.readTuple(r),u=Hx()(r[0]),d=Hx()(r[1]),a.readTuple(r),p=Hx()(r[0]),f=Hx()(r[1]),c.u=u/h.width,c.v=d/h.height,c.rotate?(c.u2=(u+f)/h.width,c.v2=(d+p)/h.height):(c.u2=(u+p)/h.width,c.v2=(d+f)/h.height),c.x=u,c.y=d,c.width=Math.abs(p),c.height=Math.abs(f),4==a.readTuple(r)&&4==a.readTuple(r)&&a.readTuple(r),c.originalWidth=Hx()(r[0]),c.originalHeight=Hx()(r[1]),a.readTuple(r),c.offsetX=Hx()(r[0]),c.offsetY=Hx()(r[1]),c.index=Hx()(a.readValue()),c.texture=h.texture,this.regions.push(c)):((h=new s).name=m,2==a.readTuple(r)&&(h.width=Hx()(r[0]),h.height=Hx()(r[1]),a.readTuple(r)),a.readTuple(r),h.minFilter=t.Texture.filterFromString(r[0]),h.magFilter=t.Texture.filterFromString(r[1]),g=a.readValue(),h.uWrap=t.TextureWrap.ClampToEdge,h.vWrap=t.TextureWrap.ClampToEdge,"x"==g?h.uWrap=t.TextureWrap.Repeat:"y"==g?h.vWrap=t.TextureWrap.Repeat:"xy"==g&&(h.uWrap=h.vWrap=t.TextureWrap.Repeat),h.texture=n(m),h.texture.setFilters(h.minFilter,h.magFilter),h.texture.setWraps(h.uWrap,h.vWrap),h.width=h.texture.getImage().width,h.height=h.texture.getImage().height,this.pages.push(h))}},n.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},n.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()},n);function n(t,e){this.pages=new Array,this.regions=new Array,this.load(t,e)}t.TextureAtlas=e;var i=(a.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},a.prototype.readValue=function(){var t,e=this.readLine(),n=g()(e).call(e,":");if(-1==n)throw new Error("Invalid line: "+e);return Yp()(t=e.substring(n+1)).call(t)},a.prototype.readTuple=function(t){var e,n=this.readLine(),i=g()(n).call(n,":");if(-1==i)throw new Error("Invalid line: "+n);for(var a=0,s=i+1;a<3;a++){var r,o=g()(n).call(n,",",s);if(-1==o)break;t[a]=Yp()(r=n.substr(s,o-s)).call(r),s=o+1}return t[a]=Yp()(e=n.substring(s)).call(e),a+1},a);function a(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}var s=function(){};t.TextureAtlasPage=s;var r,o=(r=t.TextureRegion,Ee(h,r),h);function h(){return null!==r&&r.apply(this,arguments)||this}t.TextureAtlasRegion=o}(Se=Se||{}),H=Se=Se||{},Fe.prototype.isActive=function(){return this.active},Fe.prototype.apply=function(){this.update()},Fe.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},Fe.prototype.applyAbsoluteWorld=function(){for(var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target,s=a.a,r=a.b,o=a.c,h=a.d,c=0<s*h-r*o?H.MathUtils.degRad:-H.MathUtils.degRad,l=this.data.offsetRotation*c,u=this.data.offsetShearY*c,d=this.bones,p=0,f=d.length;p<f;p++){var g,m,v,y,S,A,E,x,b,T,w,M=d[p],C=!1;0!=t&&(g=M.a,E=M.b,m=M.c,x=M.d,(T=Math.atan2(o,s)-Math.atan2(m,g)+l)>H.MathUtils.PI?T-=H.MathUtils.PI2:T<-H.MathUtils.PI&&(T+=H.MathUtils.PI2),T*=t,v=Math.cos(T),y=Math.sin(T),M.a=v*g-y*m,M.b=v*E-y*x,M.c=y*g+v*m,M.d=y*E+v*x,C=!0),0!=e&&(S=this.temp,a.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),M.worldX+=(S.x-M.worldX)*e,M.worldY+=(S.y-M.worldY)*e,C=!0),0<n&&(w=Math.sqrt(M.a*M.a+M.c*M.c),A=Math.sqrt(s*s+o*o),1e-5<w&&(w=(w+(A-w+this.data.offsetScaleX)*n)/w),M.a*=w,M.c*=w,w=Math.sqrt(M.b*M.b+M.d*M.d),A=Math.sqrt(r*r+h*h),1e-5<w&&(w=(w+(A-w+this.data.offsetScaleY)*n)/w),M.b*=w,M.d*=w,C=!0),0<i&&(E=M.b,x=M.d,b=Math.atan2(x,E),(T=Math.atan2(h,r)-Math.atan2(o,s)-(b-Math.atan2(M.c,M.a)))>H.MathUtils.PI?T-=H.MathUtils.PI2:T<-H.MathUtils.PI&&(T+=H.MathUtils.PI2),T=b+(T+u)*i,w=Math.sqrt(E*E+x*x),M.b=Math.cos(T)*w,M.d=Math.sin(T)*w,C=!0),C&&(M.appliedValid=!1)}},Fe.prototype.applyRelativeWorld=function(){for(var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target,s=a.a,r=a.b,o=a.c,h=a.d,c=0<s*h-r*o?H.MathUtils.degRad:-H.MathUtils.degRad,l=this.data.offsetRotation*c,u=this.data.offsetShearY*c,d=this.bones,p=0,f=d.length;p<f;p++){var g,m,v,y,S,A,E,x,b,T=d[p],w=!1;0!=t&&(g=T.a,E=T.b,m=T.c,x=T.d,(A=Math.atan2(o,s)+l)>H.MathUtils.PI?A-=H.MathUtils.PI2:A<-H.MathUtils.PI&&(A+=H.MathUtils.PI2),A*=t,v=Math.cos(A),y=Math.sin(A),T.a=v*g-y*m,T.b=v*E-y*x,T.c=y*g+v*m,T.d=y*E+v*x,w=!0),0!=e&&(S=this.temp,a.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),T.worldX+=S.x*e,T.worldY+=S.y*e,w=!0),0<n&&(b=(Math.sqrt(s*s+o*o)-1+this.data.offsetScaleX)*n+1,T.a*=b,T.c*=b,b=(Math.sqrt(r*r+h*h)-1+this.data.offsetScaleY)*n+1,T.b*=b,T.d*=b,w=!0),0<i&&((A=Math.atan2(h,r)-Math.atan2(o,s))>H.MathUtils.PI?A-=H.MathUtils.PI2:A<-H.MathUtils.PI&&(A+=H.MathUtils.PI2),E=T.b,x=T.d,A=Math.atan2(x,E)+(A-H.MathUtils.PI/2+u)*i,b=Math.sqrt(E*E+x*x),T.b=Math.cos(A)*b,T.d=Math.sin(A)*b,w=!0),w&&(T.appliedValid=!1)}},Fe.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,r=0,o=s.length;r<o;r++){var h=s[r];h.appliedValid||h.updateAppliedTransform();var c=h.arotation;0!=t&&(f=a.arotation-c+this.data.offsetRotation,c+=(f-=360*(16384-(16384.499999999996-f/360|0)))*t);var l=h.ax,u=h.ay;0!=e&&(l+=(a.ax-l+this.data.offsetX)*e,u+=(a.ay-u+this.data.offsetY)*e);var d=h.ascaleX,p=h.ascaleY;0!=n&&(1e-5<d&&(d=(d+(a.ascaleX-d+this.data.offsetScaleX)*n)/d),1e-5<p&&(p=(p+(a.ascaleY-p+this.data.offsetScaleY)*n)/p));var f,g=h.ashearY;0!=i&&(f=a.ashearY-g+this.data.offsetShearY,f-=360*(16384-(16384.499999999996-f/360|0)),h.shearY+=f*i),h.updateWorldTransformWith(l,u,c,d,p,h.ashearX,g)}},Fe.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,i=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var s=this.bones,r=0,o=s.length;r<o;r++){var h=s[r];h.appliedValid||h.updateAppliedTransform();var c=h.arotation;0!=t&&(c+=(a.arotation+this.data.offsetRotation)*t);var l=h.ax,u=h.ay;0!=e&&(l+=(a.ax+this.data.offsetX)*e,u+=(a.ay+this.data.offsetY)*e);var d=h.ascaleX,p=h.ascaleY;0!=n&&(1e-5<d&&(d*=(a.ascaleX-1+this.data.offsetScaleX)*n+1),1e-5<p&&(p*=(a.ascaleY-1+this.data.offsetScaleY)*n+1));var f=h.ashearY;0!=i&&(f+=(a.ashearY+this.data.offsetShearY)*i),h.updateWorldTransformWith(l,u,c,d,p,h.ashearX,f)}},W=Fe,H.TransformConstraint=W,X=Se=Se||{},K=X.ConstraintData,Ee(Ne,K),j=Ne,X.TransformConstraintData=j,q=Se=Se||{},Ge.prototype.triangulate=function(t){for(var e=t,n=t.length>>1,i=this.indicesArray,a=i.length=0;a<n;a++)i[a]=a;for(var s=this.isConcaveArray,r=(a=s.length=0,n);a<r;++a)s[a]=Ge.isConcave(a,n,e,i);var o=this.triangles;for(o.length=0;3<n;){for(var h=n-1,c=(a=0,1);;){t:if(!s[a]){for(var l=i[h]<<1,u=i[a]<<1,d=i[c]<<1,p=e[l],f=e[1+l],g=e[u],m=e[1+u],v=e[d],y=e[1+d],S=(c+1)%n;S!=h;S=(S+1)%n)if(s[S]){var A=i[S]<<1,E=e[A],x=e[1+A];if(Ge.positiveArea(v,y,p,f,E,x)&&Ge.positiveArea(p,f,g,m,E,x)&&Ge.positiveArea(g,m,v,y,E,x))break t}break}if(0==c){do{if(!s[a])break;a--}while(0<a);break}h=a,c=((a=c)+1)%n}o.push(i[(n+a-1)%n]),o.push(i[a]),o.push(i[(a+1)%n]),ar()(i).call(i,a,1),ar()(s).call(s,a,1);var b=(--n+a-1)%n,T=a==n?0:a;s[b]=Ge.isConcave(b,n,e,i),s[T]=Ge.isConcave(T,n,e,i)}return 3==n&&(o.push(i[2]),o.push(i[0]),o.push(i[1])),o},Ge.prototype.decompose=function(t,e){var n=t,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;var a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;var s=this.polygonIndicesPool.obtain();s.length=0;for(var r=this.polygonPool.obtain(),o=-1,h=r.length=0,c=0,l=e.length;c<l;c+=3){var u=e[c]<<1,d=e[c+1]<<1,p=e[c+2]<<1,f=n[u],g=n[1+u],m=n[d],v=n[1+d],y=n[p],S=n[1+p],A=!1;o==u&&(E=r.length-4,C=Ge.winding(r[E],r[E+1],r[E+2],r[E+3],y,S),P=Ge.winding(y,S,r[0],r[1],r[2],r[3]),C==h&&P==h&&(r.push(y),r.push(S),s.push(p),A=!0)),A||(0<r.length?(i.push(r),a.push(s)):(this.polygonPool.free(r),this.polygonIndicesPool.free(s)),(r=this.polygonPool.obtain()).length=0,r.push(f),r.push(g),r.push(m),r.push(v),r.push(y),r.push(S),(s=this.polygonIndicesPool.obtain()).length=0,s.push(u),s.push(d),s.push(p),h=Ge.winding(f,g,m,v,y,S),o=u)}for(0<r.length&&(i.push(r),a.push(s)),c=0,l=i.length;c<l;c++)if(0!=(s=a[c]).length)for(var E,x,b,T,w,M,C,P,I=s[0],k=s[s.length-1],R=(r=i[c])[E=r.length-4],O=r[E+1],_=r[E+2],D=r[E+3],B=r[0],L=r[1],F=r[2],N=r[3],G=Ge.winding(R,O,_,D,B,L),U=0;U<l;U++)U!=c&&3==(x=a[U]).length&&(b=x[0],T=x[1],w=x[2],y=(M=i[U])[M.length-2],S=M[M.length-1],b==I&&T==k&&(C=Ge.winding(R,O,_,D,y,S),P=Ge.winding(y,S,B,L,F,N),C==G&&P==G&&(M.length=0,x.length=0,r.push(y),r.push(S),s.push(w),R=_,O=D,_=y,D=S,U=0)));for(c=i.length-1;0<=c;c--)0==(r=i[c]).length&&(ar()(i).call(i,c,1),this.polygonPool.free(r),s=a[c],ar()(a).call(a,c,1),this.polygonIndicesPool.free(s));return i},Ge.isConcave=function(t,e,n,i){var a=i[(e+t-1)%e]<<1,s=i[t]<<1,r=i[(t+1)%e]<<1;return!this.positiveArea(n[a],n[1+a],n[s],n[1+s],n[r],n[1+r])},Ge.positiveArea=function(t,e,n,i,a,s){return 0<=t*(s-i)+n*(e-s)+a*(i-e)},Ge.winding=function(t,e,n,i,a,s){var r=n-t,o=i-e;return 0<=a*o-s*r+r*e-t*o?1:-1},Z=Ge,q.Triangulator=Z,function(t){var e=(n.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},n.prototype.contains=function(t){return null!=this.array[0|t]},n.prototype.remove=function(t){this.array[0|t]=void 0},n.prototype.clear=function(){this.array.length=0},n);function n(){this.array=new Array}t.IntSet=e;var i=(a.prototype.set=function(t,e,n,i){return this.r=t,this.g=e,this.b=n,this.a=i,this.clamp(),this},a.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},a.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=Hx()(t.substr(0,2),16)/255,this.g=Hx()(t.substr(2,2),16)/255,this.b=Hx()(t.substr(4,2),16)/255,this.a=(8!=t.length?255:Hx()(t.substr(6,2),16))/255,this},a.prototype.add=function(t,e,n,i){return this.r+=t,this.g+=e,this.b+=n,this.a+=i,this.clamp(),this},a.prototype.clamp=function(){return this.r<0?this.r=0:1<this.r&&(this.r=1),this.g<0?this.g=0:1<this.g&&(this.g=1),this.b<0?this.b=0:1<this.b&&(this.b=1),this.a<0?this.a=0:1<this.a&&(this.a=1),this},a.rgba8888ToColor=function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255},a.rgb888ToColor=function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255},a.WHITE=new a(1,1,1,1),a.RED=new a(1,0,0,1),a.GREEN=new a(0,1,0,1),a.BLUE=new a(0,0,1,1),a.MAGENTA=new a(1,0,1,1),a);function a(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.r=t,this.g=e,this.b=n,this.a=i}t.Color=i;var s=(r.clamp=function(t,e,n){return t<e?e:n<t?n:t},r.cosDeg=function(t){return Math.cos(t*r.degRad)},r.sinDeg=function(t){return Math.sin(t*r.degRad)},r.signum=function(t){return 0<t?1:t<0?-1:0},r.toInt=function(t){return 0<t?Math.floor(t):Math.ceil(t)},r.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},r.randomTriangular=function(t,e){return r.randomTriangularWith(t,e,.5*(t+e))},r.randomTriangularWith=function(t,e,n){var i=Math.random(),a=e-t;return i<=(n-t)/a?t+Math.sqrt(i*a*(n-t)):e-Math.sqrt((1-i)*a*(e-n))},r.PI2=2*(r.PI=3.1415927),r.radDeg=r.radiansToDegrees=180/r.PI,r.degRad=r.degreesToRadians=r.PI/180,r);function r(){}t.MathUtils=s;var o=(h.prototype.apply=function(t,e,n){return t+(e-t)*this.applyInternal(n)},h);function h(){}t.Interpolation=o;var c,l=(Ee(u,c=o),u.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},u);function u(t){var e=c.call(this)||this;return e.power=2,e.power=t,e}t.Pow=l;var d,p=(Ee(f,d=l),f.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},f);function f(t){return d.call(this,t)||this}t.PowOut=p;var g=(m.arrayCopy=function(t,e,n,i,a){for(var s=e,r=i;s<e+a;s++,r++)n[r]=t[s]},m.setArraySize=function(t,e,n){void 0===n&&(n=0);var i=t.length;if(i==e)return t;if(i<(t.length=e))for(var a=i;a<e;a++)t[a]=n;return t},m.ensureArrayCapacity=function(t,e,n){return void 0===n&&(n=0),t.length>=e?t:m.setArraySize(t,e,n)},m.newArray=function(t,e){for(var n=new Array(t),i=0;i<t;i++)n[i]=e;return n},m.newFloatArray=function(t){if(m.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=0;return e},m.newShortArray=function(t){if(m.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=0;return e},m.toFloatArray=function(t){return m.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t},m.toSinglePrecision=function(t){return m.SUPPORTS_TYPED_ARRAYS?zI()(t):t},m.webkit602BugfixHelper=function(t,e){},m.contains=function(t,e,n){void 0===n&&(n=!0);for(var i=0;i<t.length;i++)if(t[i]==e)return!0;return!1},m.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,m);function m(){}t.Utils=g;var v=(y.logBones=function(t){for(var e=0;e<t.bones.length;e++)t.bones[e]},y);function y(){}t.DebugUtils=v;var S=(A.prototype.obtain=function(){return 0<this.items.length?this.items.pop():this.instantiator()},A.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},A.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)this.free(t[e])},A.prototype.clear=function(){this.items.length=0},A);function A(t){this.items=new Array,this.instantiator=t}t.Pool=S;var E=(x.prototype.set=function(t,e){return this.x=t,this.y=e,this},x.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},x.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},x);function x(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}t.Vector2=E;var b=(T.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,1<this.frameTime&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},T);function T(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}t.TimeKeeper=b;var w=(M.prototype.hasEnoughData=function(){return this.addedValues>=WI()(this).length},M.prototype.addValue=function(t){this.addedValues<WI()(this).length&&this.addedValues++,WI()(this)[this.lastValue++]=t,this.lastValue>WI()(this).length-1&&(this.lastValue=0),this.dirty=!0},M.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<WI()(this).length;e++)t+=WI()(this)[e];this.mean=t/WI()(this).length,this.dirty=!1}return this.mean}return 0},M);function M(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}t.WindowedMean=w}(Se=Se||{}),zI()||(Math.fround=(J=new Float32Array(1),function(t){return J[0]=t,J[0]})),function(t){function e(t){if(null==t)throw new Error("name cannot be null.");this.name=t}t.Attachment=e;var n,i=(Ee(a,n=e),a.prototype.computeWorldVertices=function(t,e,n,i,a,s){n=a+(n>>1)*s;var r=t.bone.skeleton,o=t.deform,h=this.vertices,c=this.bones;if(null!=c){for(var l=0,u=0,d=0;d<e;d+=2)l+=(m=c[l])+1,u+=m;var p=r.bones;if(0==o.length)for(x=a,b=3*u;x<n;x+=s){var f=0,g=0,m=c[l++];for(m+=l;l<m;l++,b+=3){var v=p[c[l]],y=h[b],S=h[b+1],A=h[b+2];f+=(y*v.a+S*v.b+v.worldX)*A,g+=(y*v.c+S*v.d+v.worldY)*A}i[x]=f,i[x+1]=g}else for(var E=o,x=a,b=3*u,T=u<<1;x<n;x+=s){for(g=f=0,m=c[l++],m+=l;l<m;l++,b+=3,T+=2)v=p[c[l]],y=h[b]+E[T],S=h[b+1]+E[T+1],A=h[b+2],f+=(y*v.a+S*v.b+v.worldX)*A,g+=(y*v.c+S*v.d+v.worldY)*A;i[x]=f,i[x+1]=g}}else{0<o.length&&(h=o);var w=(v=t.bone).worldX,M=v.worldY,C=v.a,P=(b=v.b,v.c),I=v.d,k=e;for(x=a;x<n;k+=2,x+=s){y=h[k],S=h[k+1];i[x]=y*C+S*b+w,i[x+1]=y*P+S*I+M}}},a.prototype.copyTo=function(e){null!=this.bones?(e.bones=new Array(this.bones.length),t.Utils.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,null!=this.vertices?(e.vertices=t.Utils.newFloatArray(this.vertices.length),t.Utils.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)):e.vertices=null,e.worldVerticesLength=this.worldVerticesLength,e.deformAttachment=this.deformAttachment},a.nextID=0,a);function a(t){var e=n.call(this,t)||this;return e.id=(65535&a.nextID++)<<11,e.worldVerticesLength=0,e.deformAttachment=e}t.VertexAttachment=i}(Se=Se||{}),($=(Q=Se=Se||{}).AttachmentType||(Q.AttachmentType={}))[$.Region=0]="Region",$[$.BoundingBox=1]="BoundingBox",$[$.Mesh=2]="Mesh",$[$.LinkedMesh=3]="LinkedMesh",$[$.Path=4]="Path",$[$.Point=5]="Point",$[$.Clipping=6]="Clipping",tt=Se=Se||{},et=tt.VertexAttachment,Ee(Ue,et),Ue.prototype.copy=function(){var t=new Ue(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t},nt=Ue,tt.BoundingBoxAttachment=nt,at=Se=Se||{},st=at.VertexAttachment,Ee(Ve,st),Ve.prototype.copy=function(){var t=new Ve(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t},rt=Ve,at.ClippingAttachment=rt,ot=Se=Se||{},ht=ot.VertexAttachment,Ee(Ye,ht),Ye.prototype.updateUVs=function(){var t=this.regionUVs;null!=this.uvs&&this.uvs.length==t.length||(this.uvs=ot.Utils.newFloatArray(t.length));var e=this.uvs,n=this.uvs.length,i=this.region.u,a=this.region.v,s=0,r=0;if(this.region instanceof ot.TextureAtlasRegion){var o=this.region,h=o.texture.getImage().width,c=o.texture.getImage().height;switch(o.degrees){case 90:i-=(o.originalHeight-o.offsetY-o.height)/h,a-=(o.originalWidth-o.offsetX-o.width)/c,s=o.originalHeight/h,r=o.originalWidth/c;for(var l=0;l<n;l+=2)e[l]=i+t[l+1]*s,e[l+1]=a+(1-t[l])*r;return;case 180:for(i-=(o.originalWidth-o.offsetX-o.width)/h,a-=o.offsetY/c,s=o.originalWidth/h,r=o.originalHeight/c,l=0;l<n;l+=2)e[l]=i+(1-t[l])*s,e[l+1]=a+(1-t[l+1])*r;return;case 270:for(i-=o.offsetY/h,a-=o.offsetX/c,s=o.originalHeight/h,r=o.originalWidth/c,l=0;l<n;l+=2)e[l]=i+(1-t[l+1])*s,e[l+1]=a+t[l]*r;return}i-=o.offsetX/h,a-=(o.originalHeight-o.offsetY-o.height)/c,s=o.originalWidth/h,r=o.originalHeight/c}else null==this.region?(i=a=0,s=r=1):(s=this.region.u2-i,r=this.region.v2-a);for(l=0;l<n;l+=2)e[l]=i+t[l]*s,e[l+1]=a+t[l+1]*r},Ye.prototype.getParentMesh=function(){return this.parentMesh},Ye.prototype.setParentMesh=function(t){null!=(this.parentMesh=t)&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},Ye.prototype.copy=function(){if(null!=this.parentMesh)return this.newLinkedMesh();var t=new Ye(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),ot.Utils.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),ot.Utils.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),ot.Utils.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),ot.Utils.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t},Ye.prototype.newLinkedMesh=function(){var t=new Ye(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t},ct=Ye,ot.MeshAttachment=ct,lt=Se=Se||{},ut=lt.VertexAttachment,Ee(ze,ut),ze.prototype.copy=function(){var t=new ze(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),lt.Utils.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t},dt=ze,lt.PathAttachment=dt,pt=Se=Se||{},ft=pt.VertexAttachment,Ee(He,ft),He.prototype.computeWorldPosition=function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e},He.prototype.computeWorldRotation=function(t){var e=pt.MathUtils.cosDeg(this.rotation),n=pt.MathUtils.sinDeg(this.rotation),i=e*t.a+n*t.b,a=e*t.c+n*t.d;return Math.atan2(a,i)*pt.MathUtils.radDeg},He.prototype.copy=function(){var t=new He(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t},gt=He,pt.PointAttachment=gt,mt=Se=Se||{},vt=mt.Attachment,Ee(We,vt),We.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,i=-this.height/2*this.scaleY+this.region.offsetY*e,a=n+this.region.width*t,s=i+this.region.height*e,r=this.rotation*Math.PI/180,o=Math.cos(r),h=Math.sin(r),c=n*o+this.x,l=n*h,u=i*o+this.y,d=i*h,p=a*o+this.x,f=a*h,g=s*o+this.y,m=s*h,v=this.offset;v[We.OX1]=c-d,v[We.OY1]=u+l,v[We.OX2]=c-m,v[We.OY2]=g+l,v[We.OX3]=p-m,v[We.OY3]=g+f,v[We.OX4]=p-d,v[We.OY4]=u+f},We.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},We.prototype.computeWorldVertices=function(t,e,n,i){var a=this.offset,s=t.worldX,r=t.worldY,o=t.a,h=t.b,c=t.c,l=t.d,u=a[We.OX1],d=a[We.OY1];e[n]=u*o+d*h+s,e[n+1]=u*c+d*l+r,n+=i,u=a[We.OX2],d=a[We.OY2],e[n]=u*o+d*h+s,e[n+1]=u*c+d*l+r,n+=i,u=a[We.OX3],d=a[We.OY3],e[n]=u*o+d*h+s,e[n+1]=u*c+d*l+r,n+=i,u=a[We.OX4],d=a[We.OY4],e[n]=u*o+d*h+s,e[n+1]=u*c+d*l+r},We.prototype.copy=function(){var t=new We(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,mt.Utils.arrayCopy(this.uvs,0,t.uvs,0,8),mt.Utils.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t},We.OX1=0,We.OY1=1,We.OX2=2,We.OY2=3,We.OX3=4,We.OY3=5,We.OX4=6,We.OY4=7,We.X1=0,We.Y1=1,We.C1R=2,We.C1G=3,We.C1B=4,We.C1A=5,We.U1=6,We.V1=7,We.X2=8,We.Y2=9,We.C2R=10,We.C2G=11,We.C2B=12,We.C2A=13,We.U2=14,We.V2=15,We.X3=16,We.Y3=17,We.C3R=18,We.C3G=19,We.C3B=20,We.C3A=21,We.U3=22,We.V3=23,We.X4=24,We.Y4=25,We.C4R=26,We.C4G=27,We.C4B=28,We.C4A=29,We.U4=30,We.V4=31,yt=We,mt.RegionAttachment=yt,St=Se=Se||{},Xe.prototype.begin=function(t){},Xe.prototype.transform=function(t,e,n,i){t.x+=St.MathUtils.randomTriangular(-this.jitterX,this.jitterY),t.y+=St.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},Xe.prototype.end=function(){},At=Xe,St.JitterEffect=At,Et=Se=Se||{},Ke.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},Ke.prototype.transform=function(t,e,n,i){var a,s,r,o=this.angle*Et.MathUtils.degreesToRadians,h=t.x-this.worldX,c=t.y-this.worldY,l=Math.sqrt(h*h+c*c);l<this.radius&&(a=Ke.interpolation.apply(0,o,(this.radius-l)/this.radius),s=Math.cos(a),r=Math.sin(a),t.x=s*h-r*c+this.worldX,t.y=r*h+s*c+this.worldY)},Ke.prototype.end=function(){},Ke.interpolation=new Et.PowOut(2),xt=Ke,Et.SwirlEffect=xt,Tt=(bt=Se=Se||{}).canvas||(bt.canvas={}),wt=bt.AssetManager,Ee(je,wt),Mt=je,Tt.AssetManager=Mt,Pt=(Ct=Se=Se||{}).canvas||(Ct.canvas={}),It=Ct.Texture,Ee(qe,It),qe.prototype.setFilters=function(t,e){},qe.prototype.setWraps=function(t,e){},qe.prototype.dispose=function(){},kt=qe,Pt.CanvasTexture=kt,Ot=(Rt=Se=Se||{}).canvas||(Rt.canvas={}),Ze.prototype.draw=function(t){this.triangleRendering?this.drawTriangles(t):this.drawImages(t)},Ze.prototype.drawImages=function(t){var e=this.ctx,n=t.drawOrder;this.debugRendering&&(e.strokeStyle="green"),e.save();for(var i=0,a=n.length;i<a;i++){var s,r,o,h,c,l,u,d,p,f,g,m,v,y,S,A=n[i];A.bone.active&&(h=o=r=null,(s=A.getAttachment())instanceof Rt.RegionAttachment&&(h=(o=(r=s).region).texture.getImage(),c=A.bone.skeleton.color,l=A.color,u=r.color,d=c.a*l.a*u.a,(p=this.tempColor).set(c.r*l.r*u.r,c.g*l.g*u.g,c.b*l.b*u.b,d),f=s,g=A.bone,y=o.width,S=o.height,e.save(),e.transform(g.a,g.c,g.b,g.d,g.worldX,g.worldY),e.translate(s.offset[0],s.offset[1]),e.rotate(s.rotation*Math.PI/180),m=f.width/y,e.scale(m*s.scaleX,m*s.scaleY),e.translate(y/2,S/2),s.region.rotate&&(v=y,y=S,S=v,e.rotate(-Math.PI/2)),e.scale(1,-1),e.translate(-y/2,-S/2),1==p.r&&1==p.g&&1==p.b&&1==p.a||(e.globalAlpha=p.a),e.drawImage(h,o.x,o.y,y,S,0,0,y,S),this.debugRendering&&e.strokeRect(0,0,y,S),e.restore()))}e.restore()},Ze.prototype.drawTriangles=function(t){for(var e=null,n=this.vertices,i=null,a=t.drawOrder,s=0,r=a.length;s<r;s++){var o=a[s],h=o.getAttachment(),c=null;if(h instanceof Rt.RegionAttachment){var l=h;n=this.computeRegionVertices(o,l,!1),i=Ze.QUAD_TRIANGLES,c=l.region.texture.getImage()}else{if(!(h instanceof Rt.MeshAttachment))continue;var u=h;n=this.computeMeshVertices(o,u,!1),i=u.triangles,c=u.region.renderObject.texture.getImage()}if(null!=c){var d=o.data.blendMode;d!=e&&(e=d);var p=o.bone.skeleton.color,f=o.color,g=h.color,m=p.a*f.a*g.a,v=this.tempColor;v.set(p.r*f.r*g.r,p.g*f.g*g.g,p.b*f.b*g.b,m);var y=this.ctx;1==v.r&&1==v.g&&1==v.b&&1==v.a||(y.globalAlpha=v.a);for(var S=0;S<i.length;S+=3){var A=8*i[S],E=8*i[S+1],x=8*i[S+2],b=n[A],T=n[1+A],w=n[6+A],M=n[7+A],C=n[E],P=n[1+E],I=n[6+E],k=n[7+E],R=n[x],O=n[1+x],_=n[6+x],D=n[7+x];this.drawTriangle(c,b,T,w,M,C,P,I,k,R,O,_,D),this.debugRendering&&(y.strokeStyle="green",y.beginPath(),y.moveTo(b,T),y.lineTo(C,P),y.lineTo(R,O),y.lineTo(b,T),y.stroke())}}}this.ctx.globalAlpha=1},Ze.prototype.drawTriangle=function(t,e,n,i,a,s,r,o,h,c,l,u,d){var p=this.ctx;i*=t.width,a*=t.height,o*=t.width,h*=t.height,u*=t.width,d*=t.height,p.beginPath(),p.moveTo(e,n),p.lineTo(s,r),p.lineTo(c,l),p.closePath();var f=1/((o-=i)*(d-=a)-(u-=i)*(h-=a)),g=(d*(s-=e)-h*(c-=e))*f,m=(d*(r-=n)-h*(l-=n))*f,v=(o*c-u*s)*f,y=(o*l-u*r)*f,S=e-g*i-v*a,A=n-m*i-y*a;p.save(),p.transform(g,m,v,y,S,A),p.clip(),p.drawImage(t,0,0),p.restore()},Ze.prototype.computeRegionVertices=function(t,e,n){var i=t.bone.skeleton.color,a=t.color,s=e.color,r=i.a*a.a*s.a,o=n?r:1,h=this.tempColor;h.set(i.r*a.r*s.r*o,i.g*a.g*s.g*o,i.b*a.b*s.b*o,r),e.computeWorldVertices(t.bone,this.vertices,0,Ze.VERTEX_SIZE);var c=this.vertices,l=e.uvs;return c[Rt.RegionAttachment.C1R]=h.r,c[Rt.RegionAttachment.C1G]=h.g,c[Rt.RegionAttachment.C1B]=h.b,c[Rt.RegionAttachment.C1A]=h.a,c[Rt.RegionAttachment.U1]=l[0],c[Rt.RegionAttachment.V1]=l[1],c[Rt.RegionAttachment.C2R]=h.r,c[Rt.RegionAttachment.C2G]=h.g,c[Rt.RegionAttachment.C2B]=h.b,c[Rt.RegionAttachment.C2A]=h.a,c[Rt.RegionAttachment.U2]=l[2],c[Rt.RegionAttachment.V2]=l[3],c[Rt.RegionAttachment.C3R]=h.r,c[Rt.RegionAttachment.C3G]=h.g,c[Rt.RegionAttachment.C3B]=h.b,c[Rt.RegionAttachment.C3A]=h.a,c[Rt.RegionAttachment.U3]=l[4],c[Rt.RegionAttachment.V3]=l[5],c[Rt.RegionAttachment.C4R]=h.r,c[Rt.RegionAttachment.C4G]=h.g,c[Rt.RegionAttachment.C4B]=h.b,c[Rt.RegionAttachment.C4A]=h.a,c[Rt.RegionAttachment.U4]=l[6],c[Rt.RegionAttachment.V4]=l[7],c},Ze.prototype.computeMeshVertices=function(t,e,n){var i=t.bone.skeleton.color,a=t.color,s=e.color,r=i.a*a.a*s.a,o=n?r:1,h=this.tempColor;h.set(i.r*a.r*s.r*o,i.g*a.g*s.g*o,i.b*a.b*s.b*o,r);var c=e.worldVerticesLength/2;this.vertices.length<e.worldVerticesLength&&(this.vertices=Rt.Utils.newFloatArray(e.worldVerticesLength));var l=this.vertices;e.computeWorldVertices(t,0,e.worldVerticesLength,l,0,Ze.VERTEX_SIZE);for(var u=e.uvs,d=0,p=c,f=0,g=2;d<p;d++)l[g++]=h.r,l[g++]=h.g,l[g++]=h.b,l[g++]=h.a,l[g++]=u[f++],l[g++]=u[f++],g+=2;return l},Ze.QUAD_TRIANGLES=[0,1,2,2,3,0],Ze.VERTEX_SIZE=8,_t=Ze,Ot.SkeletonRenderer=_t,Bt=(Dt=Se=Se||{}).webgl||(Dt.webgl={}),Lt=Dt.AssetManager,Ee(Je,Lt),Ft=Je,Bt.AssetManager=Ft,Nt=Se=Se||{},Gt=Nt.webgl||(Nt.webgl={}),Qe.prototype.update=function(){var t=this.projection,e=this.view,n=this.projectionView,i=this.inverseProjectionView,a=this.zoom,s=this.viewportWidth,r=this.viewportHeight;t.ortho(a*(-s/2),a*(s/2),a*(-r/2),a*(r/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),n.set(WI()(t)),n.multiply(e),i.set(WI()(n)).invert()},Qe.prototype.screenToWorld=function(t,e,n){var i=t.x,a=n-t.y-1,s=this.tmp;return s.x=2*i/e-1,s.y=2*a/n-1,s.z=2*t.z-1,s.project(this.inverseProjectionView),t.set(s.x,s.y,s.z),t},Qe.prototype.setViewport=function(t,e){this.viewportWidth=t,this.viewportHeight=e},Ut=Qe,Gt.OrthoCamera=Ut,Vt=Se=Se||{},Yt=Vt.webgl||(Vt.webgl={}),zt=Vt.Texture,Ee($e,zt),$e.prototype.setFilters=function(t,e){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,$e.validateMagFilter(e))},$e.validateMagFilter=function(t){switch(t){case Vt.TextureFilter.MipMap:case Vt.TextureFilter.MipMapLinearLinear:case Vt.TextureFilter.MipMapLinearNearest:case Vt.TextureFilter.MipMapNearestLinear:case Vt.TextureFilter.MipMapNearestNearest:return Vt.TextureFilter.Linear;default:return t}},$e.prototype.setWraps=function(t,e){var n=this.context.gl;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e)},$e.prototype.update=function(t){var e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),$e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)},$e.prototype.restore=function(){this.texture=null,this.update(this.useMipMaps)},$e.prototype.bind=function(t){void 0===t&&(t=0);var e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},$e.prototype.unbind=function(){var t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)},$e.prototype.dispose=function(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)},$e.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1,Ht=$e,Yt.GLTexture=Ht,function(t){t.M00=0,t.M01=4,t.M02=8,t.M03=12,t.M10=1,t.M11=5,t.M12=9,t.M13=13,t.M20=2,t.M21=6,t.M22=10,t.M23=14,t.M30=3,t.M31=7,t.M32=11,t.M33=15;var e=(n.prototype.set=function(t){return WI()(this).set(t),this},n.prototype.transpose=function(){var e=this.temp,n=WI()(this);return e[t.M00]=n[t.M00],e[t.M01]=n[t.M10],e[t.M02]=n[t.M20],e[t.M03]=n[t.M30],e[t.M10]=n[t.M01],e[t.M11]=n[t.M11],e[t.M12]=n[t.M21],e[t.M13]=n[t.M31],e[t.M20]=n[t.M02],e[t.M21]=n[t.M12],e[t.M22]=n[t.M22],e[t.M23]=n[t.M32],e[t.M30]=n[t.M03],e[t.M31]=n[t.M13],e[t.M32]=n[t.M23],e[t.M33]=n[t.M33],this.set(e)},n.prototype.identity=function(){var e=WI()(this);return e[t.M00]=1,e[t.M01]=0,e[t.M02]=0,e[t.M03]=0,e[t.M10]=0,e[t.M11]=1,e[t.M12]=0,e[t.M13]=0,e[t.M20]=0,e[t.M21]=0,e[t.M22]=1,e[t.M23]=0,e[t.M30]=0,e[t.M31]=0,e[t.M32]=0,e[t.M33]=1,this},n.prototype.invert=function(){var e=WI()(this),n=this.temp,i=e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33];if(0==i)throw new Error("non-invertible matrix");var a=1/i;return n[t.M00]=e[t.M12]*e[t.M23]*e[t.M31]-e[t.M13]*e[t.M22]*e[t.M31]+e[t.M13]*e[t.M21]*e[t.M32]-e[t.M11]*e[t.M23]*e[t.M32]-e[t.M12]*e[t.M21]*e[t.M33]+e[t.M11]*e[t.M22]*e[t.M33],n[t.M01]=e[t.M03]*e[t.M22]*e[t.M31]-e[t.M02]*e[t.M23]*e[t.M31]-e[t.M03]*e[t.M21]*e[t.M32]+e[t.M01]*e[t.M23]*e[t.M32]+e[t.M02]*e[t.M21]*e[t.M33]-e[t.M01]*e[t.M22]*e[t.M33],n[t.M02]=e[t.M02]*e[t.M13]*e[t.M31]-e[t.M03]*e[t.M12]*e[t.M31]+e[t.M03]*e[t.M11]*e[t.M32]-e[t.M01]*e[t.M13]*e[t.M32]-e[t.M02]*e[t.M11]*e[t.M33]+e[t.M01]*e[t.M12]*e[t.M33],n[t.M03]=e[t.M03]*e[t.M12]*e[t.M21]-e[t.M02]*e[t.M13]*e[t.M21]-e[t.M03]*e[t.M11]*e[t.M22]+e[t.M01]*e[t.M13]*e[t.M22]+e[t.M02]*e[t.M11]*e[t.M23]-e[t.M01]*e[t.M12]*e[t.M23],n[t.M10]=e[t.M13]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M20]*e[t.M32]+e[t.M10]*e[t.M23]*e[t.M32]+e[t.M12]*e[t.M20]*e[t.M33]-e[t.M10]*e[t.M22]*e[t.M33],n[t.M11]=e[t.M02]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M22]*e[t.M30]+e[t.M03]*e[t.M20]*e[t.M32]-e[t.M00]*e[t.M23]*e[t.M32]-e[t.M02]*e[t.M20]*e[t.M33]+e[t.M00]*e[t.M22]*e[t.M33],n[t.M12]=e[t.M03]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M10]*e[t.M32]+e[t.M00]*e[t.M13]*e[t.M32]+e[t.M02]*e[t.M10]*e[t.M33]-e[t.M00]*e[t.M12]*e[t.M33],n[t.M13]=e[t.M02]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M12]*e[t.M20]+e[t.M03]*e[t.M10]*e[t.M22]-e[t.M00]*e[t.M13]*e[t.M22]-e[t.M02]*e[t.M10]*e[t.M23]+e[t.M00]*e[t.M12]*e[t.M23],n[t.M20]=e[t.M11]*e[t.M23]*e[t.M30]-e[t.M13]*e[t.M21]*e[t.M30]+e[t.M13]*e[t.M20]*e[t.M31]-e[t.M10]*e[t.M23]*e[t.M31]-e[t.M11]*e[t.M20]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M33],n[t.M21]=e[t.M03]*e[t.M21]*e[t.M30]-e[t.M01]*e[t.M23]*e[t.M30]-e[t.M03]*e[t.M20]*e[t.M31]+e[t.M00]*e[t.M23]*e[t.M31]+e[t.M01]*e[t.M20]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M33],n[t.M22]=e[t.M01]*e[t.M13]*e[t.M30]-e[t.M03]*e[t.M11]*e[t.M30]+e[t.M03]*e[t.M10]*e[t.M31]-e[t.M00]*e[t.M13]*e[t.M31]-e[t.M01]*e[t.M10]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M33],n[t.M23]=e[t.M03]*e[t.M11]*e[t.M20]-e[t.M01]*e[t.M13]*e[t.M20]-e[t.M03]*e[t.M10]*e[t.M21]+e[t.M00]*e[t.M13]*e[t.M21]+e[t.M01]*e[t.M10]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M23],n[t.M30]=e[t.M12]*e[t.M21]*e[t.M30]-e[t.M11]*e[t.M22]*e[t.M30]-e[t.M12]*e[t.M20]*e[t.M31]+e[t.M10]*e[t.M22]*e[t.M31]+e[t.M11]*e[t.M20]*e[t.M32]-e[t.M10]*e[t.M21]*e[t.M32],n[t.M31]=e[t.M01]*e[t.M22]*e[t.M30]-e[t.M02]*e[t.M21]*e[t.M30]+e[t.M02]*e[t.M20]*e[t.M31]-e[t.M00]*e[t.M22]*e[t.M31]-e[t.M01]*e[t.M20]*e[t.M32]+e[t.M00]*e[t.M21]*e[t.M32],n[t.M32]=e[t.M02]*e[t.M11]*e[t.M30]-e[t.M01]*e[t.M12]*e[t.M30]-e[t.M02]*e[t.M10]*e[t.M31]+e[t.M00]*e[t.M12]*e[t.M31]+e[t.M01]*e[t.M10]*e[t.M32]-e[t.M00]*e[t.M11]*e[t.M32],n[t.M33]=e[t.M01]*e[t.M12]*e[t.M20]-e[t.M02]*e[t.M11]*e[t.M20]+e[t.M02]*e[t.M10]*e[t.M21]-e[t.M00]*e[t.M12]*e[t.M21]-e[t.M01]*e[t.M10]*e[t.M22]+e[t.M00]*e[t.M11]*e[t.M22],e[t.M00]=n[t.M00]*a,e[t.M01]=n[t.M01]*a,e[t.M02]=n[t.M02]*a,e[t.M03]=n[t.M03]*a,e[t.M10]=n[t.M10]*a,e[t.M11]=n[t.M11]*a,e[t.M12]=n[t.M12]*a,e[t.M13]=n[t.M13]*a,e[t.M20]=n[t.M20]*a,e[t.M21]=n[t.M21]*a,e[t.M22]=n[t.M22]*a,e[t.M23]=n[t.M23]*a,e[t.M30]=n[t.M30]*a,e[t.M31]=n[t.M31]*a,e[t.M32]=n[t.M32]*a,e[t.M33]=n[t.M33]*a,this},n.prototype.determinant=function(){var e=WI()(this);return e[t.M30]*e[t.M21]*e[t.M12]*e[t.M03]-e[t.M20]*e[t.M31]*e[t.M12]*e[t.M03]-e[t.M30]*e[t.M11]*e[t.M22]*e[t.M03]+e[t.M10]*e[t.M31]*e[t.M22]*e[t.M03]+e[t.M20]*e[t.M11]*e[t.M32]*e[t.M03]-e[t.M10]*e[t.M21]*e[t.M32]*e[t.M03]-e[t.M30]*e[t.M21]*e[t.M02]*e[t.M13]+e[t.M20]*e[t.M31]*e[t.M02]*e[t.M13]+e[t.M30]*e[t.M01]*e[t.M22]*e[t.M13]-e[t.M00]*e[t.M31]*e[t.M22]*e[t.M13]-e[t.M20]*e[t.M01]*e[t.M32]*e[t.M13]+e[t.M00]*e[t.M21]*e[t.M32]*e[t.M13]+e[t.M30]*e[t.M11]*e[t.M02]*e[t.M23]-e[t.M10]*e[t.M31]*e[t.M02]*e[t.M23]-e[t.M30]*e[t.M01]*e[t.M12]*e[t.M23]+e[t.M00]*e[t.M31]*e[t.M12]*e[t.M23]+e[t.M10]*e[t.M01]*e[t.M32]*e[t.M23]-e[t.M00]*e[t.M11]*e[t.M32]*e[t.M23]-e[t.M20]*e[t.M11]*e[t.M02]*e[t.M33]+e[t.M10]*e[t.M21]*e[t.M02]*e[t.M33]+e[t.M20]*e[t.M01]*e[t.M12]*e[t.M33]-e[t.M00]*e[t.M21]*e[t.M12]*e[t.M33]-e[t.M10]*e[t.M01]*e[t.M22]*e[t.M33]+e[t.M00]*e[t.M11]*e[t.M22]*e[t.M33]},n.prototype.translate=function(e,n,i){var a=WI()(this);return a[t.M03]+=e,a[t.M13]+=n,a[t.M23]+=i,this},n.prototype.copy=function(){return(new n).set(WI()(this))},n.prototype.projection=function(e,n,i,a){this.identity();var s=1/Math.tan(i*(Math.PI/180)/2),r=(n+e)/(e-n),o=2*n*e/(e-n),h=WI()(this);return h[t.M00]=s/a,h[t.M10]=0,h[t.M20]=0,h[t.M30]=0,h[t.M01]=0,h[t.M11]=s,h[t.M21]=0,h[t.M31]=0,h[t.M02]=0,h[t.M12]=0,h[t.M22]=r,h[t.M32]=-1,h[t.M03]=0,h[t.M13]=0,h[t.M23]=o,h[t.M33]=0,this},n.prototype.ortho2d=function(t,e,n,i){return this.ortho(t,t+n,e,e+i,0,1)},n.prototype.ortho=function(e,n,i,a,s,r){this.identity();var o=2/(n-e),h=2/(a-i),c=-2/(r-s),l=-(n+e)/(n-e),u=-(a+i)/(a-i),d=-(r+s)/(r-s),p=WI()(this);return p[t.M00]=o,p[t.M10]=0,p[t.M20]=0,p[t.M30]=0,p[t.M01]=0,p[t.M11]=h,p[t.M21]=0,p[t.M31]=0,p[t.M02]=0,p[t.M12]=0,p[t.M22]=c,p[t.M32]=0,p[t.M03]=l,p[t.M13]=u,p[t.M23]=d,p[t.M33]=1,this},n.prototype.multiply=function(e){var n=this.temp,i=WI()(this),a=WI()(e);return n[t.M00]=i[t.M00]*a[t.M00]+i[t.M01]*a[t.M10]+i[t.M02]*a[t.M20]+i[t.M03]*a[t.M30],n[t.M01]=i[t.M00]*a[t.M01]+i[t.M01]*a[t.M11]+i[t.M02]*a[t.M21]+i[t.M03]*a[t.M31],n[t.M02]=i[t.M00]*a[t.M02]+i[t.M01]*a[t.M12]+i[t.M02]*a[t.M22]+i[t.M03]*a[t.M32],n[t.M03]=i[t.M00]*a[t.M03]+i[t.M01]*a[t.M13]+i[t.M02]*a[t.M23]+i[t.M03]*a[t.M33],n[t.M10]=i[t.M10]*a[t.M00]+i[t.M11]*a[t.M10]+i[t.M12]*a[t.M20]+i[t.M13]*a[t.M30],n[t.M11]=i[t.M10]*a[t.M01]+i[t.M11]*a[t.M11]+i[t.M12]*a[t.M21]+i[t.M13]*a[t.M31],n[t.M12]=i[t.M10]*a[t.M02]+i[t.M11]*a[t.M12]+i[t.M12]*a[t.M22]+i[t.M13]*a[t.M32],n[t.M13]=i[t.M10]*a[t.M03]+i[t.M11]*a[t.M13]+i[t.M12]*a[t.M23]+i[t.M13]*a[t.M33],n[t.M20]=i[t.M20]*a[t.M00]+i[t.M21]*a[t.M10]+i[t.M22]*a[t.M20]+i[t.M23]*a[t.M30],n[t.M21]=i[t.M20]*a[t.M01]+i[t.M21]*a[t.M11]+i[t.M22]*a[t.M21]+i[t.M23]*a[t.M31],n[t.M22]=i[t.M20]*a[t.M02]+i[t.M21]*a[t.M12]+i[t.M22]*a[t.M22]+i[t.M23]*a[t.M32],n[t.M23]=i[t.M20]*a[t.M03]+i[t.M21]*a[t.M13]+i[t.M22]*a[t.M23]+i[t.M23]*a[t.M33],n[t.M30]=i[t.M30]*a[t.M00]+i[t.M31]*a[t.M10]+i[t.M32]*a[t.M20]+i[t.M33]*a[t.M30],n[t.M31]=i[t.M30]*a[t.M01]+i[t.M31]*a[t.M11]+i[t.M32]*a[t.M21]+i[t.M33]*a[t.M31],n[t.M32]=i[t.M30]*a[t.M02]+i[t.M31]*a[t.M12]+i[t.M32]*a[t.M22]+i[t.M33]*a[t.M32],n[t.M33]=i[t.M30]*a[t.M03]+i[t.M31]*a[t.M13]+i[t.M32]*a[t.M23]+i[t.M33]*a[t.M33],this.set(this.temp)},n.prototype.multiplyLeft=function(e){var n=this.temp,i=WI()(this),a=WI()(e);return n[t.M00]=a[t.M00]*i[t.M00]+a[t.M01]*i[t.M10]+a[t.M02]*i[t.M20]+a[t.M03]*i[t.M30],n[t.M01]=a[t.M00]*i[t.M01]+a[t.M01]*i[t.M11]+a[t.M02]*i[t.M21]+a[t.M03]*i[t.M31],n[t.M02]=a[t.M00]*i[t.M02]+a[t.M01]*i[t.M12]+a[t.M02]*i[t.M22]+a[t.M03]*i[t.M32],n[t.M03]=a[t.M00]*i[t.M03]+a[t.M01]*i[t.M13]+a[t.M02]*i[t.M23]+a[t.M03]*i[t.M33],n[t.M10]=a[t.M10]*i[t.M00]+a[t.M11]*i[t.M10]+a[t.M12]*i[t.M20]+a[t.M13]*i[t.M30],n[t.M11]=a[t.M10]*i[t.M01]+a[t.M11]*i[t.M11]+a[t.M12]*i[t.M21]+a[t.M13]*i[t.M31],n[t.M12]=a[t.M10]*i[t.M02]+a[t.M11]*i[t.M12]+a[t.M12]*i[t.M22]+a[t.M13]*i[t.M32],n[t.M13]=a[t.M10]*i[t.M03]+a[t.M11]*i[t.M13]+a[t.M12]*i[t.M23]+a[t.M13]*i[t.M33],n[t.M20]=a[t.M20]*i[t.M00]+a[t.M21]*i[t.M10]+a[t.M22]*i[t.M20]+a[t.M23]*i[t.M30],n[t.M21]=a[t.M20]*i[t.M01]+a[t.M21]*i[t.M11]+a[t.M22]*i[t.M21]+a[t.M23]*i[t.M31],n[t.M22]=a[t.M20]*i[t.M02]+a[t.M21]*i[t.M12]+a[t.M22]*i[t.M22]+a[t.M23]*i[t.M32],n[t.M23]=a[t.M20]*i[t.M03]+a[t.M21]*i[t.M13]+a[t.M22]*i[t.M23]+a[t.M23]*i[t.M33],n[t.M30]=a[t.M30]*i[t.M00]+a[t.M31]*i[t.M10]+a[t.M32]*i[t.M20]+a[t.M33]*i[t.M30],n[t.M31]=a[t.M30]*i[t.M01]+a[t.M31]*i[t.M11]+a[t.M32]*i[t.M21]+a[t.M33]*i[t.M31],n[t.M32]=a[t.M30]*i[t.M02]+a[t.M31]*i[t.M12]+a[t.M32]*i[t.M22]+a[t.M33]*i[t.M32],n[t.M33]=a[t.M30]*i[t.M03]+a[t.M31]*i[t.M13]+a[t.M32]*i[t.M23]+a[t.M33]*i[t.M33],this.set(this.temp)},n.prototype.lookAt=function(e,i,a){n.initTemps();var s=n.xAxis,r=n.yAxis,o=n.zAxis;o.setFrom(i).normalize(),s.setFrom(i).normalize(),s.cross(a).normalize(),r.setFrom(s).cross(o).normalize(),this.identity();var h=WI()(this);return h[t.M00]=s.x,h[t.M01]=s.y,h[t.M02]=s.z,h[t.M10]=r.x,h[t.M11]=r.y,h[t.M12]=r.z,h[t.M20]=-o.x,h[t.M21]=-o.y,h[t.M22]=-o.z,n.tmpMatrix.identity(),WI()(n.tmpMatrix)[t.M03]=-e.x,WI()(n.tmpMatrix)[t.M13]=-e.y,WI()(n.tmpMatrix)[t.M23]=-e.z,this.multiply(n.tmpMatrix),this},n.initTemps=function(){null===n.xAxis&&(n.xAxis=new t.Vector3),null===n.yAxis&&(n.yAxis=new t.Vector3),null===n.zAxis&&(n.zAxis=new t.Vector3)},n.xAxis=null,n.yAxis=null,n.zAxis=null,n.tmpMatrix=new n,n);function n(){this.temp=new Float32Array(16),this.values=new Float32Array(16);var e=WI()(this);e[t.M00]=1,e[t.M11]=1,e[t.M22]=1,e[t.M33]=1}t.Matrix4=e}((Wt=Se=Se||{}).webgl||(Wt.webgl={})),function(t){var e=(n.prototype.getAttributes=function(){return this.attributes},n.prototype.maxVertices=function(){return this.vertices.length/this.elementsPerVertex},n.prototype.numVertices=function(){return this.verticesLength/this.elementsPerVertex},n.prototype.setVerticesLength=function(t){this.dirtyVertices=!0,this.verticesLength=t},n.prototype.getVertices=function(){return this.vertices},n.prototype.maxIndices=function(){return this.indices.length},n.prototype.numIndices=function(){return this.indicesLength},n.prototype.setIndicesLength=function(t){this.dirtyIndices=!0,this.indicesLength=t},n.prototype.getIndices=function(){return this.indices},n.prototype.getVertexSizeInFloats=function(){for(var t=0,e=0;e<this.attributes.length;e++)t+=this.attributes[e].numElements;return t},n.prototype.setVertices=function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length},n.prototype.setIndices=function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length},n.prototype.draw=function(t,e){this.drawWithOffset(t,e,0,0<this.indicesLength?this.indicesLength:this.verticesLength/this.elementsPerVertex)},n.prototype.drawWithOffset=function(t,e,n,i){var a=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),0<this.indicesLength?a.drawElements(e,i,a.UNSIGNED_SHORT,2*n):a.drawArrays(e,n,i),this.unbind(t)},n.prototype.bind=function(t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var n=0,i=0;i<this.attributes.length;i++){var a=this.attributes[i],s=t.getAttributeLocation(a.name);e.enableVertexAttribArray(s),e.vertexAttribPointer(s,a.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*n),n+=a.numElements}0<this.indicesLength&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},n.prototype.unbind=function(t){for(var e=this.context.gl,n=0;n<this.attributes.length;n++){var i=this.attributes[n],a=t.getAttributeLocation(i.name);e.disableVertexAttribArray(a)}e.bindBuffer(e.ARRAY_BUFFER,null),0<this.indicesLength&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)},n.prototype.update=function(){var t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)},n.prototype.restore=function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()},n.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)},n);function n(e,n,i,a){this.attributes=n,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e instanceof t.ManagedWebGLRenderingContext?e:new t.ManagedWebGLRenderingContext(e);for(var s=this.elementsPerVertex=0;s<n.length;s++)this.elementsPerVertex+=n[s].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(a),this.context.addRestorable(this)}function i(t,e,n){this.name=t,this.type=e,this.numElements=n}t.Mesh=e,t.VertexAttribute=i;var a,s=(Ee(r,a=i),r);function r(){return a.call(this,t.Shader.POSITION,v.Float,2)||this}t.Position2Attribute=s;var o,h=(Ee(c,o=i),c);function c(){return o.call(this,t.Shader.POSITION,v.Float,3)||this}t.Position3Attribute=h;var l,u=(Ee(d,l=i),d);function d(e){return void 0===e&&(e=0),l.call(this,t.Shader.TEXCOORDS+(0==e?"":e),v.Float,2)||this}t.TexCoordAttribute=u;var p,f=(Ee(g,p=i),g);function g(){return p.call(this,t.Shader.COLOR,v.Float,4)||this}t.ColorAttribute=f;var m,v,y,S=(Ee(A,m=i),A);function A(){return m.call(this,t.Shader.COLOR2,v.Float,4)||this}t.Color2Attribute=S,(y=v=t.VertexAttributeType||(t.VertexAttributeType={}))[y.Float=0]="Float"}((Xt=Se=Se||{}).webgl||(Xt.webgl={})),Kt=Se=Se||{},jt=Kt.webgl||(Kt.webgl={}),tn.prototype.begin=function(t){var e=this.context.gl;if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0,e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)},tn.prototype.setBlendMode=function(t,e){var n=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend))},tn.prototype.draw=function(t,e,n){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var i=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);for(var a=this.mesh.getIndices(),s=this.indicesLength,r=0;r<n.length;s++,r++)a[s]=n[r]+i;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)},tn.prototype.flush=function(){var t=this.context.gl;0!=this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,t.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)},tn.prototype.end=function(){var t=this.context.gl;if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(0<this.verticesLength||0<this.indicesLength)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1,t.disable(t.BLEND)},tn.prototype.getDrawCalls=function(){return this.drawCalls},tn.prototype.dispose=function(){this.mesh.dispose()},qt=tn,jt.PolygonBatcher=qt,Zt=Se=Se||{},Jt=Zt.webgl||(Zt.webgl={}),en.prototype.begin=function(){this.camera.update(),this.enableRenderer(this.batcher)},en.prototype.drawSkeleton=function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=-1),void 0===i&&(i=-1),this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,n,i)},en.prototype.drawSkeletonDebug=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,n)},en.prototype.drawTexture=function(t,e,n,i,a,s){void 0===s&&(s=null),this.enableRenderer(this.batcher),null===s&&(s=this.WHITE);var r=this.QUAD,o=0;r[o++]=e,r[o++]=n,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=0,r[o++]=1,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e+i,r[o++]=n,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=1,r[o++]=1,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e+i,r[o++]=n+a,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=1,r[o++]=0,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),r[o++]=e,r[o++]=n+a,r[o++]=s.r,r[o++]=s.g,r[o++]=s.b,r[o++]=s.a,r[o++]=0,r[o++]=0,this.twoColorTint&&(r[o++]=0,r[o++]=0,r[o++]=0,r[o++]=0),this.batcher.draw(t,r,this.QUAD_TRIANGLES)},en.prototype.drawTextureUV=function(t,e,n,i,a,s,r,o,h,c){void 0===c&&(c=null),this.enableRenderer(this.batcher),null===c&&(c=this.WHITE);var l=this.QUAD,u=0;l[u++]=e,l[u++]=n,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=s,l[u++]=r,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e+i,l[u++]=n,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=o,l[u++]=r,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e+i,l[u++]=n+a,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=o,l[u++]=h,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),l[u++]=e,l[u++]=n+a,l[u++]=c.r,l[u++]=c.g,l[u++]=c.b,l[u++]=c.a,l[u++]=s,l[u++]=h,this.twoColorTint&&(l[u++]=0,l[u++]=0,l[u++]=0,l[u++]=0),this.batcher.draw(t,l,this.QUAD_TRIANGLES)},en.prototype.drawTextureRotated=function(t,e,n,i,a,s,r,o,h,c){void 0===h&&(h=null),void 0===c&&(c=!1),this.enableRenderer(this.batcher),null===h&&(h=this.WHITE);var l,u,d=this.QUAD,p=e+s,f=n+r,g=-s,m=-r,v=i-s,y=a-r,S=g,A=m,E=g,x=y,b=v,T=y,w=v,M=m,C=0,P=0,I=0,k=0,R=0,O=0,_=0,D=0;k=0!=o?(I=(R=(l=Zt.MathUtils.cosDeg(o))*b-(u=Zt.MathUtils.sinDeg(o))*T)+((C=l*S-u*A)-(_=l*E-u*x)),(O=u*b+l*T)+((P=u*S+l*A)-(D=u*E+l*x))):(C=S,P=A,_=E,D=x,R=b,O=T,I=w,M),C+=p,P+=f,I+=p,k+=f,R+=p,O+=f,_+=p,D+=f;var B=0;d[B++]=C,d[B++]=P,d[B++]=h.r,d[B++]=h.g,d[B++]=h.b,d[B++]=h.a,d[B++]=0,d[B++]=1,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),d[B++]=I,d[B++]=k,d[B++]=h.r,d[B++]=h.g,d[B++]=h.b,d[B++]=h.a,d[B++]=1,d[B++]=1,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),d[B++]=R,d[B++]=O,d[B++]=h.r,d[B++]=h.g,d[B++]=h.b,d[B++]=h.a,d[B++]=1,d[B++]=0,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),d[B++]=_,d[B++]=D,d[B++]=h.r,d[B++]=h.g,d[B++]=h.b,d[B++]=h.a,d[B++]=0,d[B++]=0,this.twoColorTint&&(d[B++]=0,d[B++]=0,d[B++]=0,d[B++]=0),this.batcher.draw(t,d,this.QUAD_TRIANGLES)},en.prototype.drawRegion=function(t,e,n,i,a,s,r){void 0===s&&(s=null),void 0===r&&(r=!1),this.enableRenderer(this.batcher),null===s&&(s=this.WHITE);var o=this.QUAD,h=0;o[h++]=e,o[h++]=n,o[h++]=s.r,o[h++]=s.g,o[h++]=s.b,o[h++]=s.a,o[h++]=t.u,o[h++]=t.v2,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),o[h++]=e+i,o[h++]=n,o[h++]=s.r,o[h++]=s.g,o[h++]=s.b,o[h++]=s.a,o[h++]=t.u2,o[h++]=t.v2,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),o[h++]=e+i,o[h++]=n+a,o[h++]=s.r,o[h++]=s.g,o[h++]=s.b,o[h++]=s.a,o[h++]=t.u2,o[h++]=t.v,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),o[h++]=e,o[h++]=n+a,o[h++]=s.r,o[h++]=s.g,o[h++]=s.b,o[h++]=s.a,o[h++]=t.u,o[h++]=t.v,this.twoColorTint&&(o[h++]=0,o[h++]=0,o[h++]=0,o[h++]=0),this.batcher.draw(t.texture,o,this.QUAD_TRIANGLES)},en.prototype.line=function(t,e,n,i,a,s){void 0===a&&(a=null),void 0===s&&(s=null),this.enableRenderer(this.shapes),this.shapes.line(t,e,n,i,a)},en.prototype.triangle=function(t,e,n,i,a,s,r,o,h,c){void 0===o&&(o=null),void 0===h&&(h=null),void 0===c&&(c=null),this.enableRenderer(this.shapes),this.shapes.triangle(t,e,n,i,a,s,r,o,h,c)},en.prototype.quad=function(t,e,n,i,a,s,r,o,h,c,l,u,d){void 0===c&&(c=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===d&&(d=null),this.enableRenderer(this.shapes),this.shapes.quad(t,e,n,i,a,s,r,o,h,c,l,u,d)},en.prototype.rect=function(t,e,n,i,a,s){void 0===s&&(s=null),this.enableRenderer(this.shapes),this.shapes.rect(t,e,n,i,a,s)},en.prototype.rectLine=function(t,e,n,i,a,s,r){void 0===r&&(r=null),this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,n,i,a,s,r)},en.prototype.polygon=function(t,e,n,i){void 0===i&&(i=null),this.enableRenderer(this.shapes),this.shapes.polygon(t,e,n,i)},en.prototype.circle=function(t,e,n,i,a,s){void 0===a&&(a=null),void 0===s&&(s=0),this.enableRenderer(this.shapes),this.shapes.circle(t,e,n,i,a,s)},en.prototype.curve=function(t,e,n,i,a,s,r,o,h,c){void 0===c&&(c=null),this.enableRenderer(this.shapes),this.shapes.curve(t,e,n,i,a,s,r,o,h,c)},en.prototype.end=function(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null},en.prototype.resize=function(t){var e,n,i,a,s,r=this.canvas,o=r.clientWidth,h=r.clientHeight;r.width==o&&r.height==h||(r.width=o,r.height=h),this.context.gl.viewport(0,0,r.width,r.height),t===Qt.Stretch||(t===Qt.Expand?this.camera.setViewport(o,h):t===Qt.Fit&&(e=r.width,n=r.height,i=this.camera.viewportWidth,s=(a=this.camera.viewportHeight)/i<n/e?i/e:a/n,this.camera.viewportWidth=e*s,this.camera.viewportHeight=n*s)),this.camera.update()},en.prototype.enableRenderer=function(t){this.activeRenderer!==t&&(this.end(),t instanceof Jt.PolygonBatcher?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Jt.Shader.MVP_MATRIX,WI()(this.camera.projectionView)),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof Jt.ShapeRenderer?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Jt.Shader.MVP_MATRIX,WI()(this.camera.projectionView)),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)},en.prototype.dispose=function(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()},te=en,Jt.SceneRenderer=te,($t=Qt=Jt.ResizeMode||(Jt.ResizeMode={}))[$t.Stretch=0]="Stretch",$t[$t.Expand=1]="Expand",$t[$t.Fit=2]="Fit",ee=Se=Se||{},ne=ee.webgl||(ee.webgl={}),nn.prototype.getProgram=function(){return this.program},nn.prototype.getVertexShader=function(){return this.vertexShader},nn.prototype.getFragmentShader=function(){return this.fragmentShader},nn.prototype.getVertexShaderSource=function(){return this.vsSource},nn.prototype.getFragmentSource=function(){return this.fsSource},nn.prototype.compile=function(){var t=this.context.gl;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}},nn.prototype.compileShader=function(t,e){var n=this.context.gl,i=n.createShader(t);if(n.shaderSource(i,e),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var a="Couldn't compile shader: "+n.getShaderInfoLog(i);if(n.deleteShader(i),!n.isContextLost())throw new Error(a)}return i},nn.prototype.compileProgram=function(t,e){var n=this.context.gl,i=n.createProgram();if(n.attachShader(i,t),n.attachShader(i,e),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS)){var a="Couldn't compile shader program: "+n.getProgramInfoLog(i);if(n.deleteProgram(i),!n.isContextLost())throw new Error(a)}return i},nn.prototype.restore=function(){this.compile()},nn.prototype.bind=function(){this.context.gl.useProgram(this.program)},nn.prototype.unbind=function(){this.context.gl.useProgram(null)},nn.prototype.setUniformi=function(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)},nn.prototype.setUniformf=function(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)},nn.prototype.setUniform2f=function(t,e,n){this.context.gl.uniform2f(this.getUniformLocation(t),e,n)},nn.prototype.setUniform3f=function(t,e,n,i){this.context.gl.uniform3f(this.getUniformLocation(t),e,n,i)},nn.prototype.setUniform4f=function(t,e,n,i,a){this.context.gl.uniform4f(this.getUniformLocation(t),e,n,i,a)},nn.prototype.setUniform2x2f=function(t,e){var n=this.context.gl;this.tmp2x2.set(e),n.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)},nn.prototype.setUniform3x3f=function(t,e){var n=this.context.gl;this.tmp3x3.set(e),n.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)},nn.prototype.setUniform4x4f=function(t,e){var n=this.context.gl;this.tmp4x4.set(e),n.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)},nn.prototype.getUniformLocation=function(t){var e=this.context.gl,n=e.getUniformLocation(this.program,t);if(!n&&!e.isContextLost())throw new Error("Couldn't find location for uniform "+t);return n},nn.prototype.getAttributeLocation=function(t){var e=this.context.gl,n=e.getAttribLocation(this.program,t);if(-1==n&&!e.isContextLost())throw new Error("Couldn't find location for attribute "+t);return n},nn.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)},nn.newColoredTextured=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tattribute vec2 "+nn.TEXCOORDS+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = "+nn.COLOR+";\n\t\t\t\t\tv_texCoords = "+nn.TEXCOORDS+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n\t\t\t\t}\n\t\t\t")},nn.newTwoColoredTextured=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tattribute vec4 "+nn.COLOR2+";\n\t\t\t\tattribute vec2 "+nn.TEXCOORDS+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_light;\n\t\t\t\tvarying vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_light = "+nn.COLOR+";\n\t\t\t\t\tv_dark = "+nn.COLOR2+";\n\t\t\t\t\tv_texCoords = "+nn.TEXCOORDS+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_light;\n\t\t\t\tvarying LOWP vec4 v_dark;\n\t\t\t\tvarying vec2 v_texCoords;\n\t\t\t\tuniform sampler2D u_texture;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\t\t\t\t\tgl_FragColor.a = texColor.a * v_light.a;\n\t\t\t\t\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n\t\t\t\t}\n\t\t\t")},nn.newColored=function(t){return new nn(t,"\n\t\t\t\tattribute vec4 "+nn.POSITION+";\n\t\t\t\tattribute vec4 "+nn.COLOR+";\n\t\t\t\tuniform mat4 "+nn.MVP_MATRIX+";\n\t\t\t\tvarying vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tv_color = "+nn.COLOR+";\n\t\t\t\t\tgl_Position = "+nn.MVP_MATRIX+" * "+nn.POSITION+";\n\t\t\t\t}\n\t\t\t","\n\t\t\t\t#ifdef GL_ES\n\t\t\t\t\t#define LOWP lowp\n\t\t\t\t\tprecision mediump float;\n\t\t\t\t#else\n\t\t\t\t\t#define LOWP\n\t\t\t\t#endif\n\t\t\t\tvarying LOWP vec4 v_color;\n\n\t\t\t\tvoid main () {\n\t\t\t\t\tgl_FragColor = v_color;\n\t\t\t\t}\n\t\t\t")},nn.MVP_MATRIX="u_projTrans",nn.POSITION="a_position",nn.COLOR="a_color",nn.COLOR2="a_color2",nn.TEXCOORDS="a_texCoords",nn.SAMPLER="u_texture",ie=nn,ne.Shader=ie,ae=Se=Se||{},se=ae.webgl||(ae.webgl={}),an.prototype.begin=function(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;var e=this.context.gl;e.enable(e.BLEND),e.blendFunc(this.srcBlend,this.dstBlend)},an.prototype.setBlendMode=function(t,e){var n=this.context.gl;this.srcBlend=t,this.dstBlend=e,this.isDrawing&&(this.flush(),n.blendFunc(this.srcBlend,this.dstBlend))},an.prototype.setColor=function(t){this.color.setFromColor(t)},an.prototype.setColorWith=function(t,e,n,i){this.color.set(t,e,n,i)},an.prototype.point=function(t,e,n){void 0===n&&(n=null),this.check(re.Point,1),null===n&&(n=this.color),this.vertex(t,e,n)},an.prototype.line=function(t,e,n,i,a){void 0===a&&(a=null),this.check(re.Line,2),this.mesh.getVertices(),this.vertexIndex,null===a&&(a=this.color),this.vertex(t,e,a),this.vertex(n,i,a)},an.prototype.triangle=function(t,e,n,i,a,s,r,o,h,c){void 0===o&&(o=null),void 0===h&&(h=null),void 0===c&&(c=null),this.check(t?re.Filled:re.Line,3),this.mesh.getVertices(),this.vertexIndex,null===o&&(o=this.color),null===h&&(h=this.color),null===c&&(c=this.color),t?(this.vertex(e,n,o),this.vertex(i,a,h),this.vertex(s,r,c)):(this.vertex(e,n,o),this.vertex(i,a,h),this.vertex(i,a,o),this.vertex(s,r,h),this.vertex(s,r,o),this.vertex(e,n,h))},an.prototype.quad=function(t,e,n,i,a,s,r,o,h,c,l,u,d){void 0===c&&(c=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===d&&(d=null),this.check(t?re.Filled:re.Line,3),this.mesh.getVertices(),this.vertexIndex,null===c&&(c=this.color),null===l&&(l=this.color),null===u&&(u=this.color),null===d&&(d=this.color),t?(this.vertex(e,n,c),this.vertex(i,a,l),this.vertex(s,r,u),this.vertex(s,r,u)):(this.vertex(e,n,c),this.vertex(i,a,l),this.vertex(i,a,l),this.vertex(s,r,u),this.vertex(s,r,u),this.vertex(o,h,d)),this.vertex(o,h,d),this.vertex(e,n,c)},an.prototype.rect=function(t,e,n,i,a,s){void 0===s&&(s=null),this.quad(t,e,n,e+i,n,e+i,n+a,e,n+a,s,s,s,s)},an.prototype.rectLine=function(t,e,n,i,a,s,r){void 0===r&&(r=null),this.check(t?re.Filled:re.Line,8),null===r&&(r=this.color);var o=this.tmp.set(a-n,e-i);o.normalize(),s*=.5;var h=o.x*s,c=o.y*s;t?(this.vertex(e+h,n+c,r),this.vertex(e-h,n-c,r),this.vertex(i+h,a+c,r),this.vertex(i-h,a-c,r),this.vertex(i+h,a+c,r)):(this.vertex(e+h,n+c,r),this.vertex(e-h,n-c,r),this.vertex(i+h,a+c,r),this.vertex(i-h,a-c,r),this.vertex(i+h,a+c,r),this.vertex(e+h,n+c,r),this.vertex(i-h,a-c,r)),this.vertex(e-h,n-c,r)},an.prototype.x=function(t,e,n){this.line(t-n,e-n,t+n,e+n),this.line(t-n,e+n,t+n,e-n)},an.prototype.polygon=function(t,e,n,i){if(void 0===i&&(i=null),n<3)throw new Error("Polygon must contain at least 3 vertices");this.check(re.Line,2*n),null===i&&(i=this.color),this.mesh.getVertices(),this.vertexIndex,n<<=1;for(var a=t[e<<=1],s=t[e+1],r=e+n,o=e,h=e+n-2;o<h;o+=2){var c=t[o],l=t[o+1],u=0,d=r<=o+2?(u=a,s):(u=t[o+2],t[o+3]);this.vertex(c,l,i),this.vertex(u,d,i)}},an.prototype.circle=function(t,e,n,i,a,s){if(void 0===a&&(a=null),void 0===s&&(s=0),0===s&&(s=Math.max(1,6*ae.MathUtils.cbrt(i)|0)),s<=0)throw new Error("segments must be > 0.");null===a&&(a=this.color);var r=2*ae.MathUtils.PI/s,o=Math.cos(r),h=Math.sin(r),c=i,l=0;if(t){for(this.check(re.Filled,3*s+3),s--,d=0;d<s;d++){this.vertex(e,n,a),this.vertex(e+c,n+l,a);var u=c;c=o*c-h*l,l=h*u+o*l,this.vertex(e+c,n+l,a)}this.vertex(e,n,a),this.vertex(e+c,n+l,a)}else{this.check(re.Line,2*s+2);for(var d=0;d<s;d++){this.vertex(e+c,n+l,a);var p=c;c=o*c-h*l,l=h*p+o*l;this.vertex(e+c,n+l,a)}this.vertex(e+c,n+l,a)}c=i,l=0,this.vertex(e+c,n+l,a)},an.prototype.curve=function(t,e,n,i,a,s,r,o,h,c){void 0===c&&(c=null),this.check(re.Line,2*h+2),null===c&&(c=this.color);for(var l=1/h,u=l*l,d=l*l*l,p=3*l,f=3*u,g=6*u,m=6*d,v=t-2*n+a,y=e-2*i+s,S=3*(n-a)-t+r,A=3*(i-s)-e+o,E=t,x=e,b=(n-t)*p+v*f+S*d,T=(i-e)*p+y*f+A*d,w=v*g+S*m,M=y*g+A*m,C=S*m,P=A*m;0<h--;)this.vertex(E,x,c),E+=b,x+=T,b+=w,T+=M,w+=C,M+=P,this.vertex(E,x,c);this.vertex(E,x,c),this.vertex(r,o,c)},an.prototype.vertex=function(t,e,n){var i=this.vertexIndex,a=this.mesh.getVertices();a[i++]=t,a[i++]=e,a[i++]=n.r,a[i++]=n.g,a[i++]=n.b,a[i++]=n.a,this.vertexIndex=i},an.prototype.end=function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush(),this.context.gl.disable(this.context.gl.BLEND),this.isDrawing=!1},an.prototype.flush=function(){0!=this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)},an.prototype.check=function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t},an.prototype.dispose=function(){this.mesh.dispose()},he=an,se.ShapeRenderer=he,(oe=re=se.ShapeType||(se.ShapeType={}))[oe.Point=0]="Point",oe[oe.Line=1]="Line",oe[oe.Filled=4]="Filled",ce=Se=Se||{},le=ce.webgl||(ce.webgl={}),sn.prototype.draw=function(t,e,n){void 0===n&&(n=null);var i=e.x,a=e.y,s=this.context.gl,r=this.premultipliedAlpha?s.ONE:s.SRC_ALPHA;t.setBlendMode(r,s.ONE_MINUS_SRC_ALPHA);var o=e.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(var h=0,c=o.length;h<c;h++){var l=o[h];n&&-1<g()(n).call(n,l.data.name)||null!=l.parent&&(b=i+l.data.length*l.a+l.worldX,T=a+l.data.length*l.c+l.worldY,t.rectLine(!0,i+l.worldX,a+l.worldY,b,T,this.boneWidth*this.scale))}this.drawSkeletonXY&&t.x(i,a,4*this.scale)}if(this.drawRegionAttachments)for(t.setColor(this.attachmentLineColor),h=0,c=(U=e.slots).length;h<c;h++)(Y=(V=U[h]).getAttachment())instanceof ce.RegionAttachment&&(d=this.vertices,Y.computeWorldVertices(V.bone,d,0,2),t.line(d[0],d[1],d[2],d[3]),t.line(d[2],d[3],d[4],d[5]),t.line(d[4],d[5],d[6],d[7]),t.line(d[6],d[7],d[0],d[1]));if(this.drawMeshHull||this.drawMeshTriangles)for(h=0,c=(U=e.slots).length;h<c;h++)if((V=U[h]).bone.active&&(Y=V.getAttachment())instanceof ce.MeshAttachment){var u=Y,d=this.vertices;u.computeWorldVertices(V,0,u.worldVerticesLength,d,0,2);var p=u.triangles,f=u.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(var m=0,v=p.length;m<v;m+=3){var y=2*p[m],S=2*p[m+1],A=2*p[m+2];t.triangle(!1,d[y],d[1+y],d[S],d[1+S],d[A],d[1+A])}}if(this.drawMeshHull&&0<f){t.setColor(this.attachmentLineColor);var E=d[(f=2*(f>>1))-2],x=d[f-1];for(m=0,v=f;m<v;m+=2){var b=d[m],T=d[m+1];t.line(b,T,E,x),E=b,x=T}}}if(this.drawBoundingBoxes){var w=this.bounds;w.update(e,!0),t.setColor(this.aabbColor),t.rect(!1,w.minX,w.minY,w.getWidth(),w.getHeight());var M=w.polygons,C=w.boundingBoxes;for(h=0,c=M.length;h<c;h++){var P=M[h];t.setColor(C[h].color),t.polygon(P,0,P.length)}}if(this.drawPaths)for(h=0,c=(U=e.slots).length;h<c;h++)if((V=U[h]).bone.active&&(Y=V.getAttachment())instanceof ce.PathAttachment){var I=Y,k=(v=I.worldVerticesLength,this.temp=ce.Utils.setArraySize(this.temp,v,0));I.computeWorldVertices(V,0,v,k,0,2);var R=this.pathColor,O=k[2],_=k[3],D=0,B=0;for(I.closed&&(t.setColor(R),L=k[0],F=k[1],N=k[v-2],G=k[v-1],D=k[v-4],B=k[v-3],t.curve(O,_,L,F,N,G,D,B,32),t.setColor(sn.LIGHT_GRAY),t.line(O,_,L,F),t.line(D,B,N,G)),v-=4,m=4;m<v;m+=6){var L=k[m],F=k[m+1],N=k[m+2],G=k[m+3];D=k[m+4],B=k[m+5],t.setColor(R),t.curve(O,_,L,F,N,G,D,B,32),t.setColor(sn.LIGHT_GRAY),t.line(O,_,L,F),t.line(D,B,N,G),O=D,_=B}}if(this.drawBones)for(t.setColor(this.boneOriginColor),h=0,c=o.length;h<c;h++)l=o[h],n&&-1<g()(n).call(n,l.data.name)||t.circle(!0,i+l.worldX,a+l.worldY,3*this.scale,sn.GREEN,8);if(this.drawClipping){var U=e.slots;t.setColor(this.clipColor);var V,Y;for(h=0,c=U.length;h<c;h++)if((V=U[h]).bone.active&&(Y=V.getAttachment())instanceof ce.ClippingAttachment){var z=Y;v=z.worldVerticesLength,k=this.temp=ce.Utils.setArraySize(this.temp,v,0);z.computeWorldVertices(V,0,v,k,0,2);for(var H=0,W=k.length;H<W;H+=2)b=k[H],T=k[H+1],D=k[(H+2)%k.length],B=k[(H+3)%k.length],t.line(b,T,D,B)}}},sn.prototype.dispose=function(){},sn.LIGHT_GRAY=new ce.Color(192/255,192/255,192/255,1),sn.GREEN=new ce.Color(0,1,0,1),ue=sn,le.SkeletonDebugRenderer=ue,de=Se=Se||{},pe=de.webgl||(de.webgl={}),fe=function(t,e,n){this.vertices=t,this.numVertices=e,this.numFloats=n},rn.prototype.draw=function(t,e,n,i){void 0===n&&(n=-1),void 0===i&&(i=-1);var a=this.clipper,s=this.premultipliedAlpha,r=this.twoColorTint,o=null,h=this.temp,c=this.temp2,l=this.temp3,u=this.temp4,d=this.renderable,p=null,f=null,g=e.drawOrder,m=null,v=e.color,y=r?12:8,S=!1;-1==n&&(S=!0);for(var A=0,E=g.length;A<E;A++){var x=a.isClipping()?2:y,b=g[A];if(b.bone.active)if(0<=n&&n==b.data.index&&(S=!0),S){0<=i&&i==b.data.index&&(S=!1);var T=b.getAttachment(),w=null;if(T instanceof de.RegionAttachment){var M=T;d.vertices=this.vertices,d.numVertices=4,d.numFloats=x<<2,M.computeWorldVertices(b.bone,d.vertices,0,x),f=rn.QUAD_TRIANGLES,p=M.uvs,w=M.region.renderObject.texture,m=M.color}else{if(!(T instanceof de.MeshAttachment)){if(T instanceof de.ClippingAttachment){a.clipStart(b,T);continue}a.clipEndWithSlot(b);continue}var C=T;d.vertices=this.vertices,d.numVertices=C.worldVerticesLength>>1,d.numFloats=d.numVertices*x,d.numFloats>d.vertices.length&&(d.vertices=this.vertices=de.Utils.newFloatArray(d.numFloats)),C.computeWorldVertices(b,0,C.worldVerticesLength,d.vertices,0,x),f=C.triangles,w=C.region.renderObject.texture,p=C.uvs,m=C.color}if(null!=w){var P=b.color,I=this.tempColor;I.r=v.r*P.r*m.r,I.g=v.g*P.g*m.g,I.b=v.b*P.b*m.b,I.a=v.a*P.a*m.a,s&&(I.r*=I.a,I.g*=I.a,I.b*=I.a);var k=this.tempColor2;null==b.darkColor?k.set(0,0,0,1):(s?(k.r=b.darkColor.r*I.a,k.g=b.darkColor.g*I.a,k.b=b.darkColor.b*I.a):k.setFromColor(b.darkColor),k.a=s?1:0);var R=b.data.blendMode;if(R!=o&&(o=R,t.setBlendMode(pe.WebGLBlendModeConverter.getSourceGLBlendMode(o,s),pe.WebGLBlendModeConverter.getDestGLBlendMode(o))),a.isClipping()){a.clipTriangles(d.vertices,d.numFloats,f,f.length,p,I,k,r);var O=new Float32Array(a.clippedVertices),_=a.clippedTriangles;if(null!=this.vertexEffect){var D=this.vertexEffect,B=O;if(r)for(var L=0,F=O.length;L<F;L+=y)h.x=B[L],h.y=B[L+1],l.set(B[L+2],B[L+3],B[L+4],B[L+5]),c.x=B[L+6],c.y=B[L+7],u.set(B[L+8],B[L+9],B[L+10],B[L+11]),D.transform(h,c,l,u),B[L]=h.x,B[L+1]=h.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=c.x,B[L+7]=c.y,B[L+8]=u.r,B[L+9]=u.g,B[L+10]=u.b,B[L+11]=u.a;else{L=0;for(var N=O.length;L<N;L+=y)h.x=B[L],h.y=B[L+1],l.set(B[L+2],B[L+3],B[L+4],B[L+5]),c.x=B[L+6],c.y=B[L+7],u.set(0,0,0,0),D.transform(h,c,l,u),B[L]=h.x,B[L+1]=h.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=c.x,B[L+7]=c.y}}t.draw(w,O,_)}else{if(B=d.vertices,null!=this.vertexEffect)if(D=this.vertexEffect,r){L=0;for(var G=0,U=d.numFloats;L<U;L+=y,G+=2)h.x=B[L],h.y=B[L+1],c.x=p[G],c.y=p[G+1],l.setFromColor(I),u.setFromColor(k),D.transform(h,c,l,u),B[L]=h.x,B[L+1]=h.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=c.x,B[L+7]=c.y,B[L+8]=u.r,B[L+9]=u.g,B[L+10]=u.b,B[L+11]=u.a}else{L=0,G=0;for(var V=d.numFloats;L<V;L+=y,G+=2)h.x=B[L],h.y=B[L+1],c.x=p[G],c.y=p[G+1],l.setFromColor(I),u.set(0,0,0,0),D.transform(h,c,l,u),B[L]=h.x,B[L+1]=h.y,B[L+2]=l.r,B[L+3]=l.g,B[L+4]=l.b,B[L+5]=l.a,B[L+6]=c.x,B[L+7]=c.y}else if(r){L=2,G=0;for(var Y=d.numFloats;L<Y;L+=y,G+=2)B[L]=I.r,B[L+1]=I.g,B[L+2]=I.b,B[L+3]=I.a,B[L+4]=p[G],B[L+5]=p[G+1],B[L+6]=k.r,B[L+7]=k.g,B[L+8]=k.b,B[L+9]=k.a}else{L=2,G=0;for(var z=d.numFloats;L<z;L+=y,G+=2)B[L]=I.r,B[L+1]=I.g,B[L+2]=I.b,B[L+3]=I.a,B[L+4]=p[G],B[L+5]=p[G+1]}var H=d.vertices.subarray(0,d.numFloats);t.draw(w,H,f)}}a.clipEndWithSlot(b)}else a.clipEndWithSlot(b);else a.clipEndWithSlot(b)}a.clipEnd()},rn.QUAD_TRIANGLES=[0,1,2,2,3,0],ge=rn,pe.SkeletonRenderer=ge,me=Se=Se||{},ve=me.webgl||(me.webgl={}),on.prototype.setFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},on.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},on.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},on.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},on.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},on.prototype.normalize=function(){var t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this},on.prototype.cross=function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},on.prototype.multiply=function(t){var e=WI()(t);return this.set(this.x*e[ve.M00]+this.y*e[ve.M01]+this.z*e[ve.M02]+e[ve.M03],this.x*e[ve.M10]+this.y*e[ve.M11]+this.z*e[ve.M12]+e[ve.M13],this.x*e[ve.M20]+this.y*e[ve.M21]+this.z*e[ve.M22]+e[ve.M23])},on.prototype.project=function(t){var e=WI()(t),n=1/(this.x*e[ve.M30]+this.y*e[ve.M31]+this.z*e[ve.M32]+e[ve.M33]);return this.set((this.x*e[ve.M00]+this.y*e[ve.M01]+this.z*e[ve.M02]+e[ve.M03])*n,(this.x*e[ve.M10]+this.y*e[ve.M11]+this.z*e[ve.M12]+e[ve.M13])*n,(this.x*e[ve.M20]+this.y*e[ve.M21]+this.z*e[ve.M22]+e[ve.M23])*n)},on.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},on.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},on.prototype.distance=function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z;return Math.sqrt(e*e+n*n+i*i)},ye=on,ve.Vector3=ye,function(t){var e=(n.prototype.setupCanvas=function(t,e){var n=this;this.gl=t.getContext("webgl2",e)||t.getContext("webgl",e),(this.canvas=t).addEventListener("webglcontextlost",(function(t){t&&t.preventDefault()})),t.addEventListener("webglcontextrestored",(function(t){for(var e=0,i=n.restorables.length;e<i;e++)n.restorables[e].restore()}))},n.prototype.addRestorable=function(t){this.restorables.push(t)},n.prototype.removeRestorable=function(t){var e,n,i=g()(e=this.restorables).call(e,t);-1<i&&ar()(n=this.restorables).call(n,i,1)},n);function n(t,e){void 0===e&&(e={alpha:"true"}),this.restorables=new Array,t instanceof HTMLCanvasElement||t instanceof EventTarget?this.setupCanvas(t,e):(this.gl=t,this.canvas=this.gl.canvas)}t.ManagedWebGLRenderingContext=e;var i=(a.getDestGLBlendMode=function(t){switch(t){case Ae.BlendMode.Normal:return a.ONE_MINUS_SRC_ALPHA;case Ae.BlendMode.Additive:return a.ONE;case Ae.BlendMode.Multiply:case Ae.BlendMode.Screen:return a.ONE_MINUS_SRC_ALPHA;default:throw new Error("Unknown blend mode: "+t)}},a.getSourceGLBlendMode=function(t,e){switch(void 0===e&&(e=!1),t){case Ae.BlendMode.Normal:case Ae.BlendMode.Additive:return e?a.ONE:a.SRC_ALPHA;case Ae.BlendMode.Multiply:return a.DST_COLOR;case Ae.BlendMode.Screen:return a.ONE;default:throw new Error("Unknown blend mode: "+t)}},a.ZERO=0,a.ONE=1,a.SRC_COLOR=768,a.ONE_MINUS_SRC_COLOR=769,a.SRC_ALPHA=770,a.ONE_MINUS_SRC_ALPHA=771,a.DST_ALPHA=772,a.ONE_MINUS_DST_ALPHA=773,a.DST_COLOR=774,a);function a(){}t.WebGLBlendModeConverter=i}((Ae=Se=Se||{}).webgl||(Ae.webgl={})),t.exports=Se}).call(window)},function(t,e,n){var i=n(0),a=n(11),s=n(204),r=n(7),o=n(218),h=n(219),c=n(220),l=new i({Extends:h,initialize:function(t,e,n,i,s,l,u){var d,p,f,g=[],m=t.cacheManager.custom.spine;if(r(e)){var v=e;for(e=a(v,"key"),p=new o(t,{key:e,url:a(v,"jsonURL"),extension:a(v,"jsonExtension","json"),xhrSettings:a(v,"jsonXhrSettings")}),i=a(v,"atlasURL"),s=a(v,"preMultipliedAlpha"),Array.isArray(i)||(i=[i]),d=0;d<i.length;d++)(f=new c(t,{key:e+"!"+d,url:i[d],extension:a(v,"atlasExtension","atlas"),xhrSettings:a(v,"atlasXhrSettings")})).cache=m,g.push(f)}else for(p=new o(t,e,n,l),Array.isArray(i)||(i=[i]),d=0;d<i.length;d++)(f=new c(t,e+"!"+d,i[d],u)).cache=m,g.push(f);g.unshift(p),h.call(this,t,"spine",e,g),this.config.preMultipliedAlpha=s},onFileComplete:function(t){var e;if(-1!==g()(e=this.files).call(e,t)&&(this.pending--,"text"===t.type)){for(var n=t.data.split("\n"),i=[],r=0;r<n.length;r++){var o=n[r];""===Yp()(o).call(o)&&r<n.length-1&&(o=n[r+1],i.push(o))}var h=this.config,c=this.loader,l=c.baseURL,u=c.path,d=c.prefix,p=a(h,"baseURL",this.baseURL),f=a(h,"path",t.src.match(/^.*\//))[0],m=a(h,"prefix",this.prefix),v=a(h,"textureXhrSettings");c.setBaseURL(p),c.setPath(f),c.setPrefix(m);for(var y=0;y<i.length;y++){var S=i[y],A=new s(c,S,S,v);c.keyExists(A)||(this.addToMultiFile(A),c.addFile(A))}c.setBaseURL(l),c.setPath(u),c.setPrefix(d)}},addToCache:function(){if(this.isReadyToProcess()){var t;this.files[0].addToCache();for(var e="",n="",i=!!this.config.preMultipliedAlpha,a=this.loader.textureManager,s=1;s<this.files.length;s++){var r,o,h,c,l,u=this.files[s];"text"===u.type?(e=u.key.replace(/![\d]$/,""),t=u.cache,n=et()(n).call(n,u.data)):(c=g()(r=h=Yp()(o=u.key).call(o)).call(r,"!"),l=h.substr(c+1),a.exists(l)||a.addImage(l,u.data)),u.pendingDestroy()}t.add(e,{preMultipliedAlpha:i,data:n,prefix:this.prefix}),this.complete=!0}}});t.exports=l},function(t,e,n){var i=n(0),a=n(15),s=n(21),r=n(22),o=n(11),h=n(7),c=new i({Extends:s,initialize:function t(e,n,i,a,r){var c,l,u="png";h(n)&&(n=o(l=n,"key"),i=o(l,"url"),c=o(l,"normalMap"),a=o(l,"xhrSettings"),u=o(l,"extension",u),r=o(l,"frameConfig")),Array.isArray(i)&&(c=i[1],i=i[0]);var d,p={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:i,xhrSettings:a,config:r};s.call(this,e,p),c&&((d=new t(e,this.key,c,a,r)).type="normalMap",this.setLink(d),e.addFile(d))},onProcess:function(){this.state=a.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){s.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(t.data),t.onProcessError()},s.createObjectURL(this.data,this.xhrLoader.response,"image/png")},addToCache:function(){var t,e=this.linkFile;e&&e.state===a.FILE_COMPLETE?(t="image"===this.type?this.cache.addImage(this.key,this.data,e.data):this.cache.addImage(e.key,e.data,this.data),this.pendingDestroy(t),e.pendingDestroy(t)):e||(t=this.cache.addImage(this.key,this.data),this.pendingDestroy(t))}});r.register("image",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this})),t.exports=c},function(t,e,n){t.exports={ADD:n(206),COMPLETE:n(207),FILE_COMPLETE:n(208),FILE_KEY_COMPLETE:n(209),FILE_LOAD_ERROR:n(210),FILE_LOAD:n(211),FILE_PROGRESS:n(212),POST_PROCESS:n(213),PROGRESS:n(214),START:n(215)}},function(t,e){t.exports="addfile"},function(t,e){t.exports="complete"},function(t,e){t.exports="filecomplete"},function(t,e){t.exports="filecomplete-"},function(t,e){t.exports="loaderror"},function(t,e){t.exports="load"},function(t,e){t.exports="fileprogress"},function(t,e){t.exports="postprocess"},function(t,e){t.exports="progress"},function(t,e){t.exports="start"},function(t,e){t.exports=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}},function(t,e,n){var i=n(45);t.exports=function(t,e){var n=i(e,t.xhrSettings),a=new XMLHttpRequest;if(a.open("GET",t.src,n.async,n.user,n.password),a.responseType=t.xhrSettings.responseType,a.timeout=n.timeout,n.headers)for(var s in n.headers)a.setRequestHeader(s,n.headers[s]);return n.header&&n.headerValue&&a.setRequestHeader(n.header,n.headerValue),n.requestedWith&&a.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&a.overrideMimeType(n.overrideMimeType),n.withCredentials&&(a.withCredentials=!0),a.onload=t.onLoad.bind(t,a),a.onerror=t.onError.bind(t,a),a.onprogress=t.onProgress.bind(t),a.send(),a}},function(t,e,n){var i=n(0),a=n(15),s=n(21),r=n(22),o=n(11),h=n(10),c=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,r){var l,u="json";c(e)&&(e=o(l=e,"key"),n=o(l,"url"),i=o(l,"xhrSettings"),u=o(l,"extension",u),r=o(l,"dataKey",r));var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:e,url:n,xhrSettings:i,config:r};s.call(this,t,d),c(n)&&(this.data=r?h(n,r):n,this.state=a.FILE_POPULATED)},onProcess:function(){if(this.state!==a.FILE_POPULATED){this.state=a.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw this.onProcessError(),t}var e=this.config;this.data="string"==typeof e?h(t,e,t):t}this.onProcessComplete()}});r.register("json",(function(t,e,n,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)this.addFile(new l(this,t[a]));else this.addFile(new l(this,t,e,i,n));return this})),t.exports=l},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){var a=[];i.forEach((function(t){t&&a.push(t)})),this.loader=t,this.type=e,this.key=n,this.multiKeyIndex=t.multiKeyIndex++,this.files=a,this.complete=!1,this.pending=a.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var s=0;s<a.length;s++)a[s].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),(t.multiFile=this).pending++,this.complete=!1,this},onFileComplete:function(t){var e;-1!==g()(e=this.files).call(e,t)&&this.pending--},onFileFailed:function(t){var e;-1!==g()(e=this.files).call(e,t)&&this.failed++}});t.exports=i},function(t,e,n){var i=n(0),a=n(15),s=n(21),r=n(22),o=n(11),h=n(7),c=new i({Extends:s,initialize:function(t,e,n,i){var a,r="text",c="txt",l=t.cacheManager.text;h(e)&&(e=o(a=e,"key"),n=o(a,"url"),i=o(a,"xhrSettings"),c=o(a,"extension",c),r=o(a,"type",r),l=o(a,"cache",l));var u={type:r,cache:l,extension:c,responseType:"text",key:e,url:n,xhrSettings:i};s.call(this,t,u)},onProcess:function(){this.state=a.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});r.register("text",(function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this})),t.exports=c},function(t,e,n){var i=n(28),a=n(3),s=n(0),r=n(47),o=n(48),h=n(49),c=n(50),l=n(51),u=n(52),d=n(8),p=n(19),f=n(53),g=n(9),m=n(243),v=n(250),y=new s({Extends:f,Mixins:[r,o,h,c,l,u,v],initialize:function(t,e,n,i,a,s,r){f.call(this,t,"Spine"),this.plugin=e,this.skeleton=null,this.skeletonData=null,this.state=null,this.stateData=null,this.root=null,this.bounds=null,this.drawDebug=!1,this.timeScale=1,this.displayOriginX=0,this.displayOriginY=0,this.preMultipliedAlpha=!1,this.blendMode=-1,this.setPosition(n,i),a&&this.setSkeleton(a,s,r)},willRender:function(t,e){var n,i,a=!this.skeleton||!(15!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id);return e||a||!this.parentContainer||(i=(n=this.plugin).sceneRenderer,n.gl&&i.batcher.isDrawing&&(i.end(),n.renderer.pipelines.rebind())),a},setAlpha:function(t,e){var n;return void 0===t&&(t=1),e?(n=this.findSlot(e))&&(n.color.a=a(t,0,1)):this.alpha=t,this},alpha:{get:function(){return this.skeleton.color.a},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.a=e),0===e?this.renderFlags&=-3:this.renderFlags|=2}},red:{get:function(){return this.skeleton.color.r},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.r=e)}},green:{get:function(){return this.skeleton.color.g},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.g=e)}},blue:{get:function(){return this.skeleton.color.b},set:function(t){var e=a(t,0,1);this.skeleton&&(this.skeleton.color.b=e)}},setColor:function(t,e){void 0===t&&(t=16777215);var n,i=(t>>16&255)/255,a=(t>>8&255)/255,s=(255&t)/255,r=16777215<t?(t>>>24)/255:null,o=this.skeleton;return!e||(n=this.findSlot(e))&&(o=n),o.color.r=i,o.color.g=a,o.color.b=s,null!==r&&(o.color.a=r),this},setSkeletonFromJSON:function(t,e,n,i){return this.setSkeleton(t,e,n,i)},setSkeleton:function(t,e,n,i){this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications());var a=this.plugin.createSkeleton(t,i);this.skeletonData=a.skeletonData,this.preMultipliedAlpha=a.preMultipliedAlpha;var s=a.skeleton;return s.setSkin(),s.setToSetupPose(),this.skeleton=s,a=this.plugin.createAnimationState(s),this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications()),this.state=a.state,this.stateData=a.stateData,this.state.addListener({event:this.onEvent.bind(this),complete:this.onComplete.bind(this),start:this.onStart.bind(this),end:this.onEnd.bind(this),dispose:this.onDispose.bind(this),interrupted:this.onInterrupted.bind(this)}),e&&this.setAnimation(0,e,n),this.root=this.getRootBone(),this.root&&(this.root.rotation=g(d(this.rotation))+90),this.state.apply(s),s.updateCache(),this.updateSize()},onComplete:function(t){this.emit(m.COMPLETE,t)},onDispose:function(t){this.emit(m.DISPOSE,t)},onEnd:function(t){this.emit(m.END,t)},onEvent:function(t,e){this.emit(m.EVENT,t,e)},onInterrupted:function(t){this.emit(m.INTERRUPTED,t)},onStart:function(t){this.emit(m.START,t)},refresh:function(){return this.root&&(this.root.rotation=g(d(this.rotation))+90),this.updateSize(),this.skeleton.updateCache(),this},setSize:function(t,e,n,i){var a=this.skeleton;return void 0===t&&(t=a.data.width),void 0===e&&(e=a.data.height),void 0===n&&(n=0),void 0===i&&(i=0),this.width=t,this.height=e,this.displayOriginX=a.x-n,this.displayOriginY=a.y-i,this},setOffset:function(t,e){var n=this.skeleton;return void 0===t&&(t=0),void 0===e&&(e=0),this.displayOriginX=n.x-t,this.displayOriginY=n.y-e,this},updateSize:function(){var t=this.skeleton,e=this.plugin.renderer.height,n=this.scaleX,i=this.scaleY;t.x=this.x,t.y=e-this.y,t.scaleX=1,t.scaleY=1,t.updateWorldTransform();var a=this.getBounds();return this.width=a.size.x,this.height=a.size.y,this.displayOriginX=this.x-a.offset.x,this.displayOriginY=this.y-(e-(this.height+a.offset.y)),t.scaleX=n,t.scaleY=i,t.updateWorldTransform(),this},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,this.refresh()}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,this.refresh()}},getBoneList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.bones.length;n++)t.push(e.bones[n].name);return t},getSkinList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.skins.length;n++)t.push(e.skins[n].name);return t},getSlotList:function(){for(var t=[],e=this.skeleton,n=0;n<e.slots.length;n++)t.push(e.slots[n].data.name);return t},getAnimationList:function(){var t=[],e=this.skeletonData;if(e)for(var n=0;n<e.animations.length;n++)t.push(e.animations[n].name);return t},getCurrentAnimation:function(t){void 0===t&&(t=0);var e=this.state.getCurrent(t);if(e)return e.animation},play:function(t,e,n){return this.setAnimation(0,t,e,n),this},setAnimation:function(t,e,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),i&&this.state){var a=this.state.getCurrent(t);if(a&&a.animation.name===e&&!a.isComplete())return}if(this.findAnimation(e))return this.state.setAnimation(t,e,n)},addAnimation:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i=0),this.state.addAnimation(t,e,n,i)},setEmptyAnimation:function(t,e){return this.state.setEmptyAnimation(t,e)},clearTrack:function(t){return this.state.clearTrack(t),this},clearTracks:function(){return this.state.clearTracks(),this},setSkinByName:function(t){var e=this.skeleton;return e.setSkinByName(t),e.setSlotsToSetupPose(),this.state.apply(e),this},setSkin:function(t){var e=this.skeleton;return e.setSkin(t),e.setSlotsToSetupPose(),this.state.apply(e),this},setMix:function(t,e,n){return this.stateData.setMix(t,e,n),this},getAttachment:function(t,e){return this.skeleton.getAttachment(t,e)},getAttachmentByName:function(t,e){return this.skeleton.getAttachmentByName(t,e)},setAttachment:function(t,e){if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length)for(var n=0;n<t.length;n++)this.skeleton.setAttachment(t[n],e[n]);else this.skeleton.setAttachment(t,e);return this},setToSetupPose:function(){return this.skeleton.setToSetupPose(),this},setSlotsToSetupPose:function(){return this.skeleton.setSlotsToSetupPose(),this},setBonesToSetupPose:function(){return this.skeleton.setBonesToSetupPose(),this},getRootBone:function(){return this.skeleton.getRootBone()},angleBoneToXY:function(t,e,n,s,r,o){void 0===s&&(s=0),void 0===r&&(r=0),void 0===o&&(o=360);var h=this.plugin.renderer.height,c=d(i(t.worldX,h-t.worldY,e,n)+p(s));return t.rotation=a(g(c),r,o),this},findBone:function(t){return this.skeleton.findBone(t)},findBoneIndex:function(t){return this.skeleton.findBoneIndex(t)},findSlot:function(t){return this.skeleton.findSlot(t)},findSlotIndex:function(t){return this.skeleton.findSlotIndex(t)},findSkin:function(t){return this.skeletonData.findSkin(t)},findEvent:function(t){return this.skeletonData.findEvent(t)},findAnimation:function(t){return this.skeletonData.findAnimation(t)},findIkConstraint:function(t){return this.skeletonData.findIkConstraint(t)},findTransformConstraint:function(t){return this.skeletonData.findTransformConstraint(t)},findPathConstraint:function(t){return this.skeletonData.findPathConstraint(t)},findPathConstraintIndex:function(t){return this.skeletonData.findPathConstraintIndex(t)},getBounds:function(){return this.plugin.getBounds(this.skeleton)},preUpdate:function(t,e){var n=this.skeleton;this.state.update(e/1e3*this.timeScale),this.state.apply(n)},preDestroy:function(){this.state&&(this.state.clearListeners(),this.state.clearListenerNotifications()),this.plugin=null,this.skeleton=null,this.skeletonData=null,this.state=null,this.stateData=null}});t.exports=y},function(t,e,n){var i=n(0),a=n(223),s=new i({initialize:function(t,e){this.parent=t,(this.events=e)||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(a.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var n=[],i=0;i<t.length;i++)n.push(e[t[i]]);return n}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var n in this.list)this.list.hasOwnProperty(n)&&n.match(t)&&(e[n]=this.list[n]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var n in t)this.setValue(n,t[n]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var n=this.get(t);return void 0===n&&(n=0),this.set(t,n+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,e){return this._frozen||(this.has(t)?WI()(this)[t]=e:(i=(n=this).list,s=this.events,r=this.parent,wI()(WI()(this),t,{enumerable:!0,configurable:!0,get:function(){return i[t]},set:function(e){var o;n._frozen||(o=i[t],i[t]=e,s.emit(a.CHANGE_DATA,r,t,e,o),s.emit(a.CHANGE_DATA_KEY+t,r,e,o))}}),i[t]=e,s.emit(a.SET_DATA,r,t,e))),this;var n,i,s,r},each:function(t,e){for(var n=[this.parent,null,void 0],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var a in this.list)n[1]=a,n[2]=this.list[a],t.apply(e,n);return this},merge:function(t,e){for(var n in void 0===e&&(e=!0),t)t.hasOwnProperty(n)&&(e||!e&&!this.has(n))&&this.setValue(n,t[n]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){var e;return this.has(t)&&(e=this.list[t],delete this.list[t],delete WI()(this)[t],this.events.emit(a.REMOVE_DATA,this.parent,t,e)),this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete WI()(this)[t],this.events.emit(a.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete WI()(this)[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(a.CHANGE_DATA),this.events.off(a.SET_DATA),this.events.off(a.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});t.exports=s},function(t,e,n){t.exports={CHANGE_DATA:n(224),CHANGE_DATA_KEY:n(225),DESTROY:n(226),REMOVE_DATA:n(227),SET_DATA:n(228)}},function(t,e){t.exports="changedata"},function(t,e){t.exports="changedata-"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedata"},function(t,e){t.exports="setdata"},function(t,e,n){var i=Object.prototype.hasOwnProperty,a="~";function s(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function h(t,e,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var r=new o(n,i||t,s),h=a?a+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],r]:t._events[h].push(r):(t._events[h]=r,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function l(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(a=!1)),l.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(a?r()(e).call(e,1):e);return KI()?et()(n).call(n,KI()(t)):n},l.prototype.listeners=function(t){var e=a?a+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,r=new Array(s);i<s;i++)r[i]=n[i].fn;return r},l.prototype.listenerCount=function(t){var e=a?a+t:t,n=this._events[e];return n?n.fn?1:n.length:0},l.prototype.emit=function(t,e,n,i,s,r){var o=a?a+t:t;if(!this._events[o])return!1;var h,c=this._events[o],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,s),!0;case 6:return c.fn.call(c.context,e,n,i,s,r),!0}for(p=1,h=new Array(l-1);p<l;p++)h[p-1]=arguments[p];c.fn.apply(c.context,h)}else for(var u,d=c.length,p=0;p<d;p++)switch(c[p].once&&this.removeListener(t,c[p].fn,void 0,!0),l){case 1:c[p].fn.call(c[p].context);break;case 2:c[p].fn.call(c[p].context,e);break;case 3:c[p].fn.call(c[p].context,e,n);break;case 4:c[p].fn.call(c[p].context,e,n,i);break;default:if(!h)for(u=1,h=new Array(l-1);u<l;u++)h[u-1]=arguments[u];c[p].fn.apply(c[p].context,h)}return!0},l.prototype.on=function(t,e,n){return h(this,t,e,n,!1)},l.prototype.once=function(t,e,n){return h(this,t,e,n,!0)},l.prototype.removeListener=function(t,e,n,i){var s=a?a+t:t;if(!this._events[s])return this;if(!e)return c(this,s),this;var r=this._events[s];if(r.fn)r.fn!==e||i&&!r.once||n&&r.context!==n||c(this,s);else{for(var o=0,h=[],l=r.length;o<l;o++)(r[o].fn!==e||i&&!r[o].once||n&&r[o].context!==n)&&h.push(r[o]);h.length?this._events[s]=1===h.length?h[0]:h:c(this,s)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&c(this,e)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=a,l.EventEmitter=l,t.exports=l},function(t,e){t.exports="addedtoscene"},function(t,e){t.exports="destroy"},function(t,e){t.exports="removedfromscene"},function(t,e){t.exports="complete"},function(t,e){t.exports="created"},function(t,e){t.exports="error"},function(t,e){t.exports="loop"},function(t,e){t.exports="play"},function(t,e){t.exports="seeked"},function(t,e){t.exports="seeking"},function(t,e){t.exports="stop"},function(t,e){t.exports="timeout"},function(t,e){t.exports="unlocked"},function(t,e,n){t.exports={COMPLETE:n(244),DISPOSE:n(245),END:n(246),EVENT:n(247),INTERRUPTED:n(248),START:n(249)}},function(t,e){t.exports="complete"},function(t,e){t.exports="dispose"},function(t,e){t.exports="end"},function(t,e){t.exports="event"},function(t,e){t.exports="interrupted"},function(t,e){t.exports="start"},function(t,e,n){var i=n(1),a=n(1),s=n(1);i=n(251),s=n(252),a=n(253);t.exports={renderWebGL:i,renderCanvas:a,renderDirect:s}},function(t,e,n){var i=n(3),a=n(8),s=n(56),r=n(9),o=n(6);t.exports=function(t,e,n,h,c){var l=e.plugin,u=e.skeleton,d=l.sceneRenderer;t.newType&&(t.pipelines.clear(),d.begin());var p=e.scrollFactorX,f=e.scrollFactorY,g=u.color.a;c&&(e.scrollFactorX=c.scrollFactorX,e.scrollFactorY=c.scrollFactorY,u.color.a=i(g*c.alpha,0,1)),n.addToRenderList(e);var m,v,y=s(e,n,h).calc,S=t.height;u.x=y.tx,u.y=S-y.ty,u.scaleX=y.scaleX,u.scaleY=y.scaleY,e.scaleX<0?(u.scaleX*=-1,e.root.rotation=o(r(y.rotationNormalized)-180,0,360)):e.root.rotation=o(r(a(y.rotationNormalized))+90,0,360),e.scaleY<0&&(u.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*r(y.rotationNormalized):e.root.rotation+=2*r(y.rotationNormalized)),u.updateWorldTransform(),d.drawSkeleton(u,e.preMultipliedAlpha),c&&(e.scrollFactorX=p,e.scrollFactorY=f,u.color.a=g),(l.drawDebug||e.drawDebug)&&(m=u.x,v=u.y,u.x=0,u.y=0,d.drawSkeletonDebug(u,e.preMultipliedAlpha),u.x=m,u.y=v),t.nextTypeMatch||(d.end(),t.pipelines.rebind())}},function(t,e,n){var i=n(3),a=n(8),s=n(56),r=n(9),o=n(6);t.exports=function(t,e,n,h,c){var l=e.plugin,u=e.skeleton,d=l.sceneRenderer;t.pipelines.clear(),d.begin();var p=e.scrollFactorX,f=e.scrollFactorY,g=u.color.a;c&&(e.scrollFactorX=c.scrollFactorX,e.scrollFactorY=c.scrollFactorY,u.color.a=i(g*c.alpha,0,1)),n.addToRenderList(e);var m,v,y=s(e,n,h).calc,S=t.height;u.x=y.tx,u.y=S-y.ty,u.scaleX=y.scaleX,u.scaleY=y.scaleY,e.scaleX<0?(u.scaleX*=-1,e.root.rotation=o(r(y.rotationNormalized)-180,0,360)):e.root.rotation=o(r(a(y.rotationNormalized))+90,0,360),e.scaleY<0&&(u.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*r(y.rotationNormalized):e.root.rotation+=2*r(y.rotationNormalized)),u.updateWorldTransform(),d.drawSkeleton(u,e.preMultipliedAlpha),c&&(e.scrollFactorX=p,e.scrollFactorY=f,u.color.a=g),(l.drawDebug||e.drawDebug)&&(m=u.x,v=u.y,u.x=0,u.y=0,d.drawSkeletonDebug(u,e.preMultipliedAlpha),u.x=m,u.y=v),d.end(),t.pipelines.rebind()}},function(t,e,n){var i=n(8),a=n(9),s=n(6);t.exports=function(t,e,n,r){var o=t.currentContext,h=e.plugin,c=e.skeleton,l=h.skeletonRenderer,u=t._tempMatrix1,d=t._tempMatrix2,p=t._tempMatrix3;n.addToRenderList(e),d.applyITRS(e.x,e.y,e.rotation,Math.abs(e.scaleX),Math.abs(e.scaleY)),u.copyFrom(n.matrix),r?(u.multiplyWithOffset(r,-n.scrollX*e.scrollFactorX,-n.scrollY*e.scrollFactorY),d.e=e.x,d.f=e.y):(d.e-=n.scrollX*e.scrollFactorX,d.f-=n.scrollY*e.scrollFactorY),u.multiply(d,p),c.x=p.tx,c.y=p.ty,c.scaleX=p.scaleX,c.scaleY=-1*p.scaleY,e.scaleX<0?(c.scaleX*=-1,e.root.rotation=a(p.rotationNormalized)):e.root.rotation=s(a(i(p.rotationNormalized))+90,0,360),e.scaleY<0&&(c.scaleY*=-1,e.scaleX<0?e.root.rotation-=2*a(p.rotationNormalized):e.root.rotation+=2*a(p.rotationNormalized)),n.renderToTexture&&(c.y=p.ty,c.scaleY*=-1),c.updateWorldTransform(),l.ctx=o,l.debugRendering=h.drawDebug||e.drawDebug,o.save(),l.draw(c),o.restore()}},function(t,e,n){var i=n(0),a=n(255),s=n(347),r=new i({Extends:a,Mixins:[s],initialize:function(t,e,n,i,s){a.call(this,t,n,i,s),this.type="Spine",this.plugin=e},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[],this._displayList=null,this.plugin=null}});t.exports=r},function(t,e,n){var i=n(256),a=n(17),s=n(0),o=n(293),h=n(55),c=n(53),l=n(25),u=n(343),d=n(346),p=n(2),f=new s({Extends:c,Mixins:[o.AlphaSingle,o.BlendMode,o.ComputedSize,o.Depth,o.Mask,o.Pipeline,o.Transform,o.Visible,u],initialize:function(t,e,n,i){c.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new o.TransformMatrix,this.tempTransformMatrix=new o.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPipeline(),this.setPosition(e,n),this.clearAlpha(),this.setBlendMode(a.SKIP_CHECK),i&&this.add(i)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){var e;if(void 0===t&&(t=new l),t.setTo(this.x,this.y,0,0),this.parentContainer&&(e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y),t.setTo(e.x,e.y,0,0)),0<this.list.length){var n=this.list,i=new l,a=!1;t.setEmpty();for(var s=0;s<n.length;s++){var r=n[s];r.getBounds&&(r.getBounds(i),a?d(i,t,t):(t.setTo(i.x,i.y,i.width,i.height),a=!0))}}return t},addHandler:function(t){t.once(h.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.removeFromDisplayList(),t.parentContainer=this)},removeHandler:function(t){t.off(h.DESTROY,this.remove),this.exclusive&&(t.parentContainer=null,t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new p),this.parentContainer?this.parentContainer.pointToContainer(t,e):e=new p(t.x,t.y);var n=this.tempTransformMatrix;return n.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),n.invert(),n.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(t){return i.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return i.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){var e;return g()(e=this.list).call(e,t)},sort:function(t,e){return t&&(void 0===e&&(e=function(e,n){return e[t]-n[t]}),i.StableSort(this.list,e)),this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,a){return i.GetFirst(this.list,t,e,n,a)},getAll:function(t,e,n,a){return i.GetAll(this.list,t,e,n,a)},count:function(t,e,n,a){return i.CountAllMatching(this.list,t,e,n,a)},swap:function(t,e){return i.Swap(this.list,t,e),this},moveTo:function(t,e){return i.MoveTo(this.list,t,e),this},remove:function(t,e){var n=i.Remove(this.list,t,this.removeHandler,this);if(e&&n){Array.isArray(n)||(n=[n]);for(var a=0;a<n.length;a++)n[a].destroy()}return this},removeAt:function(t,e){var n=i.RemoveAt(this.list,t,this.removeHandler,this);return e&&n&&n.destroy(),this},removeBetween:function(t,e,n){var a=i.RemoveBetween(this.list,t,e,this.removeHandler,this);if(n)for(var s=0;s<a.length;s++)a[s].destroy();return this},removeAll:function(t){var e=i.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(t)for(var n=0;n<e.length;n++)e[n].destroy();return this},bringToTop:function(t){return i.BringToTop(this.list,t),this},sendToBack:function(t){return i.SendToBack(this.list,t),this},moveUp:function(t){return i.MoveUp(this.list,t),this},moveDown:function(t){return i.MoveDown(this.list,t),this},reverse:function(){var t;return BI()(t=this.list).call(t),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e,n){return i.Replace(this.list,t,e)&&(this.addHandler(e),this.removeHandler(t),n&&t.destroy()),this},exists:function(t){var e;return-1<g()(e=this.list).call(e,t)},setAll:function(t,e,n,a){return i.SetAll(this.list,t,e,n,a),this},each:function(t,e){for(var n=[null],i=r()(o=this.list).call(o),a=i.length,s=2;s<arguments.length;s++){var o;n.push(arguments[s])}for(s=0;s<a;s++)n[0]=i[s],t.apply(e,n);return this},iterate:function(t,e){for(var n=[null],i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n);return this},setScrollFactor:function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=!1),this.scrollFactorX=t,this.scrollFactorY=e,n&&(i.SetAll(this.list,"scrollFactorX",t),i.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return(this.position=0)<this.list.length?this.list[0]:null}},last:{get:function(){return 0<this.list.length?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return 0<this.position?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[]}});t.exports=f},function(t,e,n){t.exports={Matrix:n(257),Add:n(266),AddAt:n(267),BringToTop:n(268),CountAllMatching:n(269),Each:n(270),EachInRange:n(271),FindClosestInSorted:n(272),GetAll:n(273),GetFirst:n(274),GetRandom:n(275),MoveDown:n(276),MoveTo:n(277),MoveUp:n(278),NumberArray:n(279),NumberArrayStep:n(280),QuickSelect:n(281),Range:n(282),Remove:n(283),RemoveAt:n(284),RemoveBetween:n(285),RemoveRandomElement:n(286),Replace:n(287),RotateLeft:n(58),RotateRight:n(59),SafeRange:n(5),SendToBack:n(288),SetAll:n(289),Shuffle:n(60),SortByDigits:n(290),SpliceOne:n(12),StableSort:n(291),Swap:n(292)}},function(t,e,n){t.exports={CheckMatrix:n(24),MatrixToString:n(258),ReverseColumns:n(260),ReverseRows:n(261),Rotate180:n(262),RotateLeft:n(263),RotateMatrix:n(16),RotateRight:n(264),Translate:n(265),TransposeMatrix:n(57)}},function(t,e,n){var i=n(259),a=n(24);t.exports=function(t){var e="";if(!a(t))return e;for(var n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++){var r=t[n][s].toString();e+="undefined"!==r?i(r,2):"?",s<t[n].length-1&&(e+=" |")}if(n<t.length-1){e+="\n";for(var o=0;o<t[n].length;o++)e+="---",o<t[n].length-1&&(e+="+");e+="\n"}}return e}},function(t,e){t.exports=function(t,e,n,i){var a;if(void 0===e&&(e=0),void 0===n&&(n=" "),void 0===i&&(i=3),e+1>=(t=t.toString()).length)switch(i){case 1:t=new Array(e+1-t.length).join(n)+t;break;case 3:var s=Math.ceil((a=e-t.length)/2);t=new Array(a-s+1).join(n)+t+new Array(s+1).join(n);break;default:t+=new Array(e+1-t.length).join(n)}return t}},function(t,e){t.exports=function(t){return BI()(t).call(t)}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++){var n;BI()(n=t[e]).call(n)}return t}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,180)}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,90)}},function(t,e,n){var i=n(16);t.exports=function(t){return i(t,-90)}},function(t,e,n){var i=n(58),a=n(59);t.exports=function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=0),0!==n&&(n<0?i(t,Math.abs(n)):a(t,n)),0!==e)for(var s=0;s<t.length;s++){var r=t[s];e<0?i(r,Math.abs(e)):a(r,e)}return t}},function(t,e){t.exports=function(t,e,n,i,a){if(void 0===a&&(a=t),0<n){var s=n-t.length;if(s<=0)return null}if(!Array.isArray(e))return-1===g()(t).call(t,e)?(t.push(e),i&&i.call(a,e),e):null;for(var r=e.length-1;0<=r;)-1!==g()(t).call(t,e[r])&&ar()(e).call(e,r,1),r--;if(0===(r=e.length))return null;0<n&&s<r&&(ar()(e).call(e,s),r=s);for(var o=0;o<r;o++){var h=e[o];t.push(h),i&&i.call(a,h)}return e}},function(t,e){t.exports=function(t,e,n,i,a,s){if(void 0===n&&(n=0),void 0===s&&(s=t),0<i){var r=i-t.length;if(r<=0)return null}if(!Array.isArray(e))return-1===g()(t).call(t,e)?(ar()(t).call(t,n,0,e),a&&a.call(s,e),e):null;for(var o=e.length-1;0<=o;)-1!==g()(t).call(t,e[o])&&e.pop(),o--;if(0===(o=e.length))return null;0<i&&r<o&&(ar()(e).call(e,r),o=r);for(var h=o-1;0<=h;h--){var c=e[h];ar()(t).call(t,n,0,c),a&&a.call(s,c)}return e}},function(t,e){t.exports=function(t,e){var n=g()(t).call(t,e);return-1!==n&&n<t.length&&(ar()(t).call(t,n,1),t.push(e)),e}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){void 0===a&&(a=0),void 0===s&&(s=t.length);var r=0;if(i(t,a,s))for(var o=a;o<s;o++)t[o][e]===n&&r++;return r}},function(t,e){t.exports=function(t,e,n){for(var i=[null],a=3;a<arguments.length;a++)i.push(arguments[a]);for(a=0;a<t.length;a++)i[0]=t[a],e.apply(n,i);return t}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===a&&(a=0),void 0===s&&(s=t.length),i(t,a,s)){for(var r=[null],o=5;o<arguments.length;o++)r.push(arguments[o]);for(o=a;o<s;o++)r[0]=t[o],e.apply(n,r)}return t}},function(t,e){t.exports=function(t,e,n){if(!e.length)return NaN;if(1===e.length)return e[0];var i,a,s=1;if(n){if(t<e[0][n])return e[0];for(;e[s][n]<t;)s++}else for(;e[s]<t;)s++;return s>e.length&&(s=e.length),n?(i=e[s-1][n],(a=e[s][n])-t<=t-i?e[s]:e[s-1]):(i=e[s-1],(a=e[s])-t<=t-i?a:i)}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){void 0===a&&(a=0),void 0===s&&(s=t.length);var r=[];if(i(t,a,s))for(var o=a;o<s;o++){var h=t[o];(!e||e&&void 0===n&&h.hasOwnProperty(e)||e&&void 0!==n&&h[e]===n)&&r.push(h)}return r}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===a&&(a=0),void 0===s&&(s=t.length),i(t,a,s))for(var r=a;r<s;r++){var o=t[r];if(!e||e&&void 0===n&&o.hasOwnProperty(e)||e&&void 0!==n&&o[e]===n)return o}return null}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i=e+Math.floor(Math.random()*n);return void 0===t[i]?null:t[i]}},function(t,e){t.exports=function(t,e){var n,i,a=g()(t).call(t,e);return 0<a&&(n=t[a-1],i=g()(t).call(t,n),t[a]=n,t[i]=e),t}},function(t,e){t.exports=function(t,e,n){var i=g()(t).call(t,e);if(-1===i||n<0||n>=t.length)throw new Error("Supplied index out of bounds");return i!==n&&(ar()(t).call(t,i,1),ar()(t).call(t,n,0,e)),e}},function(t,e){t.exports=function(t,e){var n,i,a=g()(t).call(t,e);return-1!==a&&a<t.length-1&&(n=t[a+1],i=g()(t).call(t,n),t[a]=n,t[i]=e),t}},function(t,e){t.exports=function(t,e,n,i){var a,s=[],r=!1;if((n||i)&&(r=!0,n=n||"",i=i||""),e<t)for(a=t;e<=a;a--)r?s.push(n+a.toString()+i):s.push(a);else for(a=t;a<=e;a++)r?s.push(n+a.toString()+i):s.push(a);return s}},function(t,e,n){var i=n(40);t.exports=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=1),null===e&&(e=t,t=0);for(var a=[],s=Math.max(i((e-t)/(n||1)),0),r=0;r<s;r++)a.push(t),t+=n;return a}},function(t,e){function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:e<t?1:0}t.exports=function t(e,a,s,r,o){for(void 0===s&&(s=0),void 0===r&&(r=e.length-1),void 0===o&&(o=i);s<r;){var h,c,l,u,d;600<r-s&&(h=r-s+1,c=a-s+1,l=Math.log(h),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(h-u)/h)*(c-h/2<0?-1:1),t(e,a,Math.max(s,Math.floor(a-c*u/h+d)),Math.min(r,Math.floor(a+(h-c)*u/h+d)),o));var p=e[a],f=s,g=r;for(n(e,s,a),0<o(e[r],p)&&n(e,s,r);f<g;){for(n(e,f,g),f++,g--;o(e[f],p)<0;)f++;for(;0<o(e[g],p);)g--}0===o(e[s],p)?n(e,s,g):n(e,++g,r),g<=a&&(s=g+1),a<=g&&(r=g-1)}}},function(t,e,n){var i=n(10),a=n(60);t.exports=function(t,e,n){var s,r=i(n,"max",0),o=i(n,"qty",1),h=i(n,"random",!1),c=i(n,"randomB",!1),l=i(n,"repeat",0),u=i(n,"yoyo",!1),d=[];c&&a(e),-1===l&&(l=0===r?0:(s=t.length*e.length*o,u&&(s*=2),Math.ceil(r/s)));for(var p=0;p<=l;p++){var f=function(t,e,n){for(var i=[],a=0;a<t.length;a++)for(var s=0;s<e.length;s++)for(var r=0;r<n;r++)i.push({a:t[a],b:e[s]});return i}(t,e,o);h&&a(f),d=et()(d).call(d,f),u&&(BI()(f).call(f),d=et()(d).call(d,f))}return r&&ar()(d).call(d,r),d}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,a){if(void 0===a&&(a=t),!Array.isArray(e))return-1!==(o=g()(t).call(t,e))?(i(t,o),n&&n.call(a,e),e):null;for(var s=e.length-1,r=[];0<=s;){var o,h=e[s];-1!==(o=g()(t).call(t,h))&&(i(t,o),r.push(h),n&&n.call(a,h)),s--}return r}},function(t,e,n){var i=n(12);t.exports=function(t,e,n,a){if(void 0===a&&(a=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var s=i(t,e);return n&&n.call(a,s),s}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===s&&(s=t),i(t,e,n)){var r=n-e,o=ar()(t).call(t,e,r);if(a)for(var h=0;h<o.length;h++){var c=o[h];a.call(s,c)}return o}return[]}},function(t,e,n){var i=n(12);t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var a=e+Math.floor(Math.random()*n);return i(t,a)}},function(t,e){t.exports=function(t,e,n){var i=g()(t).call(t,e),a=g()(t).call(t,n);return-1!==i&&-1===a&&(t[i]=n,!0)}},function(t,e){t.exports=function(t,e){var n=g()(t).call(t,e);return-1!==n&&0<n&&(ar()(t).call(t,n,1),t.unshift(e)),e}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,a,s){if(void 0===a&&(a=0),void 0===s&&(s=t.length),i(t,a,s))for(var r=a;r<s;r++){var o=t[r];o.hasOwnProperty(e)&&(o[e]=n)}return t}},function(t,e){t.exports=function(t){var e=/\D/g;return Ba()(t).call(t,(function(t,n){return Hx()(t.replace(e,""),10)-Hx()(n.replace(e,""),10)})),t}},function(t,e){function n(t,e){return String(t).localeCompare(e)}function i(t,e,n,i){for(var a,s,r,o,h=t.length,c=0,l=2*n,u=0;u<h;u+=l)for(s=(a=u+n)+n,h<a&&(a=h),h<s&&(s=h),r=u,o=a;;)if(r<a&&o<s)e(t[r],t[o])<=0?i[c++]=t[r++]:i[c++]=t[o++];else if(r<a)i[c++]=t[r++];else{if(!(o<s))break;i[c++]=t[o++]}}t.exports=function(t,e){void 0===e&&(e=n);var a=function(t,e){var n=t.length;if(n<=1)return t;for(var a=new Array(n),s=1;s<n;s*=2){i(t,e,s,a);var r=t;t=a,a=r}return t}(t,e);return a!==t&&i(a,null,t.length,t),t}},function(t,e){t.exports=function(t,e,n){if(e!==n){var i=g()(t).call(t,e),a=g()(t).call(t,n);if(i<0||a<0)throw new Error("Supplied items must be elements of the same array");return t[i]=n,t[a]=e,t}}},function(t,e,n){t.exports={Alpha:n(294),AlphaSingle:n(295),BlendMode:n(296),ComputedSize:n(47),Crop:n(297),Depth:n(48),Flip:n(49),GetBounds:n(298),Mask:n(307),Origin:n(332),PathFollower:n(333),Pipeline:n(336),ScrollFactor:n(50),Size:n(339),Texture:n(340),TextureCrop:n(341),Tint:n(342),ToJSON:n(54),Transform:n(51),TransformMatrix:n(23),Visible:n(52)}},function(t,e,n){var i=n(3),a={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,n,a){return void 0===t&&(t=1),void 0===e?this.alpha=t:(this._alphaTL=i(t,0,1),this._alphaTR=i(e,0,1),this._alphaBL=i(n,0,1),this._alphaBR=i(a,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,0===(this._alphaBR=e)?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=i(t,0,1);0!==(this._alphaTL=e)&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=i(t,0,1);0!==(this._alphaTR=e)&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=i(t,0,1);0!==(this._alphaBL=e)&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=i(t,0,1);0!==(this._alphaBR=e)&&(this.renderFlags|=2)}}};t.exports=a},function(t,e,n){var i=n(3),a={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);0===(this._alpha=e)?this.renderFlags&=-3:this.renderFlags|=2}}};t.exports=a},function(t,e,n){var i=n(17),a={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){"string"==typeof t&&(t=i[t]),-1<=(t|=0)&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};t.exports=a},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e,n){var i=n(25),a=n(39),s=n(2),r={prepareBoundsOutput:function(t,e){return void 0===e&&(e=!1),0!==this.rotation&&a(t,this.x,this.y,this.rotation),e&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t){return void 0===t&&(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,t},getTopLeft:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return(t=t||new s).x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){var e,n,a,s,r,o,h,c,l;return void 0===t&&(t=new i),this.parentContainer?(l=this.parentContainer.getBoundsTransformMatrix(),this.getTopLeft(t),l.transformPoint(t.x,t.y,t),e=t.x,n=t.y,this.getTopRight(t),l.transformPoint(t.x,t.y,t),a=t.x,s=t.y,this.getBottomLeft(t),l.transformPoint(t.x,t.y,t),r=t.x,o=t.y,this.getBottomRight(t),l.transformPoint(t.x,t.y,t)):(this.getTopLeft(t),e=t.x,n=t.y,this.getTopRight(t),a=t.x,s=t.y,this.getBottomLeft(t),r=t.x,o=t.y,this.getBottomRight(t)),h=t.x,c=t.y,t.x=Math.min(e,a,r,h),t.y=Math.min(n,s,o,c),t.width=Math.max(e,a,r,h)-t.x,t.height=Math.max(n,s,o,c)-t.y,t}};t.exports=r},function(t,e){t.exports=function(t,e,n){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}},function(t,e,n){var i=n(61),a=n(62);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&0<n&&(e=a(t)/n);for(var r=0;r<e;r++){var o=r/e;s.push(i(t,o))}return s}},function(t,e,n){var i=n(0),a=n(302),s=n(303),r=n(26),o=n(305),h=n(2),c=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=r.LINE,this.x1=t,this.y1=e,this.x2=n,this.y2=i},getPoint:function(t,e){return a(this,t,e)},getPoints:function(t,e,n){return s(this,t,e,n)},getRandomPoint:function(t){return o(this,t)},setTo:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this},getPointA:function(t){return void 0===t&&(t=new h),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new h),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});t.exports=c},function(t,e,n){var i=n(13);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}},function(t,e,n){var i=n(304),a=n(13);t.exports=function(t,e,n,s){void 0===s&&(s=[]),!e&&0<n&&(e=i(t)/n);for(var r=t.x1,o=t.y1,h=t.x2,c=t.y2,l=0;l<e;l++){var u=l/e,d=r+(h-r)*u,p=o+(c-o)*u;s.push(new a(d,p))}return s}},function(t,e){t.exports=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}},function(t,e,n){var i=n(13);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}},function(t,e,n){var i=n(13);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e}},function(t,e,n){var i=n(308),a=n(331),s={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t){return void 0===t&&(this.texture||this.shader)&&(t=this),new i(this.scene,t)},createGeometryMask:function(t){return void 0===t&&"Graphics"===this.type&&(t=this),new a(this.scene,t)}};t.exports=s},function(t,e,n){var i=n(0),a=n(309),s=n(326),r=new i({initialize:function(t,e){var n=t.sys.renderer;this.renderer=n,this.bitmapMask=e,this.maskTexture=null,this.mainTexture=null,this.dirty=!0,this.mainFramebuffer=null,this.maskFramebuffer=null,this.invertAlpha=!1,this.isStencil=!1,this.createMask(),t.sys.game.events.on(a.CONTEXT_RESTORED,this.createMask,this),n&&n.on(s.RESIZE,this.createMask,this)},createMask:function(){var t,e,n,i,a,s,r=this.renderer;r&&r.gl&&(this.mainTexture&&this.clearMask(),t=r.width,e=r.height,n=0==(t&t-1)&&0==(e&e-1),i=r.gl,a=n?i.REPEAT:i.CLAMP_TO_EDGE,s=i.LINEAR,this.mainTexture=r.createTexture2D(0,s,s,a,a,i.RGBA,null,t,e),this.maskTexture=r.createTexture2D(0,s,s,a,a,i.RGBA,null,t,e),this.mainFramebuffer=r.createFramebuffer(t,e,this.mainTexture,!0),this.maskFramebuffer=r.createFramebuffer(t,e,this.maskTexture,!0))},clearMask:function(){var t=this.renderer;t&&t.gl&&this.mainTexture&&(t.deleteTexture(this.mainTexture),t.deleteTexture(this.maskTexture),t.deleteFramebuffer(this.mainFramebuffer),t.deleteFramebuffer(this.maskFramebuffer),this.mainTexture=null,this.maskTexture=null,this.mainFramebuffer=null,this.maskFramebuffer=null)},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,n){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,n)},postRenderWebGL:function(t,e){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.clearMask(),this.renderer&&this.renderer.off(s.RESIZE,this.createMask,this),this.bitmapMask=null,this.prevFramebuffer=null,this.renderer=null}});t.exports=r},function(t,e,n){t.exports={BLUR:n(310),BOOT:n(311),CONTEXT_LOST:n(312),CONTEXT_RESTORED:n(313),DESTROY:n(314),FOCUS:n(315),HIDDEN:n(316),PAUSE:n(317),POST_RENDER:n(318),POST_STEP:n(319),PRE_RENDER:n(320),PRE_STEP:n(321),READY:n(322),RESUME:n(323),STEP:n(324),VISIBLE:n(325)}},function(t,e){t.exports="blur"},function(t,e){t.exports="boot"},function(t,e){t.exports="contextlost"},function(t,e){t.exports="contextrestored"},function(t,e){t.exports="destroy"},function(t,e){t.exports="focus"},function(t,e){t.exports="hidden"},function(t,e){t.exports="pause"},function(t,e){t.exports="postrender"},function(t,e){t.exports="poststep"},function(t,e){t.exports="prerender"},function(t,e){t.exports="prestep"},function(t,e){t.exports="ready"},function(t,e){t.exports="resume"},function(t,e){t.exports="step"},function(t,e){t.exports="visible"},function(t,e,n){t.exports={POST_RENDER:n(327),PRE_RENDER:n(328),RENDER:n(329),RESIZE:n(330)}},function(t,e){t.exports="postrender"},function(t,e){t.exports="prerender"},function(t,e){t.exports="render"},function(t,e){t.exports="resize"},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,n){var i=t.gl;t.flush(),0===t.maskStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:n}),this.applyStencil(t,n,!0),t.maskCount++},applyStencil:function(t,e,n){var i=t.gl,a=this.geometryMask,s=t.maskCount;i.colorMask(!1,!1,!1,!1),n?(i.stencilFunc(i.EQUAL,s,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,s+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),a.renderWebGL(t,a,e),t.flush(),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),n?this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s+1,255):i.stencilFunc(i.EQUAL,s+1,255):this.invertAlpha?i.stencilFunc(i.NOTEQUAL,s,255):i.stencilFunc(i.EQUAL,s,255)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var n,i=t.currentMask;0===t.maskStack.length?(i.mask=null,e.disable(e.STENCIL_TEST)):((n=t.maskStack[t.maskStack.length-1]).mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(i.mask=n.mask,i.camera=n.camera):i.mask=null)},preRenderCanvas:function(t,e,n){var i=this.geometryMask;t.currentContext.save(),i.renderCanvas(t,i,n,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=i},function(t,e){t.exports={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}},function(t,e,n){var i=n(19),a=n(334),s=n(10),r=n(335),o=n(2),h={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:r.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var n=this.pathTween;return n&&n.isPlaying()&&n.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(t,e){void 0===t&&(t={}),void 0===e&&(e=0);var n=this.pathTween;n&&n.isPlaying()&&n.stop(),"number"==typeof t&&(t={duration:t}),t.from=s(t,"from",0),t.to=s(t,"to",1);var h=a(t,"positionOnPath",!1);this.rotateToPath=a(t,"rotateToPath",!1),this.pathRotationOffset=s(t,"rotationOffset",0);var c,l=s(t,"startAt",e);return l&&(t.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var n=e.ease(e.progress);e.current=e.start+(e.end-e.start)*n,e.target[e.key]=e.current}),this.pathOffset||(this.pathOffset=new o(this.x,this.y)),this.pathVector||(this.pathVector=new o),this.pathDelta||(this.pathDelta=new o),this.pathDelta.reset(),this.pathTween=this.scene.sys.tweens.addCounter(t),this.path.getStartPoint(this.pathOffset),h&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=r.PLAYING_FORWARD,this.rotateToPath&&(c=this.path.getPoint(.1),this.rotation=Math.atan2(c.y-this.y,c.x-this.x)+i(this.pathRotationOffset)),this.pathConfig=t,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var t=this.pathTween;if(t){var e=t.data[0],n=this.pathDelta,a=this.pathVector;if(n.copy(a).negate(),e.state===r.COMPLETE)return this.path.getPoint(1,a),n.add(a),a.add(this.pathOffset),void this.setPosition(a.x,a.y);if(e.state!==r.PLAYING_FORWARD&&e.state!==r.PLAYING_BACKWARD)return;this.path.getPoint(t.getValue(),a),n.add(a),a.add(this.pathOffset);var s=this.x,o=this.y;this.setPosition(a.x,a.y);var h=this.x-s,c=this.y-o;if(0==h&&0==c)return;if(e.state!==this._prevDirection)return void(this._prevDirection=e.state);this.rotateToPath&&(this.rotation=Math.atan2(c,h)+i(this.pathRotationOffset))}}};t.exports=h},function(t,e){t.exports=function(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}},function(t,e){t.exports={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26}},function(t,e,n){var i=n(337),a=n(338),s=n(12),r={defaultPipeline:null,pipeline:null,hasPostPipeline:!1,postPipelines:null,pipelineData:null,initPipeline:function(t){void 0===t&&(t=a.MULTI_PIPELINE);var e=this.scene.sys.renderer;if(!e)return!1;var n=e.pipelines;if(this.postPipelines=[],this.pipelineData={},n){var i=n.get(t);if(i)return this.defaultPipeline=i,this.pipeline=i,!0}return!1},setPipeline:function(t,e,n){var a=this.scene.sys.renderer;if(!a)return this;var s,r=a.pipelines;return r&&((s=r.get(t))&&(this.pipeline=s),e&&(this.pipelineData=n?i(e):e)),this},setPostPipeline:function(t,e,n){var a=this.scene.sys.renderer;if(!a)return this;var s=a.pipelines;if(s){Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var o=s.getPostPipeline(t[r],this);o&&this.postPipelines.push(o)}e&&(this.pipelineData=n?i(e):e)}return this.hasPostPipeline=0<this.postPipelines.length,this},setPipelineData:function(t,e){var n=this.pipelineData;return void 0===e?delete n[t]:n[t]=e,this},getPostPipeline:function(t){for(var e=this.postPipelines,n=[],i=0;i<e.length;i++){var a=e[i];("string"==typeof t&&a.name===t||a instanceof t)&&n.push(a)}return 1===n.length?n[0]:n},resetPipeline:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.pipeline=this.defaultPipeline,t&&(this.postPipelines=[],this.hasPostPipeline=!1),e&&(this.pipelineData={}),null!==this.pipeline},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,n=0;n<e.length;n++)e[n].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.pipelineData={})},removePostPipeline:function(t){for(var e=this.postPipelines,n=e.length-1;0<=n;n--){var i=e[n];("string"==typeof t&&i.name===t||"string"!=typeof t&&i instanceof t)&&(i.destroy(),s(e,n))}return this.hasPostPipeline=0<this.postPipelines.length,this},getPipelineName:function(){return this.pipeline.name}};t.exports=r},function(t,e){t.exports=function t(e){var n,i,a;if("object"!=typeof e||null===e)return e;for(a in n=Array.isArray(e)?[]:{},e)i=e[a],n[a]=t(i);return n}},function(t,e){t.exports={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline"}},function(t,e){var n={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){return void 0===t&&(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};t.exports=n},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){t.exports={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,n,i){return void 0===t&&(t=16777215),void 0===e&&(i=n=e=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=n,this.tintBottomRight=i,this.tintFill=!1,this},setTintFill:function(t,e,n,i){return this.setTint(t,e,n,i),this.tintFill=!0,this},tint:{set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}},function(t,e,n){var i=n(1),a=n(1);i=n(344),a=n(345);t.exports={renderWebGL:i,renderCanvas:a}},function(t,e){t.exports=function(t,e,n,i){var a=e.list,s=a.length;if(0!==s){n.addToRenderList(e);var r=e.localTransform;i?(r.loadIdentity(),r.multiply(i),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=-1!==e.blendMode;o||t.setBlendMode(0);for(var h=e.alpha,c=e.scrollFactorX,l=e.scrollFactorY,u=0;u<s;u++){var d,p,f,g,m,v,y,S,A=a[u];A.willRender(n)&&(g=void 0!==A.alphaTopLeft?(d=A.alphaTopLeft,p=A.alphaTopRight,f=A.alphaBottomLeft,A.alphaBottomRight):f=p=d=A.alpha,m=A.scrollFactorX,v=A.scrollFactorY,o||A.blendMode===t.currentBlendMode||t.setBlendMode(A.blendMode),(y=A.mask)&&y.preRenderWebGL(t,A,n),(S=A.type)!==t.currentType&&(t.newType=!0,t.currentType=S),t.nextTypeMatch=u<s-1&&a[u+1].type===t.currentType,A.setScrollFactor(m*c,v*l),A.setAlpha(d*h,p*h,f*h,g*h),A.renderWebGL(t,A,n,r),A.setAlpha(d,p,f,g),A.setScrollFactor(m,v),y&&y.postRenderWebGL(t,n),t.newType=!1)}t.pipelines.postBatch(e)}}},function(t,e){t.exports=function(t,e,n,i){var a=e.list;if(0!==a.length){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var r=-1!==e.blendMode;r||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,c=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var l=0;l<a.length;l++){var u,d,p,f=a[l];f.willRender(n)&&(u=f.alpha,d=f.scrollFactorX,p=f.scrollFactorY,r||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode),f.setScrollFactor(d*h,p*c),f.setAlpha(u*o),f.renderCanvas(t,f,n,s),f.setAlpha(u),f.setScrollFactor(d,p))}e.mask&&e.mask.postRenderCanvas(t)}}},function(t,e,n){var i=n(25);t.exports=function(t,e,n){void 0===n&&(n=new i);var a=Math.min(t.x,e.x),s=Math.min(t.y,e.y),r=Math.max(t.right,e.right)-a,o=Math.max(t.bottom,e.bottom)-s;return n.setTo(a,s,r,o)}},function(t,e,n){var i=n(1),a=n(1);i=n(348),a=n(349);t.exports={renderWebGL:i,renderCanvas:a}},function(t,e){t.exports=function(t,e,n,i){var a=e.plugin.sceneRenderer,s=e.list;if(0!==s.length){n.addToRenderList(e);var r=e.localTransform;i?(r.loadIdentity(),r.multiply(i),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.newType&&(t.pipelines.clear(),a.begin());var o=t.nextTypeMatch;t.nextTypeMatch=!0,t.newType=!1;for(var h=0;h<s.length;h++){var c,l=s[h];l.willRender(n,e)&&((c=l.mask)&&(a.end(),t.pipelines.rebind(),c.preRenderWebGL(t,l,n),t.pipelines.clear(),a.begin()),l.renderWebGL(t,l,n,r,e),c&&(a.end(),t.pipelines.rebind(),c.postRenderWebGL(t,n),t.pipelines.clear(),a.begin()))}(t.nextTypeMatch=o)||(a.end(),t.pipelines.rebind())}else a.batcher.isDrawing&&t.finalType&&(a.end(),t.pipelines.rebind())}},function(t,e){t.exports=function(t,e,n,i){var a=e.list;if(0!==a.length){n.addToRenderList(e);var s=e.localTransform;i?(s.loadIdentity(),s.multiply(i),s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(e.scaleX,e.scaleY)):s.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var r=-1!==e.blendMode;r||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,c=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,n);for(var l=0;l<a.length;l++){var u,d,p,f=a[l];f.willRender(n)&&(u=f.alpha,d=f.scrollFactorX,p=f.scrollFactorY,r||f.blendMode===t.currentBlendMode||t.setBlendMode(f.blendMode),f.setScrollFactor(d*h,p*c),f.setAlpha(u*o),f.renderCanvas(t,f,n,s),f.setAlpha(u),f.setScrollFactor(d,p))}e.mask&&e.mask.postRenderCanvas(t)}}}]);var jI=["Enable"],qI=function(t){function e(e){return t.call(this,e)||this}(0,Kt.default)(e,t);var i=e.prototype;return i.boot=function(){var e=(0,Xt.default)(qt().mark((function e(){return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.prototype.boot.call(this),this.addExtraGameObjectMethods(),this.addExtraFBInstantFunctions(),this.addPlugins(),e.next=6,this.addDevPlugins();case 6:this.addScenes(),this.addDevScenes(),this.initAds(),this.initWorld(),this.initStorage(),this.initLanguage(),this.initUtils(),this.initConsole(),this.initDebugger(),this.initStatistics(),this.initParticleEditor(),this.handleShowAdWhenStartGame(),this.initAdaptivePerformance();case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.start=function(){t.prototype.start.call(this)},i.updateFps=function(t){void 0===t&&(t=60),this.getFps()!==t&&this.setFps(t)},i.getFps=function(){return this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf?this.scene.game.loop.raf.fps:5},i.setFps=function(t){this.scene.game&&this.scene.game.loop&&this.scene.game.loop.raf&&"function"===typeof this.scene.game.loop.raf.updateFps&&this.scene.game.loop.raf.updateFps(t)},i.addExtraGameObjectMethods=function(){var t=new Qt(this);t.addKillRevive(),t.addDrawDebugBox(),t.addSetWorldSize(),t.addSetWorldSizeForContainer(),t.addGetWorldPosition(),t.addHighQuality()},i.addExtraFBInstantFunctions=function(){var t=new Zt.default(this.facebook);this.facebook.shareAsync=t.shareAsync,this.facebook.inviteAsync=t.inviteAsync,this.facebook.switchAsync=t.switchAsync,this.facebook.chooseAsync=t.chooseAsync,this.facebook.createAsync=t.createAsync,this.facebook.sendMessage=t.sendMessage,this.facebook.getContextID=t.getContextID,this.facebook.getPlayerToken=t.getPlayerToken,this.facebook.matchPlayerAsync=t.matchPlayerAsync,this.facebook.getContextPlayers=t.getContextPlayers,this.facebook.setLoadingProgress=t.setLoadingProgress,this.facebook.attemptToAddShortcut=t.attemptToAddShortcut,this.facebook.attemptToSubscribeBot=t.attemptToSubscribeBot,this.facebook.postSessionScoreAsync=t.postSessionScoreAsync,this.facebook.getRewardedVideoAsync=t.getRewardedVideoAsync,this.facebook.getInterstitialAdAsync=t.getInterstitialAdAsync,this.facebook.setLoadingProgress=t.setLoadingProgress,this.facebook.getLocale=t.getLocale,this.facebook.postSessionScoreAsync=t.postSessionScoreAsync,t.injectTournament(),this.facebook.progressLoading=new bI(this)},i.addPlugins=function(){this.plugins.install("Storage",vs,!0,"storage"),this.plugins.install("AdsManager",ue,!0,"ads"),this.plugins.install("AuthManager",Pe,!0,"auth"),this.plugins.install("AudioManager",ye,!0,"audio"),this.plugins.install("WorldManager",ws,!0,"world"),this.plugins.install("PlayerManager",Wn,!0,"player"),this.plugins.install("ProfileManager",$n,!0,"profile"),this.plugins.install("AnalyticsManager",fe,!0,"analytics"),this.plugins.install("LanguageManager",SI,!0,"lang"),this.plugins.install("AdaptivePerformance",iI,!0,"performance"),this.plugins.installScenePlugin("textStyler",bs,"textStyler"),this.plugins.installScenePlugin("ScreenManager",oi,"screen"),this.plugins.installScenePlugin("FrameCapture",Re,"frameCapture"),this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),window.SpinePlugin&&this.plugins.installScenePlugin("SpinePlugin",SpinePlugin,"spine"),this.storage=this.plugins.get("Storage"),this.ads=this.plugins.get("AdsManager"),this.auth=this.plugins.get("AuthManager"),this.audio=this.plugins.get("AudioManager"),this.world=this.plugins.get("WorldManager"),this.player=this.plugins.get("PlayerManager"),this.profile=this.plugins.get("ProfileManager"),this.analytics=this.plugins.get("AnalyticsManager"),this.lang=this.plugins.get("LanguageManager"),this.performance=this.plugins.get("AdaptivePerformance")},i.addDevPlugins=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,i,a,s;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(GameCore.Utils.Valid.isDebugger()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Promise.all([n.e(7),n.e(716)]).then(n.bind(n,562));case 4:return e=t.sent.default,t.next=7,Promise.all([n.e(498),n.e(114),n.e(227)]).then(n.bind(n,563));case 7:return i=t.sent.default,t.next=10,n.e(315).then(n.bind(n,564));case 10:return a=t.sent.default,t.next=13,Promise.all([n.e(498),n.e(516)]).then(n.bind(n,565));case 13:s=t.sent.default,this.plugins.install("Console",e,!0,"console"),this.plugins.install("Debugger",i,!0,"debugger"),this.plugins.install("Statistics",a,!0,"statistics"),this.plugins.install("ParticleEditor",s,!0,"particle-editor"),this.eruda=this.plugins.get("Console"),this.debugger=this.plugins.get("Debugger"),this.statistics=this.plugins.get("Statistics"),this.particleEditor=this.plugins.get("ParticleEditor");case 22:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.addScenes=function(){this.scene.add(qs.SceneKeys.BOOT_SCENE,er,!0),this.scene.add(qs.SceneKeys.LOAD_SCENE,Yx,!1),this.scene.add(qs.SceneKeys.GAME_SCENE,mE,!1),this.scene.add(qs.SceneKeys.LEVEL_SCENE,QP,!1),this.scene.add(qs.SceneKeys.JOURNEY_SCENE,aP,!1),this.scene.add(qs.SceneKeys.DASHBOARD_SCENE,PT,!1),this.scene.add(qs.SceneKeys.GLOBAL_SCENE,FE,!1)},i.addDevScenes=function(){var t=(0,Xt.default)(qt().mark((function t(){var e,i;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(GameCore.Utils.Valid.isDebugger()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.e(817).then(n.bind(n,567));case 4:return e=t.sent.default,t.next=7,n.e(161).then(n.bind(n,568));case 7:i=t.sent.default,this.scene.add(qs.SceneKeys.TEST_SCENE,e,!1),this.scene.add(qs.SceneKeys.ANIMATIONS_SCENE,i,!1);case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i.initAds=function(){var t=GameCore.Configs.Ads;sI.setGame(this);var e=t.Mockup.Enable?gI:sI,n=(0,wt.default)({},t.InterstitialAdOptions);n.showWhenStartGame&&(n.secondsFirstTime=0),this.ads.configure(e,{enabled:t.Enabled,interstitialPID:t.InterstitialPlacementId,rewardedVideoPID:t.VideoRewardsPlacementId,interstitialAdOptions:n,bannerAdOptions:t.BannerAdOptions})},i.initWorld=function(){var t=GameCore.Configs.Game;this.world.configure({width:375,height:667,ratio:320/518}),this.world.resize(t.ForcePixelRatio)},i.initStorage=function(){var t=new js(this);this.storage.setInitiator(t)},i.initLanguage=function(){var t=this.facebook.getLocale();this.lang.configure({locale:t,upperCaseText:!0})},i.initUtils=function(){this.handlePauseAudio()},i.initConsole=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Debugger.ShowConsole&&this.eruda.configure({tool:["console","info"],defaults:{theme:"Dark"}}))},i.initDebugger=function(){if(GameCore.Utils.Valid.isDebugger()){var t=GameCore.Configs.Debugger,e=t.ShowInspector,n=t.ShowMonitoring;(e||n)&&this.debugger.configure(GameCore.Configs.Debugger)}},i.initStatistics=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.Statistics.Enable&&this.statistics.configure(GameCore.Configs.Statistics))},i.initParticleEditor=function(){GameCore.Utils.Valid.isDebugger()&&(GameCore.Configs.ParticleEditor.Enable&&this.particleEditor.configure(GameCore.Configs.ParticleEditor))},i.initAdaptivePerformance=function(){var t=GameCore.Configs.Performance,e=t.Enable,n=(0,Wt.default)(t,jI);if(e){var i=this.world.getPixelRatio();this.performance.configure((0,wt.default)({pixelRatio:i},n)),this.performance.active()}},i.handlePauseAudio=function(){var t=this;this.sound.pauseOnBlur=!1,document.addEventListener("visibilitychange",(function(){document.hidden?t.audio.pauseMusic():t.audio.playMusic()}))},i.removeUnusedPipelines=function(){var t=this.renderer;if(t instanceof Phaser.Renderer.WebGL.WebGLRenderer){var e=t.pipelines,n=Phaser.Renderer.WebGL.Pipelines;if(n)[n.ROPE_PIPELINE,n.LIGHT_PIPELINE,n.POSTFX_PIPELINE,n.POINTLIGHT_PIPELINE,n.BITMAPMASK_PIPELINE].forEach((function(t){var n;null==(n=e.get(t))||n.destroy(),e.remove(t)}))}},i.handleShowAdWhenStartGame=function(){var t=(0,Xt.default)(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ads.showBannerAdAsync().catch(Ht.sendException),GameCore.Configs.Ads.InterstitialAdOptions.showWhenStartGame){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,this.audio.stopMusic(),this.audio.muteAll(),t.next=9,this.ads.preloadInterstitialAdAsync();case 9:return t.next=11,this.ads.showInterstitialAdAsync();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),(0,Ht.sendException)(t.t0);case 16:return t.prev=16,this.audio.unmuteAll(),this.audio.playMusic(),t.finish(16);case 20:case"end":return t.stop()}}),t,this,[[4,13,16,20]])})));return function(){return t.apply(this,arguments)}}(),e}(Phaser.Game),ZI=qI,JI=GameCore.Configs.Debugger.ShowInspector,QI={parent:"app",type:Phaser.AUTO,width:0,height:0,scale:{autoRound:!0},dom:{createContainer:!1},loader:{maxParallelDownloads:6,crossOrigin:"no-cros"},audio:{noAudio:!1,disableWebAudio:!1},input:{gamepad:!1,keyboard:JI,touch:{capture:!0},smoothFactor:1,activePointers:1,windowEvents:!1},disableContextMenu:!0,fps:{},render:{pixelArt:!1,antialias:!0,antialiasGL:!0,transparent:!0,desynchronized:!1,powerPreference:"low-power",clearBeforeRender:!1,roundPixels:!1},plugins:{global:[]}};window.GameCore=zt,(0,Ht.initSentry)();var $I=setInterval((function(){window.__analyticsInitiated&&(window.__fbGameReady=!1,clearInterval($I),clearInterval(window.__fbInstantLoadingTimer),GameSDK.setLoadingProgress(30),gtag("event","app_initialize",{send_to:["GA"]}),function(){try{var t=new ZI(QI);window.game=t}catch(e){(0,Ht.sendException)(e)}}())}),50)},252:function(t,e,n){"use strict";n.r(e);var i=n(119),a=function(){function t(t,e,n,a){this.playerId=void 0,this.name=void 0,this.photo=void 0,this.locale=void 0,this.playerId=t,this.name=e,this.photo=n||i.default.AVATAR.FILE,this.locale=a||"en_US"}return t.prototype.toObject=function(){return{playerId:this.playerId,name:this.name,photo:this.photo,locale:this.locale}},t}();e.default=a},142:function(t,e,n){"use strict";n.r(e),n.d(e,{sleepAsync:function(){return o},checkIsToday:function(){return h},formatDateHMS:function(){return c},getDateDMY:function(){return l},convertHMS:function(){return u}});var i=n(44),a=n.n(i),s=n(48),r=n.n(s),o=function(t){return new(a())((function(e){return setTimeout(e,t)}))},h=function(t){var e=new Date(t),n=new Date;return e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear()},c=function(t,e){void 0===e&&(e=!0);var n=new Date(t).toISOString();return e?r()(n).call(n,11,-5):r()(n).call(n,14,-5)},l=function(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,i=""+e,a=""+n;return e<10&&(i="0"+e),n<10&&(a="0"+n),i+"/"+a+"/"+t.getFullYear()},u=function(t){var e=t/1e3,n=Math.floor(e/3600),i=Math.floor((e-3600*n)/60);return{hours:n,minutes:i,seconds:Math.floor(e-3600*n-60*i)}}},28:function(t,e,n){"use strict";n.r(e),n.d(e,{initSentry:function(){return i},addBreadcrumbSentry:function(){return a},setSentryUser:function(){return s},sendExceptionWithScope:function(){return r},sendException:function(){return o}});n(323),n(160),n(95),n(31);var i=function(){var t=setInterval((function(){window.Sentry&&clearInterval(t)}),100)},a=function(t,e){window.Sentry&&window.Sentry.addBreadcrumb({category:t,message:e})},s=function(t){window.Sentry&&window.Sentry.setUser(t)},r=function(t,e){t&&window.Sentry.withScope((function(t){t.setExtras(e)}))},o=function(t){}},444:function(t,e,n){"use strict";n.r(e),n.d(e,{getImageScale:function(){return i}});var i=function(){return GameCore.Utils.Device.isDesktop()||GameCore.Utils.Device.pixelRatio()>1?2:1}}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[216],(function(){return e(573),e(572),e(557),e(531)}));t.O()}]);